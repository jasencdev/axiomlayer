apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: telnet-server-pdb
  namespace: telnet-server
  labels:
    app: telnet-server
    app.kubernetes.io/name: telnet-server
    app.kubernetes.io/component: server
    app.kubernetes.io/part-of: homelab
spec:
  minAvailable: 1
  selector:
    matchLabels:
      app: telnet-server
apiVersion: v1
kind: Namespace
metadata:
  name: telnet-server
  labels:
    name: telnet-server
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: apps/v1
kind: Deployment
metadata:
  name: telnet-server
  namespace: telnet-server
  labels:
    app: telnet-server
    app.kubernetes.io/name: telnet-server
    app.kubernetes.io/component: server
    app.kubernetes.io/part-of: homelab
spec:
  replicas: 2
  selector:
    matchLabels:
      app: telnet-server
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
  template:
    metadata:
      labels:
        app: telnet-server
        app.kubernetes.io/name: telnet-server
        app.kubernetes.io/component: server
        app.kubernetes.io/part-of: homelab
      annotations:
        prometheus.io/scrape: 'true'
        prometheus.io/port: '9000'
    spec:
      securityContext:
        runAsNonRoot: true
        runAsUser: 1000
        runAsGroup: 1000
        fsGroup: 1000
        seccompProfile:
          type: RuntimeDefault
      containers:
      - name: telnet-server
        image: ghcr.io/jasencarroll/telnet-server@sha256:e08fde2a9b0db0aa0a36e824bc1bc15dc7fe5cec9fcbead5243b7124d09cb041
        imagePullPolicy: Always
        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: true
          capabilities:
            drop:
              - ALL
        resources:
          requests:
            cpu: 100m
            memory: 16Mi
          limits:
            cpu: 500m
            memory: 128Mi
        ports:
        - containerPort: 2323
          name: telnet
        - containerPort: 9000
          name: metrics
        livenessProbe:
          tcpSocket:
            port: 2323
          initialDelaySeconds: 10
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        readinessProbe:
          tcpSocket:
            port: 2323
          initialDelaySeconds: 5
          periodSeconds: 5
          timeoutSeconds: 3
          failureThreshold: 3
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - deployment.yaml
  - service.yaml
  - certificate.yaml
  - ingress.yaml
  - pdb.yaml
  - networkpolicy.yaml
labels:
  - pairs:
      app.kubernetes.io/managed-by: argocd
      app.kubernetes.io/part-of: homelab
    includeSelectors: false
apiVersion: v1
kind: Service
metadata:
  name: telnet-server
  namespace: telnet-server
  labels:
    app: telnet-server
spec:
  type: LoadBalancer
  ports:
  - port: 2323
    name: telnet
    protocol: TCP
    targetPort: 2323
  selector:
    app: telnet-server
---
apiVersion: v1
kind: Service
metadata:
  name: telnet-server-metrics
  namespace: telnet-server
  labels:
    app: telnet-server
  annotations:
    prometheus.io/scrape: 'true'
    prometheus.io/port: '9000'
spec:
  type: ClusterIP
  ports:
  - port: 9000
    name: metrics
    protocol: TCP
    targetPort: 9000
  selector:
    app: telnet-server
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: telnet-metrics-tls
  namespace: telnet-server
spec:
  secretName: telnet-metrics-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - telnet.lab.axiomlayer.com
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: telnet-server-default-deny
  namespace: telnet-server
  labels:
    app.kubernetes.io/name: telnet-server
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: telnet-server-allow-ingress
  namespace: telnet-server
  labels:
    app.kubernetes.io/name: telnet-server
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: telnet-server
  policyTypes:
    - Ingress
  ingress:
    # Allow traffic from Traefik ingress controller
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: kube-system
          podSelector:
            matchLabels:
              app.kubernetes.io/name: traefik
      ports:
        - protocol: TCP
          port: 2323
    # Allow Prometheus scraping metrics
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: monitoring
      ports:
        - protocol: TCP
          port: 9000
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: telnet-server-allow-egress
  namespace: telnet-server
  labels:
    app.kubernetes.io/name: telnet-server
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: telnet-server
  policyTypes:
    - Egress
  egress:
    # Allow DNS resolution
    - to:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              k8s-app: kube-dns
      ports:
        - protocol: UDP
          port: 53
        - protocol: TCP
          port: 53
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: telnet-metrics
  namespace: telnet-server
  annotations:
    traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
spec:
  ingressClassName: traefik
  tls:
  - hosts:
    - telnet.lab.axiomlayer.com
    secretName: telnet-metrics-tls
  rules:
  - host: telnet.lab.axiomlayer.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: telnet-server-metrics
            port:
              number: 9000
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: campfire
  namespace: campfire
  labels:
    app.kubernetes.io/name: campfire
    app.kubernetes.io/component: chat
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  minAvailable: 0
  selector:
    matchLabels:
      app.kubernetes.io/name: campfire
apiVersion: v1
kind: Namespace
metadata:
  name: campfire
  labels:
    app.kubernetes.io/name: campfire
    app.kubernetes.io/component: chat
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: apps/v1
kind: Deployment
metadata:
  name: campfire
  namespace: campfire
  labels:
    app.kubernetes.io/name: campfire
    app.kubernetes.io/component: chat
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: campfire
  strategy:
    type: Recreate
  template:
    metadata:
      labels:
        app.kubernetes.io/name: campfire
        app.kubernetes.io/component: chat
        app.kubernetes.io/part-of: homelab
    spec:
      nodeSelector:
        kubernetes.io/arch: amd64
      imagePullSecrets:
        - name: ghcr-pull-secret
      securityContext:
        runAsNonRoot: true
        runAsUser: 1000
        runAsGroup: 1000
        fsGroup: 1000
        seccompProfile:
          type: RuntimeDefault
      containers:
        - name: campfire
          image: ghcr.io/jasencdev/campfire@sha256:d0d4d90dea7910d5ab4ad629d4bf0c50ab54f50855f0f75bdb23ee968e40a8a8
          ports:
            - containerPort: 80
              name: http
          envFrom:
            - configMapRef:
                name: campfire-config
            - secretRef:
                name: campfire-secret
          securityContext:
            allowPrivilegeEscalation: false
            # Rails requires writable filesystem for tmp, cache, and asset compilation
            readOnlyRootFilesystem: false
            capabilities:
              drop: ["ALL"]
          resources:
            requests:
              cpu: 100m
              memory: 256Mi
            limits:
              cpu: 1000m
              memory: 1Gi
          volumeMounts:
            - name: storage
              mountPath: /rails/storage
          livenessProbe:
            httpGet:
              path: /up
              port: 80
            initialDelaySeconds: 30
            periodSeconds: 30
            timeoutSeconds: 10
          readinessProbe:
            httpGet:
              path: /up
              port: 80
            initialDelaySeconds: 10
            periodSeconds: 10
            timeoutSeconds: 5
      volumes:
        - name: storage
          persistentVolumeClaim:
            claimName: campfire-storage
apiVersion: v1
kind: ConfigMap
metadata:
  name: campfire-config
  namespace: campfire
  labels:
    app.kubernetes.io/name: campfire
    app.kubernetes.io/component: config
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
data:
  # Disable built-in SSL - Traefik handles TLS termination
  DISABLE_SSL: "true"
  # Rails environment
  RAILS_ENV: "production"
  RAILS_LOG_TO_STDOUT: "true"
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - pvc.yaml
  - configmap.yaml
  - sealed-secret.yaml
  - sealed-pull-secret.yaml
  - deployment.yaml
  - service.yaml
  - certificate.yaml
  - ingress.yaml
  - networkpolicy.yaml
  - pdb.yaml
apiVersion: v1
kind: Service
metadata:
  name: campfire
  namespace: campfire
  labels:
    app.kubernetes.io/name: campfire
    app.kubernetes.io/component: chat
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  selector:
    app.kubernetes.io/name: campfire
  ports:
    - port: 80
      targetPort: http
      name: http
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: campfire-tls
  namespace: campfire
  labels:
    app.kubernetes.io/name: campfire
    app.kubernetes.io/component: tls
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  secretName: campfire-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - chat.lab.axiomlayer.com
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: campfire-default-deny
  namespace: campfire
  labels:
    app.kubernetes.io/name: campfire
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: campfire-allow-ingress
  namespace: campfire
  labels:
    app.kubernetes.io/name: campfire
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: campfire
  policyTypes:
    - Ingress
  ingress:
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: kube-system
          podSelector:
            matchLabels:
              app.kubernetes.io/name: traefik
      ports:
        - protocol: TCP
          port: 80
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: campfire-allow-egress
  namespace: campfire
  labels:
    app.kubernetes.io/name: campfire
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: campfire
  policyTypes:
    - Egress
  egress:
    - to:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              k8s-app: kube-dns
      ports:
        - protocol: UDP
          port: 53
        - protocol: TCP
          port: 53
    - to:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: authentik
      ports:
        - protocol: TCP
          port: 9000
        - protocol: TCP
          port: 9443
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: campfire-secrets
  namespace: campfire
spec:
  encryptedData:
    secret-key-base: AgBbUSZs+NKrQU+hIcK/nLQ3pWI/LLRmFW8SrpgpLmTwwdgXfsG679/QQ9c6iiI5Lx/NZWUVO8Y5vNgAhaAzQ4WS1zF6VRlgRle4gwPIW6UKfntDZ2VuDziVHAm7K8vm1wAv4UPUH6pRfhjZsvEp+th3Clw2JpLDg9EcOVmc+WRVbNhbKjqt7LZ9ZNMzflqIG5M8PZeJh1lprTD3aZS34d5RG2rOL7xGPUP9Xa9aC1N6L/q74yjkPBHGQp3FFRAshahvjdoC4tg5MQ1laN4PS2QbnxWKyvicJYaAaKiG/QazAEFNbE7k0tGaItJ+XPuEQV8xZTcgwLVj8m4R6mJAqJXywioYmxr1OE5aqE1/1m8pMvNtPdoEHBs7i99C9bHNKs1bMIIqTz8uf0WlMA59uKEs0R0om+8iCDKNxW6iXqUk1RPmPlarRkrGPCV0Y8VgT8whRSNynN9CTy3IbeInF9YmiifT2REacKJ0/Z/v2dmK8lsLyk2mrTTJHWT2u0QhuPvoVZ3nL2fNN7LSzHA1fAEW8QxeIt5zcpxcFVVLLzScHK5gCc1oZKwygaNzMx9748StKxJ/ikJCiE5uQWesZlgq9YtrqcCmUB9p8dTeseWV6E+MdUz33VKTUyUtpNCJO+q7slFh1EDb8lV6a9R+IJMT3sy1B/QPJ6AUI3eSIgyq7FViQdu/RwT4v6VahxVBctU=
    vapid-private-key: AgA9Tq8/ROZ1CR0vdTfqGEI5uqQNOTxLR3SdA6FozVDZlIktB2CvkvVCobq88RpJd8wK8gyTzDR8SeBNXidb080l9aFOfkTnuUYg651Cs1QAe8YVau9HQF7EoLnVTMlVAVnGEai4cpZqlKa4yUwXSnvUJtwxRkBvIxTaE5AykMONT8aVBn0DitRVH00/LQaiF2rNPZlj+rVMl81iH15kGRFptHiCNmwhNfibWGE/F7WlxvAbYHXWhCbezNOp9gf6DtPh8soDFhwTfjG8fE3yRCyl2dht2fRDF9aEv/zvurETgE9hVxBx+qfMoRsyRUNg6WHZUWURXB/8ncSC57cDiQSYLkrkR9R0mo4+/v10VzKZPo8yt+k42+Dvo3bZLKOxNfpknWXCUQVIM5gdTpMGQg6hawjVTkq1WeVJ+8Q6sHfwQi3EDQag84j+9DyZbM0CrcYWV87S7OxLUTRr60sj/JGI801z8HHaMKi6Goi2sHUX8ooRkCkljJJrVNa93SW9TQftv6l4RD1KqmfdmCvbDUwJvsF1iRvsSZOp/f6oRC4SHVkRgEMtze4ZrcWlxe8GLqV88pPOOzjJbHjRhAvQZ14lsEc5EniKcko9PNqNY1rvhPgkwtuhGZQ9E8jD7LVTV2GDOoxvC4zBicGXZBseU9xEpwfAfK0LwIwf5U3elobp3srQ0F2r2uCyJNIGmkIbHFo=
    vapid-public-key: AgCIF847TbDJCnVvHRFVd2UjtntVRf30JR4WjHkXZ83Z8JYcqTVo955q/pE+dWdabLmTqDTK/Np0bH5zX2wuMmVeP1P6g7dumimnRKt49ZuKU/xLTLYuUrAiBNi0uTpY7tuS6S3TA6/gNnqMg+Vx+bJYmycplffyKWHH4M+vug49kS80GXlsgP3rHmdlIRPTxptu8EGvhYAbtCId8PVmjco6/tIdhufSPgwJ28mgN0BV5dSD70IHwPmeZNhg9iSXSLaprzYDdpj3o9uwAFGJx21rVbdFmheWCLC9Q5fXmv5K8rO9vsJiM2tdwcesEbpmtB2qW2n16HDPXi7sspxp90OT6GHGuCBpJ3hDi7factaQ4SDZ9ZI501vUfrnErF/G5bndyyFEHLdOk8Bi62ywh1LGiHoAKGCzbJiT0SVA/oQUHGo+ExIn5PgU8GDTuSeSFK5kAYKsa6QfVDWKoJXT62vSC9/LUxRtnn07LknJKoZmpjv448bJgH0zBhCD1iNkyjNl3nywC/DdIWerg2gLnS0ugTgVyITOPJCK+isl/SZyh19T0XWICKDcTfDphJ4+sJwVcSqV/jZz/h9xWWWkxkg8weTZDsXRr6Szs3KiuWsB5IxCpSBW/rCTPPx46GkP+Jk9wZu0KMOSUparUv1GVraWhKrAeeyVnPx0FBCLpaTzrzNxau8kr4aYXp04dCMcciM=
  template:
    metadata:
      name: campfire-secrets
      namespace: campfire
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: campfire-storage
  namespace: campfire
  labels:
    app.kubernetes.io/name: campfire
    app.kubernetes.io/component: storage
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: longhorn
  resources:
    requests:
      storage: 5Gi
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: campfire
  namespace: campfire
  labels:
    app.kubernetes.io/name: campfire
    app.kubernetes.io/component: chat
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
    traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
spec:
  ingressClassName: traefik
  tls:
    - hosts:
        - chat.lab.axiomlayer.com
      secretName: campfire-tls
  rules:
    - host: chat.lab.axiomlayer.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: campfire
                port:
                  number: 80
---
# Separate ingress for static assets that don't need auth
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: campfire-static
  namespace: campfire
  labels:
    app.kubernetes.io/name: campfire
    app.kubernetes.io/component: chat
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
    traefik.ingress.kubernetes.io/router.priority: "100"
spec:
  ingressClassName: traefik
  tls:
    - hosts:
        - chat.lab.axiomlayer.com
      secretName: campfire-tls
  rules:
    - host: chat.lab.axiomlayer.com
      http:
        paths:
          - path: /webmanifest.json
            pathType: Exact
            backend:
              service:
                name: campfire
                port:
                  number: 80
          - path: /service-worker.js
            pathType: Exact
            backend:
              service:
                name: campfire
                port:
                  number: 80
          - path: /cable
            pathType: Prefix
            backend:
              service:
                name: campfire
                port:
                  number: 80
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: ghcr-pull-secret
  namespace: campfire
spec:
  encryptedData:
    .dockerconfigjson: AgCX/ZTy/hjvf1SiEsXGRkU2U/apIv7afK8hn0Bj+VABh2G5mbHAOvOUXTVwhhTUKAG+PrcXF9lG57mKCsir6537Val0eL9r0Itt4M5GvwRc4SAVBgT26M4EnsEbl8hbHLkozrpBD7ZFRLZFzyZ4256jvnURR8RWmgqA1qPCGNuEoGrtuyW1g/PorTzByNXG+PM+eox6ZeUyuosVEenAY2gZApkfM4K8CM93dkb3jyElWuCrCn0bB0A5O0ZO2By8NeE4QBLe5abKuYKYbqYntz7/S8HxNk2kTSKIuB8RvtvhcS/z+ZRNSKxc3PTe4GwtchqfKWmGWTS9dV2wCbxEOWfq4A1T2k2hQoWD4peA5A/N4duvzBUchckKahn+e3TECEB84hrETgcBrpxcXs/oQO9kxf8W/e/B3tzzhIKkoOFrxowIh/4xvk0ePqxfBJE13yFc6x1Wpcsv+B1t7v6YM9lkOV8Go1YpjqNZiTsQeru71Cy+WlcsEV3P11jhKOvtC493lMcY+ZfwhfjRlTcsV9Y2l5xRYmjJaL/oCTyPwNUuhqdNiYCiUP8/Bv9yFZbv9vbadmbfTJkFngN5KMkKx9k+noaYk2RBGG4pm3RzbpWFuZj4p6EAznE7OR/8f+azhwnBgTRN0Q5X0yKCZuIs3uV5+BvGt7n/lKnxDnTZvKZtxFQpMha6CqtOAhU1/9m1+Bk=
  template:
    metadata:
      name: ghcr-pull-secret
      namespace: campfire
    type: kubernetes.io/dockerconfigjson
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: n8n
  namespace: n8n
  labels:
    app.kubernetes.io/name: n8n
    app.kubernetes.io/component: workflow-automation
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  minAvailable: 0
  selector:
    matchLabels:
      app.kubernetes.io/name: n8n
apiVersion: v1
kind: Namespace
metadata:
  name: n8n
  labels:
    name: n8n
    app.kubernetes.io/name: n8n
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: apps/v1
kind: Deployment
metadata:
  name: n8n
  namespace: n8n
  labels:
    app.kubernetes.io/name: n8n
    app.kubernetes.io/component: workflow-automation
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: n8n
  template:
    metadata:
      labels:
        app.kubernetes.io/name: n8n
        app.kubernetes.io/component: workflow-automation
        app.kubernetes.io/part-of: homelab
    spec:
      securityContext:
        runAsNonRoot: true
        runAsUser: 1000
        runAsGroup: 1000
        fsGroup: 1000
        seccompProfile:
          type: RuntimeDefault
      containers:
      - name: n8n
        image: n8nio/n8n@sha256:42f2a4ea1ea8473934c085caeb6a4cf4599d9a13eb1e3ea2549cb71c034bd102
        imagePullPolicy: IfNotPresent
        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: false
          capabilities:
            drop:
              - ALL
        ports:
        - containerPort: 5678
          name: http
        resources:
          requests:
            cpu: 100m
            memory: 256Mi
          limits:
            cpu: 1000m
            memory: 1Gi
        livenessProbe:
          httpGet:
            path: /healthz
            port: http
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /healthz
            port: http
          initialDelaySeconds: 10
          periodSeconds: 5
          timeoutSeconds: 3
          failureThreshold: 3
        env:
        - name: NODE_ENV
          value: "production"
        - name: N8N_HOST
          value: "autom8.lab.axiomlayer.com"
        - name: N8N_PROTOCOL
          value: "https"
        - name: N8N_PORT
          value: "5678"
        - name: WEBHOOK_URL
          value: "https://autom8.lab.axiomlayer.com/"
        - name: GENERIC_TIMEZONE
          value: "America/New_York"
        # Database configuration
        - name: DB_TYPE
          value: "postgresdb"
        - name: DB_POSTGRESDB_HOST
          value: "n8n-db-rw.n8n.svc"
        - name: DB_POSTGRESDB_PORT
          value: "5432"
        - name: DB_POSTGRESDB_DATABASE
          value: "n8n"
        - name: DB_POSTGRESDB_USER
          value: "n8n"
        - name: DB_POSTGRESDB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: n8n-secrets
              key: db-password
        # Encryption key for credentials
        - name: N8N_ENCRYPTION_KEY
          valueFrom:
            secretKeyRef:
              name: n8n-secrets
              key: encryption-key
        # Auth configuration
        - name: N8N_AUTH_EXCLUDE_ENDPOINTS
          value: "healthz"
        volumeMounts:
        - name: data
          mountPath: /home/node/.n8n
      volumes:
      - name: data
        persistentVolumeClaim:
          claimName: n8n-data
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - postgres-cluster.yaml
  - pvc.yaml
  - sealed-secret.yaml
  - deployment.yaml
  - service.yaml
  - certificate.yaml
  - ingress.yaml
  - networkpolicy.yaml
  - pdb.yaml
apiVersion: v1
kind: Service
metadata:
  name: n8n
  namespace: n8n
  labels:
    app.kubernetes.io/name: n8n
    app.kubernetes.io/component: workflow-automation
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  selector:
    app.kubernetes.io/name: n8n
  ports:
  - port: 5678
    targetPort: http
    name: http
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: autom8-tls
  namespace: n8n
  labels:
    app.kubernetes.io/name: n8n
    app.kubernetes.io/component: tls
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  secretName: autom8-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - autom8.lab.axiomlayer.com
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: n8n-db
  namespace: n8n
  labels:
    app.kubernetes.io/name: n8n-db
    app.kubernetes.io/component: database
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  instances: 1

  storage:
    size: 5Gi
    storageClass: longhorn

  postgresql:
    parameters:
      max_connections: "100"
      shared_buffers: "128MB"

  bootstrap:
    initdb:
      database: n8n
      owner: n8n

  monitoring:
    enablePodMonitor: true
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: n8n-default-deny
  namespace: n8n
  labels:
    app.kubernetes.io/name: n8n
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: n8n-allow-ingress
  namespace: n8n
  labels:
    app.kubernetes.io/name: n8n
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: n8n
  policyTypes:
    - Ingress
  ingress:
    # Allow traffic from Traefik ingress controller
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: kube-system
          podSelector:
            matchLabels:
              app.kubernetes.io/name: traefik
      ports:
        - protocol: TCP
          port: 5678
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: n8n-allow-egress
  namespace: n8n
  labels:
    app.kubernetes.io/name: n8n
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: n8n
  policyTypes:
    - Egress
  egress:
    # Allow DNS resolution
    - to:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              k8s-app: kube-dns
      ports:
        - protocol: UDP
          port: 53
        - protocol: TCP
          port: 53
    # Allow PostgreSQL within namespace (n8n-db-rw)
    - to:
        - podSelector:
            matchLabels:
              cnpg.io/cluster: n8n-db
      ports:
        - protocol: TCP
          port: 5432
    # Allow external webhooks (n8n needs to call external services)
    - to:
        - ipBlock:
            cidr: 0.0.0.0/0
            except:
              - 10.0.0.0/8
              - 172.16.0.0/12
              - 192.168.0.0/16
      ports:
        - protocol: TCP
          port: 443
        - protocol: TCP
          port: 80
---
# Allow CloudNativePG pods to communicate
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: n8n-db-allow
  namespace: n8n
  labels:
    app.kubernetes.io/name: n8n
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      cnpg.io/cluster: n8n-db
  policyTypes:
    - Ingress
    - Egress
  ingress:
    # Allow n8n app to connect
    - from:
        - podSelector:
            matchLabels:
              app.kubernetes.io/name: n8n
      ports:
        - protocol: TCP
          port: 5432
    # Allow CNPG operator
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: cnpg-system
      ports:
        - protocol: TCP
          port: 5432
        - protocol: TCP
          port: 8000
  egress:
    # Allow DNS
    - to:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              k8s-app: kube-dns
      ports:
        - protocol: UDP
          port: 53
        - protocol: TCP
          port: 53
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: n8n-secrets
  namespace: n8n
spec:
  encryptedData:
    db-password: AgAZ7HSQcznnVoL1Ja4IrloeiAaWVYGem/eBO55PfGbWCEzMAx6XbIDAffRhgrJZNlRRs9A97QLjNb4YzwYOSz5NjkU5xbJ8/TONwpRiPr+OMhlPhQPgJ8x5b/+YXVYdKGj+3/TJapqsmCfET4FLesnw+OLFa4hWxE2BsoMjsoSXEBmVhwffO+aT50um9qamT3Enq2GkNeCZ0JPbN8YwpHETzvHZMab/a/D8GkBDuvhCI00ZN1/w3nlEqkQF6bryCWruAQbwYowv/NCC82RKa3fkqkkA1eLhdsXo3qUcVTvxnu+BprJZ86tkZg0fnbuxKsM6xYgQI45pIdZtL5y3txnR4yoEd0Cfzap+HBDkEKjYQn02W9/SkJDUQv2lIjdCQmGm4n0GyywuuxmHrkYtGYVGXYciesE8REV/MTXijMv1AsnSE+rgiAB2y+a7vIyw2VRNjPt8Dysh3oBfxFvUp1Lrv/VfIa4fI6+LbTgDq6bopn+y2JtneEGrEbuHDvouerKG8Pe9s7gcI+wJoEzBPaTjYGewdTOAQiEuHl/yZdGqI1MJ0K4KSI4+PSmLbNvZKUQXCpqfr6NxPIYbzDma5AHDngwIaG5Tpr6vnS9nfxiytdWKlbJY7uEy2SuOfwflm158Z/kRGHwlhJ09Eu9N7i7L00/KRiuXV3XYfqjWuJIe8sYSTE7t15DhkWMvxU9CjBE=
    encryption-key: AgAuIzA4cZJqnBeY7WahJM30Ji8NirZr8+/6mJ+ci1aJ9ctjGYTqBuQhCuAygb0/ApIa/GqE56J0W0fJFhPR4OOPzDy1MtDu8t65Rv0HMq6rfy8nGSec4r1uaeuPpB7uDwWXwU9aoGP7+hKc477Di59bcu6zpqRnqyJxRyHBxVT53qVhSkxSmvG/zgZDbKup3X4JGIAmFZAF8/py9ZB8frUlf+JUAnUqMCaDFVpxCX5DHGCW+cHGmfgReXY/mYdrbqME5lJlyQy2Tj1Rciuk7eltYSPhl+TgkBTcUaLG778O8iKqeKD1v1bUIjeEFC6dBuNaX9dYm1uiP5rgPr3s232e/9qvheuWoWCzAXpo+mYUlm/V66SGAUploUgc+BU8YPCICiah8dL++wrohm4Yl7ZaQDwSSGcT/tH/xGj3LgNL6ecbPlPMSuPzKskEUN5+e3dMVsLSi7AwODkP6mPCDze+BTcSOq1LbrsLSjnQwtg9AIjfcJnrbIimxxvJNbkSDCQ9ubhOkhLBA7oTelsPrxzWnh4KmJEu0dctixAQcPlzUVE2bqdOuWbafpsXkeelPhig28cC6nUKFxcLWh4k0IG4w+ea7/lH8P1bPKJ8EVBmdd18dhE0hF0ZlYbZsZUJqvA2ZZpPH4Jwz/6x4f2WExm5ywxgaqUtNRV+oDsRd6Ie2XK7Mi22xKFKO+znCrpIYJA=
  template:
    metadata:
      name: n8n-secrets
      namespace: n8n
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: n8n-data
  namespace: n8n
  labels:
    app.kubernetes.io/name: n8n
    app.kubernetes.io/component: storage
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: longhorn
  resources:
    requests:
      storage: 5Gi
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: n8n
  namespace: n8n
  labels:
    app.kubernetes.io/name: n8n
    app.kubernetes.io/component: workflow-automation
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
spec:
  ingressClassName: traefik
  tls:
  - hosts:
    - autom8.lab.axiomlayer.com
    secretName: autom8-tls
  rules:
  - host: autom8.lab.axiomlayer.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: n8n
            port:
              number: 5678
apiVersion: v1
kind: Namespace
metadata:
  name: argocd
  labels:
    name: argocd
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: actions-runner-infra
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "7"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: infrastructure/actions-runner
  destination:
    server: https://kubernetes.default.svc
    namespace: actions-runner
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: applications
  namespace: argocd
  annotations:
    # Only sync when CI passes - triggered by GitHub Actions
    argocd.argoproj.io/sync-wave: "0"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: apps/argocd/applications
  destination:
    server: https://kubernetes.default.svc
    namespace: argocd
  syncPolicy:
    # Manual sync - CI triggers sync after tests pass
    syncOptions:
      - ApplyOutOfSyncOnly=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: outline
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "8"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: apps/outline
  destination:
    server: https://kubernetes.default.svc
    namespace: outline
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: cert-manager
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "2"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: infrastructure/cert-manager
  destination:
    server: https://kubernetes.default.svc
    namespace: cert-manager
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: longhorn
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "2"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: infrastructure/longhorn
  destination:
    server: https://kubernetes.default.svc
    namespace: longhorn-system
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: kube-prometheus-stack
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "5"
spec:
  project: default
  source:
    repoURL: https://prometheus-community.github.io/helm-charts
    chart: kube-prometheus-stack
    targetRevision: 79.8.2
    helm:
      values: |
        grafana:
          ingress:
            enabled: true
            ingressClassName: traefik
            hosts:
              - grafana.lab.axiomlayer.com
            tls:
              - secretName: grafana-tls
                hosts:
                  - grafana.lab.axiomlayer.com
          additionalDataSources:
            - name: Loki
              type: loki
              access: proxy
              url: http://loki:3100
              isDefault: false
          envFromSecret: grafana-oidc-secret
          grafana.ini:
            server:
              root_url: https://grafana.lab.axiomlayer.com
            auth:
              disable_login_form: false
              oauth_auto_login: false
            auth.generic_oauth:
              enabled: true
              name: Authentik
              allow_sign_up: true
              use_pkce: true
              scopes: openid email profile groups
              auth_url: https://auth.lab.axiomlayer.com/application/o/authorize/
              token_url: https://auth.lab.axiomlayer.com/application/o/token/
              api_url: https://auth.lab.axiomlayer.com/application/o/userinfo
              client_id: $__env{client-id}
              client_secret: $__env{client-secret}
              email_attribute_path: email
              login_attribute_path: preferred_username
              name_attribute_path: name
              role_attribute_path: contains(groups[*], 'Homelab Admins') && 'Admin' || 'Viewer'
              skip_org_role_sync: false
              use_refresh_token: true
              id_token_attribute_name: id_token
              allow_assign_grafana_admin: true
              empty_scopes: false
            users:
              auto_assign_org_role: Viewer
        prometheus:
          prometheusSpec:
            serviceMonitorSelectorNilUsesHelmValues: false
  destination:
    server: https://kubernetes.default.svc
    namespace: monitoring
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
      - ServerSideApply=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: sealed-secrets
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "1"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: infrastructure/sealed-secrets
  destination:
    server: https://kubernetes.default.svc
    namespace: kube-system
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: telnet-server
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "8"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: apps/telnet-server
  destination:
    server: https://kubernetes.default.svc
    namespace: telnet-server
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: external-dns
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "2"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: infrastructure/external-dns
  destination:
    server: https://kubernetes.default.svc
    namespace: external-dns
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - actions-runner-controller.yaml
  - actions-runner-infra.yaml
  - alertmanager.yaml
  - argocd-helm.yaml
  - backups.yaml
  - authentik.yaml
  - authentik-helm.yaml
  - campfire.yaml
  - cert-manager.yaml
  - cert-manager-helm.yaml
  - cloudnative-pg.yaml
  - dashboard.yaml
  - external-dns.yaml
  - kube-prometheus-stack.yaml
  - monitoring-extras.yaml
  - longhorn.yaml
  - longhorn-helm.yaml
  - loki.yaml
  - n8n.yaml
  - nfs-proxy.yaml
  - open-webui.yaml
  - outline.yaml
  - plane.yaml
  - plane-extras.yaml
  - sealed-secrets.yaml
  - telnet-server.yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: authentik-helm
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "4"
spec:
  project: default
  source:
    repoURL: https://charts.goauthentik.io
    chart: authentik
    targetRevision: 2025.10.2
    helm:
      valuesObject:
        global:
          env:
            - name: AUTHENTIK_SECRET_KEY
              valueFrom:
                secretKeyRef:
                  name: authentik-helm-secrets
                  key: secret_key
            - name: AUTHENTIK_POSTGRESQL__PASSWORD
              valueFrom:
                secretKeyRef:
                  name: authentik-db-app
                  key: password
        authentik:
          secret_key: ""  # Set via env var
          postgresql:
            host: authentik-db-rw.authentik.svc
            name: authentik
            user: authentik
            password: ""  # Set via env var
        postgresql:
          enabled: false
        redis:
          enabled: true
        server:
          ingress:
            enabled: true
            ingressClassName: traefik
            hosts:
              - auth.lab.axiomlayer.com
            tls:
              - hosts:
                  - auth.lab.axiomlayer.com
                secretName: authentik-tls
          volumes:
            - name: blueprints
              configMap:
                name: authentik-blueprints
          volumeMounts:
            - name: blueprints
              mountPath: /blueprints/custom
        worker:
          volumes:
            - name: blueprints
              configMap:
                name: authentik-blueprints
          volumeMounts:
            - name: blueprints
              mountPath: /blueprints/custom
        # Service account for outpost management (RBAC managed separately)
        serviceAccount:
          create: true
  destination:
    server: https://kubernetes.default.svc
    namespace: authentik
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: plane-extras
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "9"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: apps/plane
  destination:
    server: https://kubernetes.default.svc
    namespace: plane
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: cert-manager-helm
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "1"
spec:
  project: default
  source:
    repoURL: https://charts.jetstack.io
    chart: cert-manager
    targetRevision: v1.17.2
    helm:
      values: |
        crds:
          enabled: true
        dns01RecursiveNameservers: "8.8.8.8:53,1.1.1.1:53"
        dns01RecursiveNameserversOnly: true
  destination:
    server: https://kubernetes.default.svc
    namespace: cert-manager
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: open-webui
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "8"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: infrastructure/open-webui
  destination:
    server: https://kubernetes.default.svc
    namespace: open-webui
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: authentik
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "3"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: infrastructure/authentik
  destination:
    server: https://kubernetes.default.svc
    namespace: authentik
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: alertmanager
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "5"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: infrastructure/alertmanager
  destination:
    server: https://kubernetes.default.svc
    namespace: alertmanager
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: loki
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "5"
spec:
  project: default
  source:
    repoURL: https://grafana.github.io/helm-charts
    chart: loki-stack
    targetRevision: 2.10.2
    helm:
      values: |
        grafana:
          sidecar:
            datasources:
              enabled: false
        promtail:
          enabled: true
        loki:
          persistence:
            enabled: true
            storageClassName: longhorn
            size: 10Gi
  destination:
    server: https://kubernetes.default.svc
    namespace: monitoring
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: n8n
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "8"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: apps/n8n
  destination:
    server: https://kubernetes.default.svc
    namespace: n8n
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: argocd-helm
  namespace: argocd
  annotations:
    # Sync wave 0 - ArgoCD should be one of the first things deployed
    argocd.argoproj.io/sync-wave: "0"
  finalizers:
    # Prevent accidental deletion - requires manual removal
    - resources-finalizer.argocd.argoproj.io
spec:
  project: default
  source:
    repoURL: https://argoproj.github.io/argo-helm
    chart: argo-cd
    targetRevision: 8.0.14
    helm:
      values: |
        global:
          domain: argocd.lab.axiomlayer.com

        configs:
          cm:
            url: https://argocd.lab.axiomlayer.com
            # OIDC config managed separately via configmaps.yaml
          params:
            server.insecure: true  # TLS terminated at Traefik

        server:
          ingress:
            enabled: false  # Managed separately via ingress.yaml

        redis:
          enabled: true

        dex:
          enabled: true

        notifications:
          enabled: true

        applicationSet:
          enabled: true

  destination:
    server: https://kubernetes.default.svc
    namespace: argocd
  # IMPORTANT: Manual sync only to prevent chicken/egg issues
  # Auto-sync disabled - upgrades require explicit manual sync
  syncPolicy:
    syncOptions:
      - CreateNamespace=true
      - ServerSideApply=true
      - RespectIgnoreDifferences=true
  # Ignore differences in resources that ArgoCD manages itself or we override
  ignoreDifferences:
    - group: ""
      kind: Secret
      name: argocd-secret
      jqPathExpressions:
        - .data
    - group: ""
      kind: ConfigMap
      name: argocd-cm
      jqPathExpressions:
        - .data
    - group: ""
      kind: ConfigMap
      name: argocd-cmd-params-cm
      jqPathExpressions:
        - .data
    - group: ""
      kind: ConfigMap
      name: argocd-rbac-cm
      jqPathExpressions:
        - .data
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: dashboard
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "8"
  labels:
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
  finalizers:
    - resources-finalizer.argocd.argoproj.io
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: apps/dashboard
  destination:
    server: https://kubernetes.default.svc
    namespace: dashboard
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: backups
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "10"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: HEAD
    path: infrastructure/backups
  destination:
    server: https://kubernetes.default.svc
    namespace: longhorn-system
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: actions-runner-controller
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "6"
spec:
  project: default
  source:
    repoURL: https://actions-runner-controller.github.io/actions-runner-controller
    chart: actions-runner-controller
    targetRevision: 0.23.7
    helm:
      releaseName: arc
      values: |
        installCRDs: false
        authSecret:
          create: false
          name: github-runner-token
  destination:
    server: https://kubernetes.default.svc
    namespace: actions-runner
  ignoreDifferences:
    - group: apiextensions.k8s.io
      kind: CustomResourceDefinition
      jqPathExpressions:
        - .metadata.annotations
        - .metadata.labels
        - .spec.conversion
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
      - ServerSideApply=true
      - RespectIgnoreDifferences=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: monitoring-extras
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "4"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: HEAD
    path: infrastructure/monitoring
  destination:
    server: https://kubernetes.default.svc
    namespace: monitoring
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: longhorn-helm
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "1"
spec:
  project: default
  source:
    repoURL: https://charts.longhorn.io
    chart: longhorn
    targetRevision: 1.7.2
    helm:
      skipCrds: false
      values: |
        persistence:
          defaultClassReplicaCount: 1
        defaultSettings:
          defaultReplicaCount: 1
        preUpgradeChecker:
          jobEnabled: false
  destination:
    server: https://kubernetes.default.svc
    namespace: longhorn-system
  ignoreDifferences:
    - group: apiextensions.k8s.io
      kind: CustomResourceDefinition
      jqPathExpressions:
        - .metadata.annotations
        - .metadata.labels
        - .spec.conversion
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
      - ServerSideApply=true
      - SkipDryRunOnMissingResource=true
      - RespectIgnoreDifferences=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: cloudnative-pg
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "2"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: infrastructure/cloudnative-pg
  destination:
    server: https://kubernetes.default.svc
    namespace: default
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: nfs-proxy
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "5"
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: infrastructure/nfs-proxy
  destination:
    server: https://kubernetes.default.svc
    namespace: nfs-proxy
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: campfire
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "8"
  labels:
    app.kubernetes.io/name: campfire
    app.kubernetes.io/component: application
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: apps/campfire
  destination:
    server: https://kubernetes.default.svc
    namespace: campfire
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: plane
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "8"
spec:
  project: default
  source:
    repoURL: https://helm.plane.so/
    chart: plane-ce
    targetRevision: 1.4.0
    helm:
      releaseName: plane
      values: |
        planeVersion: stable

        ingress:
          enabled: true
          appHost: plane.lab.axiomlayer.com
          ingressClass: traefik
          annotations:
            traefik.ingress.kubernetes.io/router.entrypoints: websecure
            traefik.ingress.kubernetes.io/router.tls: "true"

        ssl:
          createIssuer: false
          generateTLS: true
          secretName: plane-tls

        postgres:
          local_setup: true
          volumeSize: 10Gi
          storageClass: longhorn

        redis:
          local_setup: true
          volumeSize: 1Gi
          storageClass: longhorn

        rabbitmq:
          local_setup: true
          volumeSize: 1Gi
          storageClass: longhorn

        minio:
          local_setup: true
          volumeSize: 10Gi
          storageClass: longhorn

        env:
          docstore_bucket: "uploads"
  destination:
    server: https://kubernetes.default.svc
    namespace: plane
  ignoreDifferences:
    - group: networking.k8s.io
      kind: Ingress
      name: plane-ingress
      jsonPointers:
        - /spec/tls
        - /metadata/annotations/traefik.ingress.kubernetes.io~1router.entrypoints
        - /metadata/annotations/traefik.ingress.kubernetes.io~1router.tls
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
      - RespectIgnoreDifferences=true
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - certificate.yaml
  - ingress.yaml
  - configmaps.yaml
  - sealed-secret.yaml
  - applications/cert-manager.yaml
  - applications/authentik.yaml
  - applications/longhorn.yaml
  - applications/cloudnative-pg.yaml
  - applications/telnet-server.yaml
  - applications/loki.yaml
  - applications/kube-prometheus-stack.yaml
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: argocd-tls
  namespace: argocd
spec:
  secretName: argocd-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - argocd.lab.axiomlayer.com
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: argocd-secret
  namespace: argocd
  labels:
    app.kubernetes.io/name: argocd-secret
    app.kubernetes.io/part-of: argocd
spec:
  encryptedData:
    oidc.authentik.clientSecret: AgBD7v1z64H5O3gaVWIwu16uI6VPtt1iL+crylHD+lIkZGlIjF0z5iNlpESgK9vcUtdnv4dOwVhYnzMQ0YPXOh1WmRn/Wa/mP5MzsqmiN14/6Fcaa7KR16cPMLRITIRukTIlUMXijUHgNhlWLtSf5n5eVAxOowGfkheM29oWMu7Rubi0sYbb5DKPzrKmIMJr4uEZpJiBjr0Qi6JisjhE+H0N+fduf4tOJ+l0M9i6NDCk8PtLEJcW/7lr1B1c4kyXL53RtDRy5uy/VIoGabBzj9gpM1wJ3Q6kgEQPnMvj0sN13+JNQERiecSfqB1Zzx+bCQCVUyJgSEsYeWxmPpi4q+0KIDJxPViqdhT8wFyl4e/nLv2xxGSRPjPRZwXQT6xFN9qgLJ/JaPQWjO/PJgPNb8cmdZdyIoMONBcgMc7w14KN0bwdBFWHUmKLakN+Vqrfcvq+48HdD/iFfTr3q0Vj0dkA5jHkBDOoR88cmUQRYoC5enZdQ7yCKuD1ZbW8c9twP7civhTEZI7ffykpH+FB4sR5vCR+1CVS1FtGi13VQQool0Ru278RjAxrr49wZb3p7c6bs268teuzE4ObI3E9laUrTcsFQeRd/1GHrcqhlcy2bDAq1lM2akZBZ3QadHxRcEPM2Xwv04JsOTZE3FJXjgh5uSTK7niMFO+d69k7reRZJD7kuYWpGcfTvhaWI6tF5gUmg2JJQbd6ae5Czhq7TdpHXos8inT0f6ku4FLb4y/sdCHEteM8kCptFn6ErvTrP6ykgpHGz1ocukXPuMqnqRTF
  template:
    metadata:
      name: argocd-secret
      namespace: argocd
      labels:
        app.kubernetes.io/name: argocd-secret
        app.kubernetes.io/part-of: argocd
apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
  namespace: argocd
  labels:
    app.kubernetes.io/name: argocd-cm
    app.kubernetes.io/part-of: argocd
data:
  url: https://argocd.lab.axiomlayer.com
  oidc.config: |
    name: Authentik
    issuer: https://auth.lab.axiomlayer.com/application/o/argocd/
    clientID: argocd
    clientSecret: $oidc.authentik.clientSecret
    requestedScopes: ["openid", "profile", "email"]
    insecureSkipVerify: true
  # Custom health checks for CRDs
  resource.customizations.health.bitnami.com_SealedSecret: |
    hs = {}
    hs.status = "Healthy"
    hs.message = "SealedSecret is synced"
    return hs
  resource.customizations.health.traefik.io_Middleware: |
    hs = {}
    hs.status = "Healthy"
    hs.message = "Middleware is synced"
    return hs
  resource.customizations.health.postgresql.cnpg.io_Cluster: |
    hs = {}
    if obj.status ~= nil then
      if obj.status.phase == "Cluster in healthy state" then
        hs.status = "Healthy"
        hs.message = obj.status.phase
      elseif obj.status.phase == "Setting up primary" or obj.status.phase == "Creating primary" then
        hs.status = "Progressing"
        hs.message = obj.status.phase
      else
        hs.status = "Degraded"
        hs.message = obj.status.phase
      end
    else
      hs.status = "Progressing"
      hs.message = "Waiting for cluster status"
    end
    return hs
  resource.customizations.health.cert-manager.io_Certificate: |
    hs = {}
    if obj.status ~= nil then
      if obj.status.conditions ~= nil then
        for i, condition in ipairs(obj.status.conditions) do
          if condition.type == "Ready" and condition.status == "True" then
            hs.status = "Healthy"
            hs.message = "Certificate is ready"
            return hs
          end
        end
      end
    end
    hs.status = "Progressing"
    hs.message = "Waiting for certificate"
    return hs
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cmd-params-cm
  namespace: argocd
  labels:
    app.kubernetes.io/name: argocd-cmd-params-cm
    app.kubernetes.io/part-of: argocd
data:
  # TLS termination at Traefik ingress, ArgoCD handles HTTP internally
  server.insecure: "true"
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-rbac-cm
  namespace: argocd
  labels:
    app.kubernetes.io/name: argocd-rbac-cm
    app.kubernetes.io/part-of: argocd
data:
  policy.csv: |
    g, jasen@axiomlayer.com, role:admin
  scopes: "[email]"
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: argocd-server
  namespace: argocd
  annotations:
    traefik.ingress.kubernetes.io/router.tls: "true"
spec:
  ingressClassName: traefik
  tls:
  - hosts:
    - argocd.lab.axiomlayer.com
    secretName: argocd-tls
  rules:
  - host: argocd.lab.axiomlayer.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: argocd-server
            port:
              number: 80
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: dashboard
  namespace: dashboard
  labels:
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/component: web
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  minAvailable: 0
  selector:
    matchLabels:
      app.kubernetes.io/name: dashboard
apiVersion: v1
kind: ConfigMap
metadata:
  name: dashboard-nginx-conf
  namespace: dashboard
  labels:
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/component: config
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
data:
  default.conf: |
    server {
        listen 8080;
        server_name _;

        location / {
            root /usr/share/nginx/html;
            index index.html;
        }

        location /api/prometheus/ {
            proxy_pass http://kube-prometheus-stack-prometheus.monitoring.svc:9090/;
            proxy_http_version 1.1;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }

        location /health {
            return 200 'ok';
            add_header Content-Type text/plain;
        }

        # Health check endpoints for status indicators
        location /api/status/plane {
            proxy_pass http://plane-web.plane.svc:3000/;
            proxy_connect_timeout 3s;
            proxy_read_timeout 3s;
        }

        location /api/status/ai {
            proxy_pass http://open-webui.open-webui.svc:8080/;
            proxy_connect_timeout 3s;
            proxy_read_timeout 3s;
        }

        location /api/status/chat {
            proxy_pass http://campfire.campfire.svc:80/;
            proxy_connect_timeout 3s;
            proxy_read_timeout 3s;
        }

        location /api/status/docs {
            proxy_pass http://outline.outline.svc:3000/;
            proxy_connect_timeout 3s;
            proxy_read_timeout 3s;
        }

        location /api/status/autom8 {
            proxy_pass http://n8n.n8n.svc:5678/;
            proxy_connect_timeout 3s;
            proxy_read_timeout 3s;
        }

        location /api/status/auth {
            proxy_pass http://authentik-helm-server.authentik.svc:80/;
            proxy_connect_timeout 3s;
            proxy_read_timeout 3s;
        }

        location /api/status/argocd {
            proxy_pass http://argocd-server.argocd.svc:80/;
            proxy_connect_timeout 3s;
            proxy_read_timeout 3s;
        }

        location /api/status/grafana {
            proxy_pass http://kube-prometheus-stack-grafana.monitoring.svc:80/;
            proxy_connect_timeout 3s;
            proxy_read_timeout 3s;
        }

        location /api/status/alerts {
            proxy_pass http://kube-prometheus-stack-alertmanager.monitoring.svc:9093/;
            proxy_connect_timeout 3s;
            proxy_read_timeout 3s;
        }

        location /api/status/longhorn {
            proxy_pass http://longhorn-frontend.longhorn-system.svc:80/;
            proxy_connect_timeout 3s;
            proxy_read_timeout 3s;
        }

        location /api/status/telnet {
            proxy_pass http://telnet-server-metrics.telnet-server.svc:9000/;
            proxy_connect_timeout 3s;
            proxy_read_timeout 3s;
        }
    }
apiVersion: v1
kind: Namespace
metadata:
  name: dashboard
  labels:
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: apps/v1
kind: Deployment
metadata:
  name: dashboard
  namespace: dashboard
  labels:
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/component: web
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: dashboard
  template:
    metadata:
      labels:
        app.kubernetes.io/name: dashboard
        app.kubernetes.io/component: web
        app.kubernetes.io/part-of: homelab
    spec:
      securityContext:
        runAsNonRoot: true
        runAsUser: 101
        runAsGroup: 101
        fsGroup: 101
        seccompProfile:
          type: RuntimeDefault
      containers:
        - name: nginx
          image: nginx@sha256:65645c7bb6a0661892a8b03b89d0743208a18dd2f3f17a54ef4b76fb8e2f2a10
          ports:
            - containerPort: 8080
              name: http
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
            capabilities:
              drop: ["ALL"]
          resources:
            requests:
              cpu: 10m
              memory: 16Mi
            limits:
              cpu: 100m
              memory: 64Mi
          livenessProbe:
            httpGet:
              path: /
              port: 8080
            initialDelaySeconds: 5
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /
              port: 8080
            initialDelaySeconds: 2
            periodSeconds: 5
          volumeMounts:
            - name: html
              mountPath: /usr/share/nginx/html
              readOnly: true
            - name: nginx-conf
              mountPath: /etc/nginx/conf.d
              readOnly: true
            - name: tmp
              mountPath: /tmp
            - name: var-cache-nginx
              mountPath: /var/cache/nginx
            - name: var-run
              mountPath: /var/run
      volumes:
        - name: html
          configMap:
            name: dashboard-config
            items:
              - key: index.html
                path: index.html
        - name: nginx-conf
          configMap:
            name: dashboard-nginx-conf
        - name: tmp
          emptyDir: {}
        - name: var-cache-nginx
          emptyDir: {}
        - name: var-run
          emptyDir: {}
apiVersion: v1
kind: ConfigMap
metadata:
  name: dashboard-config
  namespace: dashboard
  labels:
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/component: config
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
data:
  index.html: |
    <!DOCTYPE html>
    <html lang="en">
    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>axiomlayer</title>
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
      <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
          --bg: #0f0f0f;
          --card-bg: #1a1a1a;
          --card-hover: #252525;
          --text: #e0e0e0;
          --text-muted: #888;
          --accent: #3b82f6;
          --border: #333;
        }

        body {
          font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
          background: var(--bg);
          color: var(--text);
          min-height: 100vh;
          padding: 2rem;
        }

        .container {
          max-width: 1200px;
          margin: 0 auto;
        }

        header {
          text-align: center;
          margin-bottom: 2rem;
        }

        .title {
          font-size: 2.5rem;
          font-weight: 300;
          letter-spacing: -0.02em;
        }

        /* Metrics Panel - Railway style */
        .metrics-panel {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 1.25rem;
          margin-bottom: 2rem;
          padding: 1.5rem;
          background: var(--card-bg);
          border: 1px solid var(--border);
          border-radius: 12px;
        }

        .metric {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .metric-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .metric-label {
          font-size: 0.75rem;
          text-transform: uppercase;
          letter-spacing: 0.05em;
          color: var(--text-muted);
        }

        .metric-value {
          font-size: 1.75rem;
          font-weight: 600;
          font-variant-numeric: tabular-nums;
        }

        .metric-graph {
          height: 48px;
          position: relative;
        }

        .metric-graph canvas {
          width: 100%;
          height: 100%;
        }

        .metric-detail {
          font-size: 0.75rem;
          color: var(--text-muted);
        }

        .grid {
          display: flex;
          flex-wrap: wrap;
          justify-content: center;
          gap: 1rem;
          max-width: 940px;
          margin: 0 auto;
        }

        .grid .card {
          width: calc(33.333% - 0.67rem);
          min-width: 280px;
          max-width: 300px;
        }

        .section-title {
          width: 100%;
          font-size: 0.75rem;
          text-transform: uppercase;
          letter-spacing: 0.1em;
          color: var(--text-muted);
          margin-top: 1.5rem;
          margin-bottom: 0.5rem;
          padding-bottom: 0.5rem;
          border-bottom: 1px solid var(--border);
          text-align: center;
        }

        .section-title:first-of-type {
          margin-top: 0;
        }

        .card {
          background: var(--card-bg);
          border: 1px solid var(--border);
          border-radius: 8px;
          padding: 1.25rem;
          text-decoration: none;
          color: var(--text);
          transition: all 0.2s ease;
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .card:hover {
          background: var(--card-hover);
          border-color: var(--accent);
          transform: translateY(-2px);
        }

        .card-header {
          display: flex;
          align-items: center;
          gap: 0.75rem;
        }

        .card-icon {
          width: 32px;
          height: 32px;
          border-radius: 6px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 1rem;
        }

        .card-title {
          font-size: 1rem;
          font-weight: 500;
        }

        .card-desc {
          font-size: 0.85rem;
          color: var(--text-muted);
          line-height: 1.4;
        }

        .card-url {
          font-size: 0.75rem;
          color: var(--accent);
          margin-top: auto;
        }

        .card {
          position: relative;
        }

        .card-status {
          position: absolute;
          top: 1rem;
          right: 1rem;
          width: 8px;
          height: 8px;
          border-radius: 50%;
          background: var(--border);
        }

        .card-status.online {
          background: #22c55e;
          box-shadow: 0 0 6px rgba(34, 197, 94, 0.5);
        }

        .card-status.offline {
          background: #ef4444;
          box-shadow: 0 0 6px rgba(239, 68, 68, 0.5);
        }

        /* Icon colors */
        .icon-blue { background: rgba(59, 130, 246, 0.2); color: #3b82f6; }
        .icon-green { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
        .icon-purple { background: rgba(168, 85, 247, 0.2); color: #a855f7; }
        .icon-orange { background: rgba(249, 115, 22, 0.2); color: #f97316; }
        .icon-red { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        .icon-cyan { background: rgba(6, 182, 212, 0.2); color: #06b6d4; }
        .icon-yellow { background: rgba(234, 179, 8, 0.2); color: #eab308; }
        .icon-pink { background: rgba(236, 72, 153, 0.2); color: #ec4899; }

        .status {
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          margin-top: 2rem;
          padding-top: 1rem;
          border-top: 1px solid var(--border);
          font-size: 0.8rem;
          color: var(--text-muted);
        }

        .status-dot {
          width: 8px;
          height: 8px;
          border-radius: 50%;
          background: #22c55e;
          animation: pulse 2s infinite;
        }

        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.5; }
        }

        @media (max-width: 640px) {
          body { padding: 1rem; }
          .title { font-size: 1.75rem; }
          .grid .card { width: 100%; max-width: 100%; }
          .metrics-panel { grid-template-columns: 1fr; }
          .metric-value { font-size: 1.25rem; }
          .metric-graph { height: 40px; }
        }
      </style>
    </head>
    <body>
      <div class="container">
        <header>
          <p class="title">axiomlayer</p>
        </header>

        <!-- Metrics Panel -->
        <div class="metrics-panel">
          <div class="metric">
            <div class="metric-header">
              <span class="metric-label">CPU</span>
            </div>
            <span class="metric-value" id="cpu-value">--</span>
            <div class="metric-graph">
              <canvas id="cpu-graph"></canvas>
            </div>
            <span class="metric-detail" id="cpu-detail">Loading...</span>
          </div>

          <div class="metric">
            <div class="metric-header">
              <span class="metric-label">Memory</span>
            </div>
            <span class="metric-value" id="memory-value">--</span>
            <div class="metric-graph">
              <canvas id="memory-graph"></canvas>
            </div>
            <span class="metric-detail" id="memory-detail">Loading...</span>
          </div>

          <div class="metric">
            <div class="metric-header">
              <span class="metric-label">Storage</span>
            </div>
            <span class="metric-value" id="storage-value">--</span>
            <div class="metric-graph">
              <canvas id="storage-graph"></canvas>
            </div>
            <span class="metric-detail" id="storage-detail">Loading...</span>
          </div>

          <div class="metric">
            <div class="metric-header">
              <span class="metric-label">Network</span>
            </div>
            <span class="metric-value" id="network-value">--</span>
            <div class="metric-graph">
              <canvas id="network-graph"></canvas>
            </div>
            <span class="metric-detail" id="network-detail">Loading...</span>
          </div>
        </div>

        <div class="grid">
          <h2 class="section-title">Applications</h2>

          <a href="https://ai.lab.axiomlayer.com" class="card" data-url="https://ai.lab.axiomlayer.com" target="_blank">
            <span class="card-status"></span>
            <div class="card-header">
              <div class="card-icon icon-green">AI</div>
              <span class="card-title">Open WebUI</span>
            </div>
            <p class="card-desc">AI chat interface with Ollama</p>
            <span class="card-url">ai.lab.axiomlayer.com</span>
          </a>

          <a href="https://chat.lab.axiomlayer.com" class="card" data-url="https://chat.lab.axiomlayer.com" target="_blank">
            <span class="card-status"></span>
            <div class="card-header">
              <div class="card-icon icon-red">C</div>
              <span class="card-title">Campfire</span>
            </div>
            <p class="card-desc">Team chat and collaboration</p>
            <span class="card-url">chat.lab.axiomlayer.com</span>
          </a>

          <a href="https://plane.lab.axiomlayer.com" class="card" data-url="https://plane.lab.axiomlayer.com" target="_blank">
            <span class="card-status"></span>
            <div class="card-header">
              <div class="card-icon icon-blue">P</div>
              <span class="card-title">Plane</span>
            </div>
            <p class="card-desc">Project management and issue tracking</p>
            <span class="card-url">plane.lab.axiomlayer.com</span>
          </a>

          <a href="https://docs.lab.axiomlayer.com" class="card" data-url="https://docs.lab.axiomlayer.com" target="_blank">
            <span class="card-status"></span>
            <div class="card-header">
              <div class="card-icon icon-purple">O</div>
              <span class="card-title">Outline</span>
            </div>
            <p class="card-desc">Documentation and knowledge base</p>
            <span class="card-url">docs.lab.axiomlayer.com</span>
          </a>

          <a href="https://autom8.lab.axiomlayer.com" class="card" data-url="https://autom8.lab.axiomlayer.com" target="_blank">
            <span class="card-status"></span>
            <div class="card-header">
              <div class="card-icon icon-orange">n8n</div>
              <span class="card-title">n8n (autom8)</span>
            </div>
            <p class="card-desc">Workflow automation platform</p>
            <span class="card-url">autom8.lab.axiomlayer.com</span>
          </a>

          <h2 class="section-title">Platform</h2>

          <a href="https://auth.lab.axiomlayer.com" class="card" data-url="https://auth.lab.axiomlayer.com" target="_blank">
            <span class="card-status"></span>
            <div class="card-header">
              <div class="card-icon icon-cyan">A</div>
              <span class="card-title">Authentik</span>
            </div>
            <p class="card-desc">Identity provider and SSO</p>
            <span class="card-url">auth.lab.axiomlayer.com</span>
          </a>

          <a href="https://argocd.lab.axiomlayer.com" class="card" data-url="https://argocd.lab.axiomlayer.com" target="_blank">
            <span class="card-status"></span>
            <div class="card-header">
              <div class="card-icon icon-orange">A</div>
              <span class="card-title">ArgoCD</span>
            </div>
            <p class="card-desc">GitOps continuous delivery</p>
            <span class="card-url">argocd.lab.axiomlayer.com</span>
          </a>

          <a href="https://github.com/jasencdev/axiomlayer" class="card" data-github="jasencdev/axiomlayer" target="_blank">
            <span class="card-status" id="github-status"></span>
            <div class="card-header">
              <div class="card-icon icon-purple">GH</div>
              <span class="card-title">GitHub</span>
            </div>
            <p class="card-desc">Repository and CI workflows</p>
            <span class="card-url" id="github-ci-status">github.com/jasencdev/axiomlayer</span>
          </a>

          <h2 class="section-title">Observability</h2>

          <a href="https://grafana.lab.axiomlayer.com" class="card" data-url="https://grafana.lab.axiomlayer.com" target="_blank">
            <span class="card-status"></span>
            <div class="card-header">
              <div class="card-icon icon-yellow">G</div>
              <span class="card-title">Grafana</span>
            </div>
            <p class="card-desc">Metrics dashboards and visualization</p>
            <span class="card-url">grafana.lab.axiomlayer.com</span>
          </a>

          <a href="https://alerts.lab.axiomlayer.com" class="card" data-url="https://alerts.lab.axiomlayer.com" target="_blank">
            <span class="card-status"></span>
            <div class="card-header">
              <div class="card-icon icon-red">!</div>
              <span class="card-title">Alertmanager</span>
            </div>
            <p class="card-desc">Alert management and routing</p>
            <span class="card-url">alerts.lab.axiomlayer.com</span>
          </a>

          <h2 class="section-title">Infrastructure</h2>

          <a href="https://longhorn.lab.axiomlayer.com" class="card" data-url="https://longhorn.lab.axiomlayer.com" target="_blank">
            <span class="card-status"></span>
            <div class="card-header">
              <div class="card-icon icon-green">L</div>
              <span class="card-title">Longhorn</span>
            </div>
            <p class="card-desc">Distributed storage management</p>
            <span class="card-url">longhorn.lab.axiomlayer.com</span>
          </a>

          <a href="https://telnet.lab.axiomlayer.com" class="card" data-url="https://telnet.lab.axiomlayer.com" target="_blank">
            <span class="card-status"></span>
            <div class="card-header">
              <div class="card-icon icon-pink">T</div>
              <span class="card-title">Telnet Server</span>
            </div>
            <p class="card-desc">Demo application with SSO</p>
            <span class="card-url">telnet.lab.axiomlayer.com</span>
          </a>
        </div>

        <div class="status">
          <span class="status-dot"></span>
          <span>All systems operational</span>
        </div>

      </div>

      <script>
        const PROMETHEUS_URL = '/api/prometheus';
        const MAX_POINTS = 30;

        // Historical data storage
        const history = {
          cpu: [],
          memory: [],
          storage: [],
          network: []
        };

        // Graph colors
        const colors = {
          cpu: { line: '#3b82f6', fill: 'rgba(59, 130, 246, 0.15)' },
          memory: { line: '#a855f7', fill: 'rgba(168, 85, 247, 0.15)' },
          storage: { line: '#22c55e', fill: 'rgba(34, 197, 94, 0.15)' },
          network: { line: '#f97316', fill: 'rgba(249, 115, 22, 0.15)' }
        };

        async function queryPrometheus(query) {
          try {
            const response = await fetch(`${PROMETHEUS_URL}/api/v1/query?query=${encodeURIComponent(query)}`);
            const data = await response.json();
            if (data.status === 'success' && data.data.result.length > 0) {
              return parseFloat(data.data.result[0].value[1]);
            }
          } catch (e) {
            console.error('Prometheus query failed:', e);
          }
          return null;
        }

        async function queryPrometheusRange(query, duration = '5m', step = '10s') {
          try {
            const end = Math.floor(Date.now() / 1000);
            const start = end - parseDuration(duration);
            const response = await fetch(`${PROMETHEUS_URL}/api/v1/query_range?query=${encodeURIComponent(query)}&start=${start}&end=${end}&step=${step}`);
            const data = await response.json();
            if (data.status === 'success' && data.data.result.length > 0) {
              return data.data.result[0].values.map(v => parseFloat(v[1]));
            }
          } catch (e) {
            console.error('Prometheus range query failed:', e);
          }
          return [];
        }

        function parseDuration(d) {
          const match = d.match(/(\d+)([smh])/);
          if (!match) return 300;
          const val = parseInt(match[1]);
          const unit = match[2];
          if (unit === 's') return val;
          if (unit === 'm') return val * 60;
          if (unit === 'h') return val * 3600;
          return 300;
        }

        function formatBytes(bytes) {
          if (bytes === 0) return '0 B';
          const k = 1024;
          const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
          const i = Math.floor(Math.log(bytes) / Math.log(k));
          return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        function formatBytesPerSec(bytes) {
          if (bytes === 0) return '0 B/s';
          const k = 1024;
          const sizes = ['B/s', 'KB/s', 'MB/s', 'GB/s'];
          const i = Math.floor(Math.log(bytes) / Math.log(k));
          return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        function drawSparkline(canvasId, data, color, maxValue = 100) {
          const canvas = document.getElementById(canvasId);
          if (!canvas || data.length === 0) return;

          const ctx = canvas.getContext('2d');
          const rect = canvas.getBoundingClientRect();
          const dpr = window.devicePixelRatio || 1;

          canvas.width = rect.width * dpr;
          canvas.height = rect.height * dpr;
          ctx.scale(dpr, dpr);

          const width = rect.width;
          const height = rect.height;
          const padding = 2;

          ctx.clearRect(0, 0, width, height);

          if (data.length < 2) return;

          const xStep = (width - padding * 2) / (MAX_POINTS - 1);
          const yScale = (height - padding * 2) / maxValue;

          // Draw filled area
          ctx.beginPath();
          ctx.moveTo(padding, height - padding);

          data.forEach((val, i) => {
            const x = padding + i * xStep;
            const y = height - padding - (val * yScale);
            if (i === 0) {
              ctx.lineTo(x, y);
            } else {
              ctx.lineTo(x, y);
            }
          });

          ctx.lineTo(padding + (data.length - 1) * xStep, height - padding);
          ctx.closePath();
          ctx.fillStyle = color.fill;
          ctx.fill();

          // Draw line
          ctx.beginPath();
          data.forEach((val, i) => {
            const x = padding + i * xStep;
            const y = height - padding - (val * yScale);
            if (i === 0) {
              ctx.moveTo(x, y);
            } else {
              ctx.lineTo(x, y);
            }
          });
          ctx.strokeStyle = color.line;
          ctx.lineWidth = 1.5;
          ctx.lineCap = 'round';
          ctx.lineJoin = 'round';
          ctx.stroke();
        }

        function addToHistory(key, value) {
          history[key].push(value);
          if (history[key].length > MAX_POINTS) {
            history[key].shift();
          }
        }

        async function updateMetrics() {
          // CPU Usage
          const cpuUsage = await queryPrometheus('100 - (avg(rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100)');
          if (cpuUsage !== null) {
            document.getElementById('cpu-value').textContent = cpuUsage.toFixed(1) + '%';
            addToHistory('cpu', cpuUsage);
            drawSparkline('cpu-graph', history.cpu, colors.cpu, 100);
            const cores = await queryPrometheus('count(node_cpu_seconds_total{mode="idle"})');
            document.getElementById('cpu-detail').textContent = cores ? `${cores} cores across cluster` : 'Cluster average';
          }

          // Memory Usage (excluding cache/buffers)
          const memTotal = await queryPrometheus('sum(node_memory_MemTotal_bytes)');
          const memFree = await queryPrometheus('sum(node_memory_MemFree_bytes)');
          const memBuffers = await queryPrometheus('sum(node_memory_Buffers_bytes)');
          const memCached = await queryPrometheus('sum(node_memory_Cached_bytes)');
          if (memTotal !== null && memFree !== null && memBuffers !== null && memCached !== null) {
            const memUsed = memTotal - memFree - memBuffers - memCached;
            const memPercent = (memUsed / memTotal) * 100;
            document.getElementById('memory-value').textContent = memPercent.toFixed(1) + '%';
            addToHistory('memory', memPercent);
            drawSparkline('memory-graph', history.memory, colors.memory, 100);
            document.getElementById('memory-detail').textContent = `${formatBytes(memUsed)} / ${formatBytes(memTotal)}`;
          }

          // Storage Usage
          const storageTotal = await queryPrometheus('sum(node_filesystem_size_bytes{mountpoint="/",fstype!="rootfs"})');
          const storageAvail = await queryPrometheus('sum(node_filesystem_avail_bytes{mountpoint="/",fstype!="rootfs"})');
          if (storageTotal !== null && storageAvail !== null) {
            const storageUsed = storageTotal - storageAvail;
            const storagePercent = (storageUsed / storageTotal) * 100;
            document.getElementById('storage-value').textContent = storagePercent.toFixed(1) + '%';
            addToHistory('storage', storagePercent);
            drawSparkline('storage-graph', history.storage, colors.storage, 100);
            document.getElementById('storage-detail').textContent = `${formatBytes(storageUsed)} / ${formatBytes(storageTotal)}`;
          }

          // Network throughput
          const netRx = await queryPrometheus('sum(rate(node_network_receive_bytes_total{device!~"lo|veth.*|cni.*|flannel.*"}[5m]))');
          const netTx = await queryPrometheus('sum(rate(node_network_transmit_bytes_total{device!~"lo|veth.*|cni.*|flannel.*"}[5m]))');
          if (netRx !== null && netTx !== null) {
            const totalNet = netRx + netTx;
            document.getElementById('network-value').textContent = formatBytesPerSec(totalNet);
            addToHistory('network', totalNet);
            // Dynamic max for network graph
            const maxNet = Math.max(...history.network, 1024 * 1024);
            drawSparkline('network-graph', history.network, colors.network, maxNet);
            document.getElementById('network-detail').textContent = ` ${formatBytesPerSec(netRx)}  ${formatBytesPerSec(netTx)}`;
          }
        }

        // Load historical data on startup
        async function loadHistoricalData() {
          // CPU history
          const cpuHistory = await queryPrometheusRange('100 - (avg(rate(node_cpu_seconds_total{mode="idle"}[1m])) * 100)', '5m', '10s');
          if (cpuHistory.length > 0) {
            history.cpu = cpuHistory.slice(-MAX_POINTS);
            drawSparkline('cpu-graph', history.cpu, colors.cpu, 100);
          }

          // Memory history (excluding cache/buffers)
          const memTotalHist = await queryPrometheusRange('sum(node_memory_MemTotal_bytes)', '5m', '10s');
          const memFreeHist = await queryPrometheusRange('sum(node_memory_MemFree_bytes)', '5m', '10s');
          const memBuffersHist = await queryPrometheusRange('sum(node_memory_Buffers_bytes)', '5m', '10s');
          const memCachedHist = await queryPrometheusRange('sum(node_memory_Cached_bytes)', '5m', '10s');
          if (memTotalHist.length > 0 && memFreeHist.length > 0) {
            history.memory = memTotalHist.slice(-MAX_POINTS).map((total, i) => {
              const free = memFreeHist[i] || 0;
              const buffers = memBuffersHist[i] || 0;
              const cached = memCachedHist[i] || 0;
              const used = total - free - buffers - cached;
              return (used / total) * 100;
            });
            drawSparkline('memory-graph', history.memory, colors.memory, 100);
          }

          // Storage history
          const storageTotalHist = await queryPrometheusRange('sum(node_filesystem_size_bytes{mountpoint="/",fstype!="rootfs"})', '5m', '10s');
          const storageAvailHist = await queryPrometheusRange('sum(node_filesystem_avail_bytes{mountpoint="/",fstype!="rootfs"})', '5m', '10s');
          if (storageTotalHist.length > 0 && storageAvailHist.length > 0) {
            history.storage = storageTotalHist.slice(-MAX_POINTS).map((total, i) => {
              const avail = storageAvailHist[i] || 0;
              return ((total - avail) / total) * 100;
            });
            drawSparkline('storage-graph', history.storage, colors.storage, 100);
          }

          // Network history
          const netRxHist = await queryPrometheusRange('sum(rate(node_network_receive_bytes_total{device!~"lo|veth.*|cni.*|flannel.*"}[1m]))', '5m', '10s');
          const netTxHist = await queryPrometheusRange('sum(rate(node_network_transmit_bytes_total{device!~"lo|veth.*|cni.*|flannel.*"}[1m]))', '5m', '10s');
          if (netRxHist.length > 0 && netTxHist.length > 0) {
            history.network = netRxHist.slice(-MAX_POINTS).map((rx, i) => {
              const tx = netTxHist[i] || 0;
              return rx + tx;
            });
            const maxNet = Math.max(...history.network, 1024 * 1024);
            drawSparkline('network-graph', history.network, colors.network, maxNet);
          }
        }

        // Initial load with historical data
        loadHistoricalData().then(() => updateMetrics());
        // Refresh every 2.5 seconds
        setInterval(updateMetrics, 2500);

        // Redraw on resize
        window.addEventListener('resize', () => {
          drawSparkline('cpu-graph', history.cpu, colors.cpu, 100);
          drawSparkline('memory-graph', history.memory, colors.memory, 100);
          drawSparkline('storage-graph', history.storage, colors.storage, 100);
          const maxNet = Math.max(...history.network, 1024 * 1024);
          drawSparkline('network-graph', history.network, colors.network, maxNet);
        });

        // Status checking via Prometheus pod metrics
        const appNamespaces = {
          'ai.lab.axiomlayer.com': 'open-webui',
          'chat.lab.axiomlayer.com': 'campfire',
          'plane.lab.axiomlayer.com': 'plane',
          'docs.lab.axiomlayer.com': 'outline',
          'autom8.lab.axiomlayer.com': 'n8n',
          'auth.lab.axiomlayer.com': 'authentik',
          'argocd.lab.axiomlayer.com': 'argocd',
          'grafana.lab.axiomlayer.com': 'monitoring',
          'alerts.lab.axiomlayer.com': 'monitoring',
          'longhorn.lab.axiomlayer.com': 'longhorn-system',
          'telnet.lab.axiomlayer.com': 'telnet-server'
        };

        async function checkNamespaceHealth(namespace) {
          try {
            const query = `sum(kube_pod_status_phase{namespace="${namespace}",phase="Running"}) > 0`;
            const response = await fetch(`${PROMETHEUS_URL}/api/v1/query?query=${encodeURIComponent(query)}`);
            const data = await response.json();
            return data.status === 'success' && data.data.result.length > 0;
          } catch (e) {
            return false;
          }
        }

        async function updateAppStatuses() {
          const cards = document.querySelectorAll('.card[data-url]');
          let allOnline = true;
          const checkedNamespaces = {};

          for (const card of cards) {
            const url = card.dataset.url;
            const statusEl = card.querySelector('.card-status');
            if (!statusEl) continue;

            const hostname = new URL(url).hostname;
            const namespace = appNamespaces[hostname];
            if (!namespace) continue;

            // Cache namespace checks
            if (!(namespace in checkedNamespaces)) {
              checkedNamespaces[namespace] = await checkNamespaceHealth(namespace);
            }

            const isOnline = checkedNamespaces[namespace];
            statusEl.classList.toggle('online', isOnline);
            statusEl.classList.toggle('offline', !isOnline);

            if (!isOnline) allOnline = false;
          }

          // Update overall status
          const statusText = document.querySelector('.status span:last-child');
          const statusDot = document.querySelector('.status-dot');
          if (statusText && statusDot) {
            if (allOnline) {
              statusText.textContent = 'All systems operational';
              statusDot.style.background = '#22c55e';
            } else {
              statusText.textContent = 'Some services unavailable';
              statusDot.style.background = '#ef4444';
            }
          }
        }

        // Check statuses on load and periodically
        updateAppStatuses();
        setInterval(updateAppStatuses, 30000);

        // GitHub Actions status check
        async function checkGitHubCI() {
          const statusEl = document.getElementById('github-status');
          const urlEl = document.getElementById('github-ci-status');
          if (!statusEl || !urlEl) return;

          try {
            // Use GitHub's public API to get workflow runs
            const response = await fetch('https://api.github.com/repos/jasencdev/axiomlayer/actions/runs?per_page=1&status=completed');
            if (!response.ok) throw new Error('GitHub API error');

            const data = await response.json();
            if (data.workflow_runs && data.workflow_runs.length > 0) {
              const latestRun = data.workflow_runs[0];
              const conclusion = latestRun.conclusion;

              if (conclusion === 'success') {
                statusEl.classList.add('online');
                statusEl.classList.remove('offline');
                urlEl.textContent = 'CI passing';
              } else if (conclusion === 'failure') {
                statusEl.classList.add('offline');
                statusEl.classList.remove('online');
                urlEl.textContent = 'CI failing';
              } else {
                statusEl.classList.remove('online', 'offline');
                urlEl.textContent = 'CI ' + conclusion;
              }
            }
          } catch (e) {
            // Fallback to just showing the URL
            statusEl.classList.remove('online', 'offline');
            urlEl.textContent = 'github.com/jasencdev/axiomlayer';
          }
        }

        // Check GitHub CI status
        checkGitHubCI();
        setInterval(checkGitHubCI, 60000); // Check every minute
      </script>
    </body>
    </html>
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: dashboard

resources:
  - namespace.yaml
  - configmap.yaml
  - nginx-configmap.yaml
  - deployment.yaml
  - service.yaml
  - certificate.yaml
  - ingress.yaml
  - networkpolicy.yaml
  - pdb.yaml

labels:
  - pairs:
      app.kubernetes.io/part-of: homelab
      app.kubernetes.io/managed-by: argocd
    includeSelectors: false
apiVersion: v1
kind: Service
metadata:
  name: dashboard
  namespace: dashboard
  labels:
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/component: web
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  type: ClusterIP
  selector:
    app.kubernetes.io/name: dashboard
  ports:
    - name: http
      port: 80
      targetPort: 8080
      protocol: TCP
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: dashboard-tls
  namespace: dashboard
  labels:
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/component: tls
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  secretName: dashboard-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - db.lab.axiomlayer.com
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: dashboard-default-deny
  namespace: dashboard
  labels:
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: dashboard-allow-ingress
  namespace: dashboard
  labels:
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: dashboard
  policyTypes:
    - Ingress
  ingress:
    # Allow traffic from Traefik ingress controller
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: kube-system
          podSelector:
            matchLabels:
              app.kubernetes.io/name: traefik
      ports:
        - protocol: TCP
          port: 8080
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: dashboard-allow-egress
  namespace: dashboard
  labels:
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: dashboard
  policyTypes:
    - Egress
  egress:
    # Allow DNS resolution
    - to:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              k8s-app: kube-dns
      ports:
        - protocol: UDP
          port: 53
        - protocol: TCP
          port: 53
    # Allow access to Prometheus for metrics
    - to:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: monitoring
      ports:
        - protocol: TCP
          port: 9090
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: dashboard
  namespace: dashboard
  labels:
    app.kubernetes.io/name: dashboard
    app.kubernetes.io/component: ingress
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
  annotations:
    traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
spec:
  ingressClassName: traefik
  tls:
    - hosts:
        - db.lab.axiomlayer.com
      secretName: dashboard-tls
  rules:
    - host: db.lab.axiomlayer.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: dashboard
                port:
                  number: 80
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: outline
  namespace: outline
  labels:
    app.kubernetes.io/name: outline
    app.kubernetes.io/component: wiki
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  minAvailable: 0
  selector:
    matchLabels:
      app.kubernetes.io/name: outline
apiVersion: v1
kind: Namespace
metadata:
  name: outline
  labels:
    name: outline
    app.kubernetes.io/name: outline
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: apps/v1
kind: Deployment
metadata:
  name: outline
  namespace: outline
  labels:
    app.kubernetes.io/name: outline
    app.kubernetes.io/component: wiki
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: outline
  template:
    metadata:
      labels:
        app.kubernetes.io/name: outline
        app.kubernetes.io/component: wiki
        app.kubernetes.io/part-of: homelab
    spec:
      securityContext:
        runAsNonRoot: true
        runAsUser: 1001
        runAsGroup: 1001
        fsGroup: 1001
        seccompProfile:
          type: RuntimeDefault
      containers:
      - name: outline
        image: outlinewiki/outline@sha256:e539971b59b2523ab54bf792105d1cff6432974a37e18211c175cd053d7feb62
        imagePullPolicy: IfNotPresent
        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: false
          capabilities:
            drop:
              - ALL
        ports:
        - containerPort: 3000
          name: http
        resources:
          requests:
            cpu: 100m
            memory: 256Mi
          limits:
            cpu: 1000m
            memory: 1Gi
        livenessProbe:
          httpGet:
            path: /_health
            port: http
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /_health
            port: http
          initialDelaySeconds: 10
          periodSeconds: 5
          timeoutSeconds: 3
          failureThreshold: 3
        env:
        - name: NODE_ENV
          value: "production"
        - name: URL
          value: "https://docs.lab.axiomlayer.com"
        - name: PORT
          value: "3000"
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: outline-secrets
              key: database-url
        - name: REDIS_URL
          value: "redis://redis:6379"
        - name: SECRET_KEY
          valueFrom:
            secretKeyRef:
              name: outline-secrets
              key: secret-key
        - name: UTILS_SECRET
          valueFrom:
            secretKeyRef:
              name: outline-secrets
              key: utils-secret
        - name: FILE_STORAGE
          value: "local"
        - name: FILE_STORAGE_LOCAL_ROOT_DIR
          value: "/var/lib/outline/data"
        - name: OIDC_CLIENT_ID
          valueFrom:
            secretKeyRef:
              name: outline-secrets
              key: oidc-client-id
        - name: OIDC_CLIENT_SECRET
          valueFrom:
            secretKeyRef:
              name: outline-secrets
              key: oidc-client-secret
        - name: OIDC_AUTH_URI
          value: "https://auth.lab.axiomlayer.com/application/o/authorize/"
        - name: OIDC_TOKEN_URI
          value: "http://authentik-helm-server.authentik.svc.cluster.local/application/o/token/"
        - name: OIDC_USERINFO_URI
          value: "http://authentik-helm-server.authentik.svc.cluster.local/application/o/userinfo/"
        - name: OIDC_DISPLAY_NAME
          value: "Authentik"
        - name: OIDC_USERNAME_CLAIM
          value: "preferred_username"
        volumeMounts:
        - name: data
          mountPath: /var/lib/outline/data
      volumes:
      - name: data
        persistentVolumeClaim:
          claimName: outline-data
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - postgres-cluster.yaml
  - redis.yaml
  - pvc.yaml
  - sealed-secret.yaml
  - deployment.yaml
  - service.yaml
  - certificate.yaml
  - ingress.yaml
  - networkpolicy.yaml
  - pdb.yaml
apiVersion: v1
kind: Service
metadata:
  name: outline
  namespace: outline
  labels:
    app.kubernetes.io/name: outline
    app.kubernetes.io/component: wiki
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  selector:
    app.kubernetes.io/name: outline
  ports:
  - port: 3000
    targetPort: http
    name: http
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: outline-tls
  namespace: outline
  labels:
    app.kubernetes.io/name: outline
    app.kubernetes.io/component: tls
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  secretName: outline-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - docs.lab.axiomlayer.com
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: outline-db
  namespace: outline
  labels:
    app.kubernetes.io/name: outline-db
    app.kubernetes.io/component: database
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  instances: 1

  storage:
    size: 5Gi
    storageClass: longhorn

  postgresql:
    parameters:
      max_connections: "50"
      shared_buffers: "128MB"

  bootstrap:
    initdb:
      database: outline
      owner: outline

  monitoring:
    enablePodMonitor: true
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: outline-default-deny
  namespace: outline
  labels:
    app.kubernetes.io/name: outline
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: outline-allow-ingress
  namespace: outline
  labels:
    app.kubernetes.io/name: outline
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: outline
  policyTypes:
    - Ingress
  ingress:
    # Allow traffic from Traefik ingress controller
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: kube-system
          podSelector:
            matchLabels:
              app.kubernetes.io/name: traefik
      ports:
        - protocol: TCP
          port: 3000
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: outline-allow-egress
  namespace: outline
  labels:
    app.kubernetes.io/name: outline
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: outline
  policyTypes:
    - Egress
  egress:
    # Allow DNS resolution
    - to:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              k8s-app: kube-dns
      ports:
        - protocol: UDP
          port: 53
        - protocol: TCP
          port: 53
    # Allow Redis within namespace
    - to:
        - podSelector:
            matchLabels:
              app.kubernetes.io/name: redis
      ports:
        - protocol: TCP
          port: 6379
    # Allow PostgreSQL (outline-db in cnpg-system or outline namespace)
    - to:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: cnpg-system
      ports:
        - protocol: TCP
          port: 5432
    - to:
        - podSelector:
            matchLabels:
              cnpg.io/cluster: outline-db
      ports:
        - protocol: TCP
          port: 5432
    # Allow Authentik for OIDC (direct connection)
    - to:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: authentik
      ports:
        - protocol: TCP
          port: 9000
        - protocol: TCP
          port: 9443
        - protocol: TCP
          port: 80
    # Allow Traefik for OIDC via ingress (auth.lab.axiomlayer.com)
    - to:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: kube-system
          podSelector:
            matchLabels:
              app.kubernetes.io/name: traefik
      ports:
        - protocol: TCP
          port: 443
    # Allow HTTPS to Tailscale network for OIDC (auth.lab.axiomlayer.com resolves to Tailscale IP)
    - to:
        - ipBlock:
            cidr: 100.64.0.0/10
      ports:
        - protocol: TCP
          port: 443
---
# Allow Redis ingress from Outline
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: redis-allow-outline
  namespace: outline
  labels:
    app.kubernetes.io/name: redis
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: redis
  policyTypes:
    - Ingress
    - Egress
  ingress:
    - from:
        - podSelector:
            matchLabels:
              app.kubernetes.io/name: outline
      ports:
        - protocol: TCP
          port: 6379
  egress:
    # Allow DNS
    - to:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              k8s-app: kube-dns
      ports:
        - protocol: UDP
          port: 53
---
# Allow CloudNativePG pods
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: outline-db-allow
  namespace: outline
  labels:
    app.kubernetes.io/name: outline
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      cnpg.io/cluster: outline-db
  policyTypes:
    - Ingress
    - Egress
  ingress:
    # Allow outline app
    - from:
        - podSelector:
            matchLabels:
              app.kubernetes.io/name: outline
      ports:
        - protocol: TCP
          port: 5432
    # Allow CNPG operator
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: cnpg-system
      ports:
        - protocol: TCP
          port: 5432
        - protocol: TCP
          port: 8000
    # Allow backup jobs from longhorn-system
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: longhorn-system
          podSelector:
            matchLabels:
              app.kubernetes.io/name: homelab-backup
      ports:
        - protocol: TCP
          port: 5432
  egress:
    # Allow DNS
    - to:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              k8s-app: kube-dns
      ports:
        - protocol: UDP
          port: 53
        - protocol: TCP
          port: 53
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: outline-secrets
  namespace: outline
spec:
  encryptedData:
    database-url: AgAA/qOKh+p4lx+bKyi5LrIs+KCntXiR6fZWZ8CRFPZIVwIkR3G6CF9R6YQhoWfOUP+BAET2MrpQwm0I02iMhI4iFRbAjGxwztQ8A5+S1dWkkt02u2HQG9/t6cEZERR8XTuNrX1/s9sMWas/4kJmsOJWeXwj+ZyRm9+wna1RHGwzZ0nKROThy0EmlIx0VJ29+YyB8na1KQyF+gjflqqRcY46K9wWXpoAxaiY5BFfZdKQ65id2BP6KwcLMv4l462Gr7U5Fk6F+z7IKv4wE1kYswxRx6TRqnuGJ43nmQE9s2OBFLbf6owMnFkCIBBqTKzfu2ZWw/3k9u7L1zlQO9hVM+LYTafAZEnKhxCe3WQM0NFqAtbCcmSsM2tS+AEJy9YOA3145PZzfUhoGako9ZPL1633739de/B4ou5MVL64S2NQYBC0rFEwys1iFz0N6g/NwTMD5k1DN0dQXV2/mxAoeFSQTSvvMJql/MNj+T99vPfblSxvJy8p8Ysg1FCRpx+zszdgZY66Fyf+OzEEawaO5snvuHNlqgz+otcklFzjweKu+T9N6TfR1b/EiIJwQz3u28aq6wHPDBiChMwZmYWo4+4CQp/cJ4uqCsDBhnE4VmRERMqkw37EsZIuUV/Xpfy08IlKb5NvtRciJBXCeVdNgoZqGCORxmQpetc/TYzz3tgyBpQG7MrNadT+hVdoOOhXz/gYIJtKxaB7gzZNAlI9IQzj2buoXXARlNh0agS0Aqu3xM+8d63LpbiAn1Il2KjRtq4M6QgFAszxT/E26Dn2Bbb7FPKMS6m4k4t9qraY6KOAVPFp/r7hJ4WaIZaKcGJY5TLjVUKLzINA4u9HNrSg3Q==
    oidc-client-secret: AgAi74Bof0bKNaqeAagvI/Q3fU/JOGgAkRxjfYxkU4GnJYndQnBTGo26W+pEc9FemH7ADqIpN9rLN0rFSzYCIAQy8hFHa3cPdMrd8QD2TlfVO8mtj5r6RpCXzzz8v7H/se9XektJIaHg34flngRsRpZHVE5oyTyBaYT32JxxDmpiegJIqo+HbKHqw4I6bdiVLojHCojTpp8XNWTP7S4cqeRcq9wDOs1IHHTqAJCvYrfWXAZQ0Q7/65hqUY3k/5wOBab9Uy8pto1h3tiUAIoR0eKU34nZ2LiYrMHfnB5s65Jzt6ZAtPNlPMAnghucniJ4EvGU4RrXQKF1CxrPyQbG+azL5+dxhj2zNpBG3Q+3i+PiEGQB+Mq/YNbZFuucN2kYpNbedP50SyrNWhrAJrOP3Di2v27qUI/Zl8+a560GdaIE+MI5Wxk/CM058p+e6r5MQWgldiDQnxnISoJTRc+kz7/e6pS4NZ6lJF0Pbh6SELm7Mumorg5iM91Ir7dF/uqGsICm47U4pJL3f3R2Z0f02iUAsGgvXfMrazMFiC4tuaH43ikmGkLWKEr+3yQg6iKViQtxVq/gMg8/ncq94mIxmLbR95Yj4mox/VMe2IViZSCmUfBW6AXwzgFpDYjCbfv9xVYehm+1x9X4S1vERJbK3wvC8Ic2Z29n33FMP0fDvKO05J1p2BKQF9F7sfeFtql+SjDkAb+BmAY+7GnNNwrNB3pCBKkILqYuE5mrb0HUFYq6Oxm48k49ySy/muEGhCENOavMakzVUfTrlzATsIbGvVY3
    secret-key: AgCMn4TjXW1ZyTX/EK4HrwOxc5eJts64HACnUSOn1tlh7fWIkpfByG5eyu+bsLqNNLEvcbLEbv85KlrzzKXELj04oy030Xr9t1S1EJBRIxz0HkmM5+RXhX15g1rRxW4mhv1DalaBGZjp6si9ZMwxXUdDcBTa5Bgjbzml/dlOGToGNEaROVWZkoJP09okbs29gP9xDHi7p3ka6c6/1K4Mlk2FJN+mA9igLHQqe+JjnCoNSM5SzlvEGtByT6h/57YxAijVaaKuqru846ak8ltynXAIuRtOc4QJ1yBUMjiMovi6Hg3QgLu02HdboSylbia4qHEzYRLQkuJbmsKx72tc2RXIHWHURqvz9nOWfQ5VIoZbxdycXHth1Tbtr8fLc57dtD/udUjrRaUw/9BT/R+G6hGmkhhw96dL/bYKuYD0BRb1MWimrWvYR7qoEQTbX8uHcgu+KSlYb9XEs1iSQsFVkm0X6wtGtoGOayGv1+iLUg/OfaLLmVmyMIwQ1BtUobANNsDzTVcp2/Zh1Pv2BbD+AMQOPvmpjCxTg3ddnsGpudhMbxea/fFIMFrjtpm0QnS1B4re4p9qJiSzJvzxYeFCdPrCJjBWMJKnsfQrowO4AAzTSNhjzo20GI1ALlMItfG8hc+5LKCI3wyE/WZnCFUkmOweV4pvxWVSebrOBwQzAbYvmXHgsDSzY7qCby3hfTExFZY0FGFH14S4d0p9RZZdUbwbfgIWQiN/cjtF/cfanCi8DVc0q2rPDFEJQqUVSXT7EHi46gO/iBMAomjI4kS9kddX
    utils-secret: AgCUVGmhBfS++YOfoNnqsS+D7mWhD8QgOeKlojYRB4u1E9prJ4YfVP0Sz+Wjqipd/U+w4bEDpXt5i3j5dbOEwO3UtqEl4NZDYTGEgqsGbUFRjOOHimGWCMRNk8WDY6eZJx9xmWip4cd6nCN3+AbF0ulhbmgYyH658CEnDvg53YzMqwKVDB5F67mdNh+oCdJYcchR8Iz44bmnhNWN/TqLV0hEAX37ZFWgaT3r/aoHP2/kSvVygWWaeExEbEZW5RRK7XciSO8cgH56yO9Z3WuCxxE9/6tagWxmgCNhR6/h7ilNZkr1NLO2wilssQqjZ9ZdL281s4MmibWx0uGvz5nQCKhhHQS/PluIjApbQwDBYjJUenBR/07rWF+1in0rukE05ctAvnOUJKLYX5jyopIIGvY0AtPUH7GydvAHW7/kOXAJ5oKQwApvGOe1xiZOrC/lCkQT9aXfINIH/nlZ9idCRvm7Mqx3COpn/4due3leFfcSx5g+I42hBlg31XxoLeCrUyFYQDNc/Cg1OXgfKHC5jIJIRrrIO+DHALmOAG+SBTKac8hDUCP6hsLydw1rdOmSIFGXQU7zn4hgKqFbsX9jzasjBUt2N29sBlflwRXkMch5ccQ6WeXXo1zyagFyaQzXKFUDwzG5itIpwl2CZMNqWtUJ5/mU7EgtfiAZJabU488D8TJq3CQkt3AiNoUMRNzaSnuI6gI+ycbO+OnYEsf0n/kWF0VFl7LgJ4X68Yto+7eCymjaB6DIeN+NaQSbnfIra4vrR2J2KdMD12tA2P34Tip2
  template:
    metadata:
      name: outline-secrets
      namespace: outline
apiVersion: apps/v1
kind: Deployment
metadata:
  name: redis
  namespace: outline
  labels:
    app.kubernetes.io/name: redis
    app.kubernetes.io/component: cache
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: redis
  template:
    metadata:
      labels:
        app.kubernetes.io/name: redis
        app.kubernetes.io/component: cache
        app.kubernetes.io/part-of: homelab
    spec:
      securityContext:
        runAsNonRoot: true
        runAsUser: 999
        runAsGroup: 999
        fsGroup: 999
        seccompProfile:
          type: RuntimeDefault
      containers:
      - name: redis
        image: redis@sha256:ee64a64eaab618d88051c3ade8f6352d11531fcf79d9a4818b9b183d8c1d18ba
        imagePullPolicy: IfNotPresent
        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: true
          capabilities:
            drop:
              - ALL
        ports:
        - containerPort: 6379
          name: redis
        resources:
          requests:
            cpu: 50m
            memory: 64Mi
          limits:
            cpu: 200m
            memory: 256Mi
        livenessProbe:
          exec:
            command:
            - redis-cli
            - ping
          initialDelaySeconds: 10
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        readinessProbe:
          exec:
            command:
            - redis-cli
            - ping
          initialDelaySeconds: 5
          periodSeconds: 5
          timeoutSeconds: 3
          failureThreshold: 3
        volumeMounts:
        - name: data
          mountPath: /data
      volumes:
      - name: data
        emptyDir: {}
---
apiVersion: v1
kind: Service
metadata:
  name: redis
  namespace: outline
  labels:
    app.kubernetes.io/name: redis
    app.kubernetes.io/component: cache
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  selector:
    app.kubernetes.io/name: redis
  ports:
  - port: 6379
    targetPort: redis
    name: redis
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: outline-data
  namespace: outline
  labels:
    app.kubernetes.io/name: outline
    app.kubernetes.io/component: storage
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: longhorn
  resources:
    requests:
      storage: 5Gi
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: outline
  namespace: outline
  labels:
    app.kubernetes.io/name: outline
    app.kubernetes.io/component: wiki
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
spec:
  ingressClassName: traefik
  tls:
  - hosts:
    - docs.lab.axiomlayer.com
    secretName: outline-tls
  rules:
  - host: docs.lab.axiomlayer.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: outline
            port:
              number: 3000
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: plane
resources:
  - certificate.yaml
patches:
  - path: ingress-patch.yaml
    target:
      kind: Ingress
      name: plane-ingress
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: plane-tls
  namespace: plane
  labels:
    app.kubernetes.io/name: plane
    app.kubernetes.io/component: tls
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  secretName: plane-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - plane.lab.axiomlayer.com
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: plane-ingress
  namespace: plane
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
spec:
  tls:
    - hosts:
        - plane.lab.axiomlayer.com
      secretName: plane-tls
#!/bin/bash
set -e

# Bootstrap ArgoCD and GitOps
# Run after K3s is installed and kubectl is configured
#
# This script:
# 1. Installs Sealed Secrets controller (needed for secrets)
# 2. Installs ArgoCD via Helm
# 3. Applies the root application to bootstrap GitOps
#
# Usage: ./bootstrap-argocd.sh

REPO_URL="https://github.com/jasencdev/axiomlayer.git"
ARGOCD_VERSION="8.0.14"
SEALED_SECRETS_VERSION="0.24.5"

echo "=== ArgoCD Bootstrap Script ==="
echo ""

# Check kubectl access
if ! kubectl get nodes &>/dev/null; then
  echo "ERROR: kubectl not configured or cluster not accessible"
  exit 1
fi

echo "Cluster nodes:"
kubectl get nodes
echo ""

# ============================================
# 1. Install Helm (if not present)
# ============================================
if ! command -v helm &>/dev/null; then
  echo "=== Installing Helm ==="
  curl -fsSL https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash
fi

# ============================================
# 2. Install Sealed Secrets Controller
# ============================================
echo "=== Installing Sealed Secrets Controller ==="

# Apply CRD first
kubectl apply -f https://github.com/bitnami-labs/sealed-secrets/releases/download/v${SEALED_SECRETS_VERSION}/controller.yaml

# Wait for controller
echo "Waiting for Sealed Secrets controller..."
kubectl rollout status deployment/sealed-secrets-controller -n kube-system --timeout=120s

# ============================================
# 3. Install ArgoCD via Helm
# ============================================
echo "=== Installing ArgoCD ==="

# Add Argo Helm repo
helm repo add argo https://argoproj.github.io/argo-helm
helm repo update

# Create namespace
kubectl create namespace argocd --dry-run=client -o yaml | kubectl apply -f -

# Install ArgoCD with minimal config (full config comes from GitOps)
helm upgrade --install argocd argo/argo-cd \
  --namespace argocd \
  --version ${ARGOCD_VERSION} \
  --set global.domain=argocd.lab.axiomlayer.com \
  --set configs.params.server\\.insecure=true \
  --set server.ingress.enabled=false \
  --wait

# Wait for ArgoCD to be ready
echo "Waiting for ArgoCD..."
kubectl rollout status deployment/argocd-server -n argocd --timeout=300s

# ============================================
# 4. Get ArgoCD admin password
# ============================================
echo ""
echo "=== ArgoCD Installed ==="
ARGOCD_PASSWORD=$(kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d)
echo "Admin username: admin"
echo "Admin password: $ARGOCD_PASSWORD"
echo ""

# ============================================
# 5. Apply root application (bootstrap GitOps)
# ============================================
echo "=== Applying Root Application ==="

cat <<EOF | kubectl apply -f -
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: applications
  namespace: argocd
spec:
  project: default
  source:
    repoURL: ${REPO_URL}
    targetRevision: main
    path: apps/argocd/applications
  destination:
    server: https://kubernetes.default.svc
    namespace: argocd
  # Manual sync for root app - sync this to deploy everything
  syncPolicy:
    syncOptions:
      - CreateNamespace=true
EOF

echo ""
echo "=== Bootstrap Complete ==="
echo ""
echo "Next steps:"
echo "1. Port-forward to ArgoCD: kubectl port-forward svc/argocd-server -n argocd 8080:443"
echo "2. Login to ArgoCD UI at https://localhost:8080"
echo "3. Sync the 'applications' app to deploy all child apps"
echo "4. Or use CLI: argocd app sync applications"
echo ""
echo "Note: The sealed secrets in the repo need to be re-sealed with the new controller's key."
echo "      Run: kubeseal --fetch-cert > sealed-secrets-pub.pem"
echo "      Then re-seal all secrets in .env"
echo ""
#!/bin/bash
set -e

# K3s Agent + Ollama GPU Provisioning Script
# For Ubuntu 24.04 servers with NVIDIA GPU joining the K3s cluster
# Run as: sudo ./provision-k3s-ollama-agent.sh <username> <server-tailscale-ip>

USERNAME=${1:-jasen}
SERVER_IP=${2:-}
SSH_PORT=22879

if [ -z "$SERVER_IP" ]; then
  echo "ERROR: Must provide K3s server Tailscale IP"
  echo "Usage: sudo ./provision-k3s-ollama-agent.sh <username> <server-tailscale-ip>"
  exit 1
fi

echo "=== K3s Ollama Agent Provisioning for user: $USERNAME ==="
echo "Target: Ubuntu 24.04 with NVIDIA GPU"
echo ""

# ============================================
# 0. Remove Unnecessary Packages
# ============================================
echo "=== Removing unnecessary packages ==="
systemctl stop nginx postgresql certbot.timer 2>/dev/null || true
systemctl disable nginx postgresql certbot.timer 2>/dev/null || true

apt purge -y \
  avahi-daemon \
  byobu \
  certbot \
  cloud-init \
  cloud-guest-utils \
  cloud-initramfs-copymods \
  cloud-initramfs-dyn-netconf \
  ftp \
  lxd-installer \
  nginx \
  pemmican-server \
  postgresql \
  python3-certbot-nginx \
  screen \
  sosreport \
  speedtest-cli \
  ubuntu-pro-client \
  motd-news-config \
  overlayroot \
  pollinate \
  2>/dev/null || true

apt autoremove -y
apt autoclean -y

# Clean up leftover configs
rm -rf /etc/nginx /etc/postgresql /var/lib/postgresql 2>/dev/null || true

# ============================================
# 1. System Update
# ============================================
echo "=== Updating system ==="
apt update && apt upgrade -y

# ============================================
# 2. Base Packages
# ============================================
echo "=== Installing base packages ==="
apt install -y \
  btop \
  curl \
  git \
  openssh-server \
  wget \
  zsh

# ============================================
# 3. NVIDIA Drivers
# ============================================
echo "=== Installing NVIDIA drivers ==="

# Remove any existing NVIDIA installations
apt remove --purge -y '^nvidia-.*' '^libnvidia-.*' 2>/dev/null || true
apt autoremove -y

# Install Ubuntu's recommended NVIDIA driver
apt install -y ubuntu-drivers-common
ubuntu-drivers install

# ============================================
# 4. CUDA Toolkit
# ============================================
echo "=== Installing CUDA toolkit ==="
apt install -y nvidia-cuda-toolkit

# ============================================
# 5. Tailscale
# ============================================
echo "=== Installing Tailscale ==="
if ! command -v tailscale &> /dev/null; then
  curl -fsSL https://tailscale.com/install.sh | sh
fi

# ============================================
# 6. SSH Hardening
# ============================================
echo "=== Hardening SSH ==="
SSH_CONFIG="/etc/ssh/sshd_config"
cp "$SSH_CONFIG" "${SSH_CONFIG}.backup-$(date +%Y%m%d)"

sed -i "s/^#*Port.*/Port $SSH_PORT/" "$SSH_CONFIG"
sed -i 's/^#*PermitRootLogin.*/PermitRootLogin no/' "$SSH_CONFIG"
sed -i 's/^#*PasswordAuthentication.*/PasswordAuthentication no/' "$SSH_CONFIG"
sed -i 's/^#*PubkeyAuthentication.*/PubkeyAuthentication yes/' "$SSH_CONFIG"
sed -i 's/^#*PermitEmptyPasswords.*/PermitEmptyPasswords no/' "$SSH_CONFIG"
sed -i 's/^#*X11Forwarding.*/X11Forwarding no/' "$SSH_CONFIG"
sed -i 's/^#*MaxAuthTries.*/MaxAuthTries 3/' "$SSH_CONFIG"

systemctl restart ssh

# ============================================
# 7. UFW Firewall
# ============================================
echo "=== Configuring UFW ==="
apt install -y ufw
ufw --force reset
ufw default deny incoming
ufw default allow outgoing

ufw allow $SSH_PORT/tcp comment 'SSH'
ufw allow 10250/tcp comment 'Kubelet'
ufw allow 8472/udp comment 'Flannel VXLAN'
ufw allow 51820/udp comment 'Flannel Wireguard'
ufw allow 11434/tcp comment 'Ollama API'

# Allow all traffic from Tailscale
ufw allow in on tailscale0

ufw --force enable

# ============================================
# 8. Oh My Zsh + Dracula Theme
# ============================================
echo "=== Installing Oh My Zsh for $USERNAME ==="
USER_HOME=$(eval echo ~$USERNAME)

if [ ! -d "$USER_HOME/.oh-my-zsh" ]; then
  sudo -u $USERNAME sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" "" --unattended
fi

DRACULA_DIR="$USER_HOME/.oh-my-zsh/custom/themes/dracula"
if [ ! -d "$DRACULA_DIR" ]; then
  sudo -u $USERNAME git clone https://github.com/dracula/zsh.git "$DRACULA_DIR"
  sudo -u $USERNAME ln -sf "$DRACULA_DIR/dracula.zsh-theme" "$USER_HOME/.oh-my-zsh/custom/themes/dracula.zsh-theme"
fi

cat > "$USER_HOME/.zshrc" << 'ZSHRC'
export ZSH="$HOME/.oh-my-zsh"
ZSH_THEME="dracula"
DRACULA_DISPLAY_CONTEXT=1
plugins=(git)
source $ZSH/oh-my-zsh.sh
export PATH="$PATH:$HOME/.local/bin"
alias ll='ls -alF'
ZSHRC

chown $USERNAME:$USERNAME "$USER_HOME/.zshrc"
chsh -s $(which zsh) $USERNAME

# ============================================
# 9. Ollama Installation
# ============================================
echo "=== Installing Ollama ==="
curl -fsSL https://ollama.com/install.sh | sh

# Configure Ollama for network access
mkdir -p /etc/systemd/system/ollama.service.d

cat > /etc/systemd/system/ollama.service.d/override.conf << 'EOF'
[Service]
Environment="OLLAMA_HOST=0.0.0.0:11434"
Environment="OLLAMA_ORIGINS=*"
EOF

systemctl daemon-reload
systemctl enable ollama

# ============================================
# 10. K3s Agent Installation
# ============================================
TAILSCALE_IP=$(tailscale ip -4 2>/dev/null || echo "")

if [ -z "$TAILSCALE_IP" ]; then
  echo ""
  echo "=== REBOOT REQUIRED ==="
  echo "NVIDIA drivers were installed. After reboot:"
  echo "  1. Connect Tailscale: sudo tailscale up"
  echo "  2. Re-run: sudo ./provision-k3s-ollama-agent.sh $USERNAME $SERVER_IP"
  exit 0
fi

echo "=== Installing K3s Agent ==="
echo "Enter the join token from the K3s server:"
read -r K3S_TOKEN

curl -sfL https://get.k3s.io | K3S_URL="https://$SERVER_IP:6443" K3S_TOKEN="$K3S_TOKEN" sh -s - agent \
  --node-ip=$TAILSCALE_IP \
  --flannel-iface=tailscale0

echo ""
echo "=== Provisioning Complete ==="
echo ""
echo "SSH Port: $SSH_PORT"
echo "Tailscale IP: $TAILSCALE_IP"
echo "K3s Agent: connected to $SERVER_IP"
echo "Ollama API: http://$TAILSCALE_IP:11434"
echo ""
echo "=== Verify Installation ==="
echo "  nvidia-smi                    # Check GPU"
echo "  ollama run llama3.2:3b        # Test Ollama"
echo "  kubectl get nodes             # Check on server"
echo ""
echo "=== Recommended Models ==="
echo "  ollama pull llama3.2:3b       # Fast, general (2GB)"
echo "  ollama pull llama3.1:8b       # Good balance (5GB)"
echo "  ollama pull codellama:13b     # Code assistance (8GB)"
echo "  ollama pull deepseek-r1:14b   # Reasoning (9GB)"
echo ""
#!/bin/bash
set -e

# Neko Provisioning Script
# Run as: sudo ./provision-neko.sh <username>

USERNAME=${1:-jasen}
SSH_PORT=22879

echo "=== Provisioning Neko for user: $USERNAME ==="

# ============================================
# 1. System Update
# ============================================
echo "=== Updating system ==="
apt update && apt upgrade -y

# ============================================
# 2. Base Packages
# ============================================
echo "=== Installing base packages ==="
apt install -y \
  btop \
  build-essential \
  curl \
  dkms \
  git \
  grep \
  gzip \
  lshw \
  openssh-server \
  pipx \
  python-is-python3 \
  python3-pip \
  wget \
  zsh

# ============================================
# 3. GitHub CLI
# ============================================
echo "=== Installing GitHub CLI ==="
if ! command -v gh &> /dev/null; then
  curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg
  chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg
  echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main" | tee /etc/apt/sources.list.d/github-cli.list > /dev/null
  apt update && apt install -y gh
fi

# ============================================
# 4. Tailscale
# ============================================
echo "=== Installing Tailscale ==="
if ! command -v tailscale &> /dev/null; then
  curl -fsSL https://tailscale.com/install.sh | sh
fi

# ============================================
# 5. SSH Hardening
# ============================================
echo "=== Hardening SSH ==="
SSH_CONFIG="/etc/ssh/sshd_config"
cp "$SSH_CONFIG" "${SSH_CONFIG}.backup-$(date +%Y%m%d)"

# Change SSH port
sed -i "s/^#*Port.*/Port $SSH_PORT/" "$SSH_CONFIG"

# Security settings
sed -i 's/^#*PermitRootLogin.*/PermitRootLogin no/' "$SSH_CONFIG"
sed -i 's/^#*PasswordAuthentication.*/PasswordAuthentication no/' "$SSH_CONFIG"
sed -i 's/^#*PubkeyAuthentication.*/PubkeyAuthentication yes/' "$SSH_CONFIG"
sed -i 's/^#*PermitEmptyPasswords.*/PermitEmptyPasswords no/' "$SSH_CONFIG"
sed -i 's/^#*X11Forwarding.*/X11Forwarding no/' "$SSH_CONFIG"
sed -i 's/^#*MaxAuthTries.*/MaxAuthTries 3/' "$SSH_CONFIG"
sed -i 's/^#*ClientAliveInterval.*/ClientAliveInterval 300/' "$SSH_CONFIG"
sed -i 's/^#*ClientAliveCountMax.*/ClientAliveCountMax 2/' "$SSH_CONFIG"

systemctl restart ssh

# ============================================
# 6. UFW Firewall
# ============================================
echo "=== Configuring UFW ==="
apt install -y ufw
ufw --force reset
ufw default deny incoming
ufw default allow outgoing
ufw allow $SSH_PORT/tcp comment 'SSH'
ufw --force enable

# ============================================
# 7. Oh My Zsh + Dracula Theme
# ============================================
echo "=== Installing Oh My Zsh for $USERNAME ==="
USER_HOME=$(eval echo ~$USERNAME)

# Install Oh My Zsh
if [ ! -d "$USER_HOME/.oh-my-zsh" ]; then
  sudo -u $USERNAME sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" "" --unattended
fi

# Install Dracula theme
DRACULA_DIR="$USER_HOME/.oh-my-zsh/custom/themes/dracula"
if [ ! -d "$DRACULA_DIR" ]; then
  sudo -u $USERNAME git clone https://github.com/dracula/zsh.git "$DRACULA_DIR"
  sudo -u $USERNAME ln -sf "$DRACULA_DIR/dracula.zsh-theme" "$USER_HOME/.oh-my-zsh/custom/themes/dracula.zsh-theme"
fi

# Configure .zshrc
cat > "$USER_HOME/.zshrc" << 'ZSHRC'
# Path to Oh My Zsh installation
export ZSH="$HOME/.oh-my-zsh"

# Dracula theme with hostname display
ZSH_THEME="dracula"
DRACULA_DISPLAY_CONTEXT=1

# Plugins
plugins=(git)

source $ZSH/oh-my-zsh.sh

# pipx path
export PATH="$PATH:$HOME/.local/bin"

# Aliases
alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'
ZSHRC

chown $USERNAME:$USERNAME "$USER_HOME/.zshrc"

# Change default shell to zsh
chsh -s $(which zsh) $USERNAME

# ============================================
# 8. Realtek R8125 Driver (for NUC NICs)
# ============================================
echo "=== Installing Realtek R8125 driver ==="
if ! dpkg -l | grep -q realtek-r8125-dkms; then
  # Check if we need to build from source or if it's available
  apt install -y realtek-r8125-dkms 2>/dev/null || {
    echo "R8125 dkms package not in repos - may need manual install"
    echo "See: https://github.com/awesometic/realtek-r8125-dkms"
  }
fi

echo ""
echo "=== Provisioning Complete ==="
echo ""
echo "SSH Port: $SSH_PORT"
echo "Shell: zsh with Dracula theme"
echo "Tailscale: installed (run 'sudo tailscale up' to connect)"
echo ""
echo "=== Next Steps ==="
echo "1. Connect Tailscale:"
echo "   sudo tailscale up"
echo ""
echo "NOTE: SSH is now on port $SSH_PORT"
echo "      Reconnect with: ssh -p $SSH_PORT $USERNAME@<ip>"
#!/bin/bash
# Run this on neko2 (secondary control plane node)
# Fixes flannel to use Tailscale interface
set -e

TAILSCALE_IP=$(tailscale ip -4 2>/dev/null || echo "")

if [ -z "$TAILSCALE_IP" ]; then
    echo "ERROR: Tailscale not connected"
    exit 1
fi

echo "Tailscale IP: $TAILSCALE_IP"
echo "Adding --node-ip, --advertise-address, and --flannel-iface to k3s server..."

# Backup original
sudo cp /etc/systemd/system/k3s.service /etc/systemd/system/k3s.service.bak

# Check if already configured
if grep -q "flannel-iface=tailscale0" /etc/systemd/system/k3s.service && grep -q "node-ip=$TAILSCALE_IP" /etc/systemd/system/k3s.service; then
    echo "Already configured correctly"
else
    # Remove any existing args first
    sudo sed -i 's| --node-ip=[^ ]*||g' /etc/systemd/system/k3s.service
    sudo sed -i 's| --advertise-address=[^ ]*||g' /etc/systemd/system/k3s.service
    sudo sed -i 's| --flannel-iface=[^ ]*||g' /etc/systemd/system/k3s.service

    # Add the correct args after 'server'
    sudo sed -i "s|server|server --node-ip=$TAILSCALE_IP --advertise-address=$TAILSCALE_IP --flannel-iface=tailscale0|" /etc/systemd/system/k3s.service
    echo "Added --node-ip=$TAILSCALE_IP --advertise-address=$TAILSCALE_IP --flannel-iface=tailscale0"
fi

echo "Reloading and restarting k3s..."
sudo systemctl daemon-reload
sudo systemctl restart k3s

echo "Waiting for k3s to start..."
sleep 10

echo "Done. Checking status..."
sudo systemctl status k3s --no-pager | head -10
#!/bin/bash
set -e

TAILSCALE_IP="100.67.134.110"
ETCD_CERTS="--cacert=/var/lib/rancher/k3s/server/tls/etcd/server-ca.crt --cert=/var/lib/rancher/k3s/server/tls/etcd/server-client.crt --key=/var/lib/rancher/k3s/server/tls/etcd/server-client.key"

echo "=== Fixing neko etcd member IP ==="

# Start k3s if not running
echo "Starting k3s..."
sudo systemctl start k3s
sleep 5

# Try to get member list with timeout - may fail due to quorum issues
echo "Getting etcd member ID (with 3s timeout)..."
for i in {1..5}; do
    MEMBER_INFO=$(timeout 3 sudo ETCDCTL_API=3 etcdctl --endpoints=https://127.0.0.1:2379 $ETCD_CERTS member list 2>/dev/null || true)
    if [ -n "$MEMBER_INFO" ]; then
        break
    fi
    echo "Attempt $i failed, retrying..."
    sleep 2
done

if [ -z "$MEMBER_INFO" ]; then
    echo "Could not get member list via API. Checking etcd logs for member name..."
    # Extract member name from k3s logs
    MEMBER_NAME=$(journalctl -u k3s --no-pager -n 50 | grep -oP 'Found \[\K[^=]+' | head -1)
    echo "Found member name: $MEMBER_NAME"

    if [ -z "$MEMBER_NAME" ]; then
        echo "ERROR: Could not determine member info"
        exit 1
    fi

    # For single-node with wrong IP, we need to update via etcdctl
    # Keep trying until we get a response
    echo "Retrying etcdctl with longer timeout..."
    MEMBER_INFO=$(timeout 10 sudo ETCDCTL_API=3 etcdctl --endpoints=https://127.0.0.1:2379 $ETCD_CERTS member list 2>/dev/null || true)
fi

echo "Current members: $MEMBER_INFO"

MEMBER_ID=$(echo "$MEMBER_INFO" | grep -oE '^[a-f0-9]+' | head -1)
echo "Member ID: $MEMBER_ID"

if [ -z "$MEMBER_ID" ]; then
    echo "ERROR: Could not get member ID. Etcd may not be responding."
    echo ""
    echo "Manual fix: Run these commands one by one:"
    echo "  sudo ETCDCTL_API=3 etcdctl --endpoints=https://127.0.0.1:2379 $ETCD_CERTS member list"
    echo "  sudo ETCDCTL_API=3 etcdctl --endpoints=https://127.0.0.1:2379 $ETCD_CERTS member update <ID> --peer-urls=https://$TAILSCALE_IP:2380"
    echo "  sudo systemctl restart k3s"
    exit 1
fi

# Update member peer URL
echo "Updating member peer URL to https://$TAILSCALE_IP:2380..."
timeout 10 sudo ETCDCTL_API=3 etcdctl --endpoints=https://127.0.0.1:2379 $ETCD_CERTS \
    member update $MEMBER_ID --peer-urls=https://$TAILSCALE_IP:2380

# Restart k3s
echo "Restarting k3s..."
sudo systemctl restart k3s

# Wait and verify
sleep 10
echo "Checking k3s status..."
sudo systemctl status k3s --no-pager | head -20

echo "Checking etcd member list..."
timeout 5 sudo ETCDCTL_API=3 etcdctl --endpoints=https://127.0.0.1:2379 $ETCD_CERTS member list || echo "Could not verify - check manually"

echo "Checking nodes..."
kubectl get nodes -o wide || echo "kubectl not ready yet"

echo "=== Done ==="
#!/bin/bash
# Provision Ubuntu 24.04 workstation with NVIDIA 5070Ti + Ollama
# Run this script on the workstation after fresh Ubuntu 24.04 install

set -euo pipefail

echo "=== AxiomLayer Ollama Workstation Provisioning ==="
echo "Target: Ubuntu 24.04 with NVIDIA RTX 5070 Ti"
echo ""

# Check if running as root
if [[ $EUID -eq 0 ]]; then
    echo "ERROR: Do not run this script as root. Run as your normal user."
    exit 1
fi

# ============================================
# STEP 1: System Update
# ============================================
echo "[1/7] Updating system packages..."
sudo apt update && sudo apt upgrade -y

# ============================================
# STEP 2: Install NVIDIA Drivers
# ============================================
echo "[2/7] Installing NVIDIA drivers..."

# Remove any existing NVIDIA installations
sudo apt remove --purge -y '^nvidia-.*' '^libnvidia-.*' 2>/dev/null || true
sudo apt autoremove -y

# Install Ubuntu's recommended NVIDIA driver (565+ for Blackwell/5070Ti)
sudo apt install -y ubuntu-drivers-common
sudo ubuntu-drivers install

# Alternative: Install specific driver version if needed
# sudo apt install -y nvidia-driver-565

echo "NVIDIA driver installation complete."
echo "NOTE: A reboot is required before continuing."

# ============================================
# STEP 3: Install CUDA Toolkit
# ============================================
echo "[3/7] Installing CUDA toolkit..."

# Install CUDA toolkit from Ubuntu repos (simpler, works well)
sudo apt install -y nvidia-cuda-toolkit

# ============================================
# STEP 4: Install Tailscale
# ============================================
echo "[4/7] Installing Tailscale..."

if ! command -v tailscale &> /dev/null; then
    curl -fsSL https://tailscale.com/install.sh | sh
    echo "Tailscale installed. Run 'sudo tailscale up' after reboot to connect."
else
    echo "Tailscale already installed."
fi

# ============================================
# STEP 5: Install Ollama
# ============================================
echo "[5/7] Installing Ollama..."

if ! command -v ollama &> /dev/null; then
    curl -fsSL https://ollama.com/install.sh | sh
else
    echo "Ollama already installed, updating..."
    curl -fsSL https://ollama.com/install.sh | sh
fi

# ============================================
# STEP 6: Configure Ollama for Network Access
# ============================================
echo "[6/7] Configuring Ollama for network access..."

# Create systemd override to allow external connections
sudo mkdir -p /etc/systemd/system/ollama.service.d

sudo tee /etc/systemd/system/ollama.service.d/override.conf > /dev/null << 'EOF'
[Service]
Environment="OLLAMA_HOST=0.0.0.0:11434"
Environment="OLLAMA_ORIGINS=*"
EOF

sudo systemctl daemon-reload

# ============================================
# STEP 7: Setup Complete
# ============================================
echo "[7/7] Installation complete!"
echo ""
echo "=== NEXT STEPS ==="
echo ""
echo "1. REBOOT the system to load NVIDIA drivers:"
echo "   sudo reboot"
echo ""
echo "2. After reboot, verify NVIDIA driver:"
echo "   nvidia-smi"
echo ""
echo "3. Connect to Tailscale:"
echo "   sudo tailscale up"
echo ""
echo "4. Start Ollama service:"
echo "   sudo systemctl enable ollama"
echo "   sudo systemctl start ollama"
echo ""
echo "5. Verify Ollama sees your GPU:"
echo "   ollama run llama3.2:3b"
echo "   (type /bye to exit)"
echo ""
echo "6. Get your Tailscale IP:"
echo "   tailscale ip -4"
echo ""
echo "7. Update Open WebUI config with your Tailscale IP in:"
echo "   infrastructure/open-webui/configmap.yaml"
echo "   Change OLLAMA_BASE_URL to: http://<YOUR_TAILSCALE_IP>:11434"
echo ""
echo "=== Recommended Models for 5070 Ti (16GB VRAM) ==="
echo "ollama pull llama3.2:3b      # Fast, general purpose (2GB)"
echo "ollama pull llama3.1:8b      # Good balance (5GB)"
echo "ollama pull codellama:13b    # Code assistance (8GB)"
echo "ollama pull llama3.1:70b-q4  # Large, slower (40GB+ needs CPU offload)"
echo "ollama pull deepseek-r1:14b  # Reasoning model (9GB)"
echo "ollama pull qwen2.5:14b      # Strong multilingual (9GB)"
echo ""
#!/bin/bash
set -e

# Neko Provisioning Script
# Run as: sudo ./provision-neko.sh <username>

USERNAME=${1:-jasen}
SSH_PORT=22879

echo "=== Provisioning Neko for user: $USERNAME ==="

# ============================================
# 1. System Update
# ============================================
echo "=== Updating system ==="
apt update && apt upgrade -y

# ============================================
# 2. Base Packages
# ============================================
echo "=== Installing base packages ==="
apt install -y \
  btop \
  build-essential \
  curl \
  dkms \
  git \
  grep \
  gzip \
  lshw \
  openssh-server \
  pipx \
  python-is-python3 \
  python3-pip \
  wget \
  zsh

# ============================================
# 3. GitHub CLI
# ============================================
echo "=== Installing GitHub CLI ==="
if ! command -v gh &> /dev/null; then
  curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg
  chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg
  echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main" | tee /etc/apt/sources.list.d/github-cli.list > /dev/null
  apt update && apt install -y gh
fi

# ============================================
# 4. Tailscale
# ============================================
echo "=== Installing Tailscale ==="
if ! command -v tailscale &> /dev/null; then
  curl -fsSL https://tailscale.com/install.sh | sh
fi

# ============================================
# 5. SSH Hardening
# ============================================
echo "=== Hardening SSH ==="
SSH_CONFIG="/etc/ssh/sshd_config"
cp "$SSH_CONFIG" "${SSH_CONFIG}.backup-$(date +%Y%m%d)"

# Change SSH port
sed -i "s/^#*Port.*/Port $SSH_PORT/" "$SSH_CONFIG"

# Security settings
sed -i 's/^#*PermitRootLogin.*/PermitRootLogin no/' "$SSH_CONFIG"
sed -i 's/^#*PasswordAuthentication.*/PasswordAuthentication no/' "$SSH_CONFIG"
sed -i 's/^#*PubkeyAuthentication.*/PubkeyAuthentication yes/' "$SSH_CONFIG"
sed -i 's/^#*PermitEmptyPasswords.*/PermitEmptyPasswords no/' "$SSH_CONFIG"
sed -i 's/^#*X11Forwarding.*/X11Forwarding no/' "$SSH_CONFIG"
sed -i 's/^#*MaxAuthTries.*/MaxAuthTries 3/' "$SSH_CONFIG"
sed -i 's/^#*ClientAliveInterval.*/ClientAliveInterval 300/' "$SSH_CONFIG"
sed -i 's/^#*ClientAliveCountMax.*/ClientAliveCountMax 2/' "$SSH_CONFIG"

systemctl restart sshd

# ============================================
# 6. UFW Firewall
# ============================================
echo "=== Configuring UFW ==="
apt install -y ufw
ufw --force reset
ufw default deny incoming
ufw default allow outgoing
ufw allow $SSH_PORT/tcp comment 'SSH'
ufw allow 5240/tcp comment 'MAAS UI'
ufw allow 5248/tcp comment 'MAAS API'
ufw allow 69/udp comment 'TFTP'
ufw allow 4011/udp comment 'PXE'
ufw allow 67:68/udp comment 'DHCP'
ufw allow 53/tcp comment 'DNS'
ufw allow 53/udp comment 'DNS'
ufw allow 5443/tcp comment 'MAAS Internal'
ufw --force enable

# ============================================
# 7. Oh My Zsh + Dracula Theme
# ============================================
echo "=== Installing Oh My Zsh for $USERNAME ==="
USER_HOME=$(eval echo ~$USERNAME)

# Install Oh My Zsh
if [ ! -d "$USER_HOME/.oh-my-zsh" ]; then
  sudo -u $USERNAME sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" "" --unattended
fi

# Install Dracula theme
DRACULA_DIR="$USER_HOME/.oh-my-zsh/custom/themes/dracula"
if [ ! -d "$DRACULA_DIR" ]; then
  sudo -u $USERNAME git clone https://github.com/dracula/zsh.git "$DRACULA_DIR"
  sudo -u $USERNAME ln -sf "$DRACULA_DIR/dracula.zsh-theme" "$USER_HOME/.oh-my-zsh/custom/themes/dracula.zsh-theme"
fi

# Configure .zshrc
cat > "$USER_HOME/.zshrc" << 'ZSHRC'
# Path to Oh My Zsh installation
export ZSH="$HOME/.oh-my-zsh"

# Dracula theme with hostname display
ZSH_THEME="dracula"
DRACULA_DISPLAY_CONTEXT=1

# Plugins
plugins=(git)

source $ZSH/oh-my-zsh.sh

# pipx path
export PATH="$PATH:$HOME/.local/bin"

# Aliases
alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'
ZSHRC

chown $USERNAME:$USERNAME "$USER_HOME/.zshrc"

# Change default shell to zsh
chsh -s $(which zsh) $USERNAME

# ============================================
# 8. Realtek R8125 Driver (for NUC NICs)
# ============================================
echo "=== Installing Realtek R8125 driver ==="
if ! dpkg -l | grep -q realtek-r8125-dkms; then
  # Check if we need to build from source or if it's available
  apt install -y realtek-r8125-dkms 2>/dev/null || {
    echo "R8125 dkms package not in repos - may need manual install"
    echo "See: https://github.com/awesometic/realtek-r8125-dkms"
  }
fi

# ============================================
# 9. MAAS Installation
# ============================================
echo "=== Installing MAAS ==="
snap install maas --channel=3.4/stable
snap install maas-test-db

echo ""
echo "=== Provisioning Complete ==="
echo ""
echo "SSH Port: $SSH_PORT"
echo "Shell: zsh with Dracula theme"
echo "Tailscale: installed (run 'sudo tailscale up' to connect)"
echo ""
echo "=== Next Steps ==="
echo "1. Initialize MAAS:"
echo "   sudo maas init region+rack --database-uri maas-test-db:///"
echo ""
echo "2. Create admin user:"
echo "   sudo maas createadmin"
echo ""
echo "3. Connect Tailscale:"
echo "   sudo tailscale up"
echo ""
echo "4. Access MAAS UI at http://<ip>:5240/MAAS"
echo ""
echo "NOTE: SSH is now on port $SSH_PORT"
echo "      Reconnect with: ssh -p $SSH_PORT $USERNAME@<ip>"
#!/bin/bash
# Run this on bobcat and panther (worker nodes)
# Fixes flannel to use Tailscale interface
set -e

TAILSCALE_IP=$(tailscale ip -4 2>/dev/null || echo "")

if [ -z "$TAILSCALE_IP" ]; then
    echo "ERROR: Tailscale not connected"
    exit 1
fi

echo "Tailscale IP: $TAILSCALE_IP"
echo "Adding --node-ip and --flannel-iface to k3s-agent..."

# Backup original
sudo cp /etc/systemd/system/k3s-agent.service /etc/systemd/system/k3s-agent.service.bak

# Check if already configured
if grep -q "flannel-iface=tailscale0" /etc/systemd/system/k3s-agent.service && grep -q "node-ip=$TAILSCALE_IP" /etc/systemd/system/k3s-agent.service; then
    echo "Already configured correctly"
else
    # Remove any existing node-ip or flannel-iface args first
    sudo sed -i 's| --node-ip=[^ ]*||g' /etc/systemd/system/k3s-agent.service
    sudo sed -i 's| --flannel-iface=[^ ]*||g' /etc/systemd/system/k3s-agent.service

    # Add the correct args
    sudo sed -i "s|ExecStart=/usr/local/bin/k3s agent|ExecStart=/usr/local/bin/k3s agent --node-ip=$TAILSCALE_IP --flannel-iface=tailscale0|" /etc/systemd/system/k3s-agent.service
    echo "Added --node-ip=$TAILSCALE_IP --flannel-iface=tailscale0"
fi

echo "Reloading and restarting k3s-agent..."
sudo systemctl daemon-reload
sudo systemctl restart k3s-agent

echo "Done. Checking status..."
sudo systemctl status k3s-agent --no-pager | head -10
#!/bin/bash
set -e

# K3s Agent Provisioning Script (Raspberry Pi)
# Run as: sudo ./provision-k3s-agent.sh <username> <server-tailscale-ip>

USERNAME=${1:-jasen}
SERVER_IP=${2:-}
SSH_PORT=22879

if [ -z "$SERVER_IP" ]; then
  echo "ERROR: Must provide K3s server Tailscale IP"
  echo "Usage: sudo ./provision-k3s-agent.sh <username> <server-tailscale-ip>"
  exit 1
fi

echo "=== K3s Agent Provisioning for user: $USERNAME ==="

# ============================================
# 0. Remove Unnecessary Packages
# ============================================
echo "=== Removing unnecessary packages ==="
systemctl stop nginx postgresql certbot.timer 2>/dev/null || true
systemctl disable nginx postgresql certbot.timer 2>/dev/null || true

apt purge -y \
  avahi-daemon \
  byobu \
  certbot \
  cloud-init \
  cloud-guest-utils \
  cloud-initramfs-copymods \
  cloud-initramfs-dyn-netconf \
  ftp \
  lxd-installer \
  nginx \
  pemmican-server \
  postgresql \
  python3-certbot-nginx \
  screen \
  sosreport \
  speedtest-cli \
  ubuntu-pro-client \
  motd-news-config \
  overlayroot \
  pollinate \
  2>/dev/null || true

apt autoremove -y
apt autoclean -y

# Clean up leftover configs
rm -rf /etc/nginx /etc/postgresql /var/lib/postgresql 2>/dev/null || true

# ============================================
# 1. System Update
# ============================================
echo "=== Updating system ==="
apt update && apt upgrade -y

# ============================================
# 2. Base Packages
# ============================================
echo "=== Installing base packages ==="
apt install -y \
  btop \
  curl \
  git \
  openssh-server \
  wget \
  zsh

# ============================================
# 3. Tailscale
# ============================================
echo "=== Installing Tailscale ==="
if ! command -v tailscale &> /dev/null; then
  curl -fsSL https://tailscale.com/install.sh | sh
fi

# ============================================
# 4. SSH Hardening
# ============================================
echo "=== Hardening SSH ==="
SSH_CONFIG="/etc/ssh/sshd_config"
cp "$SSH_CONFIG" "${SSH_CONFIG}.backup-$(date +%Y%m%d)"

sed -i "s/^#*Port.*/Port $SSH_PORT/" "$SSH_CONFIG"
sed -i 's/^#*PermitRootLogin.*/PermitRootLogin no/' "$SSH_CONFIG"
sed -i 's/^#*PasswordAuthentication.*/PasswordAuthentication no/' "$SSH_CONFIG"
sed -i 's/^#*PubkeyAuthentication.*/PubkeyAuthentication yes/' "$SSH_CONFIG"
sed -i 's/^#*PermitEmptyPasswords.*/PermitEmptyPasswords no/' "$SSH_CONFIG"
sed -i 's/^#*X11Forwarding.*/X11Forwarding no/' "$SSH_CONFIG"
sed -i 's/^#*MaxAuthTries.*/MaxAuthTries 3/' "$SSH_CONFIG"

systemctl restart ssh

# ============================================
# 5. UFW Firewall
# ============================================
echo "=== Configuring UFW ==="
apt install -y ufw
ufw --force reset
ufw default deny incoming
ufw default allow outgoing

ufw allow $SSH_PORT/tcp comment 'SSH'
ufw allow 10250/tcp comment 'Kubelet'
ufw allow 8472/udp comment 'Flannel VXLAN'
ufw allow 51820/udp comment 'Flannel Wireguard'

# Allow all traffic from Tailscale
ufw allow in on tailscale0

ufw --force enable

# ============================================
# 6. Oh My Zsh + Dracula Theme
# ============================================
echo "=== Installing Oh My Zsh for $USERNAME ==="
USER_HOME=$(eval echo ~$USERNAME)

if [ ! -d "$USER_HOME/.oh-my-zsh" ]; then
  sudo -u $USERNAME sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" "" --unattended
fi

DRACULA_DIR="$USER_HOME/.oh-my-zsh/custom/themes/dracula"
if [ ! -d "$DRACULA_DIR" ]; then
  sudo -u $USERNAME git clone https://github.com/dracula/zsh.git "$DRACULA_DIR"
  sudo -u $USERNAME ln -sf "$DRACULA_DIR/dracula.zsh-theme" "$USER_HOME/.oh-my-zsh/custom/themes/dracula.zsh-theme"
fi

cat > "$USER_HOME/.zshrc" << 'ZSHRC'
export ZSH="$HOME/.oh-my-zsh"
ZSH_THEME="dracula"
DRACULA_DISPLAY_CONTEXT=1
plugins=(git)
source $ZSH/oh-my-zsh.sh
export PATH="$PATH:$HOME/.local/bin"
alias ll='ls -alF'
ZSHRC

chown $USERNAME:$USERNAME "$USER_HOME/.zshrc"
chsh -s $(which zsh) $USERNAME

# ============================================
# 7. Raspberry Pi Specific (cgroups)
# ============================================
echo "=== Enabling cgroups for K3s ==="
if ! grep -q "cgroup_memory=1" /boot/firmware/cmdline.txt 2>/dev/null; then
  if [ -f /boot/firmware/cmdline.txt ]; then
    sed -i 's/$/ cgroup_memory=1 cgroup_enable=memory/' /boot/firmware/cmdline.txt
    echo "Cgroups enabled - REBOOT REQUIRED before K3s install"
    NEEDS_REBOOT=1
  fi
fi

# ============================================
# 8. K3s Agent Installation
# ============================================
TAILSCALE_IP=$(tailscale ip -4 2>/dev/null || echo "")

if [ -z "$TAILSCALE_IP" ]; then
  echo "ERROR: Tailscale not connected. Run 'sudo tailscale up' first."
  exit 1
fi

if [ "${NEEDS_REBOOT:-0}" == "1" ]; then
  echo ""
  echo "=== REBOOT REQUIRED ==="
  echo "Cgroups were enabled. After reboot, run:"
  echo "  sudo ./provision-k3s-agent.sh $USERNAME $SERVER_IP --post-reboot"
  exit 0
fi

if [ "$3" == "--post-reboot" ] || [ "${NEEDS_REBOOT:-0}" != "1" ]; then
  echo "=== Installing K3s Agent ==="
  echo "Enter the join token from the K3s server:"
  read -r K3S_TOKEN

  curl -sfL https://get.k3s.io | K3S_URL="https://$SERVER_IP:6443" K3S_TOKEN="$K3S_TOKEN" sh -s - agent \
    --node-ip=$TAILSCALE_IP \
    --flannel-iface=tailscale0
fi

echo ""
echo "=== Provisioning Complete ==="
echo ""
echo "SSH Port: $SSH_PORT"
echo "Tailscale IP: $TAILSCALE_IP"
echo "K3s Agent: connected to $SERVER_IP"
echo ""
echo "Verify on server with: kubectl get nodes"
#!/bin/bash
set -e

# Siberian Provisioning Script (GPU Workstation)
# Ubuntu 24.04 with NVIDIA RTX 5070 Ti + Ollama
# Run as: sudo ./provision-siberian.sh <username>

USERNAME=${1:-jasen}
SSH_PORT=22879

echo "=== Provisioning Siberian (GPU Workstation) for user: $USERNAME ==="

# ============================================
# 1. System Update
# ============================================
echo "=== Updating system ==="
apt update && apt upgrade -y

# ============================================
# 2. Base Packages
# ============================================
echo "=== Installing base packages ==="
apt install -y \
  btop \
  build-essential \
  curl \
  dkms \
  git \
  grep \
  gzip \
  lshw \
  openssh-server \
  pipx \
  python-is-python3 \
  python3-pip \
  wget \
  zsh

# ============================================
# 3. GitHub CLI
# ============================================
echo "=== Installing GitHub CLI ==="
if ! command -v gh &> /dev/null; then
  curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg
  chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg
  echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main" | tee /etc/apt/sources.list.d/github-cli.list > /dev/null
  apt update && apt install -y gh
fi

# ============================================
# 4. Tailscale
# ============================================
echo "=== Installing Tailscale ==="
if ! command -v tailscale &> /dev/null; then
  curl -fsSL https://tailscale.com/install.sh | sh
fi

# ============================================
# 5. SSH Hardening
# ============================================
echo "=== Hardening SSH ==="
SSH_CONFIG="/etc/ssh/sshd_config"
cp "$SSH_CONFIG" "${SSH_CONFIG}.backup-$(date +%Y%m%d)"

sed -i "s/^#*Port.*/Port $SSH_PORT/" "$SSH_CONFIG"
sed -i 's/^#*PermitRootLogin.*/PermitRootLogin no/' "$SSH_CONFIG"
sed -i 's/^#*PasswordAuthentication.*/PasswordAuthentication no/' "$SSH_CONFIG"
sed -i 's/^#*PubkeyAuthentication.*/PubkeyAuthentication yes/' "$SSH_CONFIG"
sed -i 's/^#*PermitEmptyPasswords.*/PermitEmptyPasswords no/' "$SSH_CONFIG"
sed -i 's/^#*X11Forwarding.*/X11Forwarding no/' "$SSH_CONFIG"
sed -i 's/^#*MaxAuthTries.*/MaxAuthTries 3/' "$SSH_CONFIG"
sed -i 's/^#*ClientAliveInterval.*/ClientAliveInterval 300/' "$SSH_CONFIG"
sed -i 's/^#*ClientAliveCountMax.*/ClientAliveCountMax 2/' "$SSH_CONFIG"

sudo systemctl daemon-reload
sudo systemctl restart ssh

# ============================================
# 6. UFW Firewall
# ============================================
echo "=== Configuring UFW ==="
apt install -y ufw
ufw --force reset
ufw default deny incoming
ufw default allow outgoing

# SSH
ufw allow $SSH_PORT/tcp comment 'SSH'

# Ollama API (only from Tailscale)
ufw allow in on tailscale0 to any port 11434 proto tcp comment 'Ollama API'

# Allow all traffic from Tailscale
ufw allow in on tailscale0

ufw --force enable

# ============================================
# 7. Oh My Zsh + Dracula Theme
# ============================================
echo "=== Installing Oh My Zsh for $USERNAME ==="
USER_HOME=$(eval echo ~$USERNAME)

if [ ! -d "$USER_HOME/.oh-my-zsh" ]; then
  sudo -u $USERNAME sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" "" --unattended
fi

DRACULA_DIR="$USER_HOME/.oh-my-zsh/custom/themes/dracula"
if [ ! -d "$DRACULA_DIR" ]; then
  sudo -u $USERNAME git clone https://github.com/dracula/zsh.git "$DRACULA_DIR"
  sudo -u $USERNAME ln -sf "$DRACULA_DIR/dracula.zsh-theme" "$USER_HOME/.oh-my-zsh/custom/themes/dracula.zsh-theme"
fi

cat > "$USER_HOME/.zshrc" << 'ZSHRC'
# Path to Oh My Zsh installation
export ZSH="$HOME/.oh-my-zsh"

# Dracula theme with hostname display
ZSH_THEME="dracula"
DRACULA_DISPLAY_CONTEXT=1

# Plugins
plugins=(git)

source $ZSH/oh-my-zsh.sh

# pipx path
export PATH="$PATH:$HOME/.local/bin"

# Aliases
alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'

# Ollama aliases
alias ollama-logs='journalctl -u ollama -f'
alias ollama-status='systemctl status ollama'

# Codex alias (uses local Ollama)
alias cx='codex'
ZSHRC

chown $USERNAME:$USERNAME "$USER_HOME/.zshrc"
chsh -s $(which zsh) $USERNAME

# ============================================
# 8. Node.js 22 LTS + Codex CLI
# ============================================
echo "=== Installing Node.js 22 LTS ==="
if ! command -v node &> /dev/null || [[ $(node -v | cut -d'.' -f1 | tr -d 'v') -lt 22 ]]; then
  curl -fsSL https://deb.nodesource.com/setup_22.x | bash -
  apt install -y nodejs
fi

echo "=== Installing Codex CLI ==="
npm install -g @openai/codex

# Create Codex config directory and config for user
CODEX_CONFIG_DIR="$USER_HOME/.codex"
mkdir -p "$CODEX_CONFIG_DIR"

cat > "$CODEX_CONFIG_DIR/config.toml" << 'CODEXCFG'
# Codex CLI configuration for local Ollama inference
model = "gpt-oss:20b"

[providers.ollama]
name = "ollama"
base_url = "http://localhost:11434/v1"
env_key = ""
CODEXCFG

chown -R $USERNAME:$USERNAME "$CODEX_CONFIG_DIR"

# ============================================
# 9. NVIDIA Drivers (5070 Ti / Blackwell)
# ============================================
echo "=== Installing NVIDIA drivers ==="

# Remove any existing NVIDIA installations
apt remove --purge -y '^nvidia-.*' '^libnvidia-.*' 2>/dev/null || true
apt autoremove -y

# Install Ubuntu's recommended NVIDIA driver (565+ for Blackwell/5070Ti)
apt install -y ubuntu-drivers-common
ubuntu-drivers install

# Install CUDA toolkit
apt install -y nvidia-cuda-toolkit

# ============================================
# 10. Ollama Installation
# ============================================
echo "=== Installing Ollama ==="

if ! command -v ollama &> /dev/null; then
  curl -fsSL https://ollama.com/install.sh | sh
else
  echo "Ollama already installed, updating..."
  curl -fsSL https://ollama.com/install.sh | sh
fi

# Configure Ollama for network access and performance
mkdir -p /etc/systemd/system/ollama.service.d

cat > /etc/systemd/system/ollama.service.d/override.conf << 'EOF'
[Service]
# Listen on all interfaces (UFW restricts to Tailscale only)
Environment="OLLAMA_HOST=0.0.0.0:11434"
# Allow connections from any origin (Open WebUI)
Environment="OLLAMA_ORIGINS=*"
# Set default context window to 32k tokens
Environment="OLLAMA_CONTEXT_LENGTH=32768"
# Keep models loaded longer (5 minutes)
Environment="OLLAMA_KEEP_ALIVE=5m"
# Flash attention for better memory efficiency
Environment="OLLAMA_FLASH_ATTENTION=1"
EOF

systemctl daemon-reload

# Don't start Ollama yet - needs reboot for NVIDIA drivers
systemctl enable ollama

echo ""
echo "=== Provisioning Complete ==="
echo ""
echo "SSH Port: $SSH_PORT"
echo "Shell: zsh with Dracula theme"
echo "NVIDIA: drivers installed (reboot required)"
echo "Ollama: installed and configured"
echo ""
echo "=== NEXT STEPS ==="
echo ""
echo "1. REBOOT to load NVIDIA drivers:"
echo "   sudo reboot"
echo ""
echo "2. After reboot, verify NVIDIA driver:"
echo "   nvidia-smi"
echo ""
echo "3. Connect to Tailscale:"
echo "   sudo tailscale up"
echo ""
echo "4. Start Ollama service:"
echo "   sudo systemctl start ollama"
echo ""
echo "5. Verify Ollama sees your GPU:"
echo "   ollama run llama3.2:3b"
echo "   (type /bye to exit)"
echo ""
echo "6. Get your Tailscale IP:"
echo "   tailscale ip -4"
echo ""
echo "7. Update Open WebUI config in the homelab-gitops repo:"
echo "   infrastructure/open-webui/configmap.yaml"
echo "   Change OLLAMA_BASE_URL to: http://<YOUR_TAILSCALE_IP>:11434"
echo ""
echo "=== Recommended Models for 5070 Ti (16GB VRAM) ==="
echo "ollama pull llama3.2:3b         # Fast, general purpose (2GB)"
echo "ollama pull llama3.1:8b         # Good balance (5GB)"
echo "ollama pull codellama:13b       # Code assistance (8GB)"
echo "ollama pull deepseek-r1:14b     # Reasoning model (9GB)"
echo "ollama pull qwen2.5:14b         # Strong multilingual (9GB)"
echo "ollama pull qwen2.5-coder:14b   # Coding model for Codex (9GB)"
echo ""
echo "=== Codex CLI ==="
echo "Codex CLI installed and configured at ~/.codex/config.toml"
echo "Using model: gpt-oss:20b"
echo "Run Codex:   codex"
echo ""
echo "NOTE: SSH is now on port $SSH_PORT"
echo "      Reconnect with: ssh -p $SSH_PORT $USERNAME@<ip>"
echo ""
#!/bin/bash
# Homelab Backup Script
# Run periodically to backup critical components
# Usage: ./scripts/backup-homelab.sh [backup_dir]

set -euo pipefail

BACKUP_DIR="${1:-$HOME/homelab-backups}"
DATE=$(date +%Y%m%d-%H%M%S)
BACKUP_PATH="$BACKUP_DIR/$DATE"
KUBECONFIG="${KUBECONFIG:-$HOME/.kube/config}"

export KUBECONFIG

mkdir -p "$BACKUP_PATH"

echo "=== Homelab Backup - $DATE ==="
echo "Backup location: $BACKUP_PATH"
echo ""

# 1. Backup .env file (contains all secrets)
echo "[1/5] Backing up .env file..."
if [ -f "/home/jasen/homelab-gitops/.env" ]; then
    cp /home/jasen/homelab-gitops/.env "$BACKUP_PATH/env.backup"
    echo "   .env backed up"
else
    echo "   .env not found"
fi

# 2. Backup sealed-secrets private key (CRITICAL - needed to unseal secrets)
echo "[2/5] Backing up sealed-secrets key..."
if kubectl get secret -n kube-system -l sealedsecrets.bitnami.com/sealed-secrets-key=active -o yaml > "$BACKUP_PATH/sealed-secrets-key.yaml" 2>/dev/null; then
    if [ -s "$BACKUP_PATH/sealed-secrets-key.yaml" ]; then
        echo "   sealed-secrets key backed up"
    else
        rm -f "$BACKUP_PATH/sealed-secrets-key.yaml"
        echo "   sealed-secrets not configured"
    fi
else
    echo "   sealed-secrets not found"
fi

# 3. Backup Authentik database
echo "[3/5] Backing up Authentik database..."
AUTHENTIK_DB_PASSWORD=$(kubectl get secret -n authentik authentik-db-app -o jsonpath='{.data.password}' 2>/dev/null | base64 -d || echo "")
if [ -n "$AUTHENTIK_DB_PASSWORD" ]; then
    if kubectl exec -n authentik authentik-db-1 -- sh -c "PGPASSWORD='$AUTHENTIK_DB_PASSWORD' pg_dump -h localhost -U authentik authentik" > "$BACKUP_PATH/authentik-db.sql" 2>/dev/null; then
        LINES=$(wc -l < "$BACKUP_PATH/authentik-db.sql")
        echo "   Authentik database backed up ($LINES lines)"
    else
        echo "   Authentik database backup failed"
    fi
else
    echo "   Authentik database password not found"
fi

# 4. Backup Outline database
echo "[4/5] Backing up Outline database..."
OUTLINE_DB_PASSWORD=$(kubectl get secret -n outline outline-db-app -o jsonpath='{.data.password}' 2>/dev/null | base64 -d || echo "")
if [ -n "$OUTLINE_DB_PASSWORD" ]; then
    if kubectl exec -n outline outline-db-1 -- sh -c "PGPASSWORD='$OUTLINE_DB_PASSWORD' pg_dump -h localhost -U outline outline" > "$BACKUP_PATH/outline-db.sql" 2>/dev/null; then
        LINES=$(wc -l < "$BACKUP_PATH/outline-db.sql")
        echo "   Outline database backed up ($LINES lines)"
    else
        echo "   Outline database backup failed"
    fi
else
    echo "   Outline database password not found"
fi

# 5. Export Longhorn volume list and settings
echo "[5/5] Backing up Longhorn configuration..."
kubectl get volumes.longhorn.io -n longhorn-system -o yaml > "$BACKUP_PATH/longhorn-volumes.yaml" 2>/dev/null || true
kubectl get settings.longhorn.io -n longhorn-system -o yaml > "$BACKUP_PATH/longhorn-settings.yaml" 2>/dev/null || true
kubectl get pvc -A -o yaml > "$BACKUP_PATH/all-pvcs.yaml" 2>/dev/null || true
echo "   Longhorn configuration exported"

# Create a summary
echo ""
echo "=== Backup Complete ==="
echo "Location: $BACKUP_PATH"
echo ""
echo "Files backed up:"
ls -lh "$BACKUP_PATH"

# Calculate total size
TOTAL_SIZE=$(du -sh "$BACKUP_PATH" | cut -f1)
echo ""
echo "Total backup size: $TOTAL_SIZE"

# Cleanup old backups (keep last 7)
echo ""
echo "Cleaning up old backups (keeping last 7)..."
if [ -d "$BACKUP_DIR" ]; then
    cd "$BACKUP_DIR" && ls -dt */ 2>/dev/null | tail -n +8 | xargs -r rm -rf
fi
echo "Done."

echo ""
echo "=== Backup Tips ==="
echo "1. Copy $BACKUP_PATH to an external location (NAS, cloud, USB)"
echo "2. The .env file contains ALL your secrets - keep it secure!"
echo "3. Run this script before any major changes"
echo "4. Consider setting up a cron job: 0 3 * * * $0"
#!/bin/bash
set -e

# K3s Server Provisioning Script
# Run as: sudo ./provision-k3s-server.sh <username> [--init|--join <server-ip>]
#
# First server:  sudo ./provision-k3s-server.sh jasen --init
# Second server: sudo ./provision-k3s-server.sh jasen --join <first-server-tailscale-ip>

USERNAME=${1:-jasen}
MODE=${2:---init}
JOIN_IP=${3:-}
SSH_PORT=22879

echo "=== K3s Server Provisioning for user: $USERNAME ==="

# ============================================
# 1. System Update
# ============================================
echo "=== Updating system ==="
apt update && apt upgrade -y

# ============================================
# 2. Base Packages
# ============================================
echo "=== Installing base packages ==="
apt install -y \
  btop \
  build-essential \
  curl \
  dkms \
  git \
  grep \
  gzip \
  lshw \
  openssh-server \
  pipx \
  python-is-python3 \
  python3-pip \
  wget \
  zsh

# ============================================
# 3. GitHub CLI
# ============================================
echo "=== Installing GitHub CLI ==="
if ! command -v gh &> /dev/null; then
  curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg
  chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg
  echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main" | tee /etc/apt/sources.list.d/github-cli.list > /dev/null
  apt update && apt install -y gh
fi

# ============================================
# 4. Tailscale
# ============================================
echo "=== Installing Tailscale ==="
if ! command -v tailscale &> /dev/null; then
  curl -fsSL https://tailscale.com/install.sh | sh
fi

# ============================================
# 5. SSH Hardening
# ============================================
echo "=== Hardening SSH ==="
SSH_CONFIG="/etc/ssh/sshd_config"
cp "$SSH_CONFIG" "${SSH_CONFIG}.backup-$(date +%Y%m%d)"

sed -i "s/^#*Port.*/Port $SSH_PORT/" "$SSH_CONFIG"
sed -i 's/^#*PermitRootLogin.*/PermitRootLogin no/' "$SSH_CONFIG"
sed -i 's/^#*PasswordAuthentication.*/PasswordAuthentication no/' "$SSH_CONFIG"
sed -i 's/^#*PubkeyAuthentication.*/PubkeyAuthentication yes/' "$SSH_CONFIG"
sed -i 's/^#*PermitEmptyPasswords.*/PermitEmptyPasswords no/' "$SSH_CONFIG"
sed -i 's/^#*X11Forwarding.*/X11Forwarding no/' "$SSH_CONFIG"
sed -i 's/^#*MaxAuthTries.*/MaxAuthTries 3/' "$SSH_CONFIG"
sed -i 's/^#*ClientAliveInterval.*/ClientAliveInterval 300/' "$SSH_CONFIG"
sed -i 's/^#*ClientAliveCountMax.*/ClientAliveCountMax 2/' "$SSH_CONFIG"

systemctl restart ssh

# ============================================
# 6. UFW Firewall
# ============================================
echo "=== Configuring UFW ==="
apt install -y ufw
ufw --force reset
ufw default deny incoming
ufw default allow outgoing

# SSH
ufw allow $SSH_PORT/tcp comment 'SSH'

# K3s ports
ufw allow 6443/tcp comment 'K3s API'
ufw allow 10250/tcp comment 'Kubelet'
ufw allow 8472/udp comment 'Flannel VXLAN'
ufw allow 51820/udp comment 'Flannel Wireguard'
ufw allow 51821/udp comment 'Flannel Wireguard IPv6'
ufw allow 2379:2380/tcp comment 'etcd'

# Allow all traffic from Tailscale
ufw allow in on tailscale0

ufw --force enable

# ============================================
# 7. Oh My Zsh + Dracula Theme
# ============================================
echo "=== Installing Oh My Zsh for $USERNAME ==="
USER_HOME=$(eval echo ~$USERNAME)

if [ ! -d "$USER_HOME/.oh-my-zsh" ]; then
  sudo -u $USERNAME sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" "" --unattended
fi

DRACULA_DIR="$USER_HOME/.oh-my-zsh/custom/themes/dracula"
if [ ! -d "$DRACULA_DIR" ]; then
  sudo -u $USERNAME git clone https://github.com/dracula/zsh.git "$DRACULA_DIR"
  sudo -u $USERNAME ln -sf "$DRACULA_DIR/dracula.zsh-theme" "$USER_HOME/.oh-my-zsh/custom/themes/dracula.zsh-theme"
fi

cat > "$USER_HOME/.zshrc" << 'ZSHRC'
# Path to Oh My Zsh installation
export ZSH="$HOME/.oh-my-zsh"

# Dracula theme with hostname display
ZSH_THEME="dracula"
DRACULA_DISPLAY_CONTEXT=1

# Plugins
plugins=(git kubectl)

source $ZSH/oh-my-zsh.sh

# pipx path
export PATH="$PATH:$HOME/.local/bin"

# Kubectl alias
alias k='kubectl'

# Aliases
alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'
ZSHRC

chown $USERNAME:$USERNAME "$USER_HOME/.zshrc"
chsh -s $(which zsh) $USERNAME

# ============================================
# 8. Realtek R8125 Driver (for NUC NICs)
# ============================================
echo "=== Installing Realtek R8125 driver ==="
if ! dpkg -l | grep -q realtek-r8125-dkms; then
  apt install -y realtek-r8125-dkms 2>/dev/null || {
    echo "R8125 dkms package not in repos - may need manual install"
  }
fi

# ============================================
# 9. K3s Installation
# ============================================
echo "=== Installing K3s ==="

# Get Tailscale IP for node communication
TAILSCALE_IP=$(tailscale ip -4 2>/dev/null || echo "")

if [ -z "$TAILSCALE_IP" ]; then
  echo "ERROR: Tailscale not connected. Run 'sudo tailscale up' first, then re-run this script."
  exit 1
fi

# Clean up any existing k3s installation to prevent stale CA cert issues
if [ -f /usr/local/bin/k3s-uninstall.sh ]; then
  echo "=== Cleaning up existing K3s installation ==="
  /usr/local/bin/k3s-uninstall.sh || true
fi

# Also remove any leftover data directories
rm -rf /var/lib/rancher/k3s
rm -rf /etc/rancher/k3s

K3S_ARGS="--node-ip=$TAILSCALE_IP --advertise-address=$TAILSCALE_IP --flannel-iface=tailscale0"

if [ "$MODE" == "--init" ]; then
  echo "=== Initializing first K3s server node ==="
  curl -sfL https://get.k3s.io | sh -s - server \
    --cluster-init \
    $K3S_ARGS

  # Wait for K3s to be ready
  sleep 10

  # Get join token
  echo ""
  echo "=== K3s Server Initialized ==="
  echo "Join token for additional servers:"
  cat /var/lib/rancher/k3s/server/node-token
  echo ""
  echo "Join command for next server:"
  echo "sudo ./provision-k3s-server.sh <username> --join $TAILSCALE_IP"

elif [ "$MODE" == "--join" ]; then
  if [ -z "$JOIN_IP" ]; then
    echo "ERROR: Must provide server IP to join"
    echo "Usage: sudo ./provision-k3s-server.sh <username> --join <server-tailscale-ip>"
    exit 1
  fi

  echo "=== Joining K3s cluster at $JOIN_IP ==="
  echo "Enter the join token from the first server:"
  read -r K3S_TOKEN

  curl -sfL https://get.k3s.io | K3S_TOKEN="$K3S_TOKEN" sh -s - server \
    --server https://$JOIN_IP:6443 \
    $K3S_ARGS
fi

# Setup kubectl for user
mkdir -p $USER_HOME/.kube
cp /etc/rancher/k3s/k3s.yaml $USER_HOME/.kube/config
sed -i "s/127.0.0.1/$TAILSCALE_IP/g" $USER_HOME/.kube/config
chown -R $USERNAME:$USERNAME $USER_HOME/.kube

echo ""
echo "=== Provisioning Complete ==="
echo ""
echo "SSH Port: $SSH_PORT"
echo "Shell: zsh with Dracula theme"
echo "Tailscale IP: $TAILSCALE_IP"
echo "K3s: installed and running"
echo ""
echo "Test with: kubectl get nodes"
echo ""
echo "NOTE: SSH is now on port $SSH_PORT"
echo "      Reconnect with: ssh -p $SSH_PORT $USERNAME@$TAILSCALE_IP"
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../infrastructure/cert-manager
  - ../../infrastructure/authentik
  - ../../apps/argocd
name: CI

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]
  workflow_dispatch:

permissions:
  contents: read
  statuses: write

jobs:
  validate-manifests:
    name: Validate Manifests
    runs-on: [self-hosted, homelab]
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install kubectl
        run: |
          if ! command -v kubectl &> /dev/null; then
            ARCH=$(uname -m)
            case $ARCH in
              x86_64) ARCH="amd64" ;;
              aarch64) ARCH="arm64" ;;
              armv7l) ARCH="arm" ;;
            esac
            curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/${ARCH}/kubectl"
            chmod +x kubectl
            sudo mv kubectl /usr/local/bin/
          fi
          kubectl version --client

      - name: Validate kustomizations
        run: ./tests/validate-manifests.sh

  lint:
    name: Kubernetes Linting
    runs-on: [self-hosted, homelab]
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install kube-linter
        run: |
          if ! command -v kube-linter &> /dev/null; then
            ARCH=$(uname -m)
            case $ARCH in
              x86_64) TARBALL="kube-linter-linux.tar.gz" ;;
              aarch64) TARBALL="kube-linter-linux_arm64.tar.gz" ;;
              *) echo "Unsupported architecture: $ARCH"; exit 1 ;;
            esac
            curl -sSL -o /tmp/kube-linter.tar.gz "https://github.com/stackrox/kube-linter/releases/download/v0.7.6/${TARBALL}"
            tar -xzf /tmp/kube-linter.tar.gz -C /tmp
            sudo mv /tmp/kube-linter /usr/local/bin/
            rm /tmp/kube-linter.tar.gz
          fi
          kube-linter version

      - name: Lint apps
        run: kube-linter lint apps/ --config .kube-linter.yaml || true

      - name: Lint infrastructure
        run: kube-linter lint infrastructure/ --config .kube-linter.yaml || true

  security:
    name: Security Scanning
    runs-on: [self-hosted, homelab]
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install Trivy
        run: |
          if ! command -v trivy &> /dev/null; then
            curl -sfL https://raw.githubusercontent.com/aquasecurity/trivy/main/contrib/install.sh | sudo sh -s -- -b /usr/local/bin v0.58.0
          fi
          trivy version

      - name: Scan for misconfigurations
        run: trivy config . --severity HIGH,CRITICAL --exit-code 0

      - name: Scan for secrets
        run: trivy fs . --scanners secret --exit-code 1

  # Gate job - only passes when all CI checks pass
  ci-passed:
    name: CI Passed
    runs-on: [self-hosted, homelab]
    needs: [validate-manifests, lint, security]
    if: always()
    steps:
      - name: Check CI results
        run: |
          if [ "${{ needs.validate-manifests.result }}" != "success" ]; then
            echo "Manifest validation failed"
            exit 1
          fi
          if [ "${{ needs.security.result }}" != "success" ]; then
            echo "Security scan failed"
            exit 1
          fi
          # Lint is informational only
          echo "All required CI checks passed"

      - name: Trigger ArgoCD sync
        if: github.ref == 'refs/heads/main' && github.event_name == 'push'
        env:
          ARGOCD_SERVER: argocd.lab.axiomlayer.com
          ARGOCD_AUTH_TOKEN: ${{ secrets.ARGOCD_AUTH_TOKEN }}
        run: |
          if [ -z "$ARGOCD_AUTH_TOKEN" ]; then
            echo "ARGOCD_AUTH_TOKEN not set, skipping sync trigger"
            exit 0
          fi

          # Trigger sync for the root application (app of apps)
          curl -sSL -X POST \
            -H "Authorization: Bearer $ARGOCD_AUTH_TOKEN" \
            -H "Content-Type: application/json" \
            "https://${ARGOCD_SERVER}/api/v1/applications/applications/sync" \
            -d '{"prune": true}' || echo "Sync trigger sent (may require manual approval)"

  # Post-deployment tests - run after ArgoCD sync
  integration-tests:
    name: Integration Tests
    runs-on: [self-hosted, homelab]
    needs: [ci-passed]
    if: github.ref == 'refs/heads/main' && github.event_name == 'push'
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install kubectl
        run: |
          if ! command -v kubectl &> /dev/null; then
            ARCH=$(uname -m)
            case $ARCH in
              x86_64) ARCH="amd64" ;;
              aarch64) ARCH="arm64" ;;
              armv7l) ARCH="arm" ;;
            esac
            curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/${ARCH}/kubectl"
            chmod +x kubectl
            sudo mv kubectl /usr/local/bin/
          fi
          kubectl version --client

      - name: Wait for ArgoCD sync
        run: |
          echo "Waiting 60s for ArgoCD to sync changes..."
          sleep 60

      - name: Run smoke tests
        run: ./tests/smoke-test.sh

      - name: Run auth tests
        run: ./tests/test-auth.sh

  outline-sync:
    name: Outline Sync
    runs-on: [self-hosted, homelab]
    needs: [ci-passed]
    if: github.ref == 'refs/heads/main' && github.event_name == 'push'
    env:
      OUTLINE_API_TOKEN: ${{ secrets.OUTLINE_API_TOKEN }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Sync docs to Outline
        run: |
          if [ -z "$OUTLINE_API_TOKEN" ]; then
            echo "OUTLINE_API_TOKEN not set; skipping Outline sync."
            exit 0
          fi
          python3 scripts/outline_sync.py
checks:
  # Exclude checks that don't apply to homelab environment
  exclude:
    # We use Longhorn for storage, not emptyDir concerns
    - "no-read-only-root-fs"  # Some apps need writable fs (Open WebUI)
    # Homelab doesn't need anti-affinity for single replicas
    - "no-anti-affinity"
    # We intentionally use latest/main tags in some cases (tracked separately)
    - "latest-tag"

customChecks: []
# Axiomlayer

GitOps-managed K3s homelab with ArgoCD, SSO, TLS, and observability.

- **Domain**: `*.lab.axiomlayer.com`
- **Cluster**: 3-node K3s over Tailscale mesh
- **CI/CD**: Self-hosted GitHub Actions runners (`jasencdev` org)
- **Repository**: `jasencdev/axiomlayer`

---

## Live Services

| Service | URL | Description |
|---------|-----|-------------|
| Dashboard | https://db.lab.axiomlayer.com | Service portal |
| Alertmanager | https://alerts.lab.axiomlayer.com | Alert management and routing |
| ArgoCD | https://argocd.lab.axiomlayer.com | GitOps continuous delivery |
| Authentik | https://auth.lab.axiomlayer.com | SSO/OIDC identity provider |
| Campfire | https://chat.lab.axiomlayer.com | Team chat (37signals) |
| Grafana | https://grafana.lab.axiomlayer.com | Metrics dashboards |
| Longhorn | https://longhorn.lab.axiomlayer.com | Distributed storage UI |
| n8n (autom8) | https://autom8.lab.axiomlayer.com | Workflow automation |
| Open WebUI | https://ai.lab.axiomlayer.com | AI chat interface (Ollama backend) |
| Outline | https://docs.lab.axiomlayer.com | Documentation wiki |
| Plane | https://plane.lab.axiomlayer.com | Project management |
| Telnet Server | https://telnet.lab.axiomlayer.com | Demo app with SSO |

---

## Architecture

### Cluster Nodes

| Node | Role | Tailscale IP | Local IP | Storage |
|------|------|--------------|----------|---------|
| neko | control-plane | 100.67.134.110 | 192.168.1.167 | 462GB NVMe |
| neko2 | control-plane | 100.106.35.14 | 192.168.1.103 | 462GB NVMe |
| bobcat | agent (Raspberry Pi) | 100.121.67.60 | 192.168.1.49 | 500GB SSD |

### GPU Workstation

| Node | Role | GPU | VRAM | Purpose |
|------|------|-----|------|---------|
| siberian | Ollama server | NVIDIA RTX 5070 Ti | 16GB | Local LLM inference |

### Technology Stack

#### Infrastructure Layer

| Component | Purpose | Namespace |
|-----------|---------|-----------|
| K3s | Lightweight Kubernetes | - |
| Tailscale | Mesh networking | - |
| Traefik | Ingress controller, TLS termination | kube-system |
| cert-manager | Let's Encrypt certificates (Cloudflare DNS-01) | cert-manager |
| Sealed Secrets | GitOps-safe secret management | kube-system |
| Longhorn | Distributed block storage (3-way replication) | longhorn-system |
| CloudNativePG | PostgreSQL operator | cnpg-system |
| External-DNS | Automatic Cloudflare DNS records | external-dns |
| Loki + Promtail | Log aggregation | monitoring |
| Prometheus + Grafana | Metrics and dashboards | monitoring |
| Alertmanager | Alert routing and notifications | alertmanager |
| NFS Proxy | Backup proxy for UniFi NAS | nfs-proxy |

#### Platform Layer

| Component | Purpose | Namespace |
|-----------|---------|-----------|
| Authentik | SSO + OIDC + forward auth | authentik |
| ArgoCD | GitOps continuous delivery | argocd |
| Actions Runner Controller | Self-hosted GitHub Actions runners | actions-runner |

#### Application Layer

| Application | Purpose | Namespace |
|-------------|---------|-----------|
| Campfire | Team chat (37signals) | campfire |
| n8n | Workflow automation | n8n |
| Open WebUI | AI chat interface | open-webui |
| Outline | Documentation wiki | outline |
| Plane | Project management | plane |
| Telnet Server | Demo application | telnet-server |

---

## Directory Structure

```
axiomlayer/
 .github/workflows/test-runner.yaml     # CI workflow for self-hosted runner
 apps/
    argocd/
       applications/                  # App-of-Apps manifests (infra + apps)
          actions-runner-*.yaml
          authentik*.yaml
          backups.yaml               # Automates infrastructure/backups
          monitoring-extras.yaml     # Grafana cert + namespace bootstrap
          outline.yaml / plane*.yaml
          root.yaml                  # App of Apps (sync wave 0)
          telnet-server.yaml
       sealed-secret.yaml             # Authentik OIDC client for ArgoCD
       configmaps.yaml                # Core settings (repo URL, RBAC)
       ingress.yaml                   # https://argocd.lab.axiomlayer.com
    campfire/                          # 37signals Campfire deployment
    dashboard/                         # db.lab.axiomlayer.com portal (Nginx)
    n8n/                               # Workflow automation (CNPG + ingress)
    outline/                           # Wiki (CNPG, Redis, NetworkPolicy, PDB)
    plane/                             # Plane Helm overlays + extras
    telnet-server/                     # Demo workload
 clusters/lab/                          # Root kustomization entrypoint
 docs/                                  # Architecture/runbooks for Outline/wiki
    ARCHITECTURE.md
    APPLICATIONS.md
    ...
 infrastructure/
    actions-runner/                    # Self-hosted GitHub runners + PAT
    alertmanager/                      # Routing + Prometheus rules
    authentik/                         # Helm values, blueprints, outpost, RBAC
    backups/                           # CronJob + Longhorn recurring jobs
    cert-manager/                      # ClusterIssuer + DNS token
    cloudnative-pg/                    # CNPG operator
    external-dns/                      # Cloudflare integration
    grafana/                           # OIDC secret
    longhorn/                          # Storage + backup target config
    monitoring/                        # Grafana TLS certificate
    nfs-proxy/                         # Single-IP NAS proxy for Longhorn
    open-webui/                        # Ollama connectivity + ingress
 scripts/                               # Provisioning & maintenance helpers
    backup-homelab.sh                  # Local backup helper
    provision-k3s-{server,agent}.sh    # Cluster bootstrap
    provision-k3s-ollama-agent.sh      # Lightweight GPU agent profile
    provision-siberian.sh              # GPU workstation automation
 templates/                             # Boilerplate for new apps
 tests/test-auth.sh                     # Authentik ingress smoke test
```

### Syncing Docs to Outline

1. Set `OUTLINE_API_TOKEN` (create one in Outline with `documents.write` + `collections.write` scopes).
2. Adjust `outline_sync/config.json` if you add/remove local docs.
3. Run `python3 scripts/outline_sync.py` to create/update the Outline collection defined in the config. The script records collection + document IDs in `outline_sync/state.json` so future runs update in place.
4. Add the same token as the GitHub secret `OUTLINE_API_TOKEN` so the `outline-sync` job in `.github/workflows/ci.yaml` can publish docs automatically on every push to `main`.

See `docs/OUTLINE_SYNC_PLAN.md` for the publishing hierarchy and API workflow.

---

## How It Works

### GitOps Workflow

```
Developer  git push  GitHub  ArgoCD detects change  Syncs to cluster
                            
                   GitHub Actions (self-hosted runner)
                            
                   Validates manifests, runs tests
```

1. All configuration lives in this Git repository
2. ArgoCD watches the repo and automatically syncs changes
3. GitHub Actions validate changes using self-hosted runners
4. No manual `kubectl apply` needed after initial bootstrap

### App of Apps Pattern

ArgoCD uses an "App of Apps" pattern for automatic Application management:

```
apps/argocd/applications/root.yaml (manages all other Applications)
         
          cert-manager.yaml  infrastructure/cert-manager/
          authentik.yaml  infrastructure/authentik/
          open-webui.yaml  infrastructure/open-webui/
          ... (all Application manifests)
```

**Adding a new application is fully automated:**
1. Create manifests in `apps/{name}/` or `infrastructure/{name}/`
2. Create `apps/argocd/applications/{name}.yaml`
3. Add to `apps/argocd/applications/kustomization.yaml`
4. Push to GitHub - ArgoCD auto-syncs everything

### DNS + TLS Flow

```
Request to *.lab.axiomlayer.com
    
    
Cloudflare DNS (A record  Tailscale IPs)
    
    
Traefik Ingress (TLS termination)
    
    
Authentik Forward Auth (SSO verification)
    
    
Application (receives X-Authentik-* headers)
```

### Automatic DNS Management

External-DNS watches Ingress resources and automatically creates/updates Cloudflare DNS records:

1. Create an Ingress with a host
2. External-DNS creates the A record in Cloudflare
3. cert-manager requests a TLS certificate via DNS-01 challenge
4. Traefik serves the application with HTTPS

### Certificate Issuance

cert-manager uses Cloudflare DNS-01 challenges:

1. cert-manager creates a TXT record via Cloudflare API
2. Let's Encrypt verifies the record
3. Certificate is issued and stored as a Kubernetes Secret
4. Traefik uses the secret for TLS termination

**Important**: cert-manager is configured to use public DNS servers (1.1.1.1, 8.8.8.8) for DNS-01 validation to avoid local DNS resolver issues.

### Backup Architecture

```
Longhorn Volume
    
    
NFS Proxy (on neko)  UniFi NAS (192.168.1.234)
                               
                                /k8s-backup/
    
     ClusterIP Service (10.43.x.x)
            
            
    All nodes can access via service
```

The NFS proxy solves the UniFi NAS single-IP NFS export limitation by:
1. Running on neko (192.168.1.167) which is allowed by NFS export
2. Re-exporting via Kubernetes Service so all nodes can access
3. Longhorn connects to the proxy service IP

**Backup Schedule**: Daily at 2:00 AM, retains 7 backups

### Backup Automation

- `infrastructure/backups/` defines the `homelab-backup` CronJob that runs on `neko` at 03:00, dumps Authentik and Outline Postgres databases via CNPG services, writes them to the NAS over the NFS proxy, and keeps only the seven newest archives.
- `infrastructure/backups/longhorn-recurring-jobs.yaml` codifies the Longhorn snapshot/backup cadence so application PVCs automatically land on the NAS target without manual UI edits.
- `scripts/backup-homelab.sh` is the operator workflow for ad-hoc backups: it copies the repo `.env`, exports Sealed Secret keys, takes fresh CNPG dumps, and captures Longhorn settings before risky maintenance.

---

## CI/CD with Self-Hosted Runners

### Overview

GitHub Actions runners are deployed in the cluster using [actions-runner-controller](https://github.com/actions/actions-runner-controller).

**Organization**: `jasencdev`
**Labels**: `self-hosted`, `homelab`
**Replicas**: 1 (auto-scales based on jobs)

### Using the Runner

In any repo under the `jasencdev` organization:

```yaml
name: Build
on: [push]
jobs:
  build:
    runs-on: [self-hosted, homelab]
    steps:
      - uses: actions/checkout@v4
      - run: echo "Running on homelab cluster!"
```

### Runner Features

- Docker-in-Docker enabled for container builds
- Access to cluster via kubectl (for deployment workflows)
- 2 CPU cores, 2GB memory per runner

### Checking Runner Status

```bash
# Check runner pods
kubectl get pods -n actions-runner

# Check runner registration
kubectl get runners -n actions-runner

# View runner logs
kubectl logs -n actions-runner -l app.kubernetes.io/name=actions-runner
```

---

## SSO Integration

All applications are protected by Authentik forward auth. Applications receive user context via HTTP headers:

```
X-Authentik-Username: jasen
X-Authentik-Email: jasen@axiomlayer.com
X-Authentik-Groups: admins,engineers
X-Authentik-Uid: abc123
```

### Ingress Configuration for SSO

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
spec:
  ingressClassName: traefik
  tls:
    - hosts:
        - myapp.lab.axiomlayer.com
      secretName: myapp-tls
```

---

## Alerting

### Alertmanager Configuration

Alertmanager receives alerts from Prometheus and routes them based on severity.

**URL**: https://alerts.lab.axiomlayer.com

### Alert Rules

| Alert | Severity | Description |
|-------|----------|-------------|
| NodeNotReady | critical | Node has been unready for 5+ minutes |
| NodeHighCPU | warning | Node CPU > 80% for 10+ minutes |
| NodeHighMemory | warning | Node memory > 85% for 10+ minutes |
| NodeDiskPressure | critical | Node disk > 90% |
| PodCrashLooping | warning | Pod restarting frequently |
| PodNotReady | warning | Pod not ready for 5+ minutes |
| CertificateExpiringSoon | warning | Certificate expires in < 30 days |
| CertificateExpired | critical | Certificate has expired |
| LonghornVolumeHealthCritical | critical | Longhorn volume faulted |
| LonghornVolumeDegraded | warning | Longhorn volume degraded |
| LonghornNodeDown | critical | Longhorn node offline |

### Customizing Alerts

Edit `infrastructure/alertmanager/prometheus-rules.yaml` to add or modify alert rules.

---

## Longhorn Storage

### Overview

Longhorn provides distributed block storage with automatic replication across nodes.

**UI**: https://longhorn.lab.axiomlayer.com
**Storage Class**: `longhorn` (default)
**Replication**: 3 replicas (or 2 for large volumes)

### Backup Configuration

- **Target**: UniFi NAS via NFS proxy
- **Schedule**: Daily at 2:00 AM
- **Retention**: 7 backups

### Managing Backups

```bash
# List backup targets
kubectl get backuptargets -n longhorn-system

# List recurring jobs
kubectl get recurringjobs -n longhorn-system

# Create manual backup (via UI or kubectl)
kubectl -n longhorn-system create -f - <<EOF
apiVersion: longhorn.io/v1beta2
kind: Backup
metadata:
  name: manual-backup-$(date +%Y%m%d)
spec:
  snapshotName: ""
EOF
```

### Checking Volume Health

```bash
# List all volumes
kubectl get volumes -n longhorn-system

# Check for degraded volumes
kubectl get volumes -n longhorn-system -o custom-columns=NAME:.metadata.name,STATE:.status.state,ROBUSTNESS:.status.robustness | grep -v healthy
```

---

## Adding a New Application

### 1. Create Application Directory

```
apps/myapp/
 namespace.yaml
 deployment.yaml
 service.yaml
 certificate.yaml
 ingress.yaml
 pdb.yaml              # If replicas > 1
 kustomization.yaml
```

### 2. Required Labels

```yaml
labels:
  app.kubernetes.io/name: myapp
  app.kubernetes.io/component: server
  app.kubernetes.io/part-of: homelab
  app.kubernetes.io/managed-by: argocd
```

### 3. Security Context (Required)

```yaml
spec:
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    seccompProfile:
      type: RuntimeDefault
  containers:
    - name: myapp
      securityContext:
        allowPrivilegeEscalation: false
        readOnlyRootFilesystem: true
        capabilities:
          drop: ["ALL"]
      resources:
        requests:
          cpu: 100m
          memory: 128Mi
        limits:
          cpu: 500m
          memory: 512Mi
      livenessProbe:
        httpGet:
          path: /health
          port: 8080
      readinessProbe:
        httpGet:
          path: /ready
          port: 8080
```

### 4. Certificate

```yaml
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: myapp-tls
  namespace: myapp
spec:
  secretName: myapp-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - myapp.lab.axiomlayer.com
```

### 5. Create ArgoCD Application

Create `apps/argocd/applications/myapp.yaml`:

```yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: myapp
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: apps/myapp
  destination:
    server: https://kubernetes.default.svc
    namespace: myapp
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
```

### 6. Add to Kustomization

Edit `apps/argocd/applications/kustomization.yaml`:

```yaml
resources:
  - myapp.yaml
```

### 7. Commit and Push

The App of Apps (`root.yaml`) will automatically detect the new Application manifest and deploy it. No manual `kubectl apply` needed.

---

## Infrastructure Components

### cert-manager

Handles TLS certificate issuance via Let's Encrypt.

**ClusterIssuer**: `letsencrypt-prod`
- Uses Cloudflare DNS-01 challenge
- API token stored in Sealed Secret
- Configured to use public DNS servers for validation

**Files**:
- `infrastructure/cert-manager/cluster-issuer.yaml`
- `infrastructure/cert-manager/sealed-secret.yaml`

### External-DNS

Automatically manages Cloudflare DNS records based on Ingress resources.

**Configuration**:
- Watches: Ingress resources
- Domain filter: `lab.axiomlayer.com`
- Policy: `upsert-only` (won't delete records)
- TXT registry for ownership tracking

**Files**:
- `infrastructure/external-dns/deployment.yaml`
- `infrastructure/external-dns/rbac.yaml`
- `infrastructure/external-dns/sealed-secret.yaml`

### Longhorn

Distributed block storage across all nodes.

**Features**:
- 3-way replication (2 for large volumes)
- Backup to UniFi NAS via NFS proxy
- Daily automated backups (7 retained)
- Volume snapshots
- UI at https://longhorn.lab.axiomlayer.com

**Storage Class**: `longhorn` (default)

### CloudNativePG

PostgreSQL operator for running HA PostgreSQL clusters.

**Namespace**: `cnpg-system`

Used by:
- Authentik
- Outline
- Plane (uses local PostgreSQL in Helm chart)

### Loki + Promtail

Centralized log aggregation.

- **Loki**: Log storage and querying
- **Promtail**: Log collection from all pods
- **Grafana**: Query interface via Explore

### NFS Proxy

Solves UniFi NAS single-IP NFS export limitation.

**How it works**:
1. Runs `erichough/nfs-server` container on neko node
2. Mounts UniFi NAS share (neko's IP is allowed)
3. Re-exports via Kubernetes ClusterIP service
4. All nodes access backups via the service IP

**Requirement**: `nfsd` kernel module must be loaded on neko:
```bash
echo "nfsd" | sudo tee /etc/modules-load.d/nfsd.conf
sudo modprobe nfsd
```

### Open WebUI + Ollama

Local LLM inference using a dedicated GPU workstation.

**Architecture**:
```
Open WebUI (K8s cluster)  Ollama (siberian workstation)
                                   
      ai.lab.axiomlayer.com       RTX 5070 Ti (16GB VRAM)
                                         via Tailscale
```

**Components**:
- **Open WebUI**: Chat interface running in K8s (`open-webui` namespace)
- **Ollama**: LLM inference server on dedicated GPU workstation
- **Connection**: Via Tailscale mesh (configured in `configmap.yaml`)

**Recommended Models** (16GB VRAM):
| Model | VRAM | Use Case |
|-------|------|----------|
| `llama3.2:3b` | 2GB | Fast, general purpose |
| `llama3.1:8b` | 5GB | Good balance |
| `deepseek-r1:14b` | 9GB | Reasoning |
| `codellama:13b` | 8GB | Code assistance |
| `qwen2.5:14b` | 9GB | Multilingual |

**Provisioning the GPU workstation**:
```bash
# On fresh Ubuntu 24.04 install
sudo ./scripts/provision-siberian.sh jasen
# Reboot, then:
sudo tailscale up
sudo systemctl start ollama
ollama pull llama3.2:3b
```

---

## Secrets Management

All secrets are managed via Sealed Secrets. **Never commit plaintext secrets.**

### Create a Sealed Secret

```bash
# Create the secret manifest
KUBECONFIG=~/.kube/config kubectl create secret generic my-secret \
  --namespace my-namespace \
  --dry-run=client \
  --from-literal=api-token=YOUR_TOKEN \
  -o yaml | kubeseal \
  --controller-name=sealed-secrets \
  --controller-namespace=kube-system \
  --format yaml > sealed-secret.yaml
```

### Sealed Secrets in Use

| Secret | Namespace | Purpose |
|--------|-----------|---------|
| cloudflare-api-token | cert-manager | DNS-01 challenge |
| cloudflare-api-token | external-dns | DNS record management |
| github-runner-token | actions-runner | GitHub Actions runner registration |

---

## Common Commands

```bash
# Check ArgoCD application status
kubectl get applications -n argocd

# Force sync an application
kubectl patch application myapp -n argocd --type=merge \
  -p '{"operation":{"sync":{}}}'

# Check certificates
kubectl get certificates -A

# Check certificate requests
kubectl get certificaterequests -A

# View cert-manager logs
kubectl logs -n cert-manager deployment/cert-manager

# Check external-dns logs
kubectl logs -n external-dns deployment/external-dns

# Validate kustomization
kubectl kustomize apps/myapp

# Restart a deployment
kubectl rollout restart deployment/myapp -n myapp

# Check Longhorn volumes
kubectl get volumes -n longhorn-system

# Check backup target status
kubectl get backuptargets -n longhorn-system

# Check GitHub Actions runners
kubectl get runners -n actions-runner
```

---

## Troubleshooting

### Certificate Stuck in Pending

1. Check the CertificateRequest:
   ```bash
   kubectl describe certificaterequest -n <namespace>
   ```

2. Check the Challenge:
   ```bash
   kubectl describe challenge -n <namespace>
   ```

3. Verify DNS propagation:
   ```bash
   dig @1.1.1.1 _acme-challenge.myapp.lab.axiomlayer.com TXT
   ```

4. Check cert-manager logs:
   ```bash
   kubectl logs -n cert-manager deployment/cert-manager | grep myapp
   ```

5. **Note**: Cloudflare caches negative DNS responses for ~7 minutes. If a record was missing, wait before retrying.

### ArgoCD OutOfSync

1. Check what's different:
   ```bash
   kubectl get application myapp -n argocd -o yaml | grep -A20 "status:"
   ```

2. For immutable resources (Jobs), delete and let ArgoCD recreate:
   ```bash
   kubectl delete job <job-name> -n <namespace>
   ```

### External-DNS Not Creating Records

1. Check logs:
   ```bash
   kubectl logs -n external-dns deployment/external-dns
   ```

2. Verify Ingress has correct annotations and host

3. Check Cloudflare API token permissions (Zone:Read, DNS:Edit)

### Longhorn Volume Degraded

1. Check volume status:
   ```bash
   kubectl describe volume <pvc-name> -n longhorn-system
   ```

2. Check node storage:
   ```bash
   kubectl get nodes.longhorn.io -n longhorn-system
   ```

3. If insufficient storage, extend LVM:
   ```bash
   sudo lvextend -l +100%FREE /dev/ubuntu-vg/ubuntu-lv
   sudo resize2fs /dev/ubuntu-vg/ubuntu-lv
   ```

4. Restart Longhorn managers to detect new space:
   ```bash
   kubectl delete pod -n longhorn-system -l app=longhorn-manager
   ```

### GitHub Actions Runner Not Picking Up Jobs

1. Check runner status:
   ```bash
   kubectl get runners -n actions-runner
   ```

2. Check controller logs:
   ```bash
   kubectl logs -n actions-runner -l app.kubernetes.io/name=actions-runner-controller
   ```

3. Verify PAT has correct scopes (`admin:org`, `repo`)

4. Delete and recreate runner:
   ```bash
   kubectl delete runners -n actions-runner --all
   ```

### NFS Proxy Not Working

1. Check nfsd module is loaded:
   ```bash
   lsmod | grep nfsd
   ```

2. Check proxy pod logs:
   ```bash
   kubectl logs -n nfs-proxy deployment/nfs-proxy
   ```

3. Verify UniFi NAS NFS export allows neko's IP (192.168.1.167)

---

## Bootstrap (Fresh Cluster)

### Prerequisites

- 3 machines with Ubuntu 24.04 LTS
- Tailscale installed and connected
- Docker installed
- LVM extended to use full disk (Ubuntu default only uses 100GB)

### 0. Extend LVM (if needed)

```bash
sudo lvextend -l +100%FREE /dev/ubuntu-vg/ubuntu-lv
sudo resize2fs /dev/ubuntu-vg/ubuntu-lv
```

### 1. Install K3s

**First control-plane (neko):**
```bash
curl -sfL https://get.k3s.io | sh -s - server \
  --cluster-init \
  --tls-san=neko \
  --flannel-iface=tailscale0
```

**Additional control-plane (neko2):**
```bash
curl -sfL https://get.k3s.io | sh -s - server \
  --server https://<neko-tailscale-ip>:6443 \
  --token <node-token> \
  --tls-san=neko2 \
  --flannel-iface=tailscale0
```

**Worker node (bobcat):**
```bash
curl -sfL https://get.k3s.io | sh -s - agent \
  --server https://<neko-tailscale-ip>:6443 \
  --token <node-token> \
  --flannel-iface=tailscale0
```

### 2. Install Core Components

```bash
# Sealed Secrets
helm repo add sealed-secrets https://bitnami-labs.github.io/sealed-secrets
helm install sealed-secrets sealed-secrets/sealed-secrets -n kube-system

# cert-manager
kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.14.4/cert-manager.yaml

# Longhorn
helm repo add longhorn https://charts.longhorn.io
helm install longhorn longhorn/longhorn -n longhorn-system --create-namespace

# CloudNativePG
kubectl apply --server-side -f https://raw.githubusercontent.com/cloudnative-pg/cloudnative-pg/release-1.22/releases/cnpg-1.22.0.yaml

# Authentik (via Helm)
helm repo add authentik https://charts.goauthentik.io
helm install authentik authentik/authentik -n authentik --create-namespace -f values.yaml

# ArgoCD
kubectl create namespace argocd
kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml

# Actions Runner Controller (CRDs need server-side apply due to size)
helm repo add actions-runner-controller https://actions-runner-controller.github.io/actions-runner-controller
for crd in runnerdeployments runnerreplicasets runners runnersets; do
  curl -sL "https://raw.githubusercontent.com/actions/actions-runner-controller/master/charts/actions-runner-controller/crds/actions.summerwind.dev_${crd}.yaml" | kubectl apply --server-side -f -
done
```

### 3. Load nfsd Module (for NFS proxy)

```bash
# On neko only
echo "nfsd" | sudo tee /etc/modules-load.d/nfsd.conf
sudo modprobe nfsd
```

### 4. Configure ArgoCD

```bash
# Apply ArgoCD applications
kubectl apply -k apps/argocd/applications
```

---

## Roadmap

- [x] K3s multi-node cluster
- [x] Tailscale mesh networking
- [x] GitOps with ArgoCD
- [x] SSO with Authentik
- [x] Automatic TLS (cert-manager + Cloudflare DNS-01)
- [x] Automatic DNS (external-dns + Cloudflare)
- [x] Sealed secrets
- [x] Forward auth middleware
- [x] Distributed storage (Longhorn)
- [x] PostgreSQL HA (CloudNativePG)
- [x] Logging (Loki + Promtail)
- [x] Monitoring (Prometheus + Grafana)
- [x] Workflow automation (n8n)
- [x] Documentation wiki (Outline)
- [x] Project management (Plane)
- [x] Alerting (Alertmanager)
- [x] CI/CD pipelines (GitHub Actions self-hosted runners)
- [x] Backup automation (Longhorn  UniFi NAS via NFS proxy)
- [x] App of Apps pattern (auto-sync ArgoCD Applications)
- [x] Local LLM inference (Open WebUI + Ollama on GPU workstation)

---

## Notes

- ArgoCD is excluded from self-management to prevent sync loops
- Helm charts are installed manually but managed via ArgoCD Applications
- TLS termination happens at Traefik; backend services run HTTP
- cert-manager uses `--dns01-recursive-nameservers=1.1.1.1:53,8.8.8.8:53` to avoid local DNS issues
- Cloudflare DNS caches negative responses; wait ~7 minutes if a record was previously missing
- Ubuntu Server 24.04 defaults to 100GB LVM; extend manually for full disk
- UniFi NAS NFS exports only accept single IP; use NFS proxy for multi-node access
- Actions Runner Controller CRDs are too large for regular apply; use `--server-side`
- App of Apps (`root.yaml`) auto-syncs all Application manifests; no manual apply needed
- Ollama runs on dedicated GPU workstation (siberian) outside the K8s cluster, connected via Tailscale

---

## License

MIT
#!/bin/bash
# Test authentication flows
# Run: ./tests/test-auth.sh

set -e

export KUBECONFIG="${KUBECONFIG:-$HOME/.kube/config}"

RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

FAILED=0
PASSED=0

pass() {
    echo -e "${GREEN}[PASS]${NC} $1"
    PASSED=$((PASSED + 1))
}

fail() {
    echo -e "${RED}[FAIL]${NC} $1"
    FAILED=$((FAILED + 1))
}

section() {
    echo ""
    echo "========================================"
    echo "$1"
    echo "========================================"
}

section "Authentik Health"

# Check Authentik is responding
AUTH_STATUS=$(curl -sk -o /dev/null -w "%{http_code}" "https://auth.lab.axiomlayer.com/-/health/live/" 2>/dev/null)
if [ "$AUTH_STATUS" = "204" ] || [ "$AUTH_STATUS" = "200" ]; then
    pass "Authentik health check passed"
else
    fail "Authentik health check failed (HTTP $AUTH_STATUS)"
fi

section "Forward Auth Outpost"

# Check outpost pod is running
if kubectl get pods -n authentik -l goauthentik.io/outpost-name=forward-auth-outpost --no-headers 2>/dev/null | grep -q "Running"; then
    pass "Forward auth outpost pod is running"
else
    fail "Forward auth outpost pod is not running"
fi

# Check outpost is processing requests (look for any recent application activity in logs)
OUTPOST_ACTIVE=$(kubectl logs -n authentik -l goauthentik.io/outpost-name=forward-auth-outpost --tail=50 --since=5m 2>/dev/null | grep -c "outpost.goauthentik.io" || echo 0)
if [ "$OUTPOST_ACTIVE" -gt 0 ]; then
    pass "Forward auth outpost is processing requests"
else
    # Outpost might just be idle, this is a warning not a failure
    pass "Forward auth outpost has no recent activity (may be idle)"
fi

section "Forward Auth Protected Apps"

# These apps should redirect to Authentik (302)
FORWARD_AUTH_APPS=(
    "db.lab.axiomlayer.com:Dashboard"
    "autom8.lab.axiomlayer.com:n8n"
    "alerts.lab.axiomlayer.com:Alertmanager"
    "longhorn.lab.axiomlayer.com:Longhorn"
    "ai.lab.axiomlayer.com:OpenWebUI"
    "chat.lab.axiomlayer.com:Campfire"
)

for app in "${FORWARD_AUTH_APPS[@]}"; do
    URL="${app%%:*}"
    NAME="${app##*:}"

    STATUS=$(curl -sk -o /dev/null -w "%{http_code}" "https://$URL/" 2>/dev/null)
    if [ "$STATUS" = "302" ]; then
        # Check it redirects to Authentik
        LOCATION=$(curl -sk -I "https://$URL/" 2>/dev/null | grep -i "location:" | head -1)
        if echo "$LOCATION" | grep -q "auth.lab.axiomlayer.com"; then
            pass "$NAME redirects to Authentik"
        else
            fail "$NAME returns 302 but not to Authentik"
        fi
    else
        fail "$NAME should return 302 (got $STATUS)"
    fi
done

section "HTTPS Connectivity"

# Test that apps respond properly over HTTPS (TLS handshake + HTTP response)
# Uses -k to skip cert verification (internal certs), tests that TLS connection succeeds
HTTPS_APPS=(
    "plane.lab.axiomlayer.com:Plane"
    "grafana.lab.axiomlayer.com:Grafana"
    "argocd.lab.axiomlayer.com:ArgoCD"
)

for app in "${HTTPS_APPS[@]}"; do
    URL="${app%%:*}"
    NAME="${app##*:}"

    # Test HTTPS connection works (skip cert verification with -k)
    STATUS=$(curl -sk -o /dev/null -w "%{http_code}" --connect-timeout 10 "https://$URL/" 2>/dev/null)

    if [ -n "$STATUS" ] && [ "$STATUS" != "000" ]; then
        pass "$NAME HTTPS connection successful (HTTP $STATUS)"
    else
        fail "$NAME HTTPS connection failed (HTTP $STATUS)"
    fi
done

section "Native OIDC Apps - Basic Access"

# Apps with native OIDC should return 200 (login page)
OIDC_APPS=(
    "argocd.lab.axiomlayer.com:ArgoCD"
    "grafana.lab.axiomlayer.com:Grafana"
    "plane.lab.axiomlayer.com:Plane"
    "docs.lab.axiomlayer.com:Outline"
)

for app in "${OIDC_APPS[@]}"; do
    URL="${app%%:*}"
    NAME="${app##*:}"

    STATUS=$(curl -sk -o /dev/null -w "%{http_code}" "https://$URL/" 2>/dev/null)
    if [ "$STATUS" = "200" ] || [ "$STATUS" = "302" ]; then
        pass "$NAME is accessible (HTTP $STATUS)"
    else
        fail "$NAME returned HTTP $STATUS"
    fi
done

section "OIDC Provider Configuration"

# Check OIDC discovery endpoints for each provider
OIDC_PROVIDERS=(
    "argocd:ArgoCD"
    "grafana:Grafana"
    "plane:Plane"
    "outline:Outline"
)

for provider in "${OIDC_PROVIDERS[@]}"; do
    SLUG="${provider%%:*}"
    NAME="${provider##*:}"

    OIDC_DISCOVERY=$(curl -sk "https://auth.lab.axiomlayer.com/application/o/$SLUG/.well-known/openid-configuration" 2>/dev/null)
    if echo "$OIDC_DISCOVERY" | grep -q "issuer"; then
        pass "$NAME OIDC provider discovery endpoint working"
    else
        fail "$NAME OIDC provider discovery endpoint not found"
    fi
done

section "ArgoCD OIDC Integration"

# Check ArgoCD serves its UI (it's a React app, so check for JS bundle)
ARGOCD_LOGIN_PAGE=$(curl -sk "https://argocd.lab.axiomlayer.com/" 2>/dev/null)
if echo "$ARGOCD_LOGIN_PAGE" | grep -qi "argocd\|script\|app"; then
    pass "ArgoCD UI loads successfully"
else
    fail "ArgoCD UI not loading"
fi

# Check ArgoCD auth callback endpoint
ARGOCD_CALLBACK=$(curl -sk -o /dev/null -w "%{http_code}" "https://argocd.lab.axiomlayer.com/auth/callback" 2>/dev/null)
if [ "$ARGOCD_CALLBACK" = "400" ] || [ "$ARGOCD_CALLBACK" = "302" ] || [ "$ARGOCD_CALLBACK" = "200" ]; then
    pass "ArgoCD auth callback endpoint exists (HTTP $ARGOCD_CALLBACK)"
else
    fail "ArgoCD auth callback endpoint not responding (HTTP $ARGOCD_CALLBACK)"
fi

# Verify ArgoCD OIDC config in cluster
ARGOCD_OIDC_CONFIG=$(kubectl get configmap argocd-cm -n argocd -o jsonpath='{.data.oidc\.config}' 2>/dev/null)
if echo "$ARGOCD_OIDC_CONFIG" | grep -q "auth.lab.axiomlayer.com"; then
    pass "ArgoCD OIDC configured to use Authentik"
else
    fail "ArgoCD OIDC not configured for Authentik"
fi

# Verify ArgoCD can initiate OIDC flow (should redirect to Authentik authorize endpoint)
ARGOCD_LOGIN_RESP=$(curl -sk "https://argocd.lab.axiomlayer.com/auth/login?return_url=https://argocd.lab.axiomlayer.com/" 2>/dev/null)
ARGOCD_LOGIN_STATUS=$(curl -sk -o /dev/null -w "%{http_code}" "https://argocd.lab.axiomlayer.com/auth/login?return_url=https://argocd.lab.axiomlayer.com/" 2>/dev/null)
ARGOCD_LOGIN_LOCATION=$(curl -sk -I "https://argocd.lab.axiomlayer.com/auth/login?return_url=https://argocd.lab.axiomlayer.com/" 2>/dev/null | grep -i "location:" | head -1)

if [ "$ARGOCD_LOGIN_STATUS" = "302" ] || [ "$ARGOCD_LOGIN_STATUS" = "303" ] || [ "$ARGOCD_LOGIN_STATUS" = "307" ]; then
    if echo "$ARGOCD_LOGIN_LOCATION" | grep -q "auth.lab.axiomlayer.com"; then
        pass "ArgoCD OIDC login redirects to Authentik"
    else
        fail "ArgoCD OIDC login redirects but not to Authentik (location: $ARGOCD_LOGIN_LOCATION)"
    fi
elif [ "$ARGOCD_LOGIN_STATUS" = "400" ]; then
    fail "ArgoCD OIDC login returns 400 - invalid redirect URL configuration"
else
    fail "ArgoCD OIDC login unexpected response (HTTP $ARGOCD_LOGIN_STATUS)"
fi

section "Grafana OIDC Integration"

# Check Grafana redirects to OAuth login
GRAFANA_STATUS=$(curl -sk -o /dev/null -w "%{http_code}" "https://grafana.lab.axiomlayer.com/login" 2>/dev/null)
if [ "$GRAFANA_STATUS" = "200" ] || [ "$GRAFANA_STATUS" = "302" ]; then
    pass "Grafana login page accessible (HTTP $GRAFANA_STATUS)"
else
    fail "Grafana login page not accessible (HTTP $GRAFANA_STATUS)"
fi

# Check Grafana OAuth endpoint redirects to Authentik
GRAFANA_OAUTH=$(curl -sk -I "https://grafana.lab.axiomlayer.com/login/generic_oauth" 2>/dev/null | grep -i "location:" | head -1)
if echo "$GRAFANA_OAUTH" | grep -q "auth.lab.axiomlayer.com"; then
    pass "Grafana OAuth redirects to Authentik"
else
    fail "Grafana OAuth does not redirect to Authentik"
fi

# Verify Grafana has OAuth configured
GRAFANA_CONFIG=$(kubectl get deployment -n monitoring -l app.kubernetes.io/name=grafana -o jsonpath='{.items[0].spec.template.spec.containers[0].env}' 2>/dev/null)
if echo "$GRAFANA_CONFIG" | grep -q "GF_AUTH_GENERIC_OAUTH_ENABLED"; then
    pass "Grafana OAuth environment variables configured"
else
    # Check via values/configmap
    GRAFANA_INI=$(kubectl get configmap -n monitoring -l app.kubernetes.io/name=grafana -o yaml 2>/dev/null | grep -i "generic_oauth")
    if [ -n "$GRAFANA_INI" ]; then
        pass "Grafana OAuth configured via ConfigMap"
    else
        fail "Grafana OAuth not configured"
    fi
fi

section "Summary"

TOTAL=$((PASSED + FAILED))
echo ""
echo "Tests: $TOTAL | Passed: $PASSED | Failed: $FAILED"
echo ""

if [ "$FAILED" -gt 0 ]; then
    echo -e "${RED}Some tests failed!${NC}"
    exit 1
else
    echo -e "${GREEN}All tests passed!${NC}"
    exit 0
fi
#!/bin/bash
# Smoke tests for homelab infrastructure
# Run: ./tests/smoke-test.sh

set -e

export KUBECONFIG="${KUBECONFIG:-$HOME/.kube/config}"

RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

FAILED=0
PASSED=0

pass() {
    echo -e "${GREEN}[PASS]${NC} $1"
    PASSED=$((PASSED + 1))
}

fail() {
    echo -e "${RED}[FAIL]${NC} $1"
    FAILED=$((FAILED + 1))
}

warn() {
    echo -e "${YELLOW}[WARN]${NC} $1"
}

section() {
    echo ""
    echo "========================================"
    echo "$1"
    echo "========================================"
}

# Check if kubectl is available
if ! command -v kubectl &> /dev/null; then
    echo "kubectl not found"
    exit 1
fi

section "Node Health"

# Check all nodes are Ready
NODE_COUNT=$(kubectl get nodes --no-headers | wc -l)
READY_NODES=$(kubectl get nodes --no-headers | grep -c " Ready")
if [ "$NODE_COUNT" -eq "$READY_NODES" ]; then
    pass "All $NODE_COUNT nodes are Ready"
else
    fail "Only $READY_NODES/$NODE_COUNT nodes are Ready"
fi

section "Core Services"

# ArgoCD components
ARGOCD_COMPONENTS=(
    "argocd-server:ArgoCD Server"
    "argocd-repo-server:ArgoCD Repo Server"
    "argocd-application-controller:ArgoCD Application Controller"
    "argocd-redis:ArgoCD Redis"
)

for component in "${ARGOCD_COMPONENTS[@]}"; do
    LABEL="${component%%:*}"
    NAME="${component##*:}"
    if kubectl get pods -n argocd -l "app.kubernetes.io/name=$LABEL" --no-headers 2>/dev/null | grep -q "Running"; then
        pass "$NAME is running"
    else
        fail "$NAME is not running"
    fi
done

# Traefik
if kubectl get pods -n kube-system -l app.kubernetes.io/name=traefik --no-headers | grep -q "Running"; then
    pass "Traefik ingress is running"
else
    fail "Traefik ingress is not running"
fi

# Cert-manager components
CERTMANAGER_COMPONENTS=(
    "cert-manager:cert-manager"
    "webhook:cert-manager-webhook"
    "cainjector:cert-manager-cainjector"
)

for component in "${CERTMANAGER_COMPONENTS[@]}"; do
    LABEL="${component%%:*}"
    NAME="${component##*:}"
    if kubectl get pods -n cert-manager -l "app.kubernetes.io/name=$LABEL" --no-headers 2>/dev/null | grep -q "Running"; then
        pass "$NAME is running"
    else
        fail "$NAME is not running"
    fi
done

# Sealed Secrets controller
if kubectl get pods -n kube-system -l app.kubernetes.io/name=sealed-secrets --no-headers 2>/dev/null | grep -q "Running"; then
    pass "Sealed Secrets controller is running"
else
    fail "Sealed Secrets controller is not running"
fi

# External DNS
if kubectl get pods -n external-dns -l app.kubernetes.io/name=external-dns --no-headers 2>/dev/null | grep -q "Running"; then
    pass "External DNS is running"
else
    fail "External DNS is not running"
fi

# CloudNativePG operator
if kubectl get pods -n cnpg-system -l app.kubernetes.io/name=cloudnative-pg --no-headers 2>/dev/null | grep -q "Running"; then
    pass "CloudNativePG operator is running"
else
    fail "CloudNativePG operator is not running"
fi

# Actions Runner Controller
if kubectl get pods -n actions-runner -l app.kubernetes.io/name=actions-runner-controller --no-headers 2>/dev/null | grep -q "Running"; then
    pass "Actions Runner Controller is running"
else
    fail "Actions Runner Controller is not running"
fi

# NFS Proxy
if kubectl get pods -n nfs-proxy -l app.kubernetes.io/name=nfs-proxy --no-headers 2>/dev/null | grep -q "Running"; then
    pass "NFS Proxy is running"
else
    fail "NFS Proxy is not running"
fi

section "Authentication"

# Authentik server
if kubectl get pods -n authentik -l app.kubernetes.io/name=authentik --no-headers 2>/dev/null | grep -q "Running"; then
    pass "Authentik server is running"
else
    fail "Authentik server is not running"
fi

# Authentik outpost
if kubectl get pods -n authentik -l goauthentik.io/outpost-name=forward-auth-outpost --no-headers 2>/dev/null | grep -q "Running"; then
    pass "Authentik forward-auth outpost is running"
else
    fail "Authentik forward-auth outpost is not running"
fi

section "Storage"

# Longhorn
if kubectl get pods -n longhorn-system -l app=longhorn-manager --no-headers | grep -q "Running"; then
    pass "Longhorn manager is running"
else
    fail "Longhorn manager is not running"
fi

# Check PVCs are bound
UNBOUND_PVC=$(kubectl get pvc -A --no-headers 2>/dev/null | grep -v "Bound" | wc -l)
if [ "$UNBOUND_PVC" -eq 0 ]; then
    pass "All PVCs are bound"
else
    fail "$UNBOUND_PVC PVCs are not bound"
fi

section "Monitoring"

# Prometheus
if kubectl get pods -n monitoring -l app.kubernetes.io/name=prometheus --no-headers 2>/dev/null | grep -q "Running"; then
    pass "Prometheus is running"
else
    fail "Prometheus is not running"
fi

# Grafana
if kubectl get pods -n monitoring -l app.kubernetes.io/name=grafana --no-headers 2>/dev/null | grep -q "Running"; then
    pass "Grafana is running"
else
    fail "Grafana is not running"
fi

# Alertmanager
if kubectl get pods -n monitoring -l app.kubernetes.io/name=alertmanager --no-headers 2>/dev/null | grep -q "Running"; then
    pass "Alertmanager is running"
else
    fail "Alertmanager is not running"
fi

# Loki (StatefulSet, check by pod name pattern)
if kubectl get pods -n monitoring --no-headers 2>/dev/null | grep "^loki-[0-9]" | grep -q "Running"; then
    pass "Loki is running"
else
    fail "Loki is not running"
fi

# Promtail
PROMTAIL_PODS=$(kubectl get pods -n monitoring -l app.kubernetes.io/name=promtail --no-headers 2>/dev/null | grep -c "Running" || echo 0)
if [ "$PROMTAIL_PODS" -gt 0 ]; then
    pass "Promtail is running ($PROMTAIL_PODS pods)"
else
    fail "Promtail is not running"
fi

# Kube-state-metrics
if kubectl get pods -n monitoring -l app.kubernetes.io/name=kube-state-metrics --no-headers 2>/dev/null | grep -q "Running"; then
    pass "kube-state-metrics is running"
else
    fail "kube-state-metrics is not running"
fi

# Node exporter
NODE_EXPORTER_PODS=$(kubectl get pods -n monitoring -l app.kubernetes.io/name=prometheus-node-exporter --no-headers 2>/dev/null | grep -c "Running" || echo 0)
if [ "$NODE_EXPORTER_PODS" -gt 0 ]; then
    pass "Node exporter is running ($NODE_EXPORTER_PODS pods)"
else
    fail "Node exporter is not running"
fi

section "Databases"

# CloudNativePG clusters (Plane uses its own PostgreSQL StatefulSet, not CNPG)
CNPG_CLUSTERS=(
    "authentik:authentik-db"
    "outline:outline-db"
    "n8n:n8n-db"
    "open-webui:open-webui-db"
)

for cluster in "${CNPG_CLUSTERS[@]}"; do
    NS="${cluster%%:*}"
    NAME="${cluster##*:}"

    if kubectl get pods -n "$NS" -l "cnpg.io/cluster=$NAME" --no-headers 2>/dev/null | grep -q "Running"; then
        pass "$NAME PostgreSQL is running"
    else
        fail "$NAME PostgreSQL is not running"
    fi
done

# Check CNPG cluster health status
for cluster in "${CNPG_CLUSTERS[@]}"; do
    NS="${cluster%%:*}"
    NAME="${cluster##*:}"

    CLUSTER_STATUS=$(kubectl get cluster "$NAME" -n "$NS" -o jsonpath='{.status.phase}' 2>/dev/null || echo "Unknown")
    if [ "$CLUSTER_STATUS" = "Cluster in healthy state" ]; then
        pass "$NAME cluster is healthy"
    elif [ "$CLUSTER_STATUS" = "Unknown" ]; then
        warn "$NAME cluster status unknown"
    else
        fail "$NAME cluster status: $CLUSTER_STATUS"
    fi
done

section "Applications"

# Dashboard
if kubectl get pods -n dashboard -l app.kubernetes.io/name=dashboard --no-headers 2>/dev/null | grep -q "Running"; then
    pass "Dashboard is running"
else
    fail "Dashboard is not running"
fi

# Outline
if kubectl get pods -n outline -l app.kubernetes.io/name=outline --no-headers 2>/dev/null | grep -q "Running"; then
    pass "Outline is running"
else
    fail "Outline is not running"
fi

# n8n
if kubectl get pods -n n8n -l app.kubernetes.io/name=n8n --no-headers 2>/dev/null | grep -q "Running"; then
    pass "n8n is running"
else
    fail "n8n is not running"
fi

# Open WebUI
if kubectl get pods -n open-webui -l app.kubernetes.io/name=open-webui --no-headers 2>/dev/null | grep -q "Running"; then
    pass "Open WebUI is running"
else
    fail "Open WebUI is not running"
fi

# Plane
PLANE_PODS=$(kubectl get pods -n plane --no-headers 2>/dev/null | grep -c "Running" || echo 0)
if [ "$PLANE_PODS" -gt 0 ]; then
    pass "Plane is running ($PLANE_PODS pods)"
else
    fail "Plane is not running"
fi

# Campfire
if kubectl get pods -n campfire -l app.kubernetes.io/name=campfire --no-headers 2>/dev/null | grep -q "Running"; then
    pass "Campfire is running"
else
    fail "Campfire is not running"
fi

# Telnet Server (demo app)
if kubectl get pods -n telnet-server -l app.kubernetes.io/name=telnet-server --no-headers 2>/dev/null | grep -q "Running"; then
    pass "Telnet Server is running"
else
    fail "Telnet Server is not running"
fi

section "Plane Components"

# Plane uses its own StatefulSets for databases and services
PLANE_STATEFULSETS=(
    "plane-pgdb-wl:Plane PostgreSQL"
    "plane-redis-wl:Plane Redis"
    "plane-minio-wl:Plane MinIO"
    "plane-rabbitmq-wl:Plane RabbitMQ"
)

for sts in "${PLANE_STATEFULSETS[@]}"; do
    NAME="${sts%%:*}"
    LABEL="${sts##*:}"
    if kubectl get pods -n plane -l "statefulset.kubernetes.io/pod-name=${NAME}-0" --no-headers 2>/dev/null | grep -q "Running"; then
        pass "$LABEL is running"
    else
        fail "$LABEL is not running"
    fi
done

# Plane deployments
PLANE_DEPLOYMENTS=(
    "plane-api-wl:Plane API"
    "plane-web-wl:Plane Web"
    "plane-space-wl:Plane Space"
    "plane-admin-wl:Plane Admin"
    "plane-live-wl:Plane Live"
    "plane-beat-worker-wl:Plane Beat Worker"
)

for deploy in "${PLANE_DEPLOYMENTS[@]}"; do
    NAME="${deploy%%:*}"
    LABEL="${deploy##*:}"
    if kubectl get pods -n plane -l "app.kubernetes.io/name=$NAME" --no-headers 2>/dev/null | grep -q "Running"; then
        pass "$LABEL is running"
    else
        # Try matching by deployment name in pod name
        if kubectl get pods -n plane --no-headers 2>/dev/null | grep "$NAME" | grep -q "Running"; then
            pass "$LABEL is running"
        else
            warn "$LABEL may not be running"
        fi
    fi
done

section "Certificates"

# Check certificates are valid
INVALID_CERTS=$(kubectl get certificates -A --no-headers 2>/dev/null | grep -v "True" | wc -l)
if [ "$INVALID_CERTS" -eq 0 ]; then
    pass "All certificates are valid"
else
    fail "$INVALID_CERTS certificates are not ready"
    kubectl get certificates -A --no-headers | grep -v "True"
fi

# Check certificate expiry (warn if expiring within 14 days)
CERTS=$(kubectl get certificates -A -o jsonpath='{range .items[*]}{.metadata.namespace}/{.metadata.name}:{.status.notAfter}{"\n"}{end}' 2>/dev/null)
EXPIRY_WARN=0
while IFS=: read -r cert_name expiry_date; do
    if [ -n "$expiry_date" ]; then
        EXPIRY_EPOCH=$(date -d "$expiry_date" +%s 2>/dev/null || echo 0)
        NOW_EPOCH=$(date +%s)
        DAYS_LEFT=$(( (EXPIRY_EPOCH - NOW_EPOCH) / 86400 ))
        if [ "$DAYS_LEFT" -lt 14 ] && [ "$DAYS_LEFT" -gt 0 ]; then
            warn "Certificate $cert_name expires in $DAYS_LEFT days"
            EXPIRY_WARN=$((EXPIRY_WARN + 1))
        elif [ "$DAYS_LEFT" -le 0 ]; then
            fail "Certificate $cert_name has expired"
        fi
    fi
done <<< "$CERTS"
if [ "$EXPIRY_WARN" -eq 0 ]; then
    pass "No certificates expiring within 14 days"
fi

section "ArgoCD Applications"

# Check ArgoCD application sync status
ARGOCD_APPS=$(kubectl get applications -n argocd -o jsonpath='{range .items[*]}{.metadata.name}:{.status.sync.status}:{.status.health.status}{"\n"}{end}' 2>/dev/null)
SYNC_ISSUES=0
HEALTH_WARNINGS=0
HEALTH_FAILURES=0
while IFS=: read -r app_name sync_status health_status; do
    if [ -n "$app_name" ]; then
        if [ "$sync_status" != "Synced" ] && [ "$sync_status" != "OutOfSync" ]; then
            fail "ArgoCD app $app_name sync status: $sync_status"
            SYNC_ISSUES=$((SYNC_ISSUES + 1))
        fi
        if [ "$health_status" = "Missing" ]; then
            fail "ArgoCD app $app_name health: $health_status"
            HEALTH_FAILURES=$((HEALTH_FAILURES + 1))
        elif [ "$health_status" = "Degraded" ]; then
            # Degraded is often due to optional resources (PDBs, etc.) - treat as warning
            warn "ArgoCD app $app_name health: $health_status"
            HEALTH_WARNINGS=$((HEALTH_WARNINGS + 1))
        fi
    fi
done <<< "$ARGOCD_APPS"
if [ "$SYNC_ISSUES" -eq 0 ]; then
    pass "All ArgoCD applications have valid sync status"
fi
if [ "$HEALTH_FAILURES" -eq 0 ]; then
    pass "No ArgoCD applications with critical health issues"
fi

section "Storage Health"

# Check Longhorn volumes health
DEGRADED_VOLUMES=$(kubectl get volumes.longhorn.io -n longhorn-system -o jsonpath='{range .items[*]}{.metadata.name}:{.status.robustness}{"\n"}{end}' 2>/dev/null | grep -v "healthy" | grep -v "^:" | wc -l)
if [ "$DEGRADED_VOLUMES" -eq 0 ]; then
    pass "All Longhorn volumes are healthy"
else
    fail "$DEGRADED_VOLUMES Longhorn volumes are degraded"
    kubectl get volumes.longhorn.io -n longhorn-system -o jsonpath='{range .items[*]}{.metadata.name}:{.status.robustness}{"\n"}{end}' 2>/dev/null | grep -v "healthy"
fi

# Check Longhorn nodes
LONGHORN_NODES=$(kubectl get nodes.longhorn.io -n longhorn-system -o jsonpath='{range .items[*]}{.metadata.name}:{.status.conditions[?(@.type=="Ready")].status}{"\n"}{end}' 2>/dev/null)
NODE_ISSUES=0
while IFS=: read -r node_name ready_status; do
    if [ -n "$node_name" ] && [ "$ready_status" != "True" ]; then
        fail "Longhorn node $node_name is not ready"
        NODE_ISSUES=$((NODE_ISSUES + 1))
    fi
done <<< "$LONGHORN_NODES"
if [ "$NODE_ISSUES" -eq 0 ]; then
    pass "All Longhorn nodes are ready"
fi

section "Network Policies"

# Check that network policies exist for key namespaces
REQUIRED_NETPOL_NS=(
    "dashboard"
    "outline"
    "n8n"
    "open-webui"
    "campfire"
    "authentik"
    "plane"
)

for ns in "${REQUIRED_NETPOL_NS[@]}"; do
    NETPOL_COUNT=$(kubectl get networkpolicies -n "$ns" --no-headers 2>/dev/null | wc -l)
    if [ "$NETPOL_COUNT" -gt 0 ]; then
        pass "Network policies exist in $ns ($NETPOL_COUNT policies)"
    else
        warn "No network policies in $ns namespace"
    fi
done

section "Backup Jobs"

# Check backup CronJob exists
if kubectl get cronjob homelab-backup -n longhorn-system --no-headers 2>/dev/null | grep -q "homelab-backup"; then
    pass "Backup CronJob exists"
else
    fail "Backup CronJob not found"
fi

# Check last backup job status (if any jobs exist)
# Format: NAME STATUS COMPLETIONS DURATION AGE
LAST_JOB=$(kubectl get jobs -n longhorn-system --sort-by=.metadata.creationTimestamp --no-headers 2>/dev/null | grep "homelab-backup" | tail -1)
if [ -n "$LAST_JOB" ]; then
    JOB_NAME=$(echo "$LAST_JOB" | awk '{print $1}')
    JOB_STATUS=$(echo "$LAST_JOB" | awk '{print $2}')
    COMPLETIONS=$(echo "$LAST_JOB" | awk '{print $3}')
    if [ "$JOB_STATUS" = "Complete" ]; then
        pass "Last backup job completed successfully ($JOB_NAME)"
    elif echo "$COMPLETIONS" | grep -q "1/1"; then
        pass "Last backup job completed ($JOB_NAME)"
    else
        warn "Last backup job status: $JOB_STATUS ($JOB_NAME)"
    fi
else
    warn "No backup job history found"
fi

section "Resource Configuration"

# Check pods without resource limits in critical namespaces
CRITICAL_NS=(
    "authentik"
    "argocd"
    "monitoring"
    "cert-manager"
)

for ns in "${CRITICAL_NS[@]}"; do
    PODS_WITHOUT_LIMITS=$(kubectl get pods -n "$ns" -o jsonpath='{range .items[*]}{.metadata.name}{range .spec.containers[*]}{":"}{.resources.limits.memory}{end}{"\n"}{end}' 2>/dev/null | grep -c ":$" || echo 0)
    if [ "$PODS_WITHOUT_LIMITS" -eq 0 ]; then
        pass "All pods in $ns have resource limits"
    else
        warn "$PODS_WITHOUT_LIMITS containers without memory limits in $ns"
    fi
done

section "DNS Resolution"

# Test internal DNS resolution
DNS_TEST=$(kubectl run dns-test --image=busybox:1.36 --rm -i --restart=Never --timeout=30s -- nslookup kubernetes.default.svc.cluster.local 2>/dev/null | grep -c "Address" || echo 0)
if [ "$DNS_TEST" -gt 0 ]; then
    pass "Internal DNS resolution working"
else
    warn "Internal DNS test inconclusive"
fi

section "Endpoint Health Checks"

check_endpoint() {
    local name=$1
    local url=$2
    local expected=$3

    STATUS=$(curl -sk -o /dev/null -w "%{http_code}" --connect-timeout 5 "$url" 2>/dev/null || echo "000")
    if [ "$STATUS" = "$expected" ] || [ "$STATUS" = "302" ] || [ "$STATUS" = "200" ]; then
        pass "$name ($url) - HTTP $STATUS"
    else
        fail "$name ($url) - HTTP $STATUS (expected $expected)"
    fi
}

check_endpoint "Dashboard" "https://db.lab.axiomlayer.com/" "302"
check_endpoint "ArgoCD" "https://argocd.lab.axiomlayer.com/" "200"
check_endpoint "Grafana" "https://grafana.lab.axiomlayer.com/" "302"
check_endpoint "Authentik" "https://auth.lab.axiomlayer.com/" "200"
check_endpoint "Outline" "https://docs.lab.axiomlayer.com/" "200"
check_endpoint "n8n" "https://autom8.lab.axiomlayer.com/" "302"
check_endpoint "Open WebUI" "https://ai.lab.axiomlayer.com/" "302"
check_endpoint "Plane" "https://plane.lab.axiomlayer.com/" "200"
check_endpoint "Longhorn" "https://longhorn.lab.axiomlayer.com/" "302"
check_endpoint "Alertmanager" "https://alerts.lab.axiomlayer.com/" "302"
check_endpoint "Campfire" "https://chat.lab.axiomlayer.com/" "302"

section "Service Endpoints"

# Check internal services are accessible
check_service() {
    local name=$1
    local namespace=$2
    local service=$3
    local port=$4

    SVC_IP=$(kubectl get svc "$service" -n "$namespace" -o jsonpath='{.spec.clusterIP}' 2>/dev/null || echo "")
    if [ -n "$SVC_IP" ] && [ "$SVC_IP" != "None" ]; then
        pass "$name service exists ($namespace/$service)"
    else
        fail "$name service not found ($namespace/$service)"
    fi
}

check_service "Dashboard" "dashboard" "dashboard" "80"
check_service "Outline" "outline" "outline" "3000"
check_service "n8n" "n8n" "n8n" "5678"
check_service "Open WebUI" "open-webui" "open-webui" "8080"
check_service "Campfire" "campfire" "campfire" "3000"
check_service "Authentik" "authentik" "authentik-helm-server" "80"
check_service "Grafana" "monitoring" "kube-prometheus-stack-grafana" "80"
check_service "Prometheus" "monitoring" "kube-prometheus-stack-prometheus" "9090"
check_service "Alertmanager" "monitoring" "kube-prometheus-stack-alertmanager" "9093"
check_service "Loki" "monitoring" "loki" "3100"
check_service "Longhorn UI" "longhorn-system" "longhorn-frontend" "80"

section "Ingress Resources"

# Check all ingresses have addresses assigned
INGRESSES=$(kubectl get ingress -A -o jsonpath='{range .items[*]}{.metadata.namespace}/{.metadata.name}:{.status.loadBalancer.ingress[0].ip}{"\n"}{end}' 2>/dev/null)
INGRESS_ISSUES=0
while IFS=: read -r ingress_name ingress_ip; do
    if [ -n "$ingress_name" ]; then
        if [ -n "$ingress_ip" ]; then
            pass "Ingress $ingress_name has IP $ingress_ip"
        else
            warn "Ingress $ingress_name has no IP assigned"
            INGRESS_ISSUES=$((INGRESS_ISSUES + 1))
        fi
    fi
done <<< "$INGRESSES"

section "Secrets Validation"

# Check critical secrets exist
CRITICAL_SECRETS=(
    "argocd:argocd-secret"
    "authentik:authentik-secret"
    "cert-manager:cloudflare-api-token"
    "monitoring:grafana-oidc"
    "outline:outline-oidc"
    "n8n:n8n-secrets"
)

for secret in "${CRITICAL_SECRETS[@]}"; do
    NS="${secret%%:*}"
    NAME="${secret##*:}"
    if kubectl get secret "$NAME" -n "$NS" --no-headers 2>/dev/null | grep -q "$NAME"; then
        pass "Secret $NS/$NAME exists"
    else
        warn "Secret $NS/$NAME not found"
    fi
done

section "ConfigMaps Validation"

# Check critical configmaps exist
CRITICAL_CONFIGMAPS=(
    "argocd:argocd-cm"
    "argocd:argocd-rbac-cm"
    "authentik:authentik-blueprints"
)

for cm in "${CRITICAL_CONFIGMAPS[@]}"; do
    NS="${cm%%:*}"
    NAME="${cm##*:}"
    if kubectl get configmap "$NAME" -n "$NS" --no-headers 2>/dev/null | grep -q "$NAME"; then
        pass "ConfigMap $NS/$NAME exists"
    else
        warn "ConfigMap $NS/$NAME not found"
    fi
done

section "ClusterIssuers"

# Check Let's Encrypt ClusterIssuers
if kubectl get clusterissuer letsencrypt-prod --no-headers 2>/dev/null | grep -q "letsencrypt-prod"; then
    ISSUER_STATUS=$(kubectl get clusterissuer letsencrypt-prod -o jsonpath='{.status.conditions[0].status}' 2>/dev/null || echo "Unknown")
    if [ "$ISSUER_STATUS" = "True" ]; then
        pass "ClusterIssuer letsencrypt-prod is ready"
    else
        fail "ClusterIssuer letsencrypt-prod is not ready"
    fi
else
    fail "ClusterIssuer letsencrypt-prod not found"
fi

section "Summary"

TOTAL=$((PASSED + FAILED))
echo ""
echo "Tests: $TOTAL | Passed: $PASSED | Failed: $FAILED"
echo ""

if [ "$FAILED" -gt 0 ]; then
    echo -e "${RED}Some tests failed!${NC}"
    exit 1
else
    echo -e "${GREEN}All tests passed!${NC}"
    exit 0
fi
#!/bin/bash
# Validate Kubernetes manifests
# Run: ./tests/validate-manifests.sh

set -e

RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
REPO_ROOT="$(dirname "$SCRIPT_DIR")"

FAILED=0
PASSED=0
WARNINGS=0

pass() {
    echo -e "${GREEN}[PASS]${NC} $1"
    PASSED=$((PASSED + 1))
}

fail() {
    echo -e "${RED}[FAIL]${NC} $1"
    FAILED=$((FAILED + 1))
}

warn() {
    echo -e "${YELLOW}[WARN]${NC} $1"
    WARNINGS=$((WARNINGS + 1))
}

section() {
    echo ""
    echo "========================================"
    echo "$1"
    echo "========================================"
}

section "Kustomization Build Validation"

# Find all kustomization directories
KUSTOMIZE_DIRS=$(find "$REPO_ROOT/apps" "$REPO_ROOT/infrastructure" -name "kustomization.yaml" -exec dirname {} \; 2>/dev/null | sort)

for dir in $KUSTOMIZE_DIRS; do
    REL_PATH="${dir#$REPO_ROOT/}"

    # Try to build the kustomization
    if kubectl kustomize "$dir" > /dev/null 2>&1; then
        pass "Kustomize build: $REL_PATH"
    else
        fail "Kustomize build: $REL_PATH"
        kubectl kustomize "$dir" 2>&1 | head -5
    fi
done

section "Security Context Validation"

# Check deployments for security contexts
for dir in $KUSTOMIZE_DIRS; do
    REL_PATH="${dir#$REPO_ROOT/}"

    # Skip ArgoCD applications directory (contains Application CRDs, not Deployments)
    if [[ "$REL_PATH" == *"argocd/applications"* ]]; then
        continue
    fi

    MANIFEST=$(kubectl kustomize "$dir" 2>/dev/null || echo "")
    if [ -z "$MANIFEST" ]; then
        continue
    fi

    # Check for Deployments without securityContext
    DEPLOYMENTS=$(echo "$MANIFEST" | grep -A1 "^kind: Deployment" | grep "^  name:" | awk '{print $2}' || true)
    for deploy in $DEPLOYMENTS; do
        if echo "$MANIFEST" | grep -A50 "name: $deploy" | grep -q "securityContext"; then
            pass "Security context: $deploy ($REL_PATH)"
        else
            warn "No security context: $deploy ($REL_PATH)"
        fi
    done
done

section "Required Labels Validation"

REQUIRED_LABELS="app.kubernetes.io/name"

for dir in $KUSTOMIZE_DIRS; do
    REL_PATH="${dir#$REPO_ROOT/}"

    # Skip ArgoCD applications directory
    if [[ "$REL_PATH" == *"argocd/applications"* ]]; then
        continue
    fi

    MANIFEST=$(kubectl kustomize "$dir" 2>/dev/null || echo "")
    if [ -z "$MANIFEST" ]; then
        continue
    fi

    # Check Deployments for required labels
    DEPLOYMENTS=$(echo "$MANIFEST" | grep -B1 "^kind: Deployment" -A20 | grep "name:" | head -5 || true)
    for deploy in $DEPLOYMENTS; do
        if echo "$MANIFEST" | grep -A30 "kind: Deployment" | grep -q "$REQUIRED_LABELS"; then
            pass "Required labels present in $REL_PATH"
            break
        else
            warn "Missing $REQUIRED_LABELS in $REL_PATH"
            break
        fi
    done
done

section "Resource Limits Validation"

for dir in $KUSTOMIZE_DIRS; do
    REL_PATH="${dir#$REPO_ROOT/}"

    # Skip non-app directories
    if [[ "$REL_PATH" != apps/* ]]; then
        continue
    fi
    # Skip ArgoCD applications directory
    if [[ "$REL_PATH" == *"argocd/applications"* ]]; then
        continue
    fi

    MANIFEST=$(kubectl kustomize "$dir" 2>/dev/null || echo "")
    if [ -z "$MANIFEST" ]; then
        continue
    fi

    # Check for resource limits in Deployments
    if echo "$MANIFEST" | grep -q "kind: Deployment"; then
        if echo "$MANIFEST" | grep -A100 "kind: Deployment" | grep -q "resources:"; then
            if echo "$MANIFEST" | grep -A100 "kind: Deployment" | grep -A20 "resources:" | grep -q "limits:"; then
                pass "Resource limits defined: $REL_PATH"
            else
                warn "Resource requests but no limits: $REL_PATH"
            fi
        else
            warn "No resource configuration: $REL_PATH"
        fi
    fi
done

section "Probe Validation"

for dir in $KUSTOMIZE_DIRS; do
    REL_PATH="${dir#$REPO_ROOT/}"

    # Skip non-app directories
    if [[ "$REL_PATH" != apps/* ]]; then
        continue
    fi
    # Skip ArgoCD applications directory
    if [[ "$REL_PATH" == *"argocd/applications"* ]]; then
        continue
    fi

    MANIFEST=$(kubectl kustomize "$dir" 2>/dev/null || echo "")
    if [ -z "$MANIFEST" ]; then
        continue
    fi

    # Check for health probes in Deployments
    if echo "$MANIFEST" | grep -q "kind: Deployment"; then
        HAS_LIVENESS=$(echo "$MANIFEST" | grep -c "livenessProbe:" || echo 0)
        HAS_READINESS=$(echo "$MANIFEST" | grep -c "readinessProbe:" || echo 0)

        if [ "$HAS_LIVENESS" -gt 0 ] && [ "$HAS_READINESS" -gt 0 ]; then
            pass "Health probes defined: $REL_PATH"
        elif [ "$HAS_LIVENESS" -gt 0 ] || [ "$HAS_READINESS" -gt 0 ]; then
            warn "Partial health probes: $REL_PATH"
        else
            warn "No health probes: $REL_PATH"
        fi
    fi
done

section "Certificate Validation"

CERT_FILES=$(find "$REPO_ROOT/apps" "$REPO_ROOT/infrastructure" -name "certificate.yaml" 2>/dev/null || true)
for cert_file in $CERT_FILES; do
    REL_PATH="${cert_file#$REPO_ROOT/}"

    # Check for required issuer reference
    if grep -q "issuerRef:" "$cert_file" && grep -q "letsencrypt-prod" "$cert_file"; then
        pass "Certificate uses prod issuer: $REL_PATH"
    elif grep -q "issuerRef:" "$cert_file"; then
        warn "Certificate may use non-prod issuer: $REL_PATH"
    else
        fail "Certificate missing issuerRef: $REL_PATH"
    fi
done

section "Ingress Validation"

INGRESS_FILES=$(find "$REPO_ROOT/apps" "$REPO_ROOT/infrastructure" -name "ingress.yaml" 2>/dev/null || true)
for ingress_file in $INGRESS_FILES; do
    REL_PATH="${ingress_file#$REPO_ROOT/}"

    # Check for TLS configuration
    if grep -q "tls:" "$ingress_file"; then
        pass "Ingress has TLS: $REL_PATH"
    else
        warn "Ingress missing TLS: $REL_PATH"
    fi

    # Check for ingressClassName
    if grep -q "ingressClassName:" "$ingress_file"; then
        pass "Ingress has className: $REL_PATH"
    else
        warn "Ingress missing ingressClassName: $REL_PATH"
    fi
done

section "Namespace Validation"

NAMESPACE_FILES=$(find "$REPO_ROOT/apps" "$REPO_ROOT/infrastructure" -name "namespace.yaml" 2>/dev/null || true)
for ns_file in $NAMESPACE_FILES; do
    REL_PATH="${ns_file#$REPO_ROOT/}"

    # Check namespace has labels
    if grep -q "labels:" "$ns_file"; then
        pass "Namespace has labels: $REL_PATH"
    else
        warn "Namespace missing labels: $REL_PATH"
    fi
done

section "Service Validation"

SERVICE_FILES=$(find "$REPO_ROOT/apps" "$REPO_ROOT/infrastructure" -name "service.yaml" 2>/dev/null || true)
for svc_file in $SERVICE_FILES; do
    REL_PATH="${svc_file#$REPO_ROOT/}"

    # Check service has selector
    if grep -q "selector:" "$svc_file"; then
        pass "Service has selector: $REL_PATH"
    else
        warn "Service missing selector: $REL_PATH"
    fi

    # Check service has port defined
    if grep -q "port:" "$svc_file"; then
        pass "Service has port: $REL_PATH"
    else
        fail "Service missing port: $REL_PATH"
    fi
done

section "Network Policy Validation"

NETPOL_FILES=$(find "$REPO_ROOT/apps" "$REPO_ROOT/infrastructure" -name "networkpolicy.yaml" -o -name "network-policy.yaml" 2>/dev/null || true)
for netpol_file in $NETPOL_FILES; do
    REL_PATH="${netpol_file#$REPO_ROOT/}"

    # Check network policy has podSelector
    if grep -q "podSelector:" "$netpol_file"; then
        pass "NetworkPolicy has podSelector: $REL_PATH"
    else
        fail "NetworkPolicy missing podSelector: $REL_PATH"
    fi
done

section "ArgoCD Application Validation"

ARGOCD_APP_FILES=$(find "$REPO_ROOT/apps/argocd/applications" -name "*.yaml" ! -name "kustomization.yaml" 2>/dev/null || true)
for app_file in $ARGOCD_APP_FILES; do
    REL_PATH="${app_file#$REPO_ROOT/}"
    FILENAME=$(basename "$app_file")

    # Check it's an Application resource
    if grep -q "kind: Application" "$app_file"; then
        pass "ArgoCD Application valid: $FILENAME"

        # Check it has a destination
        if grep -q "destination:" "$app_file"; then
            pass "ArgoCD Application has destination: $FILENAME"
        else
            fail "ArgoCD Application missing destination: $FILENAME"
        fi

        # Check it has a source
        if grep -q "source:" "$app_file" || grep -q "sources:" "$app_file"; then
            pass "ArgoCD Application has source: $FILENAME"
        else
            fail "ArgoCD Application missing source: $FILENAME"
        fi

        # Check for syncPolicy
        if grep -q "syncPolicy:" "$app_file"; then
            pass "ArgoCD Application has syncPolicy: $FILENAME"
        else
            warn "ArgoCD Application missing syncPolicy: $FILENAME"
        fi
    fi
done

section "Deployment Validation"

DEPLOYMENT_FILES=$(find "$REPO_ROOT/apps" "$REPO_ROOT/infrastructure" -name "deployment.yaml" 2>/dev/null || true)
for deploy_file in $DEPLOYMENT_FILES; do
    REL_PATH="${deploy_file#$REPO_ROOT/}"

    # Check deployment has replicas
    if grep -q "replicas:" "$deploy_file"; then
        pass "Deployment has replicas: $REL_PATH"
    else
        warn "Deployment missing replicas (defaults to 1): $REL_PATH"
    fi

    # Check deployment has selector
    if grep -q "selector:" "$deploy_file"; then
        pass "Deployment has selector: $REL_PATH"
    else
        fail "Deployment missing selector: $REL_PATH"
    fi

    # Check for image
    if grep -q "image:" "$deploy_file"; then
        pass "Deployment has image: $REL_PATH"
    else
        fail "Deployment missing image: $REL_PATH"
    fi
done

section "YAML Syntax Validation"

# YAML syntax validation using kubectl (more reliable than Python in CI)
# kubectl kustomize already validates YAML syntax, so we just verify the files are parseable
# Skip detailed YAML validation as kustomize build already catches syntax errors
pass "YAML syntax validated via kustomize build"

section "PodDisruptionBudget Validation"

PDB_FILES=$(find "$REPO_ROOT/apps" "$REPO_ROOT/infrastructure" -name "pdb.yaml" -o -name "poddisruptionbudget.yaml" 2>/dev/null || true)
for pdb_file in $PDB_FILES; do
    REL_PATH="${pdb_file#$REPO_ROOT/}"

    if grep -q "minAvailable:" "$pdb_file" || grep -q "maxUnavailable:" "$pdb_file"; then
        pass "PDB has availability constraint: $REL_PATH"
    else
        fail "PDB missing availability constraint: $REL_PATH"
    fi
done

section "Sealed Secret Validation"

SEALED_SECRET_FILES=$(find "$REPO_ROOT/apps" "$REPO_ROOT/infrastructure" -name "*sealed*.yaml" -o -name "*-secret.yaml" 2>/dev/null | grep -i seal || true)
for ss_file in $SEALED_SECRET_FILES; do
    REL_PATH="${ss_file#$REPO_ROOT/}"

    if grep -q "kind: SealedSecret" "$ss_file"; then
        pass "SealedSecret resource: $REL_PATH"

        # Check it has encryptedData
        if grep -q "encryptedData:" "$ss_file"; then
            pass "SealedSecret has encryptedData: $REL_PATH"
        else
            fail "SealedSecret missing encryptedData: $REL_PATH"
        fi
    fi
done

section "Summary"

TOTAL=$((PASSED + FAILED))
echo ""
echo "Results: $PASSED passed, $FAILED failed, $WARNINGS warnings"
echo ""

if [ "$FAILED" -gt 0 ]; then
    echo -e "${RED}Validation failed!${NC}"
    exit 1
else
    echo -e "${GREEN}Validation passed!${NC}"
    exit 0
fi
# Applications Reference

Comprehensive documentation for all applications deployed in the homelab cluster.

## Table of Contents

- [Application Inventory](#application-inventory)
- [Campfire](#campfire)
- [n8n (autom8)](#n8n-autom8)
- [Open WebUI](#open-webui)
- [Outline](#outline)
- [Plane](#plane)
- [Telnet Server](#telnet-server)
- [Dashboard](#dashboard)

---

## Application Inventory

| Application | URL | Namespace | SSO | Database | Storage |
|-------------|-----|-----------|-----|----------|---------|
| Campfire | chat.lab.axiomlayer.com | campfire | Yes | SQLite | 5Gi Longhorn |
| n8n | autom8.lab.axiomlayer.com | n8n | Yes | PostgreSQL (CNPG) | 5Gi Longhorn |
| Open WebUI | ai.lab.axiomlayer.com | open-webui | Yes | PostgreSQL (CNPG) | 5Gi Longhorn |
| Outline | docs.lab.axiomlayer.com | outline | Yes | PostgreSQL (CNPG) + Redis | 5Gi Longhorn |
| Plane | plane.lab.axiomlayer.com | plane | Yes | PostgreSQL (Helm) | 10Gi Longhorn |
| Telnet Server | telnet.lab.axiomlayer.com | telnet-server | Yes | None | None |
| Dashboard | db.lab.axiomlayer.com | dashboard | Yes | None | None |

---

## Campfire

**Team chat application by 37signals (Basecamp)**

### Overview

| Property | Value |
|----------|-------|
| URL | https://chat.lab.axiomlayer.com |
| Namespace | campfire |
| Image | ghcr.io/jasencdev/campfire |
| Port | 80 |
| Replicas | 1 |
| Architecture | amd64 only |

### Components

```
campfire/
 namespace.yaml
 deployment.yaml
 service.yaml
 certificate.yaml
 ingress.yaml           # Main app + static bypass
 pvc.yaml               # 5Gi for /rails/storage
 configmap.yaml         # RAILS_ENV, etc.
 sealed-secret.yaml     # SECRET_KEY_BASE, VAPID keys
 sealed-pull-secret.yaml # GHCR credentials
 networkpolicy.yaml
 pdb.yaml
 kustomization.yaml
```

### Configuration

**Environment Variables (ConfigMap):**
```yaml
DISABLE_SSL: "true"        # TLS handled by Traefik
RAILS_ENV: "production"
RAILS_LOG_TO_STDOUT: "true"
```

**Secrets (Sealed Secret):**
- `SECRET_KEY_BASE`: Rails secret key
- `VAPID_PUBLIC_KEY`: Web push public key
- `VAPID_PRIVATE_KEY`: Web push private key

### Ingress Routes

| Path | Auth | Purpose |
|------|------|---------|
| / | Yes | Main application |
| /webmanifest.json | No | PWA manifest |
| /service-worker.js | No | Push notifications |
| /cable | No | WebSocket (ActionCable) |
| /assets/* | No | Static assets |

### Push Notifications

Campfire uses VAPID (Voluntary Application Server Identification) for web push:

1. Generate keys: `npx web-push generate-vapid-keys`
2. Seal and deploy the keys in `sealed-secret.yaml`
3. Service worker at `/service-worker.js` handles subscriptions

### Troubleshooting

**Push notifications not working:**
```bash
# Check VAPID key is set correctly
kubectl get secret campfire-secret -n campfire -o jsonpath='{.data.VAPID_PUBLIC_KEY}' | base64 -d
```

**Image pull errors:**
```bash
# Verify GHCR pull secret
kubectl get secret ghcr-pull-secret -n campfire -o jsonpath='{.data.\.dockerconfigjson}' | base64 -d
```

---

## n8n (autom8)

**Workflow automation platform**

### Overview

| Property | Value |
|----------|-------|
| URL | https://autom8.lab.axiomlayer.com |
| Namespace | n8n |
| Image | n8nio/n8n |
| Port | 5678 |
| Replicas | 1 |

### Components

```
n8n/
 namespace.yaml
 deployment.yaml
 service.yaml
 certificate.yaml
 ingress.yaml
 pvc.yaml               # 5Gi for workflows
 postgres-cluster.yaml  # CloudNativePG
 sealed-secret.yaml
 networkpolicy.yaml
 kustomization.yaml
```

### Database

Uses CloudNativePG for PostgreSQL:

```yaml
# postgres-cluster.yaml
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: n8n-db
  namespace: n8n
spec:
  instances: 1
  storage:
    size: 5Gi
    storageClass: longhorn
```

**Connection string:**
```
postgresql://n8n:${password}@n8n-db-rw.n8n.svc:5432/n8n
```

### Configuration

**Key Environment Variables:**
```yaml
N8N_HOST: autom8.lab.axiomlayer.com
N8N_PROTOCOL: https
N8N_PORT: "5678"
WEBHOOK_URL: https://autom8.lab.axiomlayer.com/
DB_TYPE: postgresdb
DB_POSTGRESDB_HOST: n8n-db-rw.n8n.svc
```

### Webhooks

n8n webhooks are accessible at:
```
https://autom8.lab.axiomlayer.com/webhook/{workflow-id}
https://autom8.lab.axiomlayer.com/webhook-test/{workflow-id}
```

**Note:** Webhook paths bypass SSO authentication via ingress annotations.

---

## Open WebUI

**AI chat interface for Ollama**

### Overview

| Property | Value |
|----------|-------|
| URL | https://ai.lab.axiomlayer.com |
| Namespace | open-webui |
| Image | ghcr.io/open-webui/open-webui |
| Port | 8080 |
| Replicas | 1 |

### Architecture

```
     Tailscale      
    Open WebUI            siberian        
  (K8s cluster)                            (GPU workstation)  
                                                              
  ai.lab.axiomlayer                        Ollama server      
                                           RTX 5070 Ti 16GB   
                    
```

### Components

```
open-webui/
 namespace.yaml
 deployment.yaml
 service.yaml
 certificate.yaml
 ingress.yaml
 pvc.yaml               # 5Gi for uploads
 postgres-cluster.yaml  # CloudNativePG
 configmap.yaml         # Ollama connection
 sealed-secret.yaml
 networkpolicy.yaml
 kustomization.yaml
```

### Configuration

**ConfigMap:**
```yaml
OLLAMA_BASE_URL: "http://siberian:11434"  # Tailscale hostname
WEBUI_AUTH: "false"                        # Using Authentik SSO
```

### Ollama Connection

The Ollama estate currently uses two Tailscale endpoints:

| Purpose | Host | Tailscale IP | Notes |
|---------|------|--------------|-------|
| Generation (chat) | `siberian` | `100.115.3.88` | Primary RTX 5070Ti workstation; referenced by `OLLAMA_BASE_URL` in the ConfigMap. |
| Embeddings | `panther` | `100.79.124.94` | Local node dedicated to embedding workloads; reachable directly for batch jobs. |

Both nodes sit on the Tailscale mesh and expose Ollama on port `11434`. OpenWebUI talks to the generation endpoint, while tooling that needs dedicated embedding throughput can call the embedding node directly.

**Recommended Models (16GB VRAM):**

| Model | Size | VRAM | Use Case |
|-------|------|------|----------|
| llama3.2:3b | 2GB | 2GB | Fast, general |
| llama3.1:8b | 4.7GB | 5GB | Balanced |
| deepseek-r1:14b | 9GB | 9GB | Reasoning |
| codellama:13b | 7GB | 8GB | Code |
| qwen2.5:14b | 9GB | 9GB | Multilingual |

### WebSocket Configuration

Open WebUI uses WebSockets for streaming responses:

```yaml
# ingress.yaml - separate WebSocket ingress
metadata:
  name: open-webui-ws
  annotations:
    # No SSO for WebSocket upgrade
spec:
  rules:
    - host: ai.lab.axiomlayer.com
      http:
        paths:
          - path: /ws
            pathType: Prefix
```

---

## Outline

**Documentation and knowledge base wiki**

### Overview

| Property | Value |
|----------|-------|
| URL | https://docs.lab.axiomlayer.com |
| Namespace | outline |
| Image | outlinewiki/outline |
| Port | 3000 |
| Replicas | 1 |

### Components

```
outline/
 namespace.yaml
 deployment.yaml
 service.yaml
 certificate.yaml
 ingress.yaml
 pvc.yaml               # 5Gi for attachments
 postgres-cluster.yaml  # CloudNativePG
 redis.yaml             # Redis Deployment + Service (session cache)
 sealed-secret.yaml
 networkpolicy.yaml
 pdb.yaml
 kustomization.yaml
```

### Dependencies

1. **PostgreSQL** (CloudNativePG)
2. **Redis** (deployed in outline namespace)

### Configuration

**Key Environment Variables:**
```yaml
URL: https://docs.lab.axiomlayer.com
DATABASE_URL: postgres://outline:${pass}@outline-db-rw.outline.svc:5432/outline
REDIS_URL: redis://redis.outline.svc:6379
SECRET_KEY: ${from_sealed_secret}
UTILS_SECRET: ${from_sealed_secret}
```

### OIDC Integration

Outline uses Authentik OIDC directly (not forward auth):

```yaml
OIDC_CLIENT_ID: outline
OIDC_CLIENT_SECRET: ${from_sealed_secret}
OIDC_AUTH_URI: https://auth.lab.axiomlayer.com/application/o/authorize/
OIDC_TOKEN_URI: https://auth.lab.axiomlayer.com/application/o/token/
OIDC_USERINFO_URI: https://auth.lab.axiomlayer.com/application/o/userinfo/
```

### Redis Cache

- `apps/outline/redis.yaml` runs Redis with `runAsUser: 999`, probes, and an `emptyDir` volume (Outline only needs an in-memory cache).
- The service `redis.outline.svc:6379` lines up with `REDIS_URL` in the deployment.
- Network policies scope Redis ingress to the Outline pods while still allowing egress to Authentik and CNPG endpoints for sign-in callbacks.

---

## Plane

**Project management and issue tracking**

### Overview

| Property | Value |
|----------|-------|
| URL | https://plane.lab.axiomlayer.com |
| Namespace | plane |
| Deployment | Helm chart |
| Replicas | 1 (each component) |

### Architecture

Plane is a complex application with multiple components:

```

                         plane namespace                       
                                                              
            
     Web         API        Worker       Beat       
   (React)     (Django)    (Celery)    (Celery)     
            
                                                         
                  
                                                           
                    
        PostgreSQL     Redis       MinIO              
        (Helm)        (Helm)      (Helm)              
                    

```

### Components

Plane uses its own Helm chart with embedded dependencies:

| Component | Purpose | PVC Size |
|-----------|---------|----------|
| plane-web | React frontend | - |
| plane-api | Django API | - |
| plane-worker | Celery workers | - |
| plane-beat | Celery beat scheduler | - |
| plane-pgdb | PostgreSQL | 10Gi |
| plane-redis | Redis cache/queue | 1Gi |
| plane-minio | S3-compatible storage | 10Gi |
| plane-rabbitmq | Message queue | 1Gi |

### Extras

Additional manifests in `apps/plane/`:
- `certificate.yaml`: TLS certificate
- `ingress.yaml`: Custom ingress with SSO

---

## Telnet Server

**Demo application showcasing SSO integration**

### Overview

| Property | Value |
|----------|-------|
| URL | https://telnet.lab.axiomlayer.com |
| Namespace | telnet-server |
| Image | Custom telnet server |
| Ports | 2323 (telnet), 8080 (metrics) |
| Replicas | 1 |

### Purpose

This is a demonstration application that:
1. Shows SSO headers passed from Authentik
2. Exposes telnet service via LoadBalancer
3. Provides Prometheus metrics

### Services

| Service | Type | Port | Purpose |
|---------|------|------|---------|
| telnet-server | LoadBalancer | 2323 | Telnet access |
| telnet-metrics | ClusterIP | 8080 | Prometheus metrics |

### Access

```bash
# Via telnet (any node IP)
telnet 100.67.134.110 2323

# Via web (metrics)
https://telnet.lab.axiomlayer.com
```

---

## Dashboard

**Service portal for homelab applications**

### Overview

| Property | Value |
|----------|-------|
| URL | https://db.lab.axiomlayer.com |
| Namespace | dashboard |
| Image | nginx:alpine |
| Port | 80 |
| Replicas | 1 |

### Purpose

A simple static HTML dashboard listing all homelab services with:
- Service cards with descriptions
- Direct links to each application
- Status indicator
- Dark theme UI

### Configuration

The dashboard content is stored in a ConfigMap:

```yaml
# configmap.yaml
data:
  index.html: |
    <!DOCTYPE html>
    <html>
    <!-- Dashboard HTML -->
    </html>
```

### Updating

To add new applications to the dashboard:

1. Edit `apps/dashboard/configmap.yaml`
2. Add a new card in the appropriate section
3. Commit and push - ArgoCD syncs automatically

---

## Adding a New Application

See [APP-DEPLOYMENT-WORKFLOW.md](./APP-DEPLOYMENT-WORKFLOW.md) for detailed instructions on deploying new applications.

### Quick Checklist

- [ ] Create namespace with standard labels
- [ ] Create deployment with security context
- [ ] Create service (ClusterIP)
- [ ] Create certificate (Let's Encrypt)
- [ ] Create ingress with SSO middleware
- [ ] Create sealed secrets (if needed)
- [ ] Create PVC (if storage needed)
- [ ] Create network policies
- [ ] Create ArgoCD Application manifest
- [ ] Add to applications kustomization
- [ ] Update dashboard configmap
- [ ] Update README.md Live Services table
# Secrets Management

Comprehensive guide for managing secrets in the homelab cluster using Sealed Secrets.

## Table of Contents

- [Overview](#overview)
- [Sealed Secrets Architecture](#sealed-secrets-architecture)
- [Creating Sealed Secrets](#creating-sealed-secrets)
- [Secret Inventory](#secret-inventory)
- [Rotating Secrets](#rotating-secrets)
- [Backup and Recovery](#backup-and-recovery)
- [Best Practices](#best-practices)

---

## Overview

### Principles

1. **Never commit plaintext secrets to Git**
2. **Use Sealed Secrets for all sensitive data**
3. **Secrets are namespace-scoped** (encrypted for specific namespace)
4. **Controller holds the private key** (only it can decrypt)

### Components

| Component | Purpose | Location |
|-----------|---------|----------|
| Sealed Secrets Controller | Decrypts SealedSecrets | kube-system namespace |
| kubeseal CLI | Encrypts secrets locally | Developer machine |
| SealedSecret CRD | Encrypted secret in Git | Repository |
| Secret | Decrypted secret in cluster | Target namespace |

---

## Sealed Secrets Architecture

### Encryption Flow

```

                         Secret Creation Flow                                 
                                                                              
                                                          
     kubectl create                                                        
     secret ...                                                            
     --dry-run                                                             
                                                          
                                                                             
                                                                             
        Fetches public key            
       kubeseal       Sealed Secrets        
                                                   Controller           
                                      
                                                                             
             Encrypts with public key                                        
                                                                             
                                                          
     SealedSecret                                                          
     (YAML file)                        
     Safe for Git                                                        
                                                        
                                                                           
                                                                           
                                                         
                                                  Git Repo                
                                                         
                                                                           
                                                        ArgoCD syncs       
                                                                           
                                                         
                                                Kubernetes                
                                                Cluster                   
                                                         
                                                                           
                                                                           
                                                         
                                               Sealed Secrets             
                                               Controller                 
                                               (decrypts)                 
                                                         
                                                                           
                                                                           
                                                         
                                                  Secret                  
                                                (plaintext)               
                                                in cluster                
                                                         
                                                                              

```

### Key Management

The Sealed Secrets controller generates a key pair:
- **Private key**: Stored as a Secret in `kube-system` namespace
- **Public key**: Used by `kubeseal` to encrypt

```bash
# View sealing keys
kubectl get secret -n kube-system -l sealedsecrets.bitnami.com/sealed-secrets-key

# The active key
kubectl get secret -n kube-system sealed-secrets-key -o yaml
```

---

## Creating Sealed Secrets

### Basic Workflow

```bash
# Step 1: Create a regular secret (dry-run)
kubectl create secret generic my-secret \
  --namespace my-namespace \
  --from-literal=username=admin \
  --from-literal=password=supersecret \
  --dry-run=client -o yaml > /tmp/secret.yaml

# Step 2: Seal the secret
kubeseal \
  --controller-name=sealed-secrets \
  --controller-namespace=kube-system \
  --format yaml \
  < /tmp/secret.yaml \
  > my-sealed-secret.yaml

# Step 3: Clean up plaintext
rm /tmp/secret.yaml

# Step 4: Commit the sealed secret
git add my-sealed-secret.yaml
git commit -m "Add my-secret sealed secret"
```

### Creating Different Secret Types

#### Generic Secret (key-value pairs)

```bash
kubectl create secret generic app-secret \
  --namespace app \
  --from-literal=API_KEY=abc123 \
  --from-literal=DB_PASSWORD=secret \
  --dry-run=client -o yaml | \
  kubeseal --controller-name=sealed-secrets --controller-namespace=kube-system --format yaml
```

#### Docker Registry Secret

```bash
kubectl create secret docker-registry ghcr-pull-secret \
  --namespace app \
  --docker-server=ghcr.io \
  --docker-username=USERNAME \
  --docker-password=TOKEN \
  --dry-run=client -o yaml | \
  kubeseal --controller-name=sealed-secrets --controller-namespace=kube-system --format yaml
```

#### TLS Secret

```bash
kubectl create secret tls app-tls \
  --namespace app \
  --cert=./tls.crt \
  --key=./tls.key \
  --dry-run=client -o yaml | \
  kubeseal --controller-name=sealed-secrets --controller-namespace=kube-system --format yaml
```

#### From File

```bash
kubectl create secret generic config-secret \
  --namespace app \
  --from-file=config.json=./config.json \
  --dry-run=client -o yaml | \
  kubeseal --controller-name=sealed-secrets --controller-namespace=kube-system --format yaml
```

### One-Liner for Quick Sealing

```bash
# Create, seal, and save in one command
kubectl create secret generic my-secret -n my-namespace \
  --from-literal=key=value \
  --dry-run=client -o yaml | \
  kubeseal --controller-name=sealed-secrets --controller-namespace=kube-system --format yaml \
  > apps/my-app/sealed-secret.yaml
```

---

## Secret Inventory

### Current Sealed Secrets

| Namespace | Secret Name | Purpose | Keys |
|-----------|-------------|---------|------|
| actions-runner | github-arc-token | GitHub PAT for Actions Runner Controller | `github_token` |
| argocd | argocd-secret | Authentik OIDC client for ArgoCD | `oidc.authentik.clientSecret` |
| authentik | authentik-helm-secrets | Helm chart secrets | `postgresql_password`, `secret_key` |
| authentik | authentik-outpost-token | Token for forward-auth outpost | `token` |
| campfire | campfire-secret | Rails + VAPID secrets | `SECRET_KEY_BASE`, `VAPID_PUBLIC_KEY`, `VAPID_PRIVATE_KEY` |
| campfire | ghcr-pull-secret | GHCR pull credentials | `.dockerconfigjson` |
| cert-manager | cloudflare-api-token | DNS-01 challenge | `api-token` |
| external-dns | cloudflare-api-token | DNS management | `api-token` |
| longhorn-system | backup-db-credentials | Authentik + Outline DB passwords for CronJob | `authentik-password`, `outline-password` |
| monitoring | grafana-oidc-secret | Grafana SSO client | `client-id`, `client-secret` |
| n8n | n8n-secrets | CNPG password + encryption key | `db-password`, `encryption-key` |
| open-webui | open-webui-secrets | API tokens + session secret | `secret-key`, etc. |
| outline | outline-secrets | App + OIDC secrets | `database-url`, `oidc-client-secret`, `secret-key`, `utils-secret` |

### Secret Contents Reference

#### Cloudflare API Token

```yaml
# Required permissions:
# - Zone:Read (for all zones)
# - DNS:Edit (for lab.axiomlayer.com zone)
data:
  api-token: <cloudflare-api-token>
```

#### GitHub Runner Token

```yaml
# Required scopes:
# - repo (for repository runners)
# - admin:org (for organization runners)
data:
  github_token: <github-pat>
```

#### Rails Application Secrets

```yaml
# Generate with: rails secret
data:
  SECRET_KEY_BASE: <128-char-hex-string>
  VAPID_PUBLIC_KEY: <vapid-public-key>
  VAPID_PRIVATE_KEY: <vapid-private-key>
```

#### ArgoCD OIDC Secret

```yaml
data:
  oidc.authentik.clientSecret: <client-secret-from-authentik>
```

Rotate this whenever you re-issue the Authentik application credentials for ArgoCD.

#### Authentik Outpost Token

```yaml
data:
  token: <copy from Authentik outpost configuration>
```

The token is downloaded from Authentik  Outposts  `forward-auth-outpost`. Seal it immediately after download.

#### Backup DB Credentials

```yaml
data:
  authentik-password: <output of kubectl get secret authentik-db-app ...>
  outline-password: <output of kubectl get secret outline-db-app ...>
```

These values feed the `homelab-backup` CronJob. Update the secret any time you rotate CNPG credentials.

---

## Rotating Secrets

### Application Secret Rotation

1. **Generate new secret value**
2. **Create new sealed secret**
3. **Apply and verify**
4. **Restart dependent pods**

```bash
# Example: Rotate Cloudflare API token

# 1. Create new token in Cloudflare dashboard

# 2. Create new sealed secret
kubectl create secret generic cloudflare-api-token \
  --namespace cert-manager \
  --from-literal=api-token=NEW_TOKEN_HERE \
  --dry-run=client -o yaml | \
  kubeseal --controller-name=sealed-secrets --controller-namespace=kube-system --format yaml \
  > infrastructure/cert-manager/sealed-secret.yaml

# 3. Commit and push
git add infrastructure/cert-manager/sealed-secret.yaml
git commit -m "Rotate Cloudflare API token"
git push

# 4. Wait for ArgoCD sync, then restart cert-manager
kubectl rollout restart deployment/cert-manager -n cert-manager
```

### Controller Key Rotation

Sealed Secrets controller key rotation:

```bash
# 1. Generate new key (controller does this automatically every 30 days)
# New secrets will use new key, old secrets still work

# 2. Re-encrypt all secrets with new key (optional, for forward secrecy)
kubeseal --re-encrypt < old-sealed-secret.yaml > new-sealed-secret.yaml

# 3. Update all sealed secrets in repo
```

### Emergency Key Recovery

If you need to recover secrets from backup:

```bash
# 1. Get the sealing key from backup
kubectl get secret -n kube-system -l sealedsecrets.bitnami.com/sealed-secrets-key -o yaml > sealing-key-backup.yaml

# 2. In new cluster, apply the key before installing controller
kubectl apply -f sealing-key-backup.yaml

# 3. Install sealed-secrets controller
# It will use the existing key
```

---

## Backup and Recovery

### Backing Up Sealing Keys

**Critical**: Back up the sealing private key for disaster recovery!

```bash
# Export all sealing keys
kubectl get secret -n kube-system \
  -l sealedsecrets.bitnami.com/sealed-secrets-key \
  -o yaml > sealed-secrets-keys-backup.yaml

# Store securely (encrypted, offline)
gpg --symmetric --cipher-algo AES256 sealed-secrets-keys-backup.yaml
```

### Restoring Keys

```bash
# 1. Apply backed-up keys BEFORE installing controller
kubectl apply -f sealed-secrets-keys-backup.yaml

# 2. Install sealed-secrets controller
helm install sealed-secrets sealed-secrets/sealed-secrets -n kube-system

# 3. Verify existing sealed secrets work
kubectl get secrets -A | grep -v default-token
```

### What If Keys Are Lost?

If sealing keys are lost and not backed up:

1. All existing SealedSecrets become undecryptable
2. You must regenerate all secrets from source
3. Re-seal with new key
4. Deploy new sealed secrets

**Prevention**: Always backup sealing keys immediately after cluster creation!

---

## Best Practices

### DO

- **DO** backup sealing keys immediately after cluster creation
- **DO** use separate secrets for different applications
- **DO** use descriptive secret names
- **DO** document what each key contains
- **DO** rotate secrets regularly
- **DO** delete plaintext files after sealing
- **DO** verify sealed secrets work after creating

### DON'T

- **DON'T** commit plaintext secrets to Git
- **DON'T** share sealed secrets between namespaces (they're namespace-scoped)
- **DON'T** store sealing key backups in the same repo
- **DON'T** use the same secret value across environments
- **DON'T** put sensitive data in ConfigMaps

### Secret Naming Convention

```
{app}-secret          # Main application secrets
{app}-db-credentials  # Database credentials
{app}-api-token       # External API tokens
{app}-tls             # TLS certificates (managed by cert-manager)
ghcr-pull-secret      # Docker registry credentials
```

### Verification Commands

```bash
# Check if sealed secret was decrypted
kubectl get secret {name} -n {namespace}

# Check secret contents (base64 encoded)
kubectl get secret {name} -n {namespace} -o jsonpath='{.data}'

# Decode a specific key
kubectl get secret {name} -n {namespace} -o jsonpath='{.data.{key}}' | base64 -d

# Check sealed secrets controller logs
kubectl logs -n kube-system -l name=sealed-secrets

# Verify a sealed secret is valid
kubeseal --validate < sealed-secret.yaml
```

### Troubleshooting

#### Secret Not Being Created

```bash
# Check sealed secret status
kubectl describe sealedsecret {name} -n {namespace}

# Check controller logs
kubectl logs -n kube-system -l name=sealed-secrets | grep {name}
```

#### "Unable to decrypt" Error

Usually means:
1. Wrong namespace (secrets are namespace-scoped)
2. Sealed with different key
3. Corrupted sealed secret

```bash
# Verify namespace in sealed secret matches
cat sealed-secret.yaml | grep namespace

# Re-seal if needed
kubeseal --re-encrypt < sealed-secret.yaml > new-sealed-secret.yaml
```

#### Controller Not Running

```bash
# Check controller status
kubectl get pods -n kube-system -l name=sealed-secrets

# Check controller events
kubectl describe pod -n kube-system -l name=sealed-secrets
```
# Networking Guide

Comprehensive documentation for networking configuration in the homelab cluster.

## Table of Contents

- [Network Overview](#network-overview)
- [Tailscale Mesh](#tailscale-mesh)
- [Kubernetes Networking](#kubernetes-networking)
- [DNS Configuration](#dns-configuration)
- [TLS/SSL Configuration](#tlsssl-configuration)
- [Ingress Configuration](#ingress-configuration)
- [Network Policies](#network-policies)
- [Load Balancing](#load-balancing)
- [Firewall Rules](#firewall-rules)

---

## Network Overview

### Network Topology

```

                              Internet                                        

                                    
                                    

                           Cloudflare                                         
                                                                              
   DNS: *.lab.axiomlayer.com  100.67.134.110, 100.106.35.14, 100.121.67.60 
   (Tailscale IPs - accessible only via Tailscale network)                   

                                    
                                    

                         Tailscale Network                                    
                                                                              
                         
        neko              neko2            bobcat                     
    100.67.134.110 100.106.35.14  100.121.67.60                 
    192.168.1.167     192.168.1.103     192.168.1.49                  
                         
                                                                          
                                    
                                                                             
                                                            
                          siberian                                         
                         (Tailscale)                                       
                         Ollama GPU                                        
                                                            

                                    
                                    

                         Local Network (192.168.1.0/24)                       
                                                                              
   Router: 192.168.1.1                                                       
   UniFi NAS: 192.168.1.234                                                  

```

### IP Address Allocation

| Node | Tailscale IP | Local IP | Role |
|------|--------------|----------|------|
| neko | 100.67.134.110 | 192.168.1.167 | K3s control-plane |
| neko2 | 100.106.35.14 | 192.168.1.103 | K3s control-plane |
| bobcat | 100.121.67.60 | 192.168.1.49 | K3s agent |
| siberian | (Tailscale) | 192.168.1.x | GPU workstation |
| UniFi NAS | N/A | 192.168.1.234 | Backup storage |

### Kubernetes Network CIDRs

| Network | CIDR | Purpose |
|---------|------|---------|
| Pod Network | 10.42.0.0/16 | Pod IP addresses |
| Service Network | 10.43.0.0/16 | ClusterIP services |
| Node Network | 100.x.x.x/32 | Tailscale node IPs |

---

## Tailscale Mesh

### Overview

All cluster communication happens over Tailscale WireGuard mesh:

- **Encryption**: All traffic encrypted via WireGuard
- **NAT Traversal**: Works across networks without port forwarding
- **ACLs**: Can be managed via Tailscale admin console
- **MagicDNS**: Optional hostname resolution

### K3s Configuration

K3s is configured to use Tailscale interface:

```bash
# Server installation
curl -sfL https://get.k3s.io | sh -s - server \
  --cluster-init \
  --tls-san=neko \
  --flannel-iface=tailscale0

# Agent installation
curl -sfL https://get.k3s.io | sh -s - agent \
  --server https://100.67.134.110:6443 \
  --flannel-iface=tailscale0
```

### Flannel over Tailscale

The CNI (Flannel) is configured to use the `tailscale0` interface:

```yaml
# Flannel configuration
Backend:
  Type: vxlan
Interface: tailscale0
```

This means:
- Pod-to-pod traffic goes over Tailscale
- All inter-node traffic is encrypted
- No additional VPN configuration needed

### Tailscale Commands

```bash
# Check Tailscale status
tailscale status

# Check Tailscale IP
tailscale ip -4

# View network map
tailscale netcheck

# Connect to Tailscale
sudo tailscale up

# Disconnect
sudo tailscale down
```

---

## Kubernetes Networking

### Service Types

| Type | Use Case | Example |
|------|----------|---------|
| ClusterIP | Internal services | PostgreSQL, Redis |
| LoadBalancer | External access | Traefik, Telnet |
| NodePort | (Not used) | - |
| ExternalName | External services | - |

### DNS Resolution

CoreDNS provides in-cluster DNS:

```
# Service DNS format
{service}.{namespace}.svc.cluster.local

# Examples
postgres-rw.outline.svc.cluster.local
authentik-server.authentik.svc.cluster.local
nfs-proxy.nfs-proxy.svc.cluster.local
```

### Pod-to-Pod Communication

```

                            Pod Communication                                 
                                                                              
                                               
    Pod A                                      Pod B                     
    10.42.0.15                                 10.42.1.20                
    (neko)                                     (neko2)                   
                                               
                                                                            
                                    
                   Flannel VXLAN                                     
                 (over tailscale0 interface)                               
                                      
                                                                              

```

---

## DNS Configuration

### External DNS (Cloudflare)

External-DNS automatically manages Cloudflare DNS records:

| Record | Type | Value | TTL |
|--------|------|-------|-----|
| *.lab.axiomlayer.com | A | 100.67.134.110 | Auto |
| *.lab.axiomlayer.com | A | 100.106.35.14 | Auto |
| *.lab.axiomlayer.com | A | 100.121.67.60 | Auto |

### DNS Records Created

| Subdomain | Target | Purpose |
|-----------|--------|---------|
| alerts | Tailscale IPs | Alertmanager |
| argocd | Tailscale IPs | ArgoCD |
| auth | Tailscale IPs | Authentik |
| ai | Tailscale IPs | Open WebUI |
| chat | Tailscale IPs | Campfire |
| db | Tailscale IPs | Dashboard |
| docs | Tailscale IPs | Outline |
| grafana | Tailscale IPs | Grafana |
| longhorn | Tailscale IPs | Longhorn UI |
| autom8 | Tailscale IPs | n8n |
| plane | Tailscale IPs | Plane |
| telnet | Tailscale IPs | Telnet Server |

### ACME Challenge Records

cert-manager creates temporary TXT records for Let's Encrypt:

```
_acme-challenge.{app}.lab.axiomlayer.com TXT "{challenge-token}"
```

These are automatically created and cleaned up during certificate issuance.

### DNS Propagation

**Important**: Cloudflare caches negative DNS responses for ~7 minutes.

If a record was missing and you're retrying:
1. Wait at least 7 minutes
2. Or delete the certificate and let cert-manager recreate it

### Checking DNS

```bash
# Check A records
dig @1.1.1.1 app.lab.axiomlayer.com A

# Check ACME challenge
dig @1.1.1.1 _acme-challenge.app.lab.axiomlayer.com TXT

# Check from Cloudflare nameserver directly
dig @aurora.ns.cloudflare.com app.lab.axiomlayer.com A +norecurse
```

---

## TLS/SSL Configuration

### Certificate Hierarchy

```
Let's Encrypt (ACME)
        
        
ClusterIssuer (letsencrypt-prod)
        
        
Certificate (per application)
        
        
Secret (TLS cert + key)
        
        
Ingress (uses secret for TLS)
```

### Certificate Template

```yaml
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: {app}-tls
  namespace: {app}
spec:
  secretName: {app}-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - {app}.lab.axiomlayer.com
```

### Certificate Status

| App | Secret | Expires | Status |
|-----|--------|---------|--------|
| alertmanager | alertmanager-tls | ~90 days | Auto-renew |
| argocd | argocd-tls | ~90 days | Auto-renew |
| authentik | authentik-tls | ~90 days | Auto-renew |
| campfire | campfire-tls | ~90 days | Auto-renew |
| dashboard | dashboard-tls | ~90 days | Auto-renew |
| grafana | grafana-tls | ~90 days | Auto-renew |
| longhorn | longhorn-tls | ~90 days | Auto-renew |
| n8n | autom8-tls | ~90 days | Auto-renew |
| open-webui | open-webui-tls | ~90 days | Auto-renew |
| outline | outline-tls | ~90 days | Auto-renew |
| plane | plane-tls | ~90 days | Auto-renew |
| telnet-server | telnet-metrics-tls | ~90 days | Auto-renew |

### Checking Certificates

```bash
# List all certificates
kubectl get certificates -A

# Check certificate details
kubectl describe certificate {name} -n {namespace}

# Check expiration
kubectl get certificates -A -o jsonpath='{range .items[*]}{.metadata.namespace}{"\t"}{.metadata.name}{"\t"}{.status.notAfter}{"\n"}{end}'

# View certificate content
kubectl get secret {name}-tls -n {namespace} -o jsonpath='{.data.tls\.crt}' | base64 -d | openssl x509 -text -noout
```

---

## Ingress Configuration

### Standard Ingress Template

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: {app}
  namespace: {app}
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
    # Enable SSO:
    traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
spec:
  ingressClassName: traefik
  tls:
    - hosts:
        - {app}.lab.axiomlayer.com
      secretName: {app}-tls
  rules:
    - host: {app}.lab.axiomlayer.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: {app}
                port:
                  number: {port}
```

### Bypassing SSO for Specific Paths

Some paths need to bypass SSO (webhooks, APIs, static assets):

```yaml
# Create a separate ingress without middleware
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: {app}-public
  namespace: {app}
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
    # NO middleware annotation = no SSO
spec:
  ingressClassName: traefik
  tls:
    - hosts:
        - {app}.lab.axiomlayer.com
      secretName: {app}-tls
  rules:
    - host: {app}.lab.axiomlayer.com
      http:
        paths:
          - path: /webhook
            pathType: Prefix
            backend:
              service:
                name: {app}
                port:
                  number: {port}
```

### WebSocket Support

For WebSocket endpoints, create a separate ingress:

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: {app}-ws
  annotations:
    # WebSocket-specific annotations if needed
spec:
  rules:
    - host: {app}.lab.axiomlayer.com
      http:
        paths:
          - path: /ws
            pathType: Prefix
          - path: /cable
            pathType: Prefix
```

---

## Network Policies

### Default Deny Pattern

All namespaces use a default-deny approach:

```yaml
# 1. Default deny all
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: {app}-default-deny
  namespace: {app}
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress

# 2. Allow specific ingress
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: {app}-allow-ingress
  namespace: {app}
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: {app}
  policyTypes:
    - Ingress
  ingress:
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: kube-system
          podSelector:
            matchLabels:
              app.kubernetes.io/name: traefik
      ports:
        - port: {port}

# 3. Allow specific egress
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: {app}-allow-egress
  namespace: {app}
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: {app}
  policyTypes:
    - Egress
  egress:
    # DNS
    - to:
        - namespaceSelector: {}
      ports:
        - port: 53
          protocol: UDP
        - port: 53
          protocol: TCP
    # Add more as needed
```

### Current Network Policies

| Namespace | Policies |
|-----------|----------|
| alertmanager | default-deny, allow-ingress, allow-egress |
| campfire | default-deny, allow-ingress, allow-egress |
| dashboard | default-deny, allow-ingress, allow-egress |
| external-dns | default-deny, allow-egress |
| n8n | default-deny, allow-ingress, allow-egress, db-allow |
| nfs-proxy | default-deny, allow-ingress, allow-egress |
| open-webui | default-deny, allow-ingress, allow-egress, db-allow |
| outline | default-deny, allow-ingress, allow-egress, db-allow, redis-allow |
| telnet-server | default-deny, allow-ingress, allow-egress |

---

## Load Balancing

### K3s ServiceLB

K3s includes ServiceLB (formerly Klipper) for LoadBalancer services:

```

                          ServiceLB                                           
                                                                              
   LoadBalancer Service                                                       
                                                                             
                                                                             
                                           
     svclb       svclb       svclb     (DaemonSet pods)               
     neko        neko2      bobcat                                    
                                           
                                                                           
                                                 
                                                                             
                                                                             
              Target Pods                                                     
                                                                              

```

### LoadBalancer Services

| Service | Namespace | External IPs | Port |
|---------|-----------|--------------|------|
| traefik | kube-system | All Tailscale IPs | 80, 443 |
| telnet-server | telnet-server | All Tailscale IPs | 2323 |

### How Traffic Reaches Services

1. Client connects to any Tailscale IP
2. ServiceLB pod on that node receives traffic
3. ServiceLB forwards to appropriate pod (any node)
4. Response returns via same path

---

## Firewall Rules

### Node Firewall (UFW)

Recommended firewall rules for cluster nodes:

```bash
# Allow SSH
ufw allow 22/tcp

# Allow Tailscale
ufw allow in on tailscale0

# Allow K3s API (from Tailscale only)
ufw allow from 100.64.0.0/10 to any port 6443

# Allow Kubelet
ufw allow from 100.64.0.0/10 to any port 10250

# Allow Flannel VXLAN
ufw allow from 100.64.0.0/10 to any port 8472 proto udp

# Allow NodePort range (if used)
ufw allow from 100.64.0.0/10 to any port 30000:32767 proto tcp

# Enable firewall
ufw enable
```

### Tailscale ACLs

Optional Tailscale ACLs for additional security:

```json
{
  "acls": [
    {
      "action": "accept",
      "src": ["tag:k3s-node"],
      "dst": ["tag:k3s-node:*"]
    },
    {
      "action": "accept",
      "src": ["autogroup:member"],
      "dst": ["tag:k3s-node:80,443"]
    }
  ],
  "tagOwners": {
    "tag:k3s-node": ["autogroup:admin"]
  }
}
```

---

## Troubleshooting

### DNS Issues

```bash
# Check CoreDNS pods
kubectl get pods -n kube-system -l k8s-app=kube-dns

# Test DNS resolution from a pod
kubectl run -it --rm debug --image=busybox -- nslookup kubernetes.default.svc.cluster.local

# Check external DNS logs
kubectl logs -n external-dns -l app.kubernetes.io/name=external-dns
```

### Connectivity Issues

```bash
# Check Tailscale status
tailscale status

# Ping between nodes
tailscale ping neko2

# Check pod networking
kubectl run -it --rm debug --image=busybox -- wget -qO- http://service.namespace.svc:port

# Check network policies
kubectl get networkpolicies -n {namespace}
kubectl describe networkpolicy {name} -n {namespace}
```

### Certificate Issues

```bash
# Check certificate status
kubectl get certificates -A
kubectl describe certificate {name} -n {namespace}

# Check challenges
kubectl get challenges -A
kubectl describe challenge -n {namespace}

# Check cert-manager logs
kubectl logs -n cert-manager -l app=cert-manager
```

### Ingress Issues

```bash
# Check ingress configuration
kubectl get ingress -A
kubectl describe ingress {name} -n {namespace}

# Check Traefik logs
kubectl logs -n kube-system -l app.kubernetes.io/name=traefik

# Test with curl
curl -v https://app.lab.axiomlayer.com
```
# Infrastructure Components

Detailed documentation for all infrastructure components in the homelab cluster.

## Table of Contents

- [Traefik (Ingress)](#traefik-ingress)
- [cert-manager](#cert-manager)
- [Sealed Secrets](#sealed-secrets)
- [Authentik (SSO)](#authentik-sso)
- [ArgoCD (GitOps)](#argocd-gitops)
- [Longhorn (Storage)](#longhorn-storage)
- [Backups](#backups)
- [CloudNativePG](#cloudnativepg)
- [External-DNS](#external-dns)
- [Loki + Promtail](#loki--promtail)
- [Prometheus + Grafana](#prometheus--grafana)
- [Alertmanager](#alertmanager)
- [Actions Runner Controller](#actions-runner-controller)
- [NFS Proxy](#nfs-proxy)

---

## Traefik (Ingress)

**Kubernetes Ingress Controller and TLS Termination**

### Overview

| Property | Value |
|----------|-------|
| Namespace | kube-system |
| Deployment | Bundled with K3s |
| Service | LoadBalancer |
| Ports | 80 (HTTP), 443 (HTTPS) |

### Configuration

Traefik is installed by K3s by default. Key configurations:

```yaml
# Entrypoints
entryPoints:
  web:
    address: ":80"
  websecure:
    address: ":443"
```

### Middleware

The cluster uses Authentik forward auth middleware:

```yaml
apiVersion: traefik.containo.us/v1alpha1
kind: Middleware
metadata:
  name: ak-outpost-forward-auth-outpost
  namespace: authentik
spec:
  forwardAuth:
    address: http://ak-outpost-forward-auth-outpost.authentik.svc:9000/outpost.goauthentik.io/auth/traefik
    trustForwardHeader: true
    authResponseHeaders:
      - X-Authentik-Username
      - X-Authentik-Email
      - X-Authentik-Groups
      - X-Authentik-Uid
```

### Usage in Ingress

```yaml
metadata:
  annotations:
    traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
```

### Commands

```bash
# Check Traefik pods
kubectl get pods -n kube-system -l app.kubernetes.io/name=traefik

# View Traefik logs
kubectl logs -n kube-system -l app.kubernetes.io/name=traefik -f

# Restart Traefik
kubectl rollout restart deployment/traefik -n kube-system
```

---

## cert-manager

**Automatic TLS Certificate Management**

### Overview

| Property | Value |
|----------|-------|
| Namespace | cert-manager |
| Version | v1.14.4 |
| Issuer | letsencrypt-prod (ClusterIssuer) |
| Challenge | DNS-01 via Cloudflare |

### Architecture

```

                         cert-manager                                 
                                                                      
                    
   cert-manager       cainjector         webhook              
     (main)                                                   
                    
                                                                    
                                                                    
        
                     ClusterIssuer                                 
                     letsencrypt-prod                              
                                                                   
     solver: dns01                                                 
     provider: cloudflare                                          
     apiTokenSecretRef: cloudflare-api-token                      
        

```

### ClusterIssuer Configuration

```yaml
# infrastructure/cert-manager/cluster-issuer.yaml
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-prod
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    email: jasen@axiomlayer.com
    privateKeySecretRef:
      name: letsencrypt-prod
    solvers:
      - dns01:
          cloudflare:
            apiTokenSecretRef:
              name: cloudflare-api-token
              key: api-token
```

### DNS-01 Challenge Flow

1. Certificate resource created
2. cert-manager creates CertificateRequest
3. CertificateRequest creates Order
4. Order creates Challenge
5. Challenge creates TXT record: `_acme-challenge.{domain}`
6. Let's Encrypt verifies TXT record
7. Certificate issued and stored in Secret
8. Challenge and TXT record cleaned up

### Important Configuration

```yaml
# Use public DNS servers for validation
spec:
  acme:
    solvers:
      - dns01:
          cloudflare:
            # ...
        selector:
          dnsZones:
            - "lab.axiomlayer.com"
# In cert-manager deployment args:
- --dns01-recursive-nameservers=1.1.1.1:53,8.8.8.8:53
- --dns01-recursive-nameservers-only
```

### Commands

```bash
# Check all certificates
kubectl get certificates -A

# Check certificate details
kubectl describe certificate {name} -n {namespace}

# Check challenges (during issuance)
kubectl get challenges -A
kubectl describe challenge -n {namespace}

# Check certificate requests
kubectl get certificaterequests -A

# View cert-manager logs
kubectl logs -n cert-manager -l app=cert-manager -f

# Force certificate renewal
kubectl delete certificate {name} -n {namespace}
# ArgoCD will recreate it
```

---

## Sealed Secrets

**GitOps-Safe Secret Management**

### Overview

| Property | Value |
|----------|-------|
| Namespace | kube-system |
| Controller | sealed-secrets |
| CLI | kubeseal |

### How It Works

```

                                                                      
   kubectl create secret ... | kubeseal > sealed-secret.yaml         
                                                                     
                                                                     
                                              
                       SealedSecret                                
                       (encrypted)                                 
                       safe for Git                                
                                              
                                                                     
                                                                     
                                              
                      Sealed Secrets                               
                      Controller                                   
                      (decrypts)                                   
                                              
                                                                     
                                                                     
                                              
                       Secret                                      
                       (plaintext)                                 
                       in cluster only                             
                                              
                                                                      

```

### Creating Sealed Secrets

```bash
# Create and seal a secret
kubectl create secret generic my-secret \
  --namespace my-namespace \
  --from-literal=api-key=supersecret \
  --dry-run=client -o yaml | \
  kubeseal \
    --controller-name=sealed-secrets \
    --controller-namespace=kube-system \
    --format yaml > sealed-secret.yaml
```

### Sealed Secret Structure

```yaml
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: my-secret
  namespace: my-namespace
spec:
  encryptedData:
    api-key: AgBy8hCG...  # Encrypted value
  template:
    metadata:
      name: my-secret
      namespace: my-namespace
```

### Commands

```bash
# Check controller status
kubectl get pods -n kube-system -l name=sealed-secrets

# Verify a sealed secret
kubeseal --validate < sealed-secret.yaml

# Get controller logs
kubectl logs -n kube-system -l name=sealed-secrets

# Re-encrypt with new key (after key rotation)
kubeseal --re-encrypt < old-sealed-secret.yaml > new-sealed-secret.yaml
```

---

## Authentik (SSO)

**Identity Provider and Single Sign-On**

### Overview

| Property | Value |
|----------|-------|
| Namespace | authentik |
| URL | https://auth.lab.axiomlayer.com |
| Deployment | Helm chart |
| Database | PostgreSQL (local-path) |

### Components

| Component | Purpose |
|-----------|---------|
| authentik-server | Main web UI and API |
| authentik-worker | Background tasks |
| authentik-postgresql | Database |
| authentik-redis | Cache and sessions |
| ak-outpost-forward-auth | Forward auth proxy |

### GitOps Assets

- `infrastructure/authentik/outpost.yaml` defines the `ak-outpost-forward-auth-outpost` Deployment, Service, and Traefik middleware so the forward-auth proxy is version-controlled.
- `infrastructure/authentik/rbac.yaml` grants the Authentik service account the cluster-scoped permissions the outpost needs (Deployments, Traefik CRDs, Secrets).
- `infrastructure/authentik/outpost-token-sealed-secret.yaml` stores the outpost API token that Authentik issues.
- `infrastructure/authentik/sealed-secret.yaml` keeps the Helm chart secrets (PostgreSQL password, secret key) encrypted.

### Forward Auth Flow

```
User Request  Traefik  Authentik Outpost  Decision
                                
                    
                                           
            Authenticated            Not Authenticated
                                           
            Forward to App           Redirect to Login
            + X-Authentik headers
```

### Outpost Configuration

Authentik still owns the outpost definition, but everything needed to run it inside Kubernetes is declarative:

1. Create/refresh the outpost token in the Authentik UI, then update `infrastructure/authentik/outpost-token-sealed-secret.yaml` via `kubeseal`.
2. `apps/argocd/applications/authentik.yaml` syncs the Deployment/Middleware/RBAC from this repo.
3. In Authentik  Applications  Outposts, target the `ak-outpost-forward-auth-outpost` deployment (type `Proxy`, integration `Embedded`).

### Provider Types

| Type | Use Case | Example |
|------|----------|---------|
| Proxy (Forward Auth) | Web apps without native SSO | Dashboard, Grafana |
| OAuth2/OIDC | Apps with native OIDC | Outline, ArgoCD |
| LDAP | Legacy apps | - |

### Commands

```bash
# Check Authentik pods
kubectl get pods -n authentik

# Get admin password (initial setup)
kubectl get secret authentik -n authentik -o jsonpath='{.data.authentik-bootstrap-password}' | base64 -d

# View server logs
kubectl logs -n authentik -l app.kubernetes.io/name=authentik-server

# Restart outpost
kubectl rollout restart deployment/ak-outpost-forward-auth-outpost -n authentik
```

---

## ArgoCD (GitOps)

**GitOps Continuous Delivery**

### Overview

| Property | Value |
|----------|-------|
| Namespace | argocd |
| URL | https://argocd.lab.axiomlayer.com |
| Repo | github.com/jasencdev/axiomlayer |
| Branch | main |

### Components

| Component | Purpose | Replicas |
|-----------|---------|----------|
| argocd-server | Web UI and API | 1 |
| argocd-application-controller | Sync engine | 1 |
| argocd-repo-server | Git operations | 1 |
| argocd-redis | Cache | 1 |
| argocd-dex-server | OIDC (optional) | 1 |
| argocd-applicationset-controller | ApplicationSets | 1 |
| argocd-notifications-controller | Notifications | 1 |

### App of Apps

The cluster uses App of Apps pattern via `root.yaml`:

```yaml
# apps/argocd/applications/root.yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: applications
  namespace: argocd
spec:
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: apps/argocd/applications
  destination:
    server: https://kubernetes.default.svc
    namespace: argocd
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
```

### Configuration

ArgoCD runs in insecure mode (TLS handled by Traefik):

```yaml
# ArgoCD ConfigMap
data:
  server.insecure: "true"
```

### Single Sign-On

- `apps/argocd/sealed-secret.yaml` stores the Authentik OIDC client secret under `oidc.authentik.clientSecret`.
- `apps/argocd/ingress.yaml` attaches the same forward-auth middleware used by every other ingress plus the Authentik OIDC settings so users log in with their SSO account instead of the local admin.

### Commands

```bash
# List all applications
kubectl get applications -n argocd

# Get application details
kubectl get application {name} -n argocd -o yaml

# Force sync
kubectl patch application {name} -n argocd --type merge \
  -p '{"operation":{"sync":{}}}'

# Hard refresh
kubectl patch application {name} -n argocd --type merge \
  -p '{"metadata":{"annotations":{"argocd.argoproj.io/refresh":"hard"}}}'

# Get admin password
kubectl get secret argocd-initial-admin-secret -n argocd \
  -o jsonpath='{.data.password}' | base64 -d
```

---

## Longhorn (Storage)

**Distributed Block Storage**

### Overview

| Property | Value |
|----------|-------|
| Namespace | longhorn-system |
| URL | https://longhorn.lab.axiomlayer.com |
| Default Replicas | 3 |
| Storage Class | longhorn (default) |

### Architecture

```

                      Longhorn System                                 
                                                                      
                    
     Manager         Manager         Manager                  
     (neko)          (neko2)         (bobcat)                 
                    
                                                                  
                                
                                                                    
                                                      
                       Volume                                      
                      (3 replicas)                                  
                                                      
                                                                    
                                
                                                                  
                                   
     Replica         Replica         Replica                  
     (neko)          (neko2)         (bobcat)                 
                                   
                                                                      

```

### Storage Classes

```yaml
# Default (3 replicas)
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: longhorn
provisioner: driver.longhorn.io
parameters:
  numberOfReplicas: "3"
  staleReplicaTimeout: "2880"

# 2 replicas (for large volumes)
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: longhorn-2-replicas
provisioner: driver.longhorn.io
parameters:
  numberOfReplicas: "2"
```

### Backup Configuration

```yaml
# Backup target
apiVersion: longhorn.io/v1beta2
kind: Setting
metadata:
  name: backup-target
spec:
  value: nfs://nfs-proxy.nfs-proxy.svc:/exports

# Recurring backup job
apiVersion: longhorn.io/v1beta2
kind: RecurringJob
metadata:
  name: daily-backup
spec:
  cron: "0 2 * * *"   # 2:00 AM daily
  task: backup
  retain: 7
  concurrency: 1
```

### Commands

```bash
# List volumes
kubectl get volumes -n longhorn-system

# Check volume health
kubectl get volumes -n longhorn-system \
  -o custom-columns=NAME:.metadata.name,STATE:.status.state,ROBUSTNESS:.status.robustness

# List nodes
kubectl get nodes.longhorn.io -n longhorn-system

# Check backup target
kubectl get backuptargets -n longhorn-system

# View manager logs
kubectl logs -n longhorn-system -l app=longhorn-manager -f
```

---

## Backups

**Automated database dumps and Longhorn exports**

### CronJob + Secrets

- `apps/argocd/applications/backups.yaml` syncs the `infrastructure/backups` kustomization, which includes `backup-cronjob.yaml` for the 03:00 database dumps on `neko`. The job pg_dumps Authentik (`authentik-db-rw`) and Outline (`outline-db-rw`), writes the results to `/backup` (NAS via the NFS proxy), and trims everything beyond the seven newest archives.
- `infrastructure/backups/backup-db-credentials-sealed.yaml` provides the database passwords as a Sealed Secret in `longhorn-system`.

### Longhorn Recurring Jobs

- `infrastructure/backups/longhorn-recurring-jobs.yaml` describes the snapshot + backup cadence for Longhorn volumes so new PVCs inherit the 02:00 schedule and seven-day retention without manual UI edits.

### Operator Script

- `scripts/backup-homelab.sh` is the manual safety net: it copies `.env`, exports the Sealed Secret keys, takes fresh CNPG dumps by exec'ing into the pods, and captures Longhorn settings to a timestamped folder (`~/homelab-backups/{DATE}` by default).

### Commands

```bash
# Check CronJob + Jobs
kubectl get cronjobs,job -n longhorn-system -l app.kubernetes.io/name=homelab-backup

# Inspect the last run
kubectl logs job/<job-name> -n longhorn-system

# Trigger an on-demand run
kubectl create job --from=cronjob/homelab-backup homelab-backup-manual-$(date +%s) -n longhorn-system
```

---

## CloudNativePG

**PostgreSQL Operator**

### Overview

| Property | Value |
|----------|-------|
| Namespace | cnpg-system |
| Version | 1.22.0 |
| CRD | Cluster (postgresql.cnpg.io/v1) |

### Creating a PostgreSQL Cluster

```yaml
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: myapp-db
  namespace: myapp
spec:
  instances: 1        # or 3 for HA
  storage:
    size: 5Gi
    storageClass: longhorn
  bootstrap:
    initdb:
      database: myapp
      owner: myapp
      secret:
        name: myapp-db-credentials
```

### Connection Details

CloudNativePG creates services automatically:

| Service | Purpose |
|---------|---------|
| {cluster}-rw | Read-write (primary) |
| {cluster}-ro | Read-only (replicas) |
| {cluster}-r | Any replica |

**Connection string:**
```
postgresql://{user}:{pass}@{cluster}-rw.{namespace}.svc:5432/{database}
```

### Commands

```bash
# List clusters
kubectl get clusters -A

# Check cluster status
kubectl describe cluster {name} -n {namespace}

# Get connection secret
kubectl get secret {cluster}-app -n {namespace} -o yaml

# Connect to PostgreSQL
kubectl exec -it {cluster}-1 -n {namespace} -- psql

# View operator logs
kubectl logs -n cnpg-system -l app.kubernetes.io/name=cloudnative-pg
```

---

## External-DNS

**Automatic DNS Record Management**

### Overview

| Property | Value |
|----------|-------|
| Namespace | external-dns |
| Provider | Cloudflare |
| Domain Filter | lab.axiomlayer.com |
| Policy | upsert-only |

### How It Works

```

                        External-DNS                                  
                                                                      
                                     
      Ingress                            Cloudflare              
      Resource        DNS                  
                     creates/updates                             
    host: app.lab    A record           A app.lab              
    .axiomlayer                         100.x.x.x               
                                     
                                                                      

```

### Configuration

```yaml
# deployment args
- --source=ingress
- --domain-filter=lab.axiomlayer.com
- --provider=cloudflare
- --cloudflare-proxied=false
- --policy=upsert-only  # Won't delete records
- --txt-owner-id=k3s-homelab
- --txt-prefix=external-dns-
```

### Commands

```bash
# View logs
kubectl logs -n external-dns -l app.kubernetes.io/name=external-dns -f

# Check what records it would manage
kubectl get ingress -A -o jsonpath='{range .items[*]}{.spec.rules[*].host}{"\n"}{end}'
```

---

## Loki + Promtail

**Log Aggregation**

### Overview

| Component | Namespace | Purpose |
|-----------|-----------|---------|
| Loki | monitoring | Log storage and querying |
| Promtail | monitoring | Log collection (DaemonSet) |

### Architecture

```

                                                                      
                                   
    Pod          Pod          Pod                             
    logs         logs         logs                            
                                   
                                                                  
                                      
                                                                     
                                                       
                  Promtail     (DaemonSet - each node)             
                  (scrapes)                                         
                                                       
                                                                     
                                                       
                    Loki                                            
                  (stores)                                          
                                                       
                                                                     
                                                       
                   Grafana                                          
                  (queries)                                         
                                                       
                                                                      

```

### Querying Logs

In Grafana  Explore  Loki:

```logql
# All logs from a namespace
{namespace="campfire"}

# Errors only
{namespace="campfire"} |= "error"

# JSON parsing
{namespace="open-webui"} | json | level="error"
```

---

## Prometheus + Grafana

**Metrics and Visualization**

### Overview

| Component | Namespace | URL |
|-----------|-----------|-----|
| Prometheus | monitoring | (internal) |
| Grafana | monitoring | https://grafana.lab.axiomlayer.com |

### Grafana Data Sources

| Source | Type | Purpose |
|--------|------|---------|
| Prometheus | prometheus | Metrics |
| Loki | loki | Logs |

### Authentication

Grafana uses Authentik OIDC:

```yaml
GF_AUTH_GENERIC_OAUTH_ENABLED: "true"
GF_AUTH_GENERIC_OAUTH_NAME: "Authentik"
GF_AUTH_GENERIC_OAUTH_CLIENT_ID: grafana
GF_AUTH_GENERIC_OAUTH_CLIENT_SECRET: ${secret}
GF_AUTH_GENERIC_OAUTH_AUTH_URL: https://auth.lab.axiomlayer.com/application/o/authorize/
GF_AUTH_GENERIC_OAUTH_TOKEN_URL: https://auth.lab.axiomlayer.com/application/o/token/
GF_AUTH_GENERIC_OAUTH_API_URL: https://auth.lab.axiomlayer.com/application/o/userinfo/
```

### Monitoring Extras Application

- `apps/argocd/applications/monitoring-extras.yaml` syncs the `infrastructure/monitoring` kustomization so Grafana has its own namespace bootstrap and TLS certificate (`grafana-certificate.yaml`) independent of the Helm chart defaults.
- The Application runs with `sync-wave: 4`, which means it lands before Grafana tries to read the TLS secret referenced by the ingress.
- Keep `infrastructure/grafana/sealed-secret.yaml` (OIDC client) and the monitoring extras Application in lockstep whenever you rotate Authentik credentials.

---

## Alertmanager

**Alert Management and Routing**

### Overview

| Property | Value |
|----------|-------|
| Namespace | alertmanager |
| URL | https://alerts.lab.axiomlayer.com |
| Receivers | (configurable) |

### Alert Rules

Defined in `infrastructure/alertmanager/prometheus-rules.yaml`:

| Alert | Severity | Trigger |
|-------|----------|---------|
| NodeNotReady | critical | Node unready 5+ min |
| NodeHighCPU | warning | CPU > 80% for 10 min |
| NodeHighMemory | warning | Memory > 85% for 10 min |
| NodeDiskPressure | critical | Disk > 90% |
| PodCrashLooping | warning | Multiple restarts |
| CertificateExpiringSoon | warning | Expires in < 30 days |
| LonghornVolumeHealthCritical | critical | Volume faulted |

---

## Actions Runner Controller

**Self-Hosted GitHub Actions Runners**

### Overview

| Property | Value |
|----------|-------|
| Namespace | actions-runner |
| Target | jasencdev organization |
| Labels | self-hosted, homelab |

### Components

| Component | Purpose |
|-----------|---------|
| arc-actions-runner-controller | Manages runner lifecycle |
| Runner pods | Execute GitHub Actions jobs |

### Usage

In any jasencdev org repo:

```yaml
jobs:
  build:
    runs-on: [self-hosted, homelab]
    steps:
      - uses: actions/checkout@v4
      - run: echo "Running on homelab!"
```

### Commands

```bash
# Check runners
kubectl get runners -n actions-runner

# Check controller
kubectl get pods -n actions-runner -l app.kubernetes.io/name=actions-runner-controller

# View runner logs
kubectl logs -n actions-runner -l actions.github.com/scale-set-name=homelab-runner
```

---

## NFS Proxy

**NFS Re-Export for Multi-Node Access**

### Overview

| Property | Value |
|----------|-------|
| Namespace | nfs-proxy |
| Node | neko only (nodeSelector) |
| Backend | UniFi NAS (192.168.1.234) |

### Why It Exists

UniFi NAS NFS exports only accept a single client IP. The proxy:
1. Runs on neko (192.168.1.167) - the allowed IP
2. Mounts NAS share: `192.168.1.234:/k8s-backup`
3. Re-exports via ClusterIP service
4. All nodes access via service IP

### Requirements

The `nfsd` kernel module must be loaded on neko:

```bash
# Enable on boot
echo "nfsd" | sudo tee /etc/modules-load.d/nfsd.conf

# Load immediately
sudo modprobe nfsd
```

### Commands

```bash
# Check proxy pod
kubectl get pods -n nfs-proxy

# View logs
kubectl logs -n nfs-proxy -l app.kubernetes.io/name=nfs-proxy

# Test mount from another pod
kubectl run test --rm -it --image=busybox -- \
  mount -t nfs nfs-proxy.nfs-proxy.svc:/exports /mnt
```
# Homelab GitOps Complete Knowledge Base

This document is a comprehensive, RAG-optimized knowledge base for the AxiomLayer homelab Kubernetes cluster. It covers every aspect of the infrastructure from architecture to troubleshooting.

---

## TABLE OF CONTENTS

1. [Executive Summary](#executive-summary)
2. [Cluster Architecture](#cluster-architecture)
3. [Node Inventory and Hardware](#node-inventory-and-hardware)
4. [Network Architecture](#network-architecture)
5. [GitOps and ArgoCD](#gitops-and-argocd)
6. [Authentication and SSO](#authentication-and-sso)
7. [TLS and Certificate Management](#tls-and-certificate-management)
8. [DNS Management](#dns-management)
9. [Storage Architecture](#storage-architecture)
10. [Database Management](#database-management)
11. [Monitoring and Observability](#monitoring-and-observability)
12. [Backup and Disaster Recovery](#backup-and-disaster-recovery)
13. [CI/CD Pipeline](#cicd-pipeline)
14. [Secrets Management](#secrets-management)
15. [Application Catalog](#application-catalog)
16. [Security Patterns](#security-patterns)
17. [Provisioning Scripts](#provisioning-scripts)
18. [Testing Framework](#testing-framework)
19. [Operational Procedures](#operational-procedures)
20. [Troubleshooting Reference](#troubleshooting-reference)
21. [Configuration Reference](#configuration-reference)
22. [API and Integration Reference](#api-and-integration-reference)

---

## EXECUTIVE SUMMARY

### What is this repository?

The `homelab-gitops` repository (https://github.com/jasencdev/axiomlayer) is a GitOps-managed Kubernetes homelab running on K3s. It uses ArgoCD for continuous deployment with the "app of apps" pattern.

### Key Facts

- **Domain**: `*.lab.axiomlayer.com`
- **Kubernetes Distribution**: K3s v1.33.6+k3s1
- **GitOps Tool**: ArgoCD 8.0.14
- **Configuration Management**: Kustomize (no Helm templating in apps, but Helm sources for third-party charts)
- **SSO Provider**: Authentik 2025.10.2
- **Storage Provider**: Longhorn distributed block storage
- **Database Operator**: CloudNativePG for PostgreSQL
- **Network Mesh**: Tailscale (WireGuard-based)
- **Ingress Controller**: Traefik (bundled with K3s)
- **Certificate Authority**: Let's Encrypt via cert-manager
- **DNS Provider**: Cloudflare (managed by external-dns)

### Repository Structure Overview

```
homelab-gitops/
 apps/                      # User-facing applications
    argocd/               # ArgoCD configuration + Application manifests
    campfire/             # Team chat (37signals)
    dashboard/            # Custom homelab dashboard
    n8n/                  # Workflow automation
    outline/              # Documentation wiki
    plane/                # Project management
    telnet-server/        # Demo application
 infrastructure/           # Core infrastructure components
    actions-runner/       # GitHub Actions self-hosted runners
    alertmanager/         # Alert routing and management
    authentik/            # Identity provider (SSO)
    backups/              # Automated backup CronJobs
    cert-manager/         # TLS certificate automation
    cloudnative-pg/       # PostgreSQL operator
    external-dns/         # DNS record automation
    longhorn/             # Distributed storage
    monitoring/           # Grafana extras (OIDC config)
    nfs-proxy/            # NFS proxy for backup target
    open-webui/           # AI chat interface
    sealed-secrets/       # Secret encryption controller
 scripts/                  # Provisioning and utility scripts
 tests/                    # Automated test suite
 docs/                     # Documentation
 templates/                # Application templates
 clusters/lab/             # Cluster-specific kustomization
```

---

## CLUSTER ARCHITECTURE

### High-Level Architecture Diagram

```

                              Internet                                

                                   
                                   

                         Cloudflare DNS                               
              *.lab.axiomlayer.com  Tailscale IPs                   

                                   
                                   

                         Tailscale Mesh                               
   neko (100.67.134.110)  neko2 (100.106.35.14)  panther/bobcat 
                                                                     
                    siberian (GPU workstation)                        

                                   
                                   

                        K3s Cluster                                   
   
                      Traefik Ingress                               
           TLS termination + routing + forward auth                 
   
                                                                     
   
                   Authentik Forward Auth                           
                SSO verification middleware                         
   
                                                                     
   
                      Application Pods                              
      Dashboard, Campfire, Outline, Plane, n8n, Open WebUI...      
   
                                                                     
   
                        Longhorn Storage                            
           Distributed across neko, neko2, panther, bobcat          
   

                                   
                                   

                         UniFi NAS                                    
                       192.168.1.234                                  
                    Backup storage via NFS                            

```

### Kubernetes Components

| Component | Technology | Version | Purpose |
|-----------|------------|---------|---------|
| Distribution | K3s | v1.33.6+k3s1 | Lightweight Kubernetes |
| Container Runtime | containerd | 2.1.5 | Container execution |
| CNI | Flannel | Built-in | Pod networking (via Tailscale interface) |
| Ingress | Traefik | Built-in | Load balancing, TLS termination |
| Service LB | ServiceLB (Klipper) | Built-in | LoadBalancer service type |
| Local Storage | Local Path Provisioner | Built-in | Legacy storage |

### Control Plane Configuration

The cluster uses a **2-node embedded etcd** configuration:
- First server initialized with `--cluster-init`
- Second server joined with `--server https://<first-server>:6443`
- All inter-node communication uses Tailscale IPs for encryption

### Flannel Configuration

Flannel is configured to use the Tailscale interface:
```bash
--flannel-iface=tailscale0
```

This ensures all pod-to-pod traffic is automatically encrypted via WireGuard.

---

## NODE INVENTORY AND HARDWARE

### Control Plane Nodes

#### neko (Primary Control Plane)

| Property | Value |
|----------|-------|
| Role | control-plane, etcd, master |
| Hardware | Mini PC |
| CPU | AMD Ryzen |
| RAM | 32GB |
| Storage | 462GB NVMe |
| Tailscale IP | 100.67.134.110 |
| Local IP | 192.168.1.167 |
| Special | NFS proxy runs here (nodeSelector) |

#### neko2 (Secondary Control Plane)

| Property | Value |
|----------|-------|
| Role | control-plane, etcd, master |
| Hardware | Mini PC |
| CPU | AMD Ryzen |
| RAM | 32GB |
| Storage | 462GB NVMe |
| Tailscale IP | 100.106.35.14 |
| Local IP | 192.168.1.103 |

### Worker Nodes

#### panther (Primary Worker)

| Property | Value |
|----------|-------|
| Role | worker |
| Hardware | Unknown |
| Tailscale IP | 100.79.124.94 |
| GPU | RTX 3050 Ti (used for embeddings) |
| Special | Ollama for RAG embeddings (granite4:3b) |

#### bobcat (Raspberry Pi Worker)

| Property | Value |
|----------|-------|
| Role | worker |
| Hardware | Raspberry Pi 5 |
| CPU | ARM64 |
| RAM | 8GB |
| Storage | 500GB SSD |
| Tailscale IP | 100.121.67.60 |
| Local IP | 192.168.1.49 |

### External Resources

#### siberian (GPU Workstation)

| Property | Value |
|----------|-------|
| Role | External GPU compute |
| GPU | RTX 5070 Ti |
| Service | Ollama for LLM generation |
| Tailscale IP | 100.115.3.88 |
| Port | 11434 |
| Use Case | Open WebUI LLM inference |

#### UniFi NAS

| Property | Value |
|----------|-------|
| Role | Backup storage |
| IP | 192.168.1.234 |
| Protocol | NFS |
| NFS Path | /volume/e8e70d24-82e0-45f1-8ef6-f8ca399ad2d6/.srv/.unifi-drive/Shared_Drive_Example/.data |

---

## NETWORK ARCHITECTURE

### Network Layers (Top to Bottom)

1. **Internet**  User requests
2. **Cloudflare DNS**  `*.lab.axiomlayer.com` resolves to Tailscale IPs
3. **Tailscale Mesh**  WireGuard-encrypted connectivity
4. **Traefik Ingress**  TLS termination, routing
5. **Authentik Forward Auth**  SSO verification
6. **Application Pods**  Receive authenticated requests

### Tailscale Configuration

- All nodes connected via Tailscale mesh VPN
- Uses `100.0.0.0/8` CGNAT range
- MagicDNS enabled for `.ts.net` resolution
- Exit nodes not used (direct mesh connectivity)

### DNS Architecture

| Record Type | Name | Target | Manager |
|-------------|------|--------|---------|
| A | *.lab.axiomlayer.com | 100.67.134.110 | external-dns |
| A | *.lab.axiomlayer.com | 100.106.35.14 | external-dns |
| A | *.lab.axiomlayer.com | 100.79.124.94 | external-dns |
| A | *.lab.axiomlayer.com | 100.121.67.60 | external-dns |
| TXT | _acme-challenge.*.lab.axiomlayer.com | (dynamic) | cert-manager |

### External-DNS Configuration

Location: `infrastructure/external-dns/deployment.yaml`

```yaml
args:
  - --source=ingress
  - --domain-filter=lab.axiomlayer.com
  - --provider=cloudflare
  - --policy=upsert-only
  - --registry=txt
  - --txt-owner-id=homelab-k3s
  - --interval=1m
```

The `upsert-only` policy prevents external-dns from deleting records it didn't create.

### Ingress Patterns

All ingresses use Traefik with the following patterns:

**Standard Ingress with Forward Auth**:
```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: myapp
  namespace: myapp
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
    traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
spec:
  ingressClassName: traefik
  tls:
    - hosts:
        - myapp.lab.axiomlayer.com
      secretName: myapp-tls
  rules:
    - host: myapp.lab.axiomlayer.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: myapp
                port:
                  number: 8080
```

**Ingress without Forward Auth (Native OIDC apps)**:
```yaml
annotations:
  traefik.ingress.kubernetes.io/router.entrypoints: websecure
  traefik.ingress.kubernetes.io/router.tls: "true"
  # No middlewares annotation - app handles auth natively
```

### Network Policies

Every namespace has default-deny policies with explicit allow rules.

**Pattern - Default Deny**:
```yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: myapp-default-deny
  namespace: myapp
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
```

**Pattern - Allow Traefik Ingress**:
```yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: myapp-allow-ingress
  namespace: myapp
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: myapp
  policyTypes:
    - Ingress
  ingress:
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: kube-system
          podSelector:
            matchLabels:
              app.kubernetes.io/name: traefik
      ports:
        - protocol: TCP
          port: 8080
```

**Pattern - Allow DNS Egress**:
```yaml
egress:
  - to:
      - namespaceSelector: {}
        podSelector:
          matchLabels:
            k8s-app: kube-dns
    ports:
      - protocol: UDP
        port: 53
      - protocol: TCP
        port: 53
```

**Pattern - Allow Database Egress (CNPG)**:
```yaml
egress:
  - to:
      - podSelector:
          matchLabels:
            cnpg.io/cluster: myapp-db
    ports:
      - protocol: TCP
        port: 5432
```

---

## GITOPS AND ARGOCD

### App of Apps Pattern

The repository uses the ArgoCD "app of apps" pattern:

1. **Root Application** (`apps/argocd/applications/root.yaml`)
   - Points to `apps/argocd/applications/`
   - Creates all child Application resources
   - Manual sync only (triggered by CI after tests pass)

2. **Child Applications** (`apps/argocd/applications/*.yaml`)
   - Each points to its application directory
   - Auto-sync enabled with prune and selfHeal

### Sync Flow

```
1. Developer pushes to main branch
2. GitHub Actions CI runs:
   - validate-manifests.sh
   - kube-linter
   - Trivy security scan
3. ci-passed job triggers ArgoCD sync via API
4. ArgoCD syncs root application
5. Child applications sync automatically
6. Integration tests run (smoke-test.sh, test-auth.sh)
```

### ArgoCD Application Structure

Location: `apps/argocd/applications/kustomization.yaml`

Managed applications:
- `actions-runner-controller.yaml` - GitHub Actions runner controller (Helm)
- `actions-runner-infra.yaml` - Runner deployment and RBAC
- `alertmanager.yaml` - Custom Alertmanager deployment
- `argocd-helm.yaml` - ArgoCD itself (Helm, manual sync)
- `authentik-helm.yaml` - Authentik (Helm)
- `authentik.yaml` - Authentik extras (CNPG, outpost, blueprints)
- `backups.yaml` - Backup CronJob
- `campfire.yaml` - Team chat
- `cert-manager-helm.yaml` - cert-manager (Helm)
- `cert-manager.yaml` - ClusterIssuer and secrets
- `cloudnative-pg.yaml` - CNPG operator (Helm)
- `dashboard.yaml` - Custom dashboard
- `external-dns.yaml` - DNS automation
- `kube-prometheus-stack.yaml` - Prometheus + Grafana (Helm)
- `monitoring-extras.yaml` - Grafana OIDC config
- `longhorn-helm.yaml` - Longhorn (Helm)
- `longhorn.yaml` - Longhorn extras (ingress, recurring jobs)
- `loki.yaml` - Log aggregation (Helm)
- `n8n.yaml` - Workflow automation
- `nfs-proxy.yaml` - NFS proxy for backups
- `open-webui.yaml` - AI chat interface
- `outline.yaml` - Documentation wiki
- `plane.yaml` - Project management (Helm)
- `plane-extras.yaml` - Plane TLS certificate
- `sealed-secrets.yaml` - Secret controller
- `telnet-server.yaml` - Demo application

### ArgoCD Configuration

**ConfigMaps** (`apps/argocd/configmaps.yaml`):

```yaml
# argocd-cm - Main config
data:
  url: https://argocd.lab.axiomlayer.com
  oidc.config: |
    name: Authentik
    issuer: https://auth.lab.axiomlayer.com/application/o/argocd/
    clientID: argocd
    clientSecret: $oidc.authentik.clientSecret
    requestedScopes: ["openid", "profile", "email"]
    insecureSkipVerify: true

# argocd-cmd-params-cm - Server params
data:
  server.insecure: "true"  # TLS at Traefik

# argocd-rbac-cm - RBAC
data:
  policy.csv: |
    g, jasen@axiomlayer.com, role:admin
  scopes: "[email]"
```

### Sync Policies

**Manual Sync (argocd-helm, root)**:
```yaml
syncPolicy:
  syncOptions:
    - ApplyOutOfSyncOnly=true
```

**Auto Sync (most apps)**:
```yaml
syncPolicy:
  automated:
    prune: true
    selfHeal: true
  syncOptions:
    - CreateNamespace=true
```

### Sync Waves

Applications are ordered by sync waves:
- Wave 0: ArgoCD, Sealed Secrets, cert-manager
- Wave 4: Authentik
- Wave 5: Prometheus/Grafana
- Wave 8: Plane (depends on storage)

---

## AUTHENTICATION AND SSO

### Authentik Overview

Authentik is the identity provider (IdP) for all homelab applications.

- **URL**: https://auth.lab.axiomlayer.com
- **Version**: 2025.10.2
- **Deployment**: Helm chart + custom Kustomize overlays

### Authentication Types

#### 1. Forward Auth (Proxy Provider)

For applications without native OIDC support. Traefik forwards auth requests to Authentik outpost.

**Protected Apps**:
- Dashboard (db.lab.axiomlayer.com)
- n8n (autom8.lab.axiomlayer.com)
- Alertmanager (alerts.lab.axiomlayer.com)
- Longhorn (longhorn.lab.axiomlayer.com)
- Open WebUI (ai.lab.axiomlayer.com)
- Campfire (chat.lab.axiomlayer.com)
- Telnet Server (telnet.lab.axiomlayer.com)

**Flow**:
```
User  Traefik  Authentik Outpost (check session)
                        
         Has session?  YES  Forward to app with X-Authentik-* headers
                        
                       NO  Redirect to auth.lab.axiomlayer.com/login
```

**Headers passed to applications**:
```
X-Authentik-Username: jasen
X-Authentik-Email: jasen@axiomlayer.com
X-Authentik-Groups: Homelab Admins,Homelab Users
X-Authentik-Uid: abc123def456
X-Authentik-Name: Jasen
X-Authentik-Jwt: <JWT token>
```

#### 2. Native OIDC (OAuth2 Provider)

For applications with built-in OIDC support.

**Apps with Native OIDC**:
- ArgoCD (argocd.lab.axiomlayer.com)
- Grafana (grafana.lab.axiomlayer.com)
- Outline (docs.lab.axiomlayer.com)
- Plane (plane.lab.axiomlayer.com)

**Flow**:
```
User  App  Redirect to Authentik /application/o/authorize/
           User authenticates
           Redirect back to App callback URL
           App exchanges code for tokens
```

### Authentik Components

#### 1. Helm Chart (`apps/argocd/applications/authentik-helm.yaml`)

```yaml
source:
  repoURL: https://charts.goauthentik.io
  chart: authentik
  targetRevision: 2025.10.2
  helm:
    valuesObject:
      global:
        env:
          - name: AUTHENTIK_SECRET_KEY
            valueFrom:
              secretKeyRef:
                name: authentik-helm-secrets
                key: secret_key
          - name: AUTHENTIK_POSTGRESQL__PASSWORD
            valueFrom:
              secretKeyRef:
                name: authentik-db-app
                key: password
      authentik:
        postgresql:
          host: authentik-db-rw.authentik.svc
          name: authentik
          user: authentik
      postgresql:
        enabled: false  # Using CNPG
      redis:
        enabled: true
      server:
        ingress:
          enabled: true
          hosts:
            - auth.lab.axiomlayer.com
        volumes:
          - name: blueprints
            configMap:
              name: authentik-blueprints
        volumeMounts:
          - name: blueprints
            mountPath: /blueprints/custom
```

#### 2. Postgres Cluster (`infrastructure/authentik/postgres-cluster.yaml`)

```yaml
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: authentik-db
  namespace: authentik
spec:
  instances: 1
  storage:
    size: 5Gi
    storageClass: longhorn
  bootstrap:
    initdb:
      database: authentik
      owner: authentik
  monitoring:
    enablePodMonitor: true
```

#### 3. Forward Auth Outpost (`infrastructure/authentik/outpost.yaml`)

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ak-outpost-forward-auth-outpost
  namespace: authentik
spec:
  replicas: 1
  template:
    spec:
      containers:
        - name: proxy
          image: ghcr.io/goauthentik/proxy:2025.10.2
          ports:
            - containerPort: 9000  # HTTP
            - containerPort: 9443  # HTTPS
          env:
            - name: AUTHENTIK_HOST
              value: "https://auth.lab.axiomlayer.com"
            - name: AUTHENTIK_TOKEN
              valueFrom:
                secretKeyRef:
                  name: authentik-outpost-token
                  key: token
---
apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: ak-outpost-forward-auth-outpost
  namespace: authentik
spec:
  forwardAuth:
    address: http://ak-outpost-forward-auth-outpost.authentik.svc.cluster.local:9000/outpost.goauthentik.io/auth/traefik
    trustForwardHeader: true
    authResponseHeaders:
      - X-authentik-username
      - X-authentik-groups
      - X-authentik-email
      - X-authentik-name
      - X-authentik-uid
      - X-authentik-jwt
```

#### 4. Blueprints (`infrastructure/authentik/blueprints/homelab-apps.yaml`)

Authentik blueprints declaratively configure:
- User groups (Homelab Admins, Homelab Users)
- Users (jasen)
- Proxy Providers (one per forward-auth app)
- OAuth2 Providers (for native OIDC apps)
- Kubernetes Service Connection
- Outpost configuration
- Applications
- Access Policies

Key blueprint entries:
```yaml
# Proxy Provider (Forward Auth)
- model: authentik_providers_proxy.proxyprovider
  id: provider-dashboard
  identifiers:
    name: Dashboard Proxy Provider
  attrs:
    mode: forward_single
    external_host: https://db.lab.axiomlayer.com

# OAuth2 Provider (Native OIDC)
- model: authentik_providers_oauth2.oauth2provider
  id: provider-argocd
  identifiers:
    name: ArgoCD OIDC Provider
  attrs:
    client_type: confidential
    client_id: argocd
    client_secret: "..."
    redirect_uris:
      - matching_mode: strict
        url: https://argocd.lab.axiomlayer.com/auth/callback

# Outpost
- model: authentik_outposts.outpost
  id: outpost-forward-auth
  identifiers:
    name: forward-auth-outpost
  attrs:
    type: proxy
    providers:
      - !KeyOf provider-dashboard
      - !KeyOf provider-n8n
      # ... all forward-auth providers
```

### OIDC Configuration by Application

#### ArgoCD OIDC

Location: `apps/argocd/configmaps.yaml`

```yaml
oidc.config: |
  name: Authentik
  issuer: https://auth.lab.axiomlayer.com/application/o/argocd/
  clientID: argocd
  clientSecret: $oidc.authentik.clientSecret
  requestedScopes: ["openid", "profile", "email"]
  insecureSkipVerify: true  # For internal Traefik -> Authentik
```

Redirect URI: `https://argocd.lab.axiomlayer.com/auth/callback`

#### Grafana OIDC

Location: `apps/argocd/applications/kube-prometheus-stack.yaml` (Helm values)

```yaml
grafana.ini:
  auth.generic_oauth:
    enabled: true
    name: Authentik
    allow_sign_up: true
    use_pkce: true
    scopes: openid email profile groups
    auth_url: https://auth.lab.axiomlayer.com/application/o/authorize/
    token_url: https://auth.lab.axiomlayer.com/application/o/token/
    api_url: https://auth.lab.axiomlayer.com/application/o/userinfo
    client_id: $__env{client-id}
    client_secret: $__env{client-secret}
    role_attribute_path: contains(groups[*], 'Homelab Admins') && 'Admin' || 'Viewer'
```

#### Outline OIDC

Location: `apps/outline/deployment.yaml`

```yaml
env:
  - name: OIDC_CLIENT_ID
    valueFrom:
      secretKeyRef:
        name: outline-secrets
        key: oidc-client-id
  - name: OIDC_CLIENT_SECRET
    valueFrom:
      secretKeyRef:
        name: outline-secrets
        key: oidc-client-secret
  - name: OIDC_AUTH_URI
    value: "https://auth.lab.axiomlayer.com/application/o/authorize/"
  - name: OIDC_TOKEN_URI
    value: "http://authentik-helm-server.authentik.svc.cluster.local/application/o/token/"
  - name: OIDC_USERINFO_URI
    value: "http://authentik-helm-server.authentik.svc.cluster.local/application/o/userinfo/"
  - name: OIDC_DISPLAY_NAME
    value: "Authentik"
```

Note: Token/userinfo URIs use internal cluster DNS to avoid TLS issues.

---

## TLS AND CERTIFICATE MANAGEMENT

### cert-manager Configuration

**ClusterIssuer** (`infrastructure/cert-manager/cluster-issuer.yaml`):

```yaml
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-prod
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    email: jasen.c7@gmail.com
    privateKeySecretRef:
      name: letsencrypt-prod-account-key
    solvers:
      - dns01:
          cloudflare:
            apiTokenSecretRef:
              name: cloudflare-api-token
              key: api-token
        selector:
          dnsZones:
            - "axiomlayer.com"
```

### DNS-01 Challenge Flow

```
1. Certificate resource created
2. cert-manager creates CertificateRequest
3. ACME Order created
4. Challenge created (DNS-01)
5. cert-manager creates TXT record via Cloudflare API
6. Let's Encrypt validates TXT record
7. Certificate issued
8. Secret created with TLS key/cert
9. Traefik loads new certificate
```

### Certificate Pattern

Every application with an ingress has a Certificate resource:

```yaml
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: myapp-tls
  namespace: myapp
spec:
  secretName: myapp-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - myapp.lab.axiomlayer.com
```

### Current Certificates

| Namespace | Certificate | DNS Name |
|-----------|-------------|----------|
| argocd | argocd-tls | argocd.lab.axiomlayer.com |
| authentik | authentik-tls | auth.lab.axiomlayer.com |
| campfire | campfire-tls | chat.lab.axiomlayer.com |
| dashboard | dashboard-tls | db.lab.axiomlayer.com |
| longhorn-system | longhorn-tls | longhorn.lab.axiomlayer.com |
| monitoring | grafana-tls | grafana.lab.axiomlayer.com |
| monitoring | alertmanager-tls | alerts.lab.axiomlayer.com |
| n8n | n8n-tls | autom8.lab.axiomlayer.com |
| open-webui | open-webui-tls | ai.lab.axiomlayer.com |
| outline | outline-tls | docs.lab.axiomlayer.com |
| plane | plane-tls | plane.lab.axiomlayer.com |
| telnet-server | telnet-server-tls | telnet.lab.axiomlayer.com |

---

## DNS MANAGEMENT

### external-dns Overview

external-dns automatically creates DNS records in Cloudflare based on Ingress resources.

Location: `infrastructure/external-dns/`

### Configuration

```yaml
args:
  - --source=ingress           # Watch Ingress resources
  - --domain-filter=lab.axiomlayer.com  # Only manage this subdomain
  - --provider=cloudflare
  - --policy=upsert-only       # Never delete records
  - --registry=txt             # Use TXT records to track ownership
  - --txt-owner-id=homelab-k3s # Ownership identifier
  - --interval=1m              # Sync interval
```

### How Records Are Created

When an Ingress is created:
1. external-dns detects the new Ingress
2. Extracts the hostname from `.spec.rules[].host`
3. Creates A records pointing to node Tailscale IPs
4. Creates TXT record for ownership tracking

### DNS Records Example

For `db.lab.axiomlayer.com`:
```
db.lab.axiomlayer.com.         A     100.67.134.110
db.lab.axiomlayer.com.         A     100.106.35.14
db.lab.axiomlayer.com.         A     100.79.124.94
db.lab.axiomlayer.com.         A     100.121.67.60
heritage=external-dns,external-dns/owner=homelab-k3s  TXT
```

---

## STORAGE ARCHITECTURE

### Longhorn Overview

Longhorn provides distributed block storage across all nodes.

- **UI**: https://longhorn.lab.axiomlayer.com
- **Default Replicas**: 3
- **StorageClass**: `longhorn` (default)

### Storage Classes

| Class | Provider | Replicas | Use Case |
|-------|----------|----------|----------|
| longhorn | Longhorn | 3 | Production workloads |
| local-path | Rancher Local Path | 0 | Legacy (Authentik Redis) |

### Volume Distribution

Longhorn distributes volume replicas across:
- neko (462GB NVMe)
- neko2 (462GB NVMe)
- panther
- bobcat (500GB SSD)

### Recurring Jobs

Location: `infrastructure/backups/longhorn-recurring-jobs.yaml`

```yaml
apiVersion: longhorn.io/v1beta2
kind: RecurringJob
metadata:
  name: daily-snapshot
  namespace: longhorn-system
spec:
  task: snapshot
  cron: "0 2 * * *"  # 2 AM daily
  retain: 7          # Keep 7 snapshots
  groups:
    - default
---
apiVersion: longhorn.io/v1beta2
kind: RecurringJob
metadata:
  name: weekly-snapshot
  namespace: longhorn-system
spec:
  task: snapshot
  cron: "0 3 * * 0"  # 3 AM Sunday
  retain: 4          # Keep 4 snapshots
  groups:
    - default
```

### Current Volumes

| Namespace | PVC | Size | Purpose |
|-----------|-----|------|---------|
| campfire | campfire-storage | 5Gi | Campfire data |
| n8n | n8n-data | 5Gi | n8n workflows |
| n8n | n8n-db-1 | 5Gi | n8n PostgreSQL |
| open-webui | open-webui-data | 5Gi | Open WebUI data |
| open-webui | open-webui-db-1 | 10Gi | Open WebUI PostgreSQL |
| outline | outline-data | 5Gi | Outline attachments |
| outline | outline-db-1 | 5Gi | Outline PostgreSQL |
| plane | pvc-plane-* | various | Plane components |
| monitoring | storage-loki-0 | 10Gi | Loki logs |
| authentik | authentik-db-1 | 5Gi | Authentik PostgreSQL |

### NFS Proxy Architecture

The UniFi NAS only allows NFS connections from a single IP. The NFS proxy solves this:

```
          
   Any Pod           NFS Proxy         UniFi NAS      
   (any node)             (on neko)             192.168.1.234   
          
                         ClusterIP Service
```

Location: `infrastructure/nfs-proxy/deployment.yaml`

```yaml
spec:
  nodeSelector:
    kubernetes.io/hostname: neko  # Must run on neko
  containers:
    - name: nfs-server
      image: erichough/nfs-server
      env:
        - name: NFS_EXPORT_0
          value: "/data/k8s-backup *(rw,sync,no_subtree_check,no_root_squash,fsid=0)"
      volumeMounts:
        - name: upstream-nfs
          mountPath: /data
  volumes:
    - name: upstream-nfs
      nfs:
        server: 192.168.1.234
        path: /volume/.../Shared_Drive_Example/.data
```

---

## DATABASE MANAGEMENT

### CloudNativePG Overview

CloudNativePG manages PostgreSQL clusters as Kubernetes-native resources.

### PostgreSQL Clusters

| Cluster | Namespace | Service | Instances | Size | Backed Up |
|---------|-----------|---------|-----------|------|-----------|
| authentik-db | authentik | authentik-db-rw.authentik.svc:5432 | 1 | 5Gi | Yes |
| outline-db | outline | outline-db-rw.outline.svc:5432 | 1 | 5Gi | Yes |
| n8n-db | n8n | n8n-db-rw.n8n.svc:5432 | 1 | 5Gi | No |
| open-webui-db | open-webui | open-webui-db-rw.open-webui.svc:5432 | 1 | 10Gi | No |
| plane-db | plane | plane-db-rw.plane.svc:5432 | 1 (Helm) | 10Gi | No |

### Cluster Definition Pattern

```yaml
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: myapp-db
  namespace: myapp
spec:
  instances: 1
  storage:
    size: 5Gi
    storageClass: longhorn
  postgresql:
    parameters:
      max_connections: "100"
      shared_buffers: "128MB"
  bootstrap:
    initdb:
      database: myapp
      owner: myapp
  monitoring:
    enablePodMonitor: true
```

### Connecting to Databases

**From within cluster**:
```yaml
env:
  - name: DATABASE_URL
    valueFrom:
      secretKeyRef:
        name: myapp-db-app  # Auto-generated by CNPG
        key: uri
```

**Manual connection**:
```bash
kubectl exec -it -n authentik authentik-db-1 -- psql -U authentik -d authentik
```

### Database Secrets

CNPG automatically creates secrets with connection details:
- `{cluster}-app` - Application credentials (user/password/uri)
- `{cluster}-superuser` - Superuser credentials

---

## MONITORING AND OBSERVABILITY

### Stack Components

| Component | Purpose | URL |
|-----------|---------|-----|
| Prometheus | Metrics collection | Internal |
| Grafana | Dashboards | grafana.lab.axiomlayer.com |
| Alertmanager | Alert routing | alerts.lab.axiomlayer.com |
| Loki | Log aggregation | Internal |
| Promtail | Log shipping | Internal |

### Prometheus Configuration

Location: `apps/argocd/applications/kube-prometheus-stack.yaml`

Key settings:
```yaml
prometheus:
  prometheusSpec:
    serviceMonitorSelectorNilUsesHelmValues: false  # Discover all ServiceMonitors
```

### Grafana Datasources

1. **Prometheus** - Auto-provisioned by kube-prometheus-stack
2. **Loki** - Added via Helm values:

```yaml
grafana:
  additionalDataSources:
    - name: Loki
      type: loki
      access: proxy
      url: http://loki:3100
      isDefault: false
```

### Alert Rules

Location: `infrastructure/alertmanager/prometheus-rules.yaml`

**Node Alerts**:
- `NodeDown` - Node unreachable for 2m (critical)
- `NodeHighCPU` - CPU > 80% for 5m (warning)
- `NodeHighMemory` - Memory > 85% for 5m (warning)
- `NodeDiskSpaceLow` - Disk < 15% for 5m (warning)
- `NodeDiskSpaceCritical` - Disk < 5% for 2m (critical)

**Kubernetes Alerts**:
- `PodCrashLooping` - Pod restarted 3+ times in 15m (warning)
- `PodNotReady` - Pod not ready for 10m (warning)
- `DeploymentReplicasMismatch` - Replicas mismatch for 10m (warning)
- `PersistentVolumeSpaceLow` - PV < 15% space for 5m (warning)

**Certificate Alerts**:
- `CertificateExpiringSoon` - Expires in < 7 days (warning)
- `CertificateExpiryCritical` - Expires in < 24 hours (critical)

**Longhorn Alerts**:
- `LonghornVolumeHealthy` - Volume not attached for 5m (warning)
- `LonghornNodeDown` - Storage node not ready for 5m (critical)

### Alertmanager Configuration

Location: `infrastructure/alertmanager/configmap.yaml`

```yaml
route:
  group_by: ['alertname', 'namespace', 'severity']
  group_wait: 30s
  group_interval: 5m
  repeat_interval: 4h
  receiver: 'default'
  routes:
    - match:
        severity: critical
      receiver: 'critical'

receivers:
  - name: 'default'
    webhook_configs:
      - url: 'http://n8n.n8n.svc:5678/webhook/alerts'
        send_resolved: true
  - name: 'critical'
    webhook_configs:
      - url: 'http://n8n.n8n.svc:5678/webhook/alerts-critical'
        send_resolved: true
```

Alerts are sent to n8n webhooks for custom notification workflows.

---

## BACKUP AND DISASTER RECOVERY

### Backup Strategy

1. **Database Backups** - Daily pg_dump via CronJob
2. **Longhorn Snapshots** - Daily/Weekly via RecurringJobs
3. **etcd Snapshots** - K3s automatic snapshots

### Database Backup CronJob

Location: `infrastructure/backups/backup-cronjob.yaml`

```yaml
apiVersion: batch/v1
kind: CronJob
metadata:
  name: homelab-backup
  namespace: longhorn-system
spec:
  schedule: "0 3 * * *"  # 3 AM daily
  concurrencyPolicy: Forbid
  jobTemplate:
    spec:
      template:
        spec:
          nodeSelector:
            kubernetes.io/hostname: neko  # NFS access
          containers:
            - name: backup
              image: postgres:16-alpine
              command:
                - /bin/sh
                - -c
                - |
                  DATE=$(date +%Y%m%d-%H%M%S)
                  BACKUP_DIR="/backup/homelab-$DATE"
                  mkdir -p "$BACKUP_DIR"

                  # Backup Authentik DB
                  PGPASSWORD="$AUTHENTIK_DB_PASSWORD" pg_dump \
                    -h authentik-db-rw.authentik.svc \
                    -U authentik -d authentik \
                    > "$BACKUP_DIR/authentik-db.sql"

                  # Backup Outline DB
                  PGPASSWORD="$OUTLINE_DB_PASSWORD" pg_dump \
                    -h outline-db-rw.outline.svc \
                    -U outline -d outline \
                    > "$BACKUP_DIR/outline-db.sql"

                  # Cleanup old (keep 7)
                  cd /backup && ls -dt homelab-*/ | tail -n +8 | xargs -r rm -rf
              volumeMounts:
                - name: backup-storage
                  mountPath: /backup
          volumes:
            - name: backup-storage
              nfs:
                server: 192.168.1.234
                path: /.../.data/k8s-backup
```

### Backup Locations

| Backup Type | Location | Retention |
|-------------|----------|-----------|
| Database dumps | NAS:/k8s-backup/homelab-YYYYMMDD/ | 7 days |
| Longhorn snapshots | Local Longhorn storage | 7 daily, 4 weekly |
| etcd snapshots | /var/lib/rancher/k3s/server/db/snapshots/ | K3s default |

### Disaster Recovery Procedures

#### Full Cluster Rebuild

1. **Provision K3s nodes**:
   ```bash
   sudo ./scripts/provision-k3s-server.sh jasen --init          # First node
   sudo ./scripts/provision-k3s-server.sh jasen --join <IP>     # Additional
   ```

2. **Bootstrap ArgoCD**:
   ```bash
   ./scripts/bootstrap-argocd.sh
   ```

3. **Re-seal all secrets** (new Sealed Secrets controller = new keys):
   ```bash
   kubeseal --fetch-cert > sealed-secrets-pub.pem
   # Re-seal all secrets from .env
   ```

4. **Sync root application in ArgoCD UI**

5. **Restore databases from NAS backups**

#### Database Restore

```bash
# Connect to new database pod
kubectl exec -it -n authentik authentik-db-1 -- bash

# Restore from backup
psql -U authentik -d authentik < /backup/homelab-YYYYMMDD/authentik-db.sql
```

#### Longhorn Volume Restore

1. Access Longhorn UI
2. Go to Backup tab
3. Find volume by PVC name
4. Click "Restore Latest Backup"
5. Create PV/PVC pointing to restored volume

---

## CI/CD PIPELINE

### GitHub Actions Workflow

Location: `.github/workflows/ci.yaml`

### Jobs Overview

```

  validate-manifests 
    (kustomize)      

          

        lint         
   (kube-linter)     

          

      security       
      (Trivy)        

          

     ci-passed       
  (gate + sync)      

          
     
              
 
 integ-    outline- 
 tests       sync   
 
```

### Job Details

#### 1. validate-manifests

Runs `./tests/validate-manifests.sh`:
- Finds all kustomization.yaml files
- Runs `kubectl kustomize` on each
- Fails if any kustomization is invalid

#### 2. lint

Runs kube-linter with `.kube-linter.yaml` config:
```yaml
checks:
  exclude:
    - "no-read-only-root-fs"  # Some apps need writable fs
    - "no-anti-affinity"       # Single replica apps
    - "latest-tag"             # Tracked separately
```

#### 3. security

Runs Trivy:
```bash
trivy config . --severity HIGH,CRITICAL --exit-code 0
trivy fs . --scanners secret --exit-code 1  # Fail on secrets
```

#### 4. ci-passed

Gate job that:
- Checks all previous jobs succeeded
- Triggers ArgoCD sync via API:
  ```bash
  curl -X POST \
    -H "Authorization: Bearer $ARGOCD_AUTH_TOKEN" \
    "https://argocd.lab.axiomlayer.com/api/v1/applications/applications/sync"
  ```

#### 5. integration-tests

Runs after ArgoCD sync:
- `./tests/smoke-test.sh` - 29 infrastructure health checks
- `./tests/test-auth.sh` - 14 authentication flow tests

#### 6. outline-sync

Syncs markdown docs to Outline wiki:
```bash
python3 scripts/outline_sync.py
```

### Self-Hosted Runners

Location: `infrastructure/actions-runner/`

Runners are deployed using actions-runner-controller:
```yaml
apiVersion: actions.summerwind.dev/v1alpha1
kind: RunnerDeployment
metadata:
  name: homelab-runners
  namespace: actions-runner
spec:
  replicas: 1
  template:
    spec:
      repository: jasencdev/axiomlayer
      labels:
        - homelab
        - self-hosted
      serviceAccountName: actions-runner
      dockerEnabled: true
```

Runner RBAC provides read-only cluster access for tests.

### Required Secrets

| Secret | Purpose |
|--------|---------|
| ARGOCD_AUTH_TOKEN | ArgoCD API access for sync trigger |
| OUTLINE_API_TOKEN | Outline API for doc sync |

---

## SECRETS MANAGEMENT

### Sealed Secrets Overview

All secrets are encrypted using Bitnami Sealed Secrets.

**Controller**: `infrastructure/sealed-secrets/`
**Namespace**: `kube-system`

### Creating a Sealed Secret

```bash
# Create regular secret manifest
kubectl create secret generic my-secret \
  --namespace my-namespace \
  --from-literal=api-key=supersecret \
  --dry-run=client -o yaml > secret.yaml

# Seal it
kubeseal \
  --controller-name=sealed-secrets-controller \
  --controller-namespace=kube-system \
  --format yaml \
  < secret.yaml > sealed-secret.yaml

# Commit sealed-secret.yaml (never the plain secret!)
```

### Secrets Inventory

| Namespace | Secret | Purpose | Keys |
|-----------|--------|---------|------|
| actions-runner | github-arc-token | GitHub PAT | github_token |
| argocd | argocd-secret | OIDC client secret | oidc.authentik.clientSecret |
| authentik | authentik-helm-secrets | Authentik config | secret_key |
| authentik | authentik-outpost-token | Outpost auth | token |
| campfire | campfire-secret | Rails secret | SECRET_KEY_BASE, VAPID keys |
| campfire | ghcr-pull-secret | GHCR pull | .dockerconfigjson |
| cert-manager | cloudflare-api-token | DNS-01 | api-token |
| external-dns | cloudflare-api-token | DNS mgmt | api-token |
| longhorn-system | backup-db-credentials | DB backup | authentik-password, outline-password |
| monitoring | grafana-oidc-secret | Grafana OIDC | client-id, client-secret |
| n8n | n8n-secrets | n8n config | db-password, encryption-key |
| open-webui | open-webui-secret | Open WebUI | WEBUI_SECRET_KEY |
| outline | outline-secrets | Outline config | database-url, secret-key, utils-secret, oidc-* |

### .env File

The `.env` file (gitignored) stores plain-text values for re-sealing:

```bash
# Example .env structure (NOT real values)
AUTHENTIK_SECRET_KEY=...
AUTHENTIK_POSTGRESQL_PASSWORD=...
CLOUDFLARE_API_TOKEN=...
GITHUB_RUNNER_TOKEN=...
GRAFANA_OIDC_CLIENT_ID=...
GRAFANA_OIDC_CLIENT_SECRET=...
# ... etc
```

### Secret Rotation Procedure

1. Generate new credential
2. Update `.env`
3. Re-create sealed secret:
   ```bash
   kubectl create secret generic my-secret \
     --from-literal=key=NEW_VALUE \
     --dry-run=client -o yaml | \
     kubeseal --format yaml > sealed-secret.yaml
   ```
4. Commit and push
5. Restart affected pods

---

## APPLICATION CATALOG

### Platform Applications

#### Dashboard

- **URL**: db.lab.axiomlayer.com
- **Auth**: Forward Auth
- **Purpose**: Homelab service dashboard with real-time metrics
- **Technology**: Static HTML + JavaScript + nginx
- **Location**: `apps/dashboard/`

Features:
- Live CPU, memory, storage, network metrics from Prometheus
- Service status indicators
- Links to all applications
- Dark theme with modern UI

#### ArgoCD

- **URL**: argocd.lab.axiomlayer.com
- **Auth**: Native OIDC
- **Purpose**: GitOps continuous delivery
- **Technology**: ArgoCD Helm chart
- **Location**: `apps/argocd/`

### User Applications

#### Campfire

- **URL**: chat.lab.axiomlayer.com
- **Auth**: Forward Auth
- **Purpose**: Team chat (37signals open source)
- **Technology**: Ruby on Rails
- **Database**: SQLite (local PVC)
- **Location**: `apps/campfire/`

Special requirements:
- Needs writable filesystem (`readOnlyRootFilesystem: false`)
- Private GHCR image (requires pull secret)
- AMD64 only (nodeSelector)

#### n8n (autom8)

- **URL**: autom8.lab.axiomlayer.com
- **Auth**: Forward Auth
- **Purpose**: Workflow automation
- **Database**: CNPG PostgreSQL (n8n-db)
- **Location**: `apps/n8n/`

Integration points:
- Receives Alertmanager webhooks
- Can trigger external APIs

#### Outline

- **URL**: docs.lab.axiomlayer.com
- **Auth**: Native OIDC
- **Purpose**: Documentation wiki
- **Database**: CNPG PostgreSQL (outline-db) + Redis
- **Location**: `apps/outline/`

Features:
- Markdown documentation
- OIDC authentication
- S3-compatible storage (local filesystem)

#### Plane

- **URL**: plane.lab.axiomlayer.com
- **Auth**: Native OIDC
- **Purpose**: Project management / issue tracking
- **Technology**: Helm chart (plane-ce)
- **Location**: `apps/plane/`

Components (via Helm):
- PostgreSQL
- Redis
- RabbitMQ
- MinIO (object storage)

#### Open WebUI

- **URL**: ai.lab.axiomlayer.com
- **Auth**: Forward Auth
- **Purpose**: AI chat interface
- **Backend**: Ollama on siberian (100.115.3.88:11434)
- **Database**: CNPG PostgreSQL (open-webui-db)
- **Location**: `infrastructure/open-webui/`

Configuration:
```yaml
OLLAMA_BASE_URL: "http://100.115.3.88:11434"
RAG_EMBEDDING_ENGINE: "ollama"
RAG_EMBEDDING_MODEL: "granite4:3b"
RAG_OLLAMA_BASE_URL: "http://100.79.124.94:11434"  # panther for embeddings
```

### Infrastructure Applications

#### Telnet Server

- **URL**: telnet.lab.axiomlayer.com
- **Auth**: Forward Auth
- **Purpose**: Demo application for testing SSO
- **Replicas**: 2 (with PDB)
- **Location**: `apps/telnet-server/`

---

## SECURITY PATTERNS

### Pod Security Standards

All deployments follow these security patterns:

```yaml
spec:
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    runAsGroup: 1000
    fsGroup: 1000
    seccompProfile:
      type: RuntimeDefault
  containers:
    - securityContext:
        allowPrivilegeEscalation: false
        readOnlyRootFilesystem: true  # When possible
        capabilities:
          drop: ["ALL"]
```

### Exceptions

Some applications require exceptions:

| Application | Exception | Reason |
|-------------|-----------|--------|
| Campfire | readOnlyRootFilesystem: false | Rails tmp/cache |
| n8n | readOnlyRootFilesystem: false | Node.js modules |
| Outline | readOnlyRootFilesystem: false | File uploads |
| NFS Proxy | privileged: true | NFS kernel module |

### RBAC Patterns

**Minimal cluster access** (actions-runner):
```yaml
rules:
  - apiGroups: [""]
    resources: ["nodes", "pods", "pods/log", "persistentvolumeclaims", "configmaps"]
    verbs: ["get", "list"]
  - apiGroups: ["apps"]
    resources: ["deployments"]
    verbs: ["get", "list"]
  - apiGroups: ["cert-manager.io"]
    resources: ["certificates"]
    verbs: ["get", "list"]
```

**Service account with specific namespace access** (external-dns):
```yaml
rules:
  - apiGroups: ["", "extensions", "networking.k8s.io"]
    resources: ["services", "endpoints", "pods", "ingresses", "nodes"]
    verbs: ["get", "watch", "list"]
```

### Network Security

Default-deny network policies in every namespace with explicit allow rules:
1. Allow ingress from Traefik only
2. Allow egress to DNS
3. Allow egress to specific databases
4. Allow egress to external APIs (when needed)

---

## PROVISIONING SCRIPTS

### provision-k3s-server.sh

Location: `scripts/provision-k3s-server.sh`

Purpose: Sets up a K3s server node with full hardening.

**Usage**:
```bash
# First server
sudo ./provision-k3s-server.sh jasen --init

# Additional servers
sudo ./provision-k3s-server.sh jasen --join 100.67.134.110
```

**What it does**:
1. System update
2. Install packages (btop, curl, git, zsh, etc.)
3. Install GitHub CLI
4. Install Tailscale
5. SSH hardening (port 22879, key-only, no root)
6. UFW firewall (allow K3s ports, Tailscale)
7. Oh My Zsh + Dracula theme
8. Realtek R8125 driver (for NUCs)
9. K3s installation with Tailscale interface

### bootstrap-argocd.sh

Location: `scripts/bootstrap-argocd.sh`

Purpose: Bootstrap ArgoCD and GitOps from scratch.

**What it does**:
1. Install Helm
2. Install Sealed Secrets controller
3. Install ArgoCD via Helm
4. Apply root application
5. Output admin password

### Other Scripts

- `provision-k3s-agent.sh` - Set up worker node
- `provision-ollama-workstation.sh` - Set up GPU workstation
- `backup-homelab.sh` - Pre-maintenance backup
- `outline_sync.py` - Sync docs to Outline

---

## TESTING FRAMEWORK

### smoke-test.sh

Location: `tests/smoke-test.sh`

**Tests** (29 total):
1. Node health (all Ready)
2. Core services (ArgoCD, Traefik, cert-manager)
3. Authentication (Authentik server, outpost)
4. Storage (Longhorn, PVCs bound)
5. Monitoring (Prometheus, Grafana)
6. Databases (CNPG clusters)
7. Applications (Dashboard, Outline, n8n, Open WebUI, Plane, Campfire)
8. Certificates (all valid)
9. Endpoint health (HTTP status checks)

### test-auth.sh

Location: `tests/test-auth.sh`

**Tests** (14 total):
1. Authentik health check
2. Forward auth outpost running
3. Forward auth apps redirect to Authentik
4. HTTPS connectivity
5. Native OIDC apps accessible
6. OIDC discovery endpoints
7. ArgoCD OIDC integration
8. Grafana OIDC integration

### validate-manifests.sh

Location: `tests/validate-manifests.sh`

Validates all Kustomize manifests compile without errors.

---

## OPERATIONAL PROCEDURES

### Adding a New Application

1. Create directory structure:
   ```
   apps/myapp/
    namespace.yaml
    deployment.yaml
    service.yaml
    certificate.yaml
    ingress.yaml
    networkpolicy.yaml
    kustomization.yaml
   ```

2. Create ArgoCD Application:
   ```
   apps/argocd/applications/myapp.yaml
   ```

3. Add to kustomization:
   ```
   apps/argocd/applications/kustomization.yaml
   ```

4. Configure Authentik (if using Forward Auth):
   - Add Proxy Provider in blueprints
   - Add to outpost providers list

5. Commit and push

### Rolling Back

**Via ArgoCD UI**:
1. Open ArgoCD
2. Select application
3. Click History
4. Select previous sync
5. Click Rollback

**Via kubectl**:
```bash
kubectl rollout undo deployment/myapp -n myapp
```

### Node Maintenance

```bash
# Cordon
kubectl cordon node-name

# Drain
kubectl drain node-name --ignore-daemonsets --delete-emptydir-data

# Perform maintenance

# Uncordon
kubectl uncordon node-name
```

### Debugging Applications

```bash
# Logs
kubectl logs -n namespace deployment/app -f

# Shell access
kubectl exec -it -n namespace deployment/app -- /bin/sh

# Events
kubectl get events -n namespace --sort-by='.lastTimestamp'

# Describe
kubectl describe pod/app-xxx -n namespace
```

---

## TROUBLESHOOTING REFERENCE

### Certificate Not Issuing

```bash
# Check certificate
kubectl describe certificate myapp-tls -n myapp

# Check CertificateRequest
kubectl get certificaterequests -n myapp

# Check Challenge
kubectl get challenges -n myapp
kubectl describe challenge xxx -n myapp

# Check cert-manager logs
kubectl logs -n cert-manager -l app=cert-manager | grep myapp
```

**Common causes**:
- Cloudflare API token invalid
- DNS propagation delay (wait 7+ minutes)
- Rate limiting

### ArgoCD Sync Issues

```bash
# Force sync
kubectl patch application myapp -n argocd --type merge \
  -p '{"operation":{"sync":{"force":true}}}'

# Hard refresh
kubectl patch application myapp -n argocd --type merge \
  -p '{"metadata":{"annotations":{"argocd.argoproj.io/refresh":"hard"}}}'
```

### Pod Won't Start

```bash
# Check status
kubectl describe pod/xxx -n namespace

# Common issues:
# - ImagePullBackOff: Check image name, pull secret
# - CrashLoopBackOff: Check logs, resources, config
# - Pending: Check node resources, PVC binding, node selectors
```

### Database Connection Failed

```bash
# Check CNPG cluster
kubectl get clusters -n namespace
kubectl describe cluster mydb -n namespace

# Check endpoints
kubectl get endpoints mydb-rw -n namespace

# Test connection
kubectl run psql --rm -it --image=postgres:16 -- \
  psql -h mydb-rw.namespace.svc -U user -d database
```

### Authentik Issues

```bash
# Check server
kubectl logs -n authentik -l app.kubernetes.io/name=authentik-server

# Check outpost
kubectl logs -n authentik -l goauthentik.io/outpost-name=forward-auth-outpost

# Restart outpost
kubectl rollout restart deployment/ak-outpost-forward-auth-outpost -n authentik
```

---

## CONFIGURATION REFERENCE

### Key ConfigMaps

| Namespace | ConfigMap | Purpose |
|-----------|-----------|---------|
| argocd | argocd-cm | ArgoCD main config |
| argocd | argocd-cmd-params-cm | Server parameters |
| argocd | argocd-rbac-cm | RBAC policies |
| authentik | authentik-blueprints | App/provider definitions |
| alertmanager | alertmanager-config | Alert routing |
| dashboard | dashboard-config | HTML content |
| open-webui | open-webui-config | Ollama endpoints |

### Important Annotations

**Ingress Forward Auth**:
```yaml
traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
```

**Ingress TLS**:
```yaml
traefik.ingress.kubernetes.io/router.entrypoints: websecure
traefik.ingress.kubernetes.io/router.tls: "true"
```

**ArgoCD Sync Wave**:
```yaml
argocd.argoproj.io/sync-wave: "5"
```

### Required Labels

```yaml
labels:
  app.kubernetes.io/name: myapp
  app.kubernetes.io/component: server
  app.kubernetes.io/part-of: homelab
  app.kubernetes.io/managed-by: argocd
```

---

## API AND INTEGRATION REFERENCE

### ArgoCD API

**Trigger sync**:
```bash
curl -X POST \
  -H "Authorization: Bearer $TOKEN" \
  "https://argocd.lab.axiomlayer.com/api/v1/applications/myapp/sync"
```

### Authentik API

**Base URL**: `https://auth.lab.axiomlayer.com/api/v3/`

### Prometheus API

**Query**:
```bash
curl "http://prometheus:9090/api/v1/query?query=up"
```

### Alertmanager API

**Silence**:
```bash
curl -X POST "http://alertmanager:9093/api/v2/silences" \
  -H "Content-Type: application/json" \
  -d '{"matchers":[{"name":"alertname","value":"MyAlert"}],"startsAt":"...","endsAt":"..."}'
```

### Longhorn API

**List volumes**:
```bash
kubectl get volumes -n longhorn-system -o json
```

### Outline API

**Base URL**: `https://docs.lab.axiomlayer.com/api/`

Used by `scripts/outline_sync.py` for documentation synchronization.

---

## GLOSSARY

| Term | Definition |
|------|------------|
| ArgoCD | GitOps continuous delivery tool |
| Authentik | Identity provider / SSO platform |
| Blueprint | Authentik declarative configuration |
| CNPG | CloudNativePG - PostgreSQL operator |
| Forward Auth | Authentication via proxy (Traefik  Authentik) |
| Kustomize | Kubernetes manifest templating |
| Longhorn | Distributed block storage for Kubernetes |
| OIDC | OpenID Connect - authentication protocol |
| Sealed Secret | Encrypted Kubernetes secret |
| Tailscale | WireGuard-based mesh VPN |
| Traefik | Ingress controller and load balancer |

---

## QUICK REFERENCE COMMANDS

```bash
# Cluster status
kubectl get nodes -o wide
kubectl get pods -A | grep -v Running

# ArgoCD apps
kubectl get applications -n argocd

# Certificates
kubectl get certificates -A

# PVCs
kubectl get pvc -A

# Secrets (sealed)
kubectl get sealedsecrets -A

# Recent events
kubectl get events -A --sort-by='.lastTimestamp' | tail -20

# Resource usage
kubectl top nodes
kubectl top pods -A --sort-by=memory | head -10

# Restart deployment
kubectl rollout restart deployment/myapp -n namespace

# Port forward for debugging
kubectl port-forward svc/myapp -n namespace 8080:80

# Run tests
./tests/smoke-test.sh
./tests/test-auth.sh
./tests/validate-manifests.sh
```

---

*This document was generated for RAG indexing. Last updated: 2025-11-30*
# App Deployment Workflow

This guide covers the complete workflow for adding new applications to the homelab GitOps cluster.

## Overview

This cluster uses an **App of Apps** pattern for fully automated deployments. Once you create the manifests and push to GitHub, ArgoCD automatically syncs everything - no manual `kubectl apply` needed.

## Prerequisites

- Access to the K3s cluster (`kubectl` configured)
- `kubeseal` CLI installed for creating sealed secrets
- Cloudflare API token stored in `cert-manager` namespace (already configured)

## Step-by-Step Workflow

### 1. Create the App Directory Structure

```bash
mkdir -p apps/{app-name}
```

Create the following files:

```
apps/{app-name}/
 namespace.yaml
 deployment.yaml
 service.yaml
 certificate.yaml
 ingress.yaml
 sealed-secret.yaml    # If secrets are needed
 pvc.yaml              # If persistent storage is needed
 postgres-cluster.yaml # If PostgreSQL is needed
 kustomization.yaml
```

### 2. Create the Namespace

```yaml
# namespace.yaml
apiVersion: v1
kind: Namespace
metadata:
  name: {app-name}
  labels:
    app.kubernetes.io/name: {app-name}
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
```

### 3. Create the Certificate (TLS)

```yaml
# certificate.yaml
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: {app-name}-tls
  namespace: {app-name}
  labels:
    app.kubernetes.io/name: {app-name}
    app.kubernetes.io/component: tls
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  secretName: {app-name}-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - {app-name}.lab.axiomlayer.com
```

### 4. Create the Ingress

```yaml
# ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: {app-name}
  namespace: {app-name}
  labels:
    app.kubernetes.io/name: {app-name}
    app.kubernetes.io/component: ingress
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    # Include this line to require SSO authentication:
    traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
spec:
  ingressClassName: traefik
  tls:
  - hosts:
    - {app-name}.lab.axiomlayer.com
    secretName: {app-name}-tls
  rules:
  - host: {app-name}.lab.axiomlayer.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: {app-name}
            port:
              number: {port}
```

### 5. Create the Deployment

```yaml
# deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: {app-name}
  namespace: {app-name}
  labels:
    app.kubernetes.io/name: {app-name}
    app.kubernetes.io/component: server
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: {app-name}
  template:
    metadata:
      labels:
        app.kubernetes.io/name: {app-name}
        app.kubernetes.io/component: server
        app.kubernetes.io/part-of: homelab
    spec:
      securityContext:
        runAsNonRoot: true
        runAsUser: 1000
        runAsGroup: 1000
        fsGroup: 1000
        seccompProfile:
          type: RuntimeDefault
      containers:
      - name: {app-name}
        image: {image}:{tag}  # Always pin to specific version
        imagePullPolicy: IfNotPresent
        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: true  # Set false if app needs to write
          capabilities:
            drop:
              - ALL
        ports:
        - containerPort: {port}
          name: http
        resources:
          requests:
            cpu: 100m
            memory: 128Mi
          limits:
            cpu: 500m
            memory: 512Mi
        livenessProbe:
          httpGet:
            path: /health
            port: http
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /health
            port: http
          initialDelaySeconds: 10
          periodSeconds: 5
```

### 6. Create the Service

```yaml
# service.yaml
apiVersion: v1
kind: Service
metadata:
  name: {app-name}
  namespace: {app-name}
  labels:
    app.kubernetes.io/name: {app-name}
    app.kubernetes.io/component: server
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  type: ClusterIP
  ports:
  - port: {port}
    targetPort: http
    protocol: TCP
    name: http
  selector:
    app.kubernetes.io/name: {app-name}
```

### 7. Create the Kustomization

```yaml
# kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - deployment.yaml
  - service.yaml
  - certificate.yaml
  - ingress.yaml
  # Add these if needed:
  # - sealed-secret.yaml
  # - pvc.yaml
  # - postgres-cluster.yaml
```

### 8. Create the ArgoCD Application

```yaml
# apps/argocd/applications/{app-name}.yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: {app-name}
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: apps/{app-name}
  destination:
    server: https://kubernetes.default.svc
    namespace: {app-name}
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
```

### 9. Create Sealed Secrets (if needed)

```bash
# Create the secret and seal it
kubectl create secret generic {app-name}-secrets -n {app-name} \
  --from-literal=key1=value1 \
  --from-literal=key2=value2 \
  --dry-run=client -o yaml | \
  kubeseal --format yaml > apps/{app-name}/sealed-secret.yaml
```

### 10. Add to Applications Kustomization

Edit `apps/argocd/applications/kustomization.yaml`:

```yaml
resources:
  # ... existing apps ...
  - {app-name}.yaml
```

### 11. Commit and Deploy

```bash
git add apps/{app-name} apps/argocd/applications/{app-name}.yaml apps/argocd/applications/kustomization.yaml
git commit -m "Add {app-name} application"
git push
```

The **App of Apps** (`root.yaml`) will automatically:
1. Detect the new Application manifest in the kustomization
2. Create the ArgoCD Application
3. Sync the application manifests to the cluster

No manual `kubectl apply` needed - everything is fully GitOps.

---

## TLS Certificate Management with cert-manager

### How It Works

1. The `Certificate` resource tells cert-manager to obtain a TLS certificate
2. cert-manager uses the `letsencrypt-prod` ClusterIssuer
3. The ClusterIssuer uses Cloudflare DNS-01 challenge for validation
4. cert-manager automatically creates the `_acme-challenge` TXT record in Cloudflare
5. Let's Encrypt validates domain ownership via the TXT record
6. Certificate is stored in the specified secret (e.g., `{app-name}-tls`)
7. Ingress uses this secret for TLS termination

### Monitoring Certificate Status

```bash
# Check certificate status
kubectl get certificates -A

# Check certificate details
kubectl describe certificate {app-name}-tls -n {app-name}

# Check challenges (during issuance)
kubectl get challenges -A

# Check challenge details
kubectl describe challenge -n {app-name}
```

### Troubleshooting TLS Issues

#### Certificate Stuck in "Pending" State

1. **Check the challenge status:**
   ```bash
   kubectl get challenges -n {app-name}
   kubectl describe challenge -n {app-name}
   ```

2. **Verify DNS propagation:**
   ```bash
   dig TXT _acme-challenge.{app-name}.lab.axiomlayer.com @aurora.ns.cloudflare.com +norecurse +short
   ```

3. **If DNS doesn't resolve but challenge exists:**

   **DO NOT manually create TXT records via Cloudflare API.**

   Instead, delete the challenge and let cert-manager recreate it:
   ```bash
   kubectl delete challenge -n {app-name} --all
   ```

   Wait 30 seconds and verify:
   ```bash
   dig TXT _acme-challenge.{app-name}.lab.axiomlayer.com @aurora.ns.cloudflare.com +norecurse +short
   ```

4. **If still not working, delete and recreate the certificate:**
   ```bash
   kubectl delete certificate {app-name}-tls -n {app-name}
   # ArgoCD will recreate it from Git
   ```

5. **Check cert-manager logs:**
   ```bash
   kubectl logs -n cert-manager -l app=cert-manager --tail=100 | grep {app-name}
   ```

#### Important: Never Manually Create ACME Challenge Records

When troubleshooting DNS-01 challenges, **never manually create TXT records** via the Cloudflare API or dashboard. Records created manually via the API may appear in API responses but fail to sync to Cloudflare's authoritative DNS servers.

Always let cert-manager create and manage the `_acme-challenge` TXT records through its Cloudflare webhook integration.

#### Traefik Not Picking Up New TLS Secret

If the certificate is ready but Traefik shows TLS errors:

```bash
# Restart Traefik to pick up new secrets
kubectl rollout restart daemonset/traefik -n kube-system
```

---

## Optional Components

### PostgreSQL Database (CloudNativePG)

```yaml
# postgres-cluster.yaml
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: {app-name}-db
  namespace: {app-name}
  labels:
    app.kubernetes.io/name: {app-name}
    app.kubernetes.io/component: database
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  instances: 1  # Use 3 for HA
  storage:
    size: 5Gi
    storageClass: longhorn
  bootstrap:
    initdb:
      database: {app-name}
      owner: {app-name}
      secret:
        name: {app-name}-secrets  # Must contain 'password' key
```

Connect using: `{app-name}-db-rw.{app-name}.svc:5432`

### Persistent Volume Claim

```yaml
# pvc.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: {app-name}-data
  namespace: {app-name}
  labels:
    app.kubernetes.io/name: {app-name}
    app.kubernetes.io/component: storage
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: longhorn
  resources:
    requests:
      storage: 5Gi
```

---

## Verification Checklist

After deployment, verify:

- [ ] `kubectl get pods -n {app-name}` - All pods Running
- [ ] `kubectl get certificate -n {app-name}` - Certificate Ready=True
- [ ] `kubectl get ingress -n {app-name}` - Ingress has address
- [ ] `curl -I https://{app-name}.lab.axiomlayer.com` - Returns 200/302
- [ ] ArgoCD UI shows app as "Synced" and "Healthy"

---

## Quick Reference Commands

```bash
# Validate kustomization before commit
kubectl kustomize apps/{app-name}

# Check ArgoCD sync status
kubectl get applications -n argocd

# Check App of Apps status (manages all other apps)
kubectl get application applications -n argocd

# Force ArgoCD sync
kubectl patch application {app-name} -n argocd --type merge -p '{"operation":{"sync":{}}}'

# View app logs
kubectl logs -n {app-name} -l app.kubernetes.io/name={app-name} -f

# Check all certificates
kubectl get certificates -A

# Check all challenges
kubectl get challenges -A
```

## App of Apps Architecture

The cluster uses an "App of Apps" pattern via `apps/argocd/applications/root.yaml`:

```
root.yaml (Application)
    
     watches: apps/argocd/applications/
            
             cert-manager.yaml  syncs infrastructure/cert-manager/
             authentik.yaml  syncs infrastructure/authentik/
             open-webui.yaml  syncs infrastructure/open-webui/
             {new-app}.yaml  syncs apps/{new-app}/ or infrastructure/{new-app}/
```

This means:
- Adding a new app is fully automated (just add to kustomization.yaml)
- No manual `kubectl apply` for Application manifests
- All apps are version-controlled and auditable
# Operational Runbooks

Step-by-step procedures for common operational tasks in the homelab cluster.

## Table of Contents

- [Daily Operations](#daily-operations)
- [Deploying a New Application](#deploying-a-new-application)
- [Upgrading Applications](#upgrading-applications)
- [Node Operations](#node-operations)
- [Backup and Restore](#backup-and-restore)
- [Secret Rotation](#secret-rotation)
- [Certificate Operations](#certificate-operations)
- [Disaster Recovery](#disaster-recovery)

---

## Daily Operations

### Morning Health Check

```bash
#!/bin/bash
# Run this to check cluster health

echo "=== Node Status ==="
kubectl get nodes -o wide

echo -e "\n=== Unhealthy Pods ==="
kubectl get pods -A | grep -v Running | grep -v Completed

echo -e "\n=== ArgoCD Applications ==="
kubectl get applications -n argocd

echo -e "\n=== Certificates Expiring Soon ==="
kubectl get certificates -A -o jsonpath='{range .items[*]}{.metadata.namespace}{"\t"}{.metadata.name}{"\t"}{.status.notAfter}{"\n"}{end}'

echo -e "\n=== Resource Usage ==="
kubectl top nodes

echo -e "\n=== Recent Events (last 10) ==="
kubectl get events -A --sort-by='.lastTimestamp' | tail -10
```

### Check Longhorn Storage

```bash
# Volume health
kubectl get volumes -n longhorn-system \
  -o custom-columns=NAME:.metadata.name,STATE:.status.state,ROBUSTNESS:.status.robustness

# Node storage
kubectl get nodes.longhorn.io -n longhorn-system \
  -o custom-columns=NAME:.metadata.name,SCHEDULABLE:.spec.allowScheduling
```

---

## Deploying a New Application

### Checklist

- [ ] Create application directory structure
- [ ] Create namespace.yaml
- [ ] Create deployment.yaml with security context
- [ ] Create service.yaml
- [ ] Create certificate.yaml
- [ ] Create ingress.yaml with SSO
- [ ] Create network policies
- [ ] Create sealed secrets (if needed)
- [ ] Create ArgoCD Application
- [ ] Update kustomization
- [ ] Update dashboard
- [ ] Update README

### Step-by-Step

#### 1. Create Directory Structure

```bash
APP_NAME=myapp
mkdir -p apps/${APP_NAME}
```

#### 2. Create Namespace

```bash
cat > apps/${APP_NAME}/namespace.yaml << 'EOF'
apiVersion: v1
kind: Namespace
metadata:
  name: myapp
  labels:
    app.kubernetes.io/name: myapp
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
EOF
```

#### 3. Create Deployment

```bash
cat > apps/${APP_NAME}/deployment.yaml << 'EOF'
apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp
  namespace: myapp
  labels:
    app.kubernetes.io/name: myapp
    app.kubernetes.io/component: server
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: myapp
  template:
    metadata:
      labels:
        app.kubernetes.io/name: myapp
        app.kubernetes.io/component: server
        app.kubernetes.io/part-of: homelab
    spec:
      securityContext:
        runAsNonRoot: true
        runAsUser: 1000
        runAsGroup: 1000
        fsGroup: 1000
        seccompProfile:
          type: RuntimeDefault
      containers:
        - name: myapp
          image: myapp:latest
          ports:
            - containerPort: 8080
              name: http
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
            capabilities:
              drop: ["ALL"]
          resources:
            requests:
              cpu: 100m
              memory: 128Mi
            limits:
              cpu: 500m
              memory: 512Mi
          livenessProbe:
            httpGet:
              path: /health
              port: http
            initialDelaySeconds: 30
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /health
              port: http
            initialDelaySeconds: 10
            periodSeconds: 5
EOF
```

#### 4. Create Service

```bash
cat > apps/${APP_NAME}/service.yaml << 'EOF'
apiVersion: v1
kind: Service
metadata:
  name: myapp
  namespace: myapp
  labels:
    app.kubernetes.io/name: myapp
    app.kubernetes.io/component: server
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  type: ClusterIP
  ports:
    - port: 8080
      targetPort: http
      protocol: TCP
      name: http
  selector:
    app.kubernetes.io/name: myapp
EOF
```

#### 5. Create Certificate

```bash
cat > apps/${APP_NAME}/certificate.yaml << 'EOF'
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: myapp-tls
  namespace: myapp
  labels:
    app.kubernetes.io/name: myapp
    app.kubernetes.io/component: tls
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  secretName: myapp-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - myapp.lab.axiomlayer.com
EOF
```

#### 6. Create Ingress

```bash
cat > apps/${APP_NAME}/ingress.yaml << 'EOF'
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: myapp
  namespace: myapp
  labels:
    app.kubernetes.io/name: myapp
    app.kubernetes.io/component: ingress
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
    traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
spec:
  ingressClassName: traefik
  tls:
    - hosts:
        - myapp.lab.axiomlayer.com
      secretName: myapp-tls
  rules:
    - host: myapp.lab.axiomlayer.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: myapp
                port:
                  number: 8080
EOF
```

#### 7. Create Network Policies

```bash
cat > apps/${APP_NAME}/networkpolicy.yaml << 'EOF'
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: myapp-default-deny
  namespace: myapp
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: myapp-allow-ingress
  namespace: myapp
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: myapp
  policyTypes:
    - Ingress
  ingress:
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: kube-system
          podSelector:
            matchLabels:
              app.kubernetes.io/name: traefik
      ports:
        - port: 8080
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: myapp-allow-egress
  namespace: myapp
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: myapp
  policyTypes:
    - Egress
  egress:
    - to:
        - namespaceSelector: {}
      ports:
        - port: 53
          protocol: UDP
        - port: 53
          protocol: TCP
EOF
```

#### 8. Create Kustomization

```bash
cat > apps/${APP_NAME}/kustomization.yaml << 'EOF'
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - deployment.yaml
  - service.yaml
  - certificate.yaml
  - ingress.yaml
  - networkpolicy.yaml
EOF
```

#### 9. Create ArgoCD Application

```bash
cat > apps/argocd/applications/myapp.yaml << 'EOF'
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: myapp
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/jasencdev/axiomlayer.git
    targetRevision: main
    path: apps/myapp
  destination:
    server: https://kubernetes.default.svc
    namespace: myapp
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
EOF

# Add to kustomization
echo "  - myapp.yaml" >> apps/argocd/applications/kustomization.yaml
```

#### 10. Validate and Deploy

```bash
# Validate kustomization
kubectl kustomize apps/myapp

# Commit and push
git add apps/myapp apps/argocd/applications/myapp.yaml apps/argocd/applications/kustomization.yaml
git commit -m "Add myapp application"
git push

# Watch deployment
kubectl get application myapp -n argocd -w
```

---

## Upgrading Applications

### Update Container Image

```bash
# Edit deployment.yaml
# Change image tag

# Commit and push
git add apps/{app}/deployment.yaml
git commit -m "Upgrade {app} to version X.Y.Z"
git push

# Watch rollout
kubectl rollout status deployment/{app} -n {app}
```

### Rollback

```bash
# Via ArgoCD (recommended)
# Go to ArgoCD UI  Application  History  Rollback

# Or via kubectl
kubectl rollout undo deployment/{app} -n {namespace}
```

---

## Node Operations

### Drain Node for Maintenance

```bash
# Cordon (prevent new pods)
kubectl cordon {node}

# Drain (evict pods)
kubectl drain {node} --ignore-daemonsets --delete-emptydir-data

# Perform maintenance...

# Uncordon
kubectl uncordon {node}
```

### Add New Node

```bash
# 1. Install prerequisites
ssh {new-node}
# Install Tailscale
curl -fsSL https://tailscale.com/install.sh | sh
sudo tailscale up

# 2. Get join token from existing server
ssh neko sudo cat /var/lib/rancher/k3s/server/node-token

# 3. Join cluster
curl -sfL https://get.k3s.io | sh -s - agent \
  --server https://100.67.134.110:6443 \
  --token {TOKEN} \
  --flannel-iface=tailscale0

# 4. Verify
kubectl get nodes
```

### Remove Node

```bash
# 1. Drain node
kubectl drain {node} --ignore-daemonsets --delete-emptydir-data

# 2. Delete from cluster
kubectl delete node {node}

# 3. On the node itself
ssh {node} sudo /usr/local/bin/k3s-uninstall.sh
# or for agent
ssh {node} sudo /usr/local/bin/k3s-agent-uninstall.sh
```

---

## Backup and Restore

### Backup Architecture

```
Longhorn Volumes  NFS Proxy (in-cluster)  UNAS NFS Share
                   10.43.37.240:/          192.168.1.234:/.../.data/k8s-backup
```

- **Backup Target**: `nfs://10.43.37.240:/` (NFS proxy service)
- **NFS Proxy**: Runs on `neko`, mounts UNAS and re-exports `/data/k8s-backup`
- **Schedule**: Daily at 2 AM UTC, retains 7 backups
- **Compression**: LZ4

### Volume Reference

Current volumes and their Longhorn IDs (for restore operations):

| Application | PVC | Longhorn Volume |
|-------------|-----|-----------------|
| n8n | n8n/n8n-data | pvc-5de7aa5b-2d45-467b-8a4c-ffc5e92d813e |
| n8n | n8n/n8n-db-1 | pvc-0a260809-b635-456e-b384-543ffc5f6eb3 |
| Outline | outline/outline-data | pvc-9756bc85-cb36-4bc4-9c7f-f00a9b26a554 |
| Outline | outline/outline-db-1 | pvc-0058a340-5ce8-45de-a576-f2f9702aaab2 |
| Open WebUI | open-webui/open-webui-data | pvc-06a1e2bd-0df8-4ee5-8cda-80083848b467 |
| Open WebUI | open-webui/open-webui-db-1 | pvc-acd7bca6-9465-4c29-8469-398017128a6a |
| Campfire | campfire/campfire-storage | pvc-e8a29df4-cae8-4136-a617-6f18e169c780 |
| Authentik | authentik/authentik-db-1 | pvc-6aeea1d0-7173-4942-802f-9c7ac4f48c28 |
| Plane | plane/pvc-plane-pgdb-vol-* | pvc-ba8acbfb-7a46-4667-b51b-dc8635caa1fa |
| Plane | plane/pvc-plane-minio-vol-* | pvc-9cf0ab57-9f2b-498f-b9a0-8aff5aadf77d |
| Loki | monitoring/storage-loki-0 | pvc-44507cad-3fea-457a-965f-490f199688d3 |

Generate current mapping:
```bash
kubectl get volumes -n longhorn-system -o json | \
  jq -r '.items[] | "\(.status.kubernetesStatus.namespace)/\(.status.kubernetesStatus.pvcName)  \(.metadata.name)"' | sort
```

### Check Backup Status

```bash
# List all backup volumes
kubectl get backupvolumes -n longhorn-system

# List recent backups
kubectl get backups -n longhorn-system --sort-by=.metadata.creationTimestamp | tail -20

# Check backup target health
kubectl get backuptarget -n longhorn-system default -o yaml

# Verify NFS mount is working
kubectl exec -n nfs-proxy deploy/nfs-proxy -- ls -la /data/k8s-backup/backupstore/volumes/

# Check backup size
kubectl exec -n nfs-proxy deploy/nfs-proxy -- du -sh /data/k8s-backup/backupstore/
```

### Manual Longhorn Backup

```bash
# Via UI
# Go to Longhorn UI  Volumes  Select volume  Create Backup

# Via kubectl - first create a snapshot, then backup
VOLUME_NAME=pvc-xxxxx  # Get from: kubectl get volumes -n longhorn-system

kubectl -n longhorn-system create -f - <<EOF
apiVersion: longhorn.io/v1beta2
kind: Backup
metadata:
  name: manual-backup-$(date +%Y%m%d-%H%M%S)
  namespace: longhorn-system
spec:
  snapshotName: ""
  volumeName: ${VOLUME_NAME}
EOF

# Watch backup progress
kubectl get backups -n longhorn-system -w
```

---

### Restore Procedures

#### Method 1: Restore via Longhorn UI (Recommended)

Best for: Quick restores, exploring available backups

1. Access Longhorn UI at https://longhorn.lab.axiomlayer.com
2. Navigate to **Backup** tab
3. Find the volume you want to restore (volumes are named by PVC ID)
4. Click the backup you want to restore
5. Click **Restore Latest Backup** (or select specific backup)
6. Enter a **new volume name** (cannot match existing volume name)
7. Click **OK**
8. Wait for volume to become `detached` state
9. Create PV/PVC to use the restored volume (see Step 2 below)

#### Method 2: Restore for Regular Deployments

Use when: Restoring a single volume for a Deployment/StatefulSet with 1 replica

**Step 1: Restore the Volume**

```bash
# Via Longhorn UI (preferred) or identify the backup
kubectl get backupvolumes -n longhorn-system

# Note the volume name (e.g., pvc-5de7aa5b-2d45-467b-8a4c-ffc5e92d813e)
# Restore via UI  Backup  Select volume  Restore Latest Backup
# Name it something like: restored-n8n-data
```

**Step 2: Create PersistentVolume pointing to restored volume**

```bash
# Get the restored volume details
RESTORED_VOL=restored-n8n-data
NAMESPACE=n8n
PVC_NAME=n8n-data
SIZE=5Gi

kubectl apply -f - <<EOF
apiVersion: v1
kind: PersistentVolume
metadata:
  name: ${RESTORED_VOL}
spec:
  capacity:
    storage: ${SIZE}
  volumeMode: Filesystem
  accessModes:
    - ReadWriteOnce
  persistentVolumeReclaimPolicy: Delete
  storageClassName: longhorn
  csi:
    driver: driver.longhorn.io
    fsType: ext4
    volumeHandle: ${RESTORED_VOL}
    volumeAttributes:
      numberOfReplicas: "3"
      staleReplicaTimeout: "30"
EOF
```

**Step 3: Delete old PVC and create new one bound to restored PV**

```bash
# Scale down the deployment first
kubectl scale deployment/${APP_NAME} -n ${NAMESPACE} --replicas=0

# Delete the old PVC (this will delete the old Longhorn volume!)
kubectl delete pvc ${PVC_NAME} -n ${NAMESPACE}

# Create new PVC bound to the restored PV
kubectl apply -f - <<EOF
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: ${PVC_NAME}
  namespace: ${NAMESPACE}
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: longhorn
  volumeName: ${RESTORED_VOL}
  resources:
    requests:
      storage: ${SIZE}
EOF

# Scale deployment back up
kubectl scale deployment/${APP_NAME} -n ${NAMESPACE} --replicas=1
```

#### Method 3: Restore for StatefulSets (Multiple Replicas)

Use when: Restoring volumes for StatefulSets like PostgreSQL clusters

**Example: Restore a 2-replica PostgreSQL cluster**

```bash
# 1. Restore both volumes via Longhorn UI
#    - pvc-xxx (postgres-0)  restored-postgres-0
#    - pvc-yyy (postgres-1)  restored-postgres-1

# 2. Scale down StatefulSet
kubectl scale statefulset/postgres -n default --replicas=0

# 3. Delete old PVCs
kubectl delete pvc postgres-0 postgres-1 -n default

# 4. Create PVs for each restored volume
for i in 0 1; do
kubectl apply -f - <<EOF
apiVersion: v1
kind: PersistentVolume
metadata:
  name: restored-postgres-${i}
spec:
  capacity:
    storage: 10Gi
  volumeMode: Filesystem
  accessModes:
    - ReadWriteOnce
  persistentVolumeReclaimPolicy: Delete
  storageClassName: longhorn
  csi:
    driver: driver.longhorn.io
    fsType: ext4
    volumeHandle: restored-postgres-${i}
    volumeAttributes:
      numberOfReplicas: "3"
      staleReplicaTimeout: "30"
EOF
done

# 5. Create PVCs with exact names StatefulSet expects
for i in 0 1; do
kubectl apply -f - <<EOF
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: data-postgres-${i}
  namespace: default
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: longhorn
  volumeName: restored-postgres-${i}
  resources:
    requests:
      storage: 10Gi
EOF
done

# 6. Scale StatefulSet back up
kubectl scale statefulset/postgres -n default --replicas=2
```

#### Method 4: Restore to New Namespace (Migration/Testing)

Use when: Testing restore without affecting production, or migrating data

```bash
# 1. Restore volume via UI with new name: test-restore-n8n

# 2. Create PV and PVC in test namespace
kubectl create namespace restore-test

kubectl apply -f - <<EOF
apiVersion: v1
kind: PersistentVolume
metadata:
  name: test-restore-n8n
spec:
  capacity:
    storage: 5Gi
  volumeMode: Filesystem
  accessModes:
    - ReadWriteOnce
  persistentVolumeReclaimPolicy: Delete
  storageClassName: longhorn
  csi:
    driver: driver.longhorn.io
    fsType: ext4
    volumeHandle: test-restore-n8n
    volumeAttributes:
      numberOfReplicas: "3"
      staleReplicaTimeout: "30"
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: test-data
  namespace: restore-test
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: longhorn
  volumeName: test-restore-n8n
  resources:
    requests:
      storage: 5Gi
EOF

# 3. Create a test pod to verify data
kubectl run -n restore-test data-check --image=busybox --restart=Never \
  --overrides='{"spec":{"containers":[{"name":"data-check","image":"busybox","command":["sleep","3600"],"volumeMounts":[{"name":"data","mountPath":"/data"}]}],"volumes":[{"name":"data","persistentVolumeClaim":{"claimName":"test-data"}}]}}'

# 4. Verify data
kubectl exec -n restore-test data-check -- ls -la /data
kubectl exec -n restore-test data-check -- cat /data/some-file

# 5. Cleanup
kubectl delete namespace restore-test
```

---

### Troubleshooting Restores

#### "Volume already exists" error

The restored volume name cannot match any existing volume.

```bash
# Check existing volumes
kubectl get volumes -n longhorn-system | grep {name}

# Use a unique name like: restored-{app}-{date}
```

#### Restored volume stuck in "Detached" state

This is normal. The volume attaches when a pod mounts it.

```bash
# Check volume state
kubectl get volumes -n longhorn-system {vol-name} -o jsonpath='{.status.state}'

# Create PV/PVC and start a pod to attach it
```

#### PVC stuck in "Pending"

```bash
# Check PVC events
kubectl describe pvc {name} -n {namespace}

# Common issues:
# - PV volumeName doesn't match
# - StorageClass mismatch
# - Size mismatch (PVC size must be <= PV size)
```

#### Data appears empty after restore

```bash
# Verify the backup has data
kubectl get backup {backup-name} -n longhorn-system -o jsonpath='{.status.size}'

# Check the restore completed
kubectl get volumes -n longhorn-system {vol-name} -o yaml | grep -A5 restoreStatus

# Verify mount inside pod
kubectl exec -n {namespace} {pod} -- df -h
kubectl exec -n {namespace} {pod} -- ls -la /path/to/mount
```

#### NFS proxy not accessible

```bash
# Check NFS proxy pod
kubectl get pods -n nfs-proxy
kubectl logs -n nfs-proxy deploy/nfs-proxy

# Check NFS service
kubectl get svc -n nfs-proxy

# Test NFS mount from another pod
kubectl run nfs-test --rm -it --image=busybox --restart=Never -- \
  sh -c "mount -t nfs 10.43.37.240:/ /mnt && ls /mnt/k8s-backup"
```

---

### Backup etcd

```bash
# On control plane node
ssh neko
sudo k3s etcd-snapshot save --name manual-backup-$(date +%Y%m%d)

# List snapshots
sudo k3s etcd-snapshot ls
```

### Restore etcd

```bash
# Stop K3s on all nodes first
# On control plane
sudo systemctl stop k3s

# Restore
sudo k3s server --cluster-reset --cluster-reset-restore-path=/var/lib/rancher/k3s/server/db/snapshots/{snapshot-name}

# Restart K3s
sudo systemctl start k3s
```

---

## Secret Rotation

### Rotate Cloudflare API Token

```bash
# 1. Create new token in Cloudflare dashboard

# 2. Create new sealed secret
kubectl create secret generic cloudflare-api-token \
  --namespace cert-manager \
  --from-literal=api-token=NEW_TOKEN \
  --dry-run=client -o yaml | \
  kubeseal --controller-name=sealed-secrets --controller-namespace=kube-system --format yaml \
  > infrastructure/cert-manager/sealed-secret.yaml

# 3. Update external-dns too
kubectl create secret generic cloudflare-api-token \
  --namespace external-dns \
  --from-literal=api-token=NEW_TOKEN \
  --dry-run=client -o yaml | \
  kubeseal --controller-name=sealed-secrets --controller-namespace=kube-system --format yaml \
  > infrastructure/external-dns/sealed-secret.yaml

# 4. Commit and push
git add infrastructure/cert-manager/sealed-secret.yaml infrastructure/external-dns/sealed-secret.yaml
git commit -m "Rotate Cloudflare API token"
git push

# 5. Restart components
kubectl rollout restart deployment/cert-manager -n cert-manager
kubectl rollout restart deployment/external-dns -n external-dns
```

### Rotate GitHub Runner Token

```bash
# 1. Create new PAT in GitHub with required scopes

# 2. Create new sealed secret
kubectl create secret generic github-runner-token \
  --namespace actions-runner \
  --from-literal=github_token=NEW_PAT \
  --dry-run=client -o yaml | \
  kubeseal --controller-name=sealed-secrets --controller-namespace=kube-system --format yaml \
  > infrastructure/actions-runner/sealed-secret.yaml

# 3. Commit and deploy
git add infrastructure/actions-runner/sealed-secret.yaml
git commit -m "Rotate GitHub runner token"
git push

# 4. Restart controller
kubectl rollout restart deployment -n actions-runner
```

---

## Certificate Operations

### Force Certificate Renewal

```bash
# Delete certificate (ArgoCD will recreate)
kubectl delete certificate {name}-tls -n {namespace}

# Watch for new certificate
kubectl get certificate -n {namespace} -w
```

### Check All Certificate Expiry

```bash
kubectl get certificates -A -o jsonpath='{range .items[*]}{.metadata.namespace}{"\t"}{.metadata.name}{"\t"}{.status.notAfter}{"\n"}{end}' | sort -k3
```

### Debug Certificate Issuance

```bash
# Full chain check
kubectl describe certificate {name} -n {namespace}
kubectl describe certificaterequest -n {namespace}
kubectl describe order -n {namespace}
kubectl describe challenge -n {namespace}
kubectl logs -n cert-manager -l app=cert-manager | grep {domain}
```

---

## Disaster Recovery

### Full Cluster Recovery

#### Prerequisites
- Backup of sealed-secrets keys
- Backup of etcd (or Longhorn backups)
- Access to Git repository

#### Steps

1. **Provision new nodes**
   ```bash
   # Use provisioning scripts
   ./scripts/provision-k3s-server.sh
   ./scripts/provision-k3s-agent.sh
   ```

2. **Restore sealed-secrets key**
   ```bash
   kubectl apply -f sealed-secrets-keys-backup.yaml
   ```

3. **Install core components**
   ```bash
   # Sealed Secrets
   helm install sealed-secrets sealed-secrets/sealed-secrets -n kube-system

   # cert-manager
   kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.14.4/cert-manager.yaml

   # Longhorn
   helm install longhorn longhorn/longhorn -n longhorn-system --create-namespace

   # ArgoCD
   kubectl create namespace argocd
   kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml
   ```

4. **Configure ArgoCD**
   ```bash
   kubectl apply -f apps/argocd/applications/root.yaml
   ```

5. **Restore Longhorn volumes from backup**
   - Access Longhorn UI
   - Go to Backup
   - Restore volumes

6. **Verify all applications**
   ```bash
   kubectl get applications -n argocd
   kubectl get pods -A
   ```

### Single Application Recovery

```bash
# 1. Check ArgoCD application status
kubectl get application {app} -n argocd

# 2. If deleted, recreate from Git
kubectl apply -f apps/argocd/applications/{app}.yaml

# 3. If data lost, restore from Longhorn backup
# Access Longhorn UI  Backup  Restore

# 4. Force sync
kubectl patch application {app} -n argocd --type merge \
  -p '{"operation":{"sync":{"force":true}}}'
```

---

## Emergency Contacts

| System | Contact | Access |
|--------|---------|--------|
| Cloudflare | Cloudflare Dashboard | DNS, SSL |
| Let's Encrypt | letsencrypt.org | Rate limits |
| Tailscale | Tailscale Admin | Network |
| GitHub | GitHub Settings | PATs, Runners |
# Architecture Overview

This document provides a comprehensive technical overview of the homelab Kubernetes cluster architecture.

## Table of Contents

- [Cluster Topology](#cluster-topology)
- [Network Architecture](#network-architecture)
- [Storage Architecture](#storage-architecture)
- [Security Architecture](#security-architecture)
- [GitOps Architecture](#gitops-architecture)
- [High Availability](#high-availability)

---

## Cluster Topology

### Node Inventory

| Node | Role | Hardware | CPU | RAM | Storage | Tailscale IP | Local IP |
|------|------|----------|-----|-----|---------|--------------|----------|
| neko | control-plane, etcd, master | Mini PC | AMD Ryzen | 32GB | 462GB NVMe | 100.67.134.110 | 192.168.1.167 |
| neko2 | control-plane, etcd, master | Mini PC | AMD Ryzen | 32GB | 462GB NVMe | 100.106.35.14 | 192.168.1.103 |
| bobcat | agent | Raspberry Pi 5 | ARM64 | 8GB | 500GB SSD | 100.121.67.60 | 192.168.1.49 |

### External Resources

| Resource | Purpose | Location | Connection |
|----------|---------|----------|------------|
| siberian | GPU workstation (Ollama) | Local network | Tailscale mesh |
| UniFi NAS | Backup storage | 192.168.1.234 | NFS via proxy |

### Kubernetes Version

- **Distribution**: K3s v1.33.6+k3s1
- **Container Runtime**: containerd 2.1.5
- **CNI**: Flannel (over Tailscale interface)

---

## Network Architecture

### Network Layers

```

                         Internet                                     

                                
                                

                    Cloudflare DNS                                    
         *.lab.axiomlayer.com  Tailscale IPs                        

                                
                                

                    Tailscale Mesh                                    
    neko (100.67.134.110)  neko2 (100.106.35.14)  bobcat         
                                                                     
                   siberian (GPU workstation)                         

                                
                                

                    Traefik Ingress                                   
              TLS termination + routing                               

                                
                                

                 Authentik Forward Auth                               
              SSO verification middleware                             

                                
                                

                    Application Pods                                  
              (receive X-Authentik-* headers)                         

```

### DNS Configuration

| Record Type | Name | Value | Manager |
|-------------|------|-------|---------|
| A | *.lab.axiomlayer.com | 100.67.134.110 | External-DNS |
| A | *.lab.axiomlayer.com | 100.106.35.14 | External-DNS |
| A | *.lab.axiomlayer.com | 100.121.67.60 | External-DNS |
| TXT | _acme-challenge.*.lab.axiomlayer.com | (dynamic) | cert-manager |

### Service Mesh

The cluster uses Flannel CNI configured to use the Tailscale interface (`tailscale0`), enabling:

- Pod-to-pod communication across nodes via Tailscale
- Automatic encryption via WireGuard (Tailscale)
- No need for traditional VPN or overlay networks

### Load Balancing

K3s includes ServiceLB (formerly Klipper), which:

- Exposes LoadBalancer services on all node IPs
- Routes traffic to appropriate pods
- Used for Traefik ingress and Telnet demo service

---

## Storage Architecture

### Storage Classes

| Class | Provider | Replication | Use Case |
|-------|----------|-------------|----------|
| longhorn | Longhorn | 3 replicas | Production workloads |
| longhorn-2-replicas | Longhorn | 2 replicas | Large volumes |
| local-path | Rancher Local Path | None | Legacy/testing |

### Longhorn Configuration

```

                      Longhorn Manager                                
                    (longhorn-system namespace)                       

                                
                
                                              
                 
            neko          neko2        bobcat  
          462GB         462GB         500GB    
          NVMe          NVMe          SSD      
                 
```

### Volume Inventory

| Namespace | PVC | Size | Storage Class | Purpose |
|-----------|-----|------|---------------|---------|
| authentik | data-authentik-postgresql-0 | 8Gi | local-path | Authentik PostgreSQL |
| authentik | redis-data-authentik-redis-master-0 | 8Gi | local-path | Authentik Redis |
| campfire | campfire-storage | 5Gi | longhorn | Campfire data |
| default | postgres-1/2/3 | 10Gi each | longhorn | Shared PostgreSQL cluster |
| monitoring | storage-loki-0 | 10Gi | longhorn | Log storage |
| n8n | n8n-data | 5Gi | longhorn | n8n workflows |
| n8n | n8n-db-1 | 5Gi | longhorn | n8n PostgreSQL |
| open-webui | open-webui-data | 5Gi | longhorn | Open WebUI data |
| open-webui | open-webui-db-1 | 10Gi | longhorn | Open WebUI PostgreSQL |
| outline | outline-data | 5Gi | longhorn | Outline attachments |
| outline | outline-db-1 | 5Gi | longhorn | Outline PostgreSQL |
| plane | pvc-plane-* | various | longhorn | Plane components |

### Backup Architecture

```
          
   Longhorn Volume         NFS Proxy             UniFi NAS        
   (any node)                   (neko only)             192.168.1.234       
          
                                      
                                       ClusterIP Service
                                       (accessible from all nodes)
                                      
                             
                                Longhorn Backup    
                                  Controller       
                             
```

**Why NFS Proxy?**

UniFi NAS NFS exports only allow a single client IP. The NFS proxy:
1. Runs on neko (192.168.1.167) - the allowed IP
2. Mounts the NAS share locally
3. Re-exports via Kubernetes ClusterIP service
4. All nodes can now access backups via the service

### Data Protection Automation

- `infrastructure/backups/` holds the `homelab-backup` CronJob (03:00 daily on `neko`) plus the `backup-db-credentials` SealedSecret so Authentik and Outline database dumps land on the NAS via the proxy automatically.
- `infrastructure/backups/longhorn-recurring-jobs.yaml` defines recurring snapshot + backup jobs for Longhorn, ensuring every PVC follows the same retention rules.
- `scripts/backup-homelab.sh` backs up the repo `.env`, Sealed Secret keys, live CNPG databases, and Longhorn metadata before disruptive maintenance.

---

## Security Architecture

### Authentication Flow

```

                         User Request                                 
                    https://app.lab.axiomlayer.com                   

                                
                                

                      Traefik Ingress                                 
              Checks forward-auth middleware                          

                                
                                

                    Authentik Outpost                                 
              /outpost.goauthentik.io/auth/nginx                     
                                                                      
          
     Has valid session cookie?                                      
       YES  Return 200 + X-Authentik-* headers                    
       NO   Return 401 + redirect to login                        
          

                                
              
                                                 
                   
        200 OK                          401 Redirect   
        Forward to app                   Login page   
                   
```

### SSO Headers

When authenticated, applications receive:

```
X-Authentik-Username: jasen
X-Authentik-Email: jasen@axiomlayer.com
X-Authentik-Groups: admins,users
X-Authentik-Uid: abc123def456
X-Authentik-Name: Jasen
```

### Forward Auth Deployment

- `infrastructure/authentik/outpost.yaml` deploys the `ak-outpost-forward-auth-outpost` Deployment/Service/Middleware that Traefik references via `authentik-ak-outpost-forward-auth-outpost@kubernetescrd`.
- `infrastructure/authentik/rbac.yaml` grants the Authentik service account cluster-wide RBAC (Deployments, Secrets, Traefik CRDs) so no manual bindings are needed.
- `infrastructure/authentik/outpost-token-sealed-secret.yaml` stores the outpost token issued by Authentik, keeping the middleware stateless and GitOps-friendly.
- Every ingress copies the annotation block from `templates/app/ingress.yaml`, so attaching forward auth is a one-line operation for any workload.

### Network Policies

Default-deny network policies are applied to all namespaces:

```yaml
# Pattern: {app}-default-deny
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: {app}-default-deny
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
```

Then explicit allow rules for:
- `{app}-allow-ingress`: Allow from Traefik
- `{app}-allow-egress`: Allow to DNS, specific services

### Sealed Secrets

All secrets are encrypted using Bitnami Sealed Secrets:

| Namespace | Secret | Purpose |
|-----------|--------|---------|
| actions-runner | github-arc-token | GitHub PAT for self-hosted runners |
| argocd | argocd-secret | Authentik OIDC client secret for ArgoCD |
| authentik | authentik-helm-secrets | Helm values: Postgres password, secret key |
| authentik | authentik-outpost-token | Token for forward-auth outpost deployment |
| campfire | campfire-secret | Rails SECRET_KEY_BASE + VAPID keys |
| campfire | ghcr-pull-secret | GHCR docker-registry credentials |
| cert-manager | cloudflare-api-token | DNS-01 challenge token |
| external-dns | cloudflare-api-token | Cloudflare DNS management token |
| longhorn-system | backup-db-credentials | Outline/Auth DB creds for CronJob |
| monitoring | grafana-oidc-secret | Grafana Authentik client |
| n8n | n8n-secrets | CNPG password + N8N_ENCRYPTION_KEY |
| open-webui | open-webui-secrets | API keys + session secret |
| outline | outline-secrets | DB URL, SECRET_KEY, UTILS_SECRET, OIDC secret |

### Pod Security

All deployments enforce:

```yaml
securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  seccompProfile:
    type: RuntimeDefault
containers:
  - securityContext:
      allowPrivilegeEscalation: false
      readOnlyRootFilesystem: true  # where possible
      capabilities:
        drop: ["ALL"]
```

---

## GitOps Architecture

### App of Apps Pattern

```

                         GitHub Repository                            
                   jasencdev/axiomlayer (main branch)                

                                
                                

                         ArgoCD Server                                
                    (argocd namespace)                                
                                                                      
          
                  root.yaml (App of Apps)                           
             watches: apps/argocd/applications/                    
          
                                                                     
                      
                                                                  
                                
    cert-mgr            authentik           campfire          
    .yaml               .yaml               .yaml             
                                
                                                                  
                                                                  
  infrastructure/        infrastructure/         apps/               
  cert-manager/          authentik/              campfire/           

```

### Sync Flow

1. Developer pushes to `main` branch
2. ArgoCD polls repository (every 3 minutes) or receives webhook
3. `root.yaml` detects changes in `apps/argocd/applications/`
4. New Application manifests are applied
5. Each Application syncs its target path
6. Resources are created/updated in cluster

### Application Lifecycle

```
            
   Unknown       OutOfSync     Syncing        Synced    
            
                                                                    
                                                                    
                                                            
                                                               Healthy    
                                                            
```

---

## High Availability

### Control Plane HA

- 2 control-plane nodes (neko, neko2)
- Embedded etcd with 2-node quorum
- K3s API server load balanced via Tailscale

### Application HA

| Component | Replicas | Strategy |
|-----------|----------|----------|
| ArgoCD Application Controller | 1 | StatefulSet |
| ArgoCD Server | 1 | Deployment |
| Traefik | 1 | DaemonSet-like |
| Authentik Server | 1 | Deployment |
| Longhorn Manager | 3 | DaemonSet |
| Most apps | 1 | Deployment |

### Storage HA

- Longhorn volumes replicated to 3 nodes (or 2 for large volumes)
- Automatic failover when node unavailable
- Backup to external NAS for disaster recovery

### Database HA

CloudNativePG clusters can be configured with multiple instances:

```yaml
spec:
  instances: 3  # For HA
  # or
  instances: 1  # For single-node (current setup for most apps)
```

Current PostgreSQL topology:
- `postgres` cluster: 3 instances (HA)
- Per-app databases: 1 instance each (via CloudNativePG)

---

## Diagrams

### Complete System Diagram

```
                                    
                                          Internet       
                                    
                                               
                                    
                                        Cloudflare DNS   
                                      *.lab.axiomlayer   
                                    
                                               
                    
                                      Tailscale Mesh                      
                                                                          
    
                                                                     
                                                                     
                                 
 neko         neko2       bobcat        siberian                
controlcontrol agent         (GPU)                  
 plane        plane        (Pi5)         Ollama                 
                                 
                                                                     
                          
                                                                         
                                                  
             K3s Cluster                                               
                                                       
              Traefik                                                
             (Ingress)                                               
                                                       
                                                                      
                                                       
             Authentik                                               
               (SSO)                                                 
                                                       
                                                                      
                                                       
            Applications                                             
                                                          
            Campfire                                               
            Plane                                                  
            Outline                                                
            n8n                                                    
            Open WebUI
            ...                                                     
                                                           
                                                        
                                                                       
                                                        
             Longhorn                                                 
             (Storage)                                                
                                                        
                                                   
                                                                         
                                                   
             NFS Proxy                                                  
             (on neko)                                                  
                                                   
                                                                         
                                                   
             UniFi NAS        
           192.168.1.234      
            /k8s-backup/      
         
```
# Troubleshooting Guide

Comprehensive troubleshooting guide for common issues in the homelab cluster.

## Table of Contents

- [Quick Diagnostics](#quick-diagnostics)
- [Certificate Issues](#certificate-issues)
- [ArgoCD Issues](#argocd-issues)
- [Storage Issues](#storage-issues)
- [Network Issues](#network-issues)
- [Application Issues](#application-issues)
- [Node Issues](#node-issues)
- [Authentication Issues](#authentication-issues)
- [Database Issues](#database-issues)

---

## Quick Diagnostics

### Cluster Health Check

```bash
# Node status
kubectl get nodes -o wide

# All pods status
kubectl get pods -A | grep -v Running | grep -v Completed

# Recent events
kubectl get events -A --sort-by='.lastTimestamp' | tail -20

# Resource usage
kubectl top nodes
kubectl top pods -A --sort-by=memory | head -20
```

### Component Health

```bash
# ArgoCD applications
kubectl get applications -n argocd

# Certificates
kubectl get certificates -A

# Sealed secrets
kubectl get sealedsecrets -A

# Persistent volumes
kubectl get pv

# Ingresses
kubectl get ingress -A
```

---

## Certificate Issues

### Certificate Stuck in "Pending"

**Symptoms:**
- Certificate shows `Ready: False`
- Challenge not completing

**Diagnosis:**

```bash
# Check certificate status
kubectl describe certificate {name} -n {namespace}

# Check certificate request
kubectl get certificaterequests -n {namespace}
kubectl describe certificaterequest {name} -n {namespace}

# Check challenges
kubectl get challenges -n {namespace}
kubectl describe challenge {name} -n {namespace}

# Check cert-manager logs
kubectl logs -n cert-manager -l app=cert-manager --tail=100 | grep {domain}
```

**Common Causes & Solutions:**

1. **DNS record not created**
   ```bash
   # Check if TXT record exists
   dig @1.1.1.1 _acme-challenge.{app}.lab.axiomlayer.com TXT

   # If missing, delete challenge and let cert-manager retry
   kubectl delete challenge -n {namespace} --all
   ```

2. **Cloudflare API token invalid**
   ```bash
   # Check token is correct
   kubectl get secret cloudflare-api-token -n cert-manager -o jsonpath='{.data.api-token}' | base64 -d

   # Reseal with correct token if needed
   ```

3. **DNS propagation delay**
   ```bash
   # Wait 7+ minutes (Cloudflare negative cache TTL)
   # Then delete and recreate certificate
   kubectl delete certificate {name} -n {namespace}
   ```

4. **Rate limiting (Let's Encrypt)**
   ```bash
   # Check cert-manager logs for rate limit errors
   # Wait 1 hour and retry
   ```

### Certificate Expired

**Quick Fix:**

```bash
# Delete certificate to trigger renewal
kubectl delete certificate {name} -n {namespace}

# ArgoCD will recreate it
# Watch for new certificate
kubectl get certificates -n {namespace} -w
```

### Traefik Not Using New Certificate

```bash
# Restart Traefik to pick up new TLS secret
kubectl rollout restart deployment/traefik -n kube-system

# Or delete the pod
kubectl delete pod -n kube-system -l app.kubernetes.io/name=traefik
```

---

## ArgoCD Issues

### Application OutOfSync

**Diagnosis:**

```bash
# Check sync status
kubectl get application {name} -n argocd -o jsonpath='{.status.sync.status}'

# Get detailed diff
kubectl get application {name} -n argocd -o yaml | grep -A50 "status:"
```

**Common Causes & Solutions:**

1. **Immutable resource changed (Jobs)**
   ```bash
   # Delete the job, ArgoCD will recreate
   kubectl delete job {name} -n {namespace}
   ```

2. **Resource modified outside GitOps**
   ```bash
   # Force sync to restore Git state
   kubectl patch application {name} -n argocd --type merge \
     -p '{"operation":{"sync":{"force":true}}}'
   ```

3. **Finalizer blocking deletion**
   ```bash
   # Remove finalizer
   kubectl patch {resource} {name} -n {namespace} --type merge \
     -p '{"metadata":{"finalizers":null}}'
   ```

### Application Stuck in "Progressing"

```bash
# Check application status
kubectl describe application {name} -n argocd

# Check target resources
kubectl get all -n {target-namespace}

# Check for pods not starting
kubectl get pods -n {target-namespace} -o wide
kubectl describe pod {pod} -n {target-namespace}
```

### ArgoCD UI Not Accessible

```bash
# Check ArgoCD server
kubectl get pods -n argocd -l app.kubernetes.io/name=argocd-server

# Check ingress
kubectl describe ingress argocd-server -n argocd

# Check certificate
kubectl get certificate argocd-tls -n argocd

# Restart server
kubectl rollout restart deployment/argocd-server -n argocd
```

### Force Hard Refresh

```bash
# Refresh from Git (hard refresh)
kubectl patch application {name} -n argocd --type merge \
  -p '{"metadata":{"annotations":{"argocd.argoproj.io/refresh":"hard"}}}'
```

---

## Storage Issues

### Longhorn Volume Degraded

**Symptoms:**
- Volume shows "Degraded" in UI
- Less than expected replicas

**Diagnosis:**

```bash
# Check volume status
kubectl get volumes -n longhorn-system
kubectl describe volume {pvc-name} -n longhorn-system

# Check replicas
kubectl get replicas -n longhorn-system | grep {pvc-name}

# Check node storage
kubectl get nodes.longhorn.io -n longhorn-system -o custom-columns=NAME:.metadata.name,SCHEDULABLE:.spec.allowScheduling,STORAGE:.status.conditions
```

**Solutions:**

1. **Node disk full**
   ```bash
   # Check disk usage on nodes
   ssh {node} df -h

   # Extend LVM if needed
   sudo lvextend -l +100%FREE /dev/ubuntu-vg/ubuntu-lv
   sudo resize2fs /dev/ubuntu-vg/ubuntu-lv

   # Restart Longhorn manager to detect new space
   kubectl delete pod -n longhorn-system -l app=longhorn-manager
   ```

2. **Node not schedulable**
   ```bash
   # Check Longhorn UI or
   kubectl get nodes.longhorn.io -n longhorn-system -o yaml | grep allowScheduling
   ```

### Volume Stuck in Attaching

```bash
# Check volume attachment
kubectl describe volumeattachment | grep {pvc-name}

# Force detach (careful!)
kubectl delete volumeattachment {attachment-name}

# Delete and recreate pod using the volume
kubectl delete pod {pod-name} -n {namespace}
```

### PVC Stuck in Pending

```bash
# Check PVC events
kubectl describe pvc {name} -n {namespace}

# Check storage class exists
kubectl get storageclass

# Check Longhorn CSI
kubectl get pods -n longhorn-system | grep csi
```

---

## Network Issues

### Pod Cannot Reach External Services

**Diagnosis:**

```bash
# Test from pod
kubectl run -it --rm debug --image=busybox -- sh
# Inside pod:
wget -qO- https://google.com
nslookup google.com
```

**Common Causes:**

1. **Network policy blocking egress**
   ```bash
   kubectl get networkpolicies -n {namespace}
   kubectl describe networkpolicy {name} -n {namespace}
   ```

2. **CoreDNS not working**
   ```bash
   kubectl get pods -n kube-system -l k8s-app=kube-dns
   kubectl logs -n kube-system -l k8s-app=kube-dns
   ```

### Service Not Reachable

```bash
# Check service exists
kubectl get svc -n {namespace}

# Check endpoints
kubectl get endpoints {service} -n {namespace}

# Test connectivity
kubectl run -it --rm debug --image=busybox -- wget -qO- http://{service}.{namespace}.svc:port
```

### Ingress Not Working

```bash
# Check ingress
kubectl describe ingress {name} -n {namespace}

# Check Traefik logs
kubectl logs -n kube-system -l app.kubernetes.io/name=traefik | grep {domain}

# Test with curl
curl -vk https://{domain}
```

### Tailscale Connection Issues

```bash
# Check Tailscale status
tailscale status

# Check connectivity between nodes
tailscale ping {other-node}

# Restart Tailscale
sudo systemctl restart tailscaled
sudo tailscale up
```

---

## Application Issues

### Pod CrashLooping

**Diagnosis:**

```bash
# Check pod status
kubectl get pods -n {namespace}
kubectl describe pod {pod} -n {namespace}

# Check logs
kubectl logs {pod} -n {namespace}
kubectl logs {pod} -n {namespace} --previous  # Previous crash
```

**Common Causes:**

1. **Configuration error**
   ```bash
   # Check ConfigMap/Secret mounted correctly
   kubectl get pod {pod} -n {namespace} -o yaml | grep -A20 "volumes:"
   ```

2. **Resource limits too low**
   ```bash
   # Check if OOMKilled
   kubectl describe pod {pod} -n {namespace} | grep -A5 "State:"

   # Increase limits in deployment
   ```

3. **Liveness probe failing**
   ```bash
   # Check probe configuration
   kubectl get deployment {name} -n {namespace} -o yaml | grep -A10 "livenessProbe:"
   ```

### Pod Stuck in Pending

```bash
# Check events
kubectl describe pod {pod} -n {namespace}

# Common causes:
# - No nodes with enough resources
# - Node selector/affinity not matching
# - PVC not bound
# - Image pull error
```

### Pod Stuck in Terminating

```bash
# Force delete
kubectl delete pod {pod} -n {namespace} --grace-period=0 --force

# If still stuck, check finalizers
kubectl get pod {pod} -n {namespace} -o yaml | grep finalizers
```

### Image Pull Error

```bash
# Check image name and tag
kubectl describe pod {pod} -n {namespace} | grep Image

# Check pull secret
kubectl get pod {pod} -n {namespace} -o yaml | grep imagePullSecrets

# Verify secret exists
kubectl get secret {pull-secret} -n {namespace}
```

---

## Node Issues

### Node NotReady

**Diagnosis:**

```bash
# Check node status
kubectl describe node {node}

# Check kubelet logs
ssh {node} journalctl -u k3s -n 100

# Check disk space
ssh {node} df -h

# Check memory
ssh {node} free -h
```

**Solutions:**

1. **Disk pressure**
   ```bash
   # Clean up
   ssh {node} sudo docker system prune -af  # if using docker
   ssh {node} sudo crictl rmi --prune       # for containerd

   # Extend disk
   sudo lvextend -l +100%FREE /dev/ubuntu-vg/ubuntu-lv
   sudo resize2fs /dev/ubuntu-vg/ubuntu-lv
   ```

2. **K3s service crashed**
   ```bash
   ssh {node} sudo systemctl restart k3s
   # or for agent
   ssh {node} sudo systemctl restart k3s-agent
   ```

3. **Tailscale disconnected**
   ```bash
   ssh {node} tailscale status
   ssh {node} sudo tailscale up
   ```

### High CPU/Memory Usage

```bash
# Find resource hogs
kubectl top pods -A --sort-by=cpu | head -10
kubectl top pods -A --sort-by=memory | head -10

# Check node resource usage
kubectl top nodes
```

---

## Authentication Issues

### SSO Login Failing

**Diagnosis:**

```bash
# Check Authentik server
kubectl get pods -n authentik
kubectl logs -n authentik -l app.kubernetes.io/name=authentik-server

# Check outpost
kubectl get pods -n authentik | grep outpost
kubectl logs -n authentik -l app.kubernetes.io/name=ak-outpost-forward-auth-outpost
```

**Common Causes:**

1. **Outpost not running**
   ```bash
   kubectl rollout restart deployment/ak-outpost-forward-auth-outpost -n authentik
   ```

2. **Wrong redirect URL in provider**
   - Check Authentik admin  Providers  Application
   - Verify redirect URIs match

3. **Middleware not applied**
   ```bash
   kubectl describe ingress {name} -n {namespace} | grep middlewares
   ```

### Authentik UI Not Loading

```bash
# Check all Authentik components
kubectl get pods -n authentik

# Check database
kubectl logs -n authentik authentik-postgresql-0

# Check Redis
kubectl logs -n authentik authentik-redis-master-0

# Restart Authentik
kubectl rollout restart deployment/authentik-server -n authentik
```

---

## Database Issues

### CloudNativePG Cluster Unhealthy

```bash
# Check cluster status
kubectl get clusters -A
kubectl describe cluster {name} -n {namespace}

# Check pods
kubectl get pods -n {namespace} -l cnpg.io/cluster={name}

# Check primary
kubectl get pods -n {namespace} -l cnpg.io/cluster={name},role=primary
```

### PostgreSQL Connection Refused

```bash
# Test connection
kubectl run -it --rm psql --image=postgres:15 -- \
  psql -h {cluster}-rw.{namespace}.svc -U {user} -d {database}

# Check service
kubectl get svc -n {namespace} | grep {cluster}

# Check endpoints
kubectl get endpoints {cluster}-rw -n {namespace}
```

### Database Full

```bash
# Check PVC usage
kubectl exec -it {cluster}-1 -n {namespace} -- df -h /var/lib/postgresql/data

# Expand PVC (Longhorn supports expansion)
kubectl patch pvc {pvc-name} -n {namespace} --type merge \
  -p '{"spec":{"resources":{"requests":{"storage":"20Gi"}}}}'
```

---

## Quick Reference Commands

### Logs

```bash
# Application logs
kubectl logs -n {namespace} -l app.kubernetes.io/name={app} -f

# Previous container logs
kubectl logs -n {namespace} {pod} --previous

# All containers in pod
kubectl logs -n {namespace} {pod} --all-containers

# Logs with timestamps
kubectl logs -n {namespace} {pod} --timestamps
```

### Debugging

```bash
# Interactive shell in pod
kubectl exec -it {pod} -n {namespace} -- /bin/sh

# Run debug container
kubectl run -it --rm debug --image=busybox -- sh

# Network debugging
kubectl run -it --rm debug --image=nicolaka/netshoot -- bash
```

### Resource Management

```bash
# Force delete stuck resources
kubectl delete {resource} {name} -n {namespace} --grace-period=0 --force

# Remove finalizers
kubectl patch {resource} {name} -n {namespace} --type merge \
  -p '{"metadata":{"finalizers":null}}'

# Restart deployment
kubectl rollout restart deployment/{name} -n {namespace}
```

### Events

```bash
# All events
kubectl get events -A --sort-by='.lastTimestamp'

# Namespace events
kubectl get events -n {namespace} --sort-by='.lastTimestamp'

# Watch events
kubectl get events -A -w
```
# Outline Sync Plan

Working notes for moving the refreshed engineering docs into Outline and the company wiki.

## Goals

1. Keep the engineering source of truth in Git while mirroring the latest content into Outline for easier discovery.
2. Split audiences: detailed runbooks/architecture for engineers, simplified service overviews for the wider company wiki.
3. Automate publishing via the Outline API so updates travel with each pull request.

## Proposed Outline Structure

- **Engineering**
  - Architecture (from `docs/ARCHITECTURE.md`)
  - Infrastructure (Traefik, Authentik, backups, monitoring, etc.)
  - Applications (per-app runbooks from `docs/APPLICATIONS.md`)
  - Runbooks & Troubleshooting (`docs/RUNBOOKS.md`, `docs/TROUBLESHOOTING.md`)
  - Secrets & Compliance (`docs/SECRETS.md` high-level view, no raw values)
  - Networking (`docs/NETWORKING.md`)
- **Company Wiki**
  - Service Catalog (short version of `README.md` Live Services table)
  - Access & Accounts (link to Authentik + Outline login instructions)
  - Incident Process (links back to Runbooks sections)

## API Workflow

1. Request an Outline API token with `documents.read`, `documents.write`, and `collections.write` scopes.
2. For each markdown source file:
   - Convert to Outline-compatible markdown (no GitHub-specific callouts).
   - Map it to a document slug + parent document/collection.
   - Call `POST /api/documents.create` (or `documents.update` if `id` exists) with `{ title, text, collectionId, parentDocumentId, publish: true }`.
3. Store the resulting Outline document IDs in a small JSON map (e.g. `.outline-sync.json`) so future syncs can call `documents.update`.
4. Wire the sync script into CI or a local helper (`scripts/sync-outline.sh`) that runs after docs change.

## Next Actions

1. **Need**: Outline API token + collection IDs for the Engineering and Company wiki spaces.
2. Prototype a sync script (Node.js or Python w/ `requests`) that:
   - Reads the JSON map,
   - Pushes updated markdown,
   - Raises an error if Outline returns validation issues.
3. Dry-run with `README.md` + `docs/ARCHITECTURE.md` to validate formatting.
4. Once stable, gate CI merges on `bin/outline-sync --check` so docs stay in lockstep.

## Automation Hook

- The sync script lives at `scripts/outline_sync.py` and uses `outline_sync/config.json` + `outline_sync/state.json`.
- `.github/workflows/ci.yaml` contains the `outline-sync` job, which runs on every push to `main` (after CI succeeds) when the repository secret `OUTLINE_API_TOKEN` is present.
- For forks or branches without the secret, the job logs a skip message so contributors can still run CI.
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: {{APP_NAME}}-pdb
  namespace: {{APP_NAME}}
  labels:
    app.kubernetes.io/name: {{APP_NAME}}
    app.kubernetes.io/component: pdb
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  minAvailable: 0
  selector:
    matchLabels:
      app.kubernetes.io/name: {{APP_NAME}}
apiVersion: v1
kind: Namespace
metadata:
  name: {{APP_NAME}}
  labels:
    app.kubernetes.io/name: {{APP_NAME}}
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: apps/v1
kind: Deployment
metadata:
  name: {{APP_NAME}}
  namespace: {{APP_NAME}}
  labels:
    app.kubernetes.io/name: {{APP_NAME}}
    app.kubernetes.io/component: server
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: {{APP_NAME}}
  template:
    metadata:
      labels:
        app.kubernetes.io/name: {{APP_NAME}}
        app.kubernetes.io/component: server
        app.kubernetes.io/part-of: homelab
    spec:
      securityContext:
        runAsNonRoot: true
        runAsUser: 1000
        runAsGroup: 1000
        fsGroup: 1000
        seccompProfile:
          type: RuntimeDefault
      containers:
        - name: {{APP_NAME}}
          # TODO: Update with your image digest after first build
          image: ghcr.io/jasencdev/{{APP_NAME}}@sha256:REPLACE_WITH_DIGEST
          ports:
            - containerPort: {{PORT}}
              name: http
          env:
            - name: NODE_ENV
              value: "production"
          envFrom:
            - secretRef:
                name: {{APP_NAME}}-secret
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
            capabilities:
              drop: ["ALL"]
          resources:
            requests:
              cpu: 100m
              memory: 128Mi
            limits:
              cpu: 500m
              memory: 512Mi
          volumeMounts:
            - name: tmp
              mountPath: /tmp
          livenessProbe:
            httpGet:
              path: /health
              port: http
            initialDelaySeconds: 30
            periodSeconds: 10
            timeoutSeconds: 5
            failureThreshold: 3
          readinessProbe:
            httpGet:
              path: /health
              port: http
            initialDelaySeconds: 10
            periodSeconds: 5
            timeoutSeconds: 3
            failureThreshold: 3
      volumes:
        - name: tmp
          emptyDir: {}
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - deployment.yaml
  - service.yaml
  - certificate.yaml
  - ingress.yaml
  - networkpolicy.yaml
  - pdb.yaml
  # Uncomment after creating sealed secret:
  # - sealed-secret.yaml
apiVersion: v1
kind: Service
metadata:
  name: {{APP_NAME}}
  namespace: {{APP_NAME}}
  labels:
    app.kubernetes.io/name: {{APP_NAME}}
    app.kubernetes.io/component: server
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  type: ClusterIP
  ports:
    - port: {{PORT}}
      targetPort: http
      protocol: TCP
      name: http
  selector:
    app.kubernetes.io/name: {{APP_NAME}}
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: {{APP_NAME}}-tls
  namespace: {{APP_NAME}}
  labels:
    app.kubernetes.io/name: {{APP_NAME}}
    app.kubernetes.io/component: tls
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  secretName: {{APP_NAME}}-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - {{APP_NAME}}.lab.axiomlayer.com
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: {{APP_NAME}}-default-deny
  namespace: {{APP_NAME}}
  labels:
    app.kubernetes.io/name: {{APP_NAME}}
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: {{APP_NAME}}-allow-ingress
  namespace: {{APP_NAME}}
  labels:
    app.kubernetes.io/name: {{APP_NAME}}
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: {{APP_NAME}}
  policyTypes:
    - Ingress
  ingress:
    # Allow traffic from Traefik ingress controller
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: kube-system
          podSelector:
            matchLabels:
              app.kubernetes.io/name: traefik
      ports:
        - protocol: TCP
          port: {{PORT}}
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: {{APP_NAME}}-allow-egress
  namespace: {{APP_NAME}}
  labels:
    app.kubernetes.io/name: {{APP_NAME}}
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: {{APP_NAME}}
  policyTypes:
    - Egress
  egress:
    # Allow DNS resolution
    - to:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              k8s-app: kube-dns
      ports:
        - protocol: UDP
          port: 53
        - protocol: TCP
          port: 53
    # Uncomment if app needs external HTTPS access:
    # - to:
    #     - ipBlock:
    #         cidr: 0.0.0.0/0
    #         except:
    #           - 10.0.0.0/8
    #           - 172.16.0.0/12
    #           - 192.168.0.0/16
    #   ports:
    #     - protocol: TCP
    #       port: 443
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: {{APP_NAME}}
  namespace: {{APP_NAME}}
  labels:
    app.kubernetes.io/name: {{APP_NAME}}
    app.kubernetes.io/component: ingress
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    # Uncomment to require SSO authentication:
    # traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
spec:
  ingressClassName: traefik
  tls:
    - hosts:
        - {{APP_NAME}}.lab.axiomlayer.com
      secretName: {{APP_NAME}}-tls
  rules:
    - host: {{APP_NAME}}.lab.axiomlayer.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: {{APP_NAME}}
                port:
                  number: {{PORT}}
name: Build and Push

on:
  push:
    tags: ['v*']
  workflow_dispatch:

env:
  REGISTRY: ghcr.io
  IMAGE_NAME: ${{ github.repository }}

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      packages: write

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: Log in to Container Registry
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}

      - name: Extract metadata
        id: meta
        uses: docker/metadata-action@v5
        with:
          images: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}
          tags: |
            type=semver,pattern={{version}}
            type=semver,pattern={{major}}.{{minor}}
            type=sha

      - name: Build and push
        uses: docker/build-push-action@v5
        with:
          context: .
          push: true
          tags: ${{ steps.meta.outputs.tags }}
          labels: ${{ steps.meta.outputs.labels }}
          cache-from: type=gha
          cache-to: type=gha,mode=max

      - name: Output image digest
        run: |
          echo "## Image Published " >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Image:** \`${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}\`" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Digest:** \`${{ steps.meta.outputs.digest }}\`" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "Update your deployment.yaml with:" >> $GITHUB_STEP_SUMMARY
          echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
          echo "image: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}@${{ steps.meta.outputs.digest }}" >> $GITHUB_STEP_SUMMARY
          echo "\`\`\`" >> $GITHUB_STEP_SUMMARY
services:
  app:
    build:
      context: .
      target: production
    ports:
      - "3000:{{PORT}}"
    environment:
      - NODE_ENV=development
    env_file:
      - .env
    volumes:
      # Hot reload: mount source code
      - ./src:/app/src:ro
    restart: unless-stopped

  # Optional: local database for development
  # postgres:
  #   image: postgres:16-alpine
  #   environment:
  #     POSTGRES_DB: {{APP_NAME}}
  #     POSTGRES_USER: {{APP_NAME}}
  #     POSTGRES_PASSWORD: localdev
  #   ports:
  #     - "5432:5432"
  #   volumes:
  #     - postgres_data:/var/lib/postgresql/data

# volumes:
#   postgres_data:
# {{APP_NAME}}

## Quick Start

### Local Development

```bash
# Copy environment file
cp .env.example .env

# Start with hot reload
docker compose up

# Access at http://localhost:3000
```

### Deploy to Axiom Layer

1. **Push to GitHub**  CI builds and pushes image to ghcr.io

2. **Copy k8s manifests to axiomlayer repo:**
   ```bash
   cp -r k8s/ /path/to/axiomlayer/apps/{{APP_NAME}}/
   ```

3. **Create ArgoCD Application:**
   ```bash
   cat <<EOF > /path/to/axiomlayer/apps/argocd/applications/{{APP_NAME}}.yaml
   apiVersion: argoproj.io/v1alpha1
   kind: Application
   metadata:
     name: {{APP_NAME}}
     namespace: argocd
   spec:
     project: default
     source:
       repoURL: https://github.com/jasencdev/axiomlayer.git
       targetRevision: main
       path: apps/{{APP_NAME}}
     destination:
       server: https://kubernetes.default.svc
       namespace: {{APP_NAME}}
     syncPolicy:
       automated:
         prune: true
         selfHeal: true
   EOF
   ```

4. **Add to kustomization:**
   ```bash
   # Edit apps/argocd/applications/kustomization.yaml
   # Add: - {{APP_NAME}}.yaml
   ```

5. **Push axiomlayer repo**  ArgoCD auto-syncs

### Update Deployment

```bash
# Tag a release
git tag v1.0.1
git push origin v1.0.1

# CI builds new image, then either:
# A) Manually update image digest in k8s/deployment.yaml
# B) Let Renovate auto-PR the update
```

## Project Structure

```
{{APP_NAME}}/
 .github/workflows/
    build.yaml          # CI: build & push to ghcr.io
 k8s/                    # Kubernetes manifests (copy to axiomlayer)
    namespace.yaml
    deployment.yaml
    service.yaml
    certificate.yaml
    ingress.yaml
    networkpolicy.yaml
    pdb.yaml
    sealed-secret.yaml  # Create with kubeseal
    kustomization.yaml
 src/                    # Your application code
 Dockerfile
 docker-compose.yml
 .env.example
 README.md
```

## Creating Secrets

```bash
# Generate sealed secret for axiomlayer cluster
kubectl create secret generic {{APP_NAME}}-secret \
  -n {{APP_NAME}} \
  --from-literal=DATABASE_URL=postgres://... \
  --from-literal=SECRET_KEY=$(openssl rand -hex 32) \
  --dry-run=client -o yaml | \
  kubeseal --format yaml > k8s/sealed-secret.yaml
```

## Checklist

- [ ] Replace all `{{APP_NAME}}` with your app name
- [ ] Replace `{{PORT}}` with your app's port
- [ ] Update Dockerfile for your stack
- [ ] Create sealed secrets
- [ ] Update health check endpoints in deployment.yaml
- [ ] Adjust resource limits based on app requirements
# CLAUDE.md - Homelab GitOps Repository

## Overview

GitOps-managed K3s homelab with ArgoCD, SSO, TLS, observability, and automated backups.

- **Domain**: `*.lab.axiomlayer.com`
- **Cluster**: 4-node K3s over Tailscale mesh (2 control-plane, 2 workers)
- **Repository**: https://github.com/jasencdev/axiomlayer
- **K3s Version**: v1.33.6+k3s1

## Nodes

| Node | Role | Tailscale IP | Purpose |
|------|------|--------------|---------|
| neko | control-plane, etcd, master | 100.67.134.110 | K3s server (primary) |
| neko2 | control-plane, etcd, master | 100.106.35.14 | K3s server (HA) |
| panther | worker | 100.79.124.94 | K3s agent (main workloads) |
| bobcat | worker | 100.121.67.60 | K3s agent (Raspberry Pi) |
| siberian | external | - | GPU workstation (Ollama) |

**Note**: The old node names (leopard, bobcat, lynx) in documentation are outdated. Current nodes are neko, neko2, panther, bobcat.

## Structure

```
homelab-gitops/
 apps/                      # Applications
    argocd/               # GitOps + Application CRDs
       applications/     # ArgoCD Application manifests
    campfire/             # Team chat (37signals)
    dashboard/            # Homelab dashboard
    n8n/                  # Workflow automation
    outline/              # Documentation wiki
    plane/                # Project management
    telnet-server/        # Demo app
 infrastructure/           # Core infrastructure
    actions-runner/       # GitHub Actions self-hosted runners
    alertmanager/         # Alert routing
    authentik/            # SSO/OIDC provider
    backups/              # Automated database backup CronJob
    cert-manager/         # TLS certificates
    cloudnative-pg/       # PostgreSQL operator
    external-dns/         # DNS management (Cloudflare)
    longhorn/             # Distributed storage
    monitoring/           # Prometheus/Grafana extras (OIDC, certs)
    nfs-proxy/            # NFS access for Longhorn
    open-webui/           # AI chat interface
    sealed-secrets/       # Sealed Secrets controller
 tests/                    # Test suite
    smoke-test.sh         # Infrastructure health (29 tests)
    test-auth.sh          # Authentication flows (14 tests)
    validate-manifests.sh # Kustomize validation (20 checks)
 scripts/                  # Provisioning scripts
    provision-k3s-server.sh  # K3s node setup
    bootstrap-argocd.sh      # ArgoCD + GitOps bootstrap
 .env                      # Secrets for sealed secrets (not committed)
 .github/workflows/        # CI/CD pipeline
     ci.yaml               # Main workflow
```

## Stack

| Component | Technology | Purpose |
|-----------|------------|---------|
| Cluster | K3s v1.33.6 | Lightweight Kubernetes |
| GitOps | ArgoCD | Continuous deployment |
| Config | Kustomize | Manifest management |
| Ingress | Traefik | Load balancing, TLS termination |
| TLS | cert-manager + Let's Encrypt | Automatic certificates (DNS-01 via Cloudflare) |
| DNS | external-dns + Cloudflare | Automatic DNS record management |
| Auth | Authentik 2025.10 | OIDC + forward auth SSO |
| Storage | Longhorn | Distributed block storage |
| Database | CloudNativePG | PostgreSQL operator |
| Monitoring | Prometheus + Grafana | Metrics and dashboards |
| Logging | Loki + Promtail | Log aggregation |
| Network | Tailscale | Mesh VPN |
| AI/LLM | Open WebUI + Ollama | Chat interface |
| Backups | CronJob + NFS | Daily database backups to NAS |
| Secrets | Sealed Secrets | Encrypted secrets in Git |

## Applications

| App | URL | Auth Type | Namespace | Database |
|-----|-----|-----------|-----------|----------|
| Dashboard | db.lab.axiomlayer.com | Forward Auth | dashboard | - |
| Open WebUI | ai.lab.axiomlayer.com | Forward Auth | open-webui | CNPG |
| Campfire | chat.lab.axiomlayer.com | Forward Auth | campfire | SQLite |
| n8n | autom8.lab.axiomlayer.com | Forward Auth | n8n | CNPG |
| Alertmanager | alerts.lab.axiomlayer.com | Forward Auth | monitoring | - |
| Longhorn | longhorn.lab.axiomlayer.com | Forward Auth | longhorn-system | - |
| ArgoCD | argocd.lab.axiomlayer.com | Native OIDC | argocd | - |
| Grafana | grafana.lab.axiomlayer.com | Native OIDC | monitoring | - |
| Outline | docs.lab.axiomlayer.com | Native OIDC | outline | CNPG |
| Plane | plane.lab.axiomlayer.com | Native OIDC | plane | CNPG |
| Authentik | auth.lab.axiomlayer.com | Native | authentik | CNPG |

## Databases

CloudNativePG manages PostgreSQL instances:

| Database | Namespace | Service | Backed Up |
|----------|-----------|---------|-----------|
| authentik-db | authentik | authentik-db-rw.authentik.svc:5432 | Yes |
| outline-db | outline | outline-db-rw.outline.svc:5432 | Yes |
| n8n-db | n8n | n8n-db-rw.n8n.svc:5432 | No |
| open-webui-db | open-webui | open-webui-db-rw.open-webui.svc:5432 | No |
| plane-db | plane | plane-db-rw.plane.svc:5432 | No |

## Automated Backups

Daily backup CronJob runs at 3 AM:
- **Location**: `infrastructure/backups/backup-cronjob.yaml`
- **Namespace**: longhorn-system (for NFS access)
- **Target**: Unifi NAS at 192.168.1.234
- **Databases backed up**: Authentik, Outline
- **Retention**: 7 days

```bash
# Test backup manually
kubectl create job --from=cronjob/homelab-backup homelab-backup-test -n longhorn-system

# View backup logs
kubectl logs -n longhorn-system -l job-name=homelab-backup-test
```

## CI/CD Pipeline

### Flow
1. Push to main  GitHub Actions CI
2. Jobs: validate-manifests, lint, security scan (Trivy)
3. ci-passed gate  triggers ArgoCD sync
4. ArgoCD deploys  changes applied
5. integration-tests  smoke + auth tests

### GitHub Actions Secrets
| Secret | Purpose |
|--------|---------|
| ARGOCD_AUTH_TOKEN | ArgoCD API access for sync trigger |

### Running Tests Locally
```bash
./tests/validate-manifests.sh  # Kustomize validation
./tests/smoke-test.sh          # Infrastructure health
./tests/test-auth.sh           # Authentication flows
```

## Patterns

### Component Structure
```
{component}/
 namespace.yaml
 deployment.yaml
 service.yaml
 certificate.yaml
 ingress.yaml
 networkpolicy.yaml    # Default deny + explicit allows
 pdb.yaml              # PodDisruptionBudget (if replicas > 1)
 kustomization.yaml
```

### Required Labels
```yaml
labels:
  app.kubernetes.io/name: {name}
  app.kubernetes.io/component: {component}
  app.kubernetes.io/part-of: homelab
  app.kubernetes.io/managed-by: argocd
```

### Deployment Security
```yaml
spec:
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    fsGroup: 1000
    seccompProfile:
      type: RuntimeDefault
  containers:
  - securityContext:
      allowPrivilegeEscalation: false
      readOnlyRootFilesystem: true  # Some apps need false (Campfire, n8n, Outline)
      capabilities:
        drop: ["ALL"]
    livenessProbe: {...}
    readinessProbe: {...}
    resources:
      requests: {...}
      limits: {...}
```

### Ingress with Forward Auth
```yaml
annotations:
  traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
spec:
  ingressClassName: traefik
```

### Network Policy Pattern
```yaml
# Default deny
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: {app}-default-deny
spec:
  podSelector: {}
  policyTypes: [Ingress, Egress]
---
# Allow specific traffic
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: {app}-allow-ingress
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: {app}
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          kubernetes.io/metadata.name: kube-system
      podSelector:
        matchLabels:
          app.kubernetes.io/name: traefik
```

### Cross-Namespace Database Access
For backup jobs or cross-namespace access, add network policy rules:
```yaml
# Allow backup jobs from longhorn-system
- from:
    - namespaceSelector:
        matchLabels:
          kubernetes.io/metadata.name: longhorn-system
      podSelector:
        matchLabels:
          app.kubernetes.io/name: homelab-backup
  ports:
    - protocol: TCP
      port: 5432
```

## Secrets Management

**Use Sealed Secrets only** - no plaintext secrets in Git.

The Sealed Secrets controller runs in `kube-system` namespace and is now GitOps-managed via `infrastructure/sealed-secrets/`.

```bash
# Create sealed secret
kubectl create secret generic {name} -n {namespace} \
  --from-literal=key=value --dry-run=client -o yaml | \
  kubeseal --format yaml > sealed-secret.yaml

# Fetch public key (for offline sealing)
kubeseal --fetch-cert > sealed-secrets-pub.pem
```

### .env File Variables
The `.env` file stores secrets for re-sealing. Never commit this file.

| Variable | Purpose |
|----------|---------|
| AUTHENTIK_AUTH_TOKEN | Authentik API access |
| AUTHENTIK_POSTGRESQL_PASSWORD | Authentik DB password |
| AUTHENTIK_SECRET_KEY | Authentik encryption key |
| CLOUDFLARE_API_TOKEN | DNS-01 challenges |
| GITHUB_RUNNER_TOKEN | GitHub Actions runner PAT |
| GRAFANA_OIDC_CLIENT_ID/SECRET | Grafana OIDC |
| OUTLINE_OIDC_CLIENT_ID/SECRET | Outline OIDC |
| PLANE_OIDC_CLIENT_ID/SECRET | Plane OIDC |
| N8N_DB_PASSWORD | n8n database |
| N8N_ENCRYPTION_KEY | n8n encryption |
| OPEN_WEBUI_SECRET_KEY | Open WebUI encryption |
| CAMPFIRE_SECRET_KEY_BASE | Campfire Rails secret |
| GHCR_DOCKERCONFIGJSON | GitHub Container Registry pull secret |
| K3_JOIN_SERVER | K3s cluster join token |
| PLANE_API_KEY | Plane API access |
| OUTLINE_API_KEY | Outline API access |

## Key Commands

```bash
# Validate kustomization
kubectl kustomize apps/{service}

# Check ArgoCD status
kubectl get applications -n argocd

# Check certificates
kubectl get certificates -A

# Check pods across namespaces
kubectl get pods -A

# Check non-running pods
kubectl get pods -A --field-selector=status.phase!=Running,status.phase!=Succeeded

# Drain node for maintenance
kubectl drain <node> --ignore-daemonsets --delete-emptydir-data

# Uncordon node
kubectl uncordon <node>

# Restart deployment
kubectl rollout restart deployment/<name> -n <namespace>

# Check Authentik outpost
kubectl logs -n authentik -l goauthentik.io/outpost-name=forward-auth-outpost --tail=100

# Direct database access (Authentik example)
kubectl exec -it -n authentik authentik-db-1 -- psql -U authentik -d authentik

# Test backup job
kubectl create job --from=cronjob/homelab-backup homelab-backup-test -n longhorn-system

# Check Longhorn volumes
kubectl get volumes -n longhorn-system
```

## Adding a New Service

1. Create `apps/{service}/` or `infrastructure/{service}/` with:
   - `namespace.yaml`
   - `deployment.yaml` (with security context, probes, resources)
   - `service.yaml`
   - `certificate.yaml`
   - `ingress.yaml` (with forward auth annotation)
   - `networkpolicy.yaml`
   - `kustomization.yaml`

2. Create ArgoCD Application: `apps/argocd/applications/{service}.yaml`

3. Add to `apps/argocd/applications/kustomization.yaml`

4. If using forward auth, create Authentik provider and add to outpost

5. If using native OIDC:
   - Create OAuth2/OpenID Provider in Authentik
   - Add scope mappings (openid, email, profile)
   - Create Application linked to provider
   - Store client_id/secret in .env and create sealed secret

6. Commit and push - CI validates, then ArgoCD syncs

## Authentik Configuration

### Forward Auth Apps
Each app needs:
1. Provider (Proxy Provider, forward auth mode)
2. Application linked to provider
3. Provider added to forward-auth-outpost

### Native OIDC Apps
Each app needs:
1. Provider (OAuth2/OpenID Provider)
2. Scope mappings added to provider (openid, email, profile)
3. Application linked to provider
4. Client ID/Secret configured in app via sealed secret

### Outpost Configuration
The forward-auth-outpost requires PostgreSQL env vars (Authentik 2025.10+):
- AUTHENTIK_POSTGRESQL__HOST
- AUTHENTIK_POSTGRESQL__USER
- AUTHENTIK_POSTGRESQL__PASSWORD
- AUTHENTIK_POSTGRESQL__NAME

### Direct Authentik DB Access
```bash
# Connect to Authentik database
kubectl exec -it -n authentik authentik-db-1 -- psql -U authentik -d authentik

# Useful queries
SELECT name, client_id FROM authentik_providers_oauth2_oauth2provider;
SELECT name, slug FROM authentik_core_application;
SELECT id, name FROM authentik_flows_flow WHERE slug LIKE '%authorization%';
```

## NFS and Storage

### Longhorn
- Default StorageClass for PVCs
- Distributed across worker nodes
- UI at longhorn.lab.axiomlayer.com

### NFS Proxy
- Runs on neko node (nodeSelector)
- Proxies NFS from Unifi NAS (192.168.1.234)
- Used by backup CronJob

### Direct NAS Access
```
Server: 192.168.1.234
Path: /volume/e8e70d24-82e0-45f1-8ef6-f8ca399ad2d6/.srv/.unifi-drive/Shared_Drive_Example/.data
```

## Monitoring and Logging

### Grafana Datasources
- **Prometheus**: kube-prometheus-stack (auto-provisioned)
- **Loki**: loki-stack (disabled duplicate provisioning via sidecar)

### Loki Configuration
The loki-stack Helm chart has sidecar datasource disabled to avoid duplicate:
```yaml
grafana:
  sidecar:
    datasources:
      enabled: false  # Provisioned by kube-prometheus-stack
```

## Known Limitations

### Trivy Security Findings (Informational)
These are known and acceptable:
- **AVD-KSV-0109**: ConfigMaps storing secrets (argocd-cm, authentik-blueprints) - by design
- **AVD-KSV-0014**: readOnlyRootFilesystem not true (Campfire, n8n, Outline) - apps need writable fs

### Authentik Blueprints
- Blueprints don't update client_secret after initial creation
- Manual database update required for OIDC secret changes

## Disaster Recovery / Bootstrap

### Recovery Order
1. **K3s Cluster** - `scripts/provision-k3s-server.sh`
2. **ArgoCD + Sealed Secrets** - `scripts/bootstrap-argocd.sh`
3. **Sync root app** - ArgoCD UI or `argocd app sync applications`
4. **Re-seal secrets** - New Sealed Secrets controller = new keys

### Full Cluster Rebuild
```bash
# 1. Provision K3s nodes
sudo ./scripts/provision-k3s-server.sh jasen --init          # First node
sudo ./scripts/provision-k3s-server.sh jasen --join <IP>     # Additional nodes

# 2. Bootstrap ArgoCD (from any node with kubectl access)
./scripts/bootstrap-argocd.sh

# 3. Re-seal all secrets (new controller = new keys)
kubeseal --fetch-cert > sealed-secrets-pub.pem
# Update all sealed secrets using .env values

# 4. Sync root application in ArgoCD UI
# This deploys all child apps
```

### Important Notes
- **Sealed Secrets**: New cluster = new encryption keys. All sealed secrets must be re-sealed.
- **Database backups**: Restore from NAS at 192.168.1.234
- **ArgoCD self-management**: `argocd-helm` app has manual sync only to prevent chicken/egg

## Documentation

Full documentation in Outline at https://docs.lab.axiomlayer.com:
- Cluster Overview
- CI/CD Pipeline
- Monitoring and Observability
- Runbooks
- Security
- GitHub Actions Runners
- Dashboard
- GitOps Workflow
- Networking and TLS
- Application Catalog
- Authentik SSO Configuration
- Cloudflare DNS and ACME Challenges
- Storage and Databases

## Notes

- Root application (`applications`) uses manual sync - triggered by CI after tests pass
- Child applications use auto-sync with prune and selfHeal
- ArgoCD self-manages via `argocd-helm` app with **manual sync only** (prevents chicken/egg issues)
- Helm charts (ArgoCD, Authentik, Longhorn, kube-prometheus-stack, cert-manager, actions-runner-controller) installed via ArgoCD Helm source
- TLS termination at Traefik; internal services use HTTP
- Ollama for LLM generation runs on siberian (GPU workstation, RTX 5070 Ti) via Tailscale at 100.115.3.88:11434
- Ollama for embeddings runs on panther (RTX 3050 Ti) via Tailscale at 100.79.124.94:11434
- Open WebUI uses granite4:3b model for RAG embeddings
- GitHub Actions runners have read-only cluster RBAC for tests
- Backup jobs run on neko node (nodeSelector for NFS access)
- panther is the primary worker node for most workloads
- Sealed Secrets controller is GitOps-managed in infrastructure/sealed-secrets/
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: external-dns
  namespace: external-dns
  labels:
    app.kubernetes.io/name: external-dns
    app.kubernetes.io/component: dns
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  minAvailable: 0
  selector:
    matchLabels:
      app.kubernetes.io/name: external-dns
apiVersion: v1
kind: Namespace
metadata:
  name: external-dns
  labels:
    app.kubernetes.io/name: external-dns
    app.kubernetes.io/component: dns
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: v1
kind: ServiceAccount
metadata:
  name: external-dns
  namespace: external-dns
  labels:
    app.kubernetes.io/name: external-dns
    app.kubernetes.io/component: dns
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: external-dns
  labels:
    app.kubernetes.io/name: external-dns
    app.kubernetes.io/component: dns
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
rules:
- apiGroups: [""]
  resources: ["services", "endpoints", "pods"]
  verbs: ["get", "watch", "list"]
- apiGroups: ["extensions", "networking.k8s.io"]
  resources: ["ingresses"]
  verbs: ["get", "watch", "list"]
- apiGroups: [""]
  resources: ["nodes"]
  verbs: ["list", "watch"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: external-dns-viewer
  labels:
    app.kubernetes.io/name: external-dns
    app.kubernetes.io/component: dns
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: external-dns
subjects:
- kind: ServiceAccount
  name: external-dns
  namespace: external-dns
apiVersion: apps/v1
kind: Deployment
metadata:
  name: external-dns
  namespace: external-dns
  labels:
    app.kubernetes.io/name: external-dns
    app.kubernetes.io/component: dns
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  replicas: 1
  strategy:
    type: Recreate
  selector:
    matchLabels:
      app.kubernetes.io/name: external-dns
  template:
    metadata:
      labels:
        app.kubernetes.io/name: external-dns
        app.kubernetes.io/component: dns
        app.kubernetes.io/part-of: homelab
    spec:
      serviceAccountName: external-dns
      securityContext:
        runAsNonRoot: true
        runAsUser: 65534
        seccompProfile:
          type: RuntimeDefault
      containers:
      - name: external-dns
        image: registry.k8s.io/external-dns/external-dns@sha256:3fcad62c4a9a8a72cb2db5ce7adeb121be66cac5f7f5ddad43684c2b20c72aa5
        imagePullPolicy: IfNotPresent
        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: true
          capabilities:
            drop:
              - ALL
        args:
        - --source=ingress
        - --domain-filter=lab.axiomlayer.com
        - --provider=cloudflare
        - --policy=upsert-only
        - --registry=txt
        - --txt-owner-id=homelab-k3s
        - --interval=1m
        - --log-level=info
        env:
        - name: CF_API_TOKEN
          valueFrom:
            secretKeyRef:
              name: cloudflare-api-token
              key: api-token
        resources:
          requests:
            cpu: 10m
            memory: 32Mi
          limits:
            cpu: 100m
            memory: 128Mi
        livenessProbe:
          httpGet:
            path: /healthz
            port: 7979
          initialDelaySeconds: 10
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /healthz
            port: 7979
          initialDelaySeconds: 5
          periodSeconds: 5
          timeoutSeconds: 3
          failureThreshold: 3
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: external-dns
resources:
  - namespace.yaml
  - rbac.yaml
  - deployment.yaml
  - sealed-secret.yaml
  - pdb.yaml
  - networkpolicy.yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: external-dns-default-deny
  namespace: external-dns
  labels:
    app.kubernetes.io/name: external-dns
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: external-dns-allow-egress
  namespace: external-dns
  labels:
    app.kubernetes.io/name: external-dns
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: external-dns
  policyTypes:
    - Egress
  egress:
    # Allow DNS resolution
    - to:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              k8s-app: kube-dns
      ports:
        - protocol: UDP
          port: 53
        - protocol: TCP
          port: 53
    # Allow Kubernetes API (for watching ingresses)
    - to:
        - ipBlock:
            cidr: 0.0.0.0/0
      ports:
        - protocol: TCP
          port: 6443
    # Allow Cloudflare API
    - to:
        - ipBlock:
            cidr: 0.0.0.0/0
            except:
              - 10.0.0.0/8
              - 172.16.0.0/12
              - 192.168.0.0/16
      ports:
        - protocol: TCP
          port: 443
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: cloudflare-api-token
  namespace: external-dns
spec:
  encryptedData:
    api-token: AgBjYvo+9K0dDl5IMBlU8mfTtKrTNQKh9Q6XVvJp/WL/M4+THO7Q0JmnDCi9iYAXk1oP8Vf+wwVhLOPLCq9qdR5yvoWg0Mz1S4rJiMKTJ52Bl2LjlTWa8LvfHG27STiQQW5spBD46ZxOkjvXGHPDHHn8LVFvX+MADR34coPxcR66WZ3oheXaHAUyb+VA6Mqh9yvka77OLBhNl9fdS0riwb3PkavJDvd+Qe7M/WQJlGJ1mExVfuUwdsGi5exWPOzMe+MBV6y/XaOej0RVDoP3ryLj5rIp3OJAomJGoBv+RSo2HIAfgfmQvFQnrPnxnZun64KYSSTH3bqaccILim/touCcQK5eoDLD08jZKPlA/XQDZtAoEMfyzi1MvKXPUSPNYiwvaLwTMpfNFREIquGp4ebPzekmpN3yJAAi6oY+wPEtwUIgbnK/Om9u9F/MfzzS5sp4ty4IK6yOMNz5+JaJRnf5GMbspjv1HipVJONs/fryQfmhMQmnBCoiSJBiuGrq86+wiJmmws7vybqgBF/QlcuufCvkXilBStzvfotjkGu7KlJSppAgBvu/tRBTsYqyGfDzmK/SxGQwtBbyA4vKKqPNWELMwRoFXNf+BLchHrgy1xlkMr13tCRxOXISoccL1yhcCMxWnkYQty/KtJD0Fo+MPpWFMNtfecVw75M0pS07yNm3IZPxvy1ec76KuNNNLnA=
  template:
    metadata:
      name: cloudflare-api-token
      namespace: external-dns
apiVersion: v1
kind: Namespace
metadata:
  name: actions-runner
  labels:
    app.kubernetes.io/name: actions-runner
    app.kubernetes.io/component: ci-cd
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: actions.summerwind.dev/v1alpha1
kind: RunnerDeployment
metadata:
  name: homelab-runners
  namespace: actions-runner
  labels:
    app.kubernetes.io/name: actions-runner
    app.kubernetes.io/component: runner
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  replicas: 1
  template:
    spec:
      repository: jasencdev/axiomlayer
      labels:
        - homelab
        - self-hosted
      serviceAccountName: actions-runner
      dockerEnabled: true
      resources:
        requests:
          cpu: 500m
          memory: 512Mi
        limits:
          cpu: 2000m
          memory: 2Gi
apiVersion: v1
kind: ServiceAccount
metadata:
  name: actions-runner
  namespace: actions-runner
  labels:
    app.kubernetes.io/name: actions-runner
    app.kubernetes.io/component: rbac
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: actions-runner-readonly
  labels:
    app.kubernetes.io/name: actions-runner
    app.kubernetes.io/component: rbac
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
rules:
  # Read-only access to core resources
  - apiGroups: [""]
    resources: ["nodes", "namespaces"]
    verbs: ["get", "list"]
  - apiGroups: [""]
    resources: ["pods", "pods/log"]
    verbs: ["get", "list"]
  - apiGroups: [""]
    resources: ["services", "endpoints"]
    verbs: ["get", "list"]
  - apiGroups: [""]
    resources: ["persistentvolumeclaims"]
    verbs: ["get", "list"]
  - apiGroups: [""]
    resources: ["configmaps", "secrets"]
    verbs: ["get", "list"]
  # Read-only access to apps
  - apiGroups: ["apps"]
    resources: ["deployments", "statefulsets", "daemonsets"]
    verbs: ["get", "list"]
  - apiGroups: ["batch"]
    resources: ["jobs", "cronjobs"]
    verbs: ["get", "list"]
  # Read-only access to networking
  - apiGroups: ["networking.k8s.io"]
    resources: ["ingresses", "networkpolicies"]
    verbs: ["get", "list"]
  # Read-only access to cert-manager
  - apiGroups: ["cert-manager.io"]
    resources: ["certificates", "clusterissuers", "issuers"]
    verbs: ["get", "list"]
  # Read-only access to ArgoCD
  - apiGroups: ["argoproj.io"]
    resources: ["applications", "applicationsets"]
    verbs: ["get", "list"]
  # Read-only access to CloudNativePG
  - apiGroups: ["postgresql.cnpg.io"]
    resources: ["clusters"]
    verbs: ["get", "list"]
  # Read-only access to Longhorn
  - apiGroups: ["longhorn.io"]
    resources: ["volumes", "nodes"]
    verbs: ["get", "list"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: actions-runner-readonly
  labels:
    app.kubernetes.io/name: actions-runner
    app.kubernetes.io/component: rbac
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
subjects:
  - kind: ServiceAccount
    name: actions-runner
    namespace: actions-runner
  # Also bind the default SA in case runners use that
  - kind: ServiceAccount
    name: default
    namespace: actions-runner
roleRef:
  kind: ClusterRole
  name: actions-runner-readonly
  apiGroup: rbac.authorization.k8s.io
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: actions-runner
resources:
  - namespace.yaml
  - rbac.yaml
  - sealed-secret.yaml
  - runner-deployment.yaml
labels:
  - pairs:
      app.kubernetes.io/managed-by: argocd
      app.kubernetes.io/part-of: homelab
    includeSelectors: false
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: github-arc-token
  namespace: actions-runner
spec:
  encryptedData:
    github_token: AgC5go07gLL7Cz7Bsfbb1v2PkTaZy1z/9AUfz9sSAkHPRjszxAUHeezk8uuaPk09IDPQpHD5eh0lDXBjV72FseQBM6i2DvC2DKOGdXsh/fdEO3UOkEcYK5An0JqFfrDFHkYJTHIrGFN0qne/Yu1/Z8Ij6nk5IOemvxbcza21okYze0eUibj2BOrd2DR41LDvGwy2b7IkTTC48fqbllT8LyYl9FdNSbt4AuDEndqrM1o1+Ly3laDdHtvq4sPVe2357BC60Cu9eNygzn8ul/d7lQDEGmmo/HP+Z1TuLQ/+Vd9r1WQfhMYclcxsPlaP97w/lKoHWqOmfddG+iBNqOLBEAbs+VF9l5oJuemInDcCZdtXtHUzUtbrg/sEe14hpd5fhm49Wgvb13J9VWKVRZB8w43KAwwVjPDwi0tjKXAFBwTA35gXEGMwt7lkWPIYr/nw6M16wlDqHKA0Eqz1yO7Zmcr0enuFZK4nYK58xn3F2b43BVQPzVogD9fBk6+WqJZEPK7lvHhXR2RlPfHQ3vh5BS0RgJk56IPzbERmH+i1R1zcciCdx0HBmChcoVFFsZA8R/IqQIsRYl3gOVAQhlcWKG6OfyGITeod6tOMPJ8HXjm/Xc3r+dic+D/pLKij1pU3SC5Zqp97JCaDlEhnTVGskws6iMjESD0GvGqwVEztr7MdkdQ0nSsRgh1FX8zJ+/vJ2lQ=
  template:
    metadata:
      name: github-arc-token
      namespace: actions-runner
apiVersion: v1
kind: Namespace
metadata:
  name: cert-manager
  labels:
    name: cert-manager
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - cluster-issuer.yaml
  - sealed-secret.yaml
  - networkpolicy.yaml
labels:
  - pairs:
      app.kubernetes.io/managed-by: argocd
      app.kubernetes.io/part-of: homelab
    includeSelectors: false
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-prod
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    email: jasen.c7@gmail.com
    privateKeySecretRef:
      name: letsencrypt-prod-account-key
    solvers:
    - dns01:
        cloudflare:
          apiTokenSecretRef:
            name: cloudflare-api-token
            key: api-token
      selector:
        dnsZones:
        - "axiomlayer.com"
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: cert-manager-default-deny
  namespace: cert-manager
  labels:
    app.kubernetes.io/name: cert-manager
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: cert-manager-allow-egress
  namespace: cert-manager
  labels:
    app.kubernetes.io/name: cert-manager
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/instance: cert-manager-helm
  policyTypes:
    - Egress
  egress:
    # Allow DNS resolution
    - to:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              k8s-app: kube-dns
      ports:
        - protocol: UDP
          port: 53
        - protocol: TCP
          port: 53
    # Allow communication with Kubernetes API server
    - to:
        - ipBlock:
            cidr: 0.0.0.0/0
      ports:
        - protocol: TCP
          port: 443
        - protocol: TCP
          port: 6443
    # Allow external DNS for DNS-01 challenge verification
    - to:
        - ipBlock:
            cidr: 0.0.0.0/0
            except:
              - 10.0.0.0/8
              - 172.16.0.0/12
              - 192.168.0.0/16
      ports:
        - protocol: UDP
          port: 53
        - protocol: TCP
          port: 53
    # Allow ACME HTTP-01 challenges (Let's Encrypt)
    - to:
        - ipBlock:
            cidr: 0.0.0.0/0
            except:
              - 10.0.0.0/8
              - 172.16.0.0/12
              - 192.168.0.0/16
      ports:
        - protocol: TCP
          port: 80
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: cert-manager-webhook-allow-ingress
  namespace: cert-manager
  labels:
    app.kubernetes.io/name: cert-manager
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/component: webhook
  policyTypes:
    - Ingress
  ingress:
    # Allow Kubernetes API server to call the webhook (10250 is the actual container port)
    - ports:
        - protocol: TCP
          port: 10250
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: cloudflare-api-token
  namespace: cert-manager
spec:
  encryptedData:
    api-token: AgCRurFPHDBTLQpNmwuQK2X/TrhGhNRlSKZ05hjkzU6OjIIKpmsk/Rw7/Hn5eb6wsD2utAIG6tyffWCl3FnKim4kX0mcJc01YnGLNJjjIfGS2b5/JIz4mtpDTUOqroMbO3Hlh3e/lSSS3LD9wta1o2JmhEJoFYCjvEVUp3J4dDRbq3e7RdG6o4qA6uneO/aTwCB4rGYNJ2+tggTszhnzYB7Mu9lnVIyYjN0QCn/x2gHs15ScPETfBI7Meaa4qTK0YkR/TrEDnOa04D7bdPVQ5KPpUhQBcVmbxa0uR3O9luOPti/3sbMrt8TQVCDsmsuEYTI6CJjzx4mr/6A2d2kA/7pMDbToppY+8LPDaOKYqLGZVfdUfsugcPAav/m+y7RY9+dBo+3FVpps2CTmqLkmhiiJN0ARQYzxw6lk8wc8NZr6CcGVDAp1N2sR0efYwLw96yzC25p1dFuhm9et0jBIwV+AduA6kfDeQniO+gWITxxrXz1kEUrjWcI51oUbsLA+Vom12A0nJnrU39IGQpHDCiAtjjBRj58lv9Gvz1Xn9XlxMRrICV2JVh0vEZMAGorXP/5i/dPUcz8br3MkbG4NneSMOznnfjsnpbSbQTrqptkfJJrWHbSNnf2vVyh7PrKA21pNomQ7dToAJ4SkVEZwUv2LnOG3AY1QrTYyRHvY1eArrw9Dem9w674FsqQnFkyhDjI=
  template:
    metadata:
      name: cloudflare-api-token
      namespace: cert-manager
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: secrets-unsealer
  labels:
    app.kubernetes.io/name: sealed-secrets
    app.kubernetes.io/component: controller
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
rules:
  - apiGroups:
      - bitnami.com
    resources:
      - sealedsecrets
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - bitnami.com
    resources:
      - sealedsecrets/status
    verbs:
      - update
  - apiGroups:
      - ""
    resources:
      - secrets
    verbs:
      - get
      - list
      - create
      - update
      - delete
      - watch
  - apiGroups:
      - ""
    resources:
      - events
    verbs:
      - create
      - patch
  - apiGroups:
      - ""
    resources:
      - namespaces
    verbs:
      - get
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: sealed-secrets-controller
  labels:
    app.kubernetes.io/name: sealed-secrets
    app.kubernetes.io/component: controller
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: secrets-unsealer
subjects:
  - kind: ServiceAccount
    name: sealed-secrets-controller
    namespace: kube-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: sealed-secrets-key-admin
  namespace: kube-system
  labels:
    app.kubernetes.io/name: sealed-secrets
    app.kubernetes.io/component: controller
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
rules:
  - apiGroups:
      - ""
    resources:
      - secrets
    verbs:
      - get
      - list
      - create
      - update
      - delete
      - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: sealed-secrets-key-admin
  namespace: kube-system
  labels:
    app.kubernetes.io/name: sealed-secrets
    app.kubernetes.io/component: controller
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: sealed-secrets-key-admin
subjects:
  - kind: ServiceAccount
    name: sealed-secrets-controller
    namespace: kube-system
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sealed-secrets-controller
  namespace: kube-system
  labels:
    app.kubernetes.io/name: sealed-secrets
    app.kubernetes.io/component: controller
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  replicas: 1
  minReadySeconds: 30
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app.kubernetes.io/name: sealed-secrets
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
  template:
    metadata:
      labels:
        app.kubernetes.io/name: sealed-secrets
        app.kubernetes.io/component: controller
    spec:
      serviceAccountName: sealed-secrets-controller
      securityContext:
        runAsNonRoot: true
        runAsUser: 1001
        fsGroup: 65534
        seccompProfile:
          type: RuntimeDefault
      terminationGracePeriodSeconds: 30
      containers:
        - name: sealed-secrets-controller
          image: docker.io/bitnami/sealed-secrets-controller:v0.24.5
          imagePullPolicy: IfNotPresent
          command:
            - controller
          ports:
            - name: http
              containerPort: 8080
              protocol: TCP
            - name: metrics
              containerPort: 8081
              protocol: TCP
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
            capabilities:
              drop:
                - ALL
          livenessProbe:
            httpGet:
              path: /healthz
              port: http
            initialDelaySeconds: 5
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /healthz
              port: http
            initialDelaySeconds: 5
            periodSeconds: 10
          resources:
            requests:
              cpu: 50m
              memory: 64Mi
            limits:
              memory: 128Mi
          volumeMounts:
            - name: tmp
              mountPath: /tmp
      volumes:
        - name: tmp
          emptyDir: {}
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - crd.yaml
  - serviceaccount.yaml
  - rbac.yaml
  - deployment.yaml
  - service.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: sealedsecrets.bitnami.com
  labels:
    app.kubernetes.io/name: sealed-secrets
    app.kubernetes.io/component: crd
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  group: bitnami.com
  names:
    kind: SealedSecret
    listKind: SealedSecretList
    plural: sealedsecrets
    singular: sealedsecret
  scope: Namespaced
  versions:
    - name: v1alpha1
      served: true
      storage: true
      subresources:
        status: {}
      schema:
        openAPIV3Schema:
          description: SealedSecret is the K8s representation of a "sealed Secret" - a regular k8s Secret that has been sealed (encrypted) using the controller's key.
          type: object
          required:
            - spec
          properties:
            apiVersion:
              description: APIVersion defines the versioned schema of this representation of an object.
              type: string
            kind:
              description: Kind is a string value representing the REST resource this object represents.
              type: string
            metadata:
              type: object
            spec:
              description: SealedSecretSpec is the specification of a SealedSecret
              type: object
              required:
                - encryptedData
              properties:
                data:
                  description: Data is deprecated. Use per-value EncryptedData instead.
                  type: string
                  format: byte
                encryptedData:
                  type: object
                  additionalProperties:
                    type: string
                  x-kubernetes-preserve-unknown-fields: true
                template:
                  description: Template defines the structure of the Secret that will be created.
                  type: object
                  properties:
                    data:
                      type: object
                      nullable: true
                      additionalProperties:
                        type: string
                    metadata:
                      type: object
                      nullable: true
                      x-kubernetes-preserve-unknown-fields: true
                      properties:
                        annotations:
                          type: object
                          additionalProperties:
                            type: string
                        finalizers:
                          type: array
                          items:
                            type: string
                        labels:
                          type: object
                          additionalProperties:
                            type: string
                        name:
                          type: string
                        namespace:
                          type: string
                    type:
                      description: Used to facilitate programmatic handling of secret data.
                      type: string
            status:
              description: SealedSecretStatus is the most recently observed status of the SealedSecret.
              type: object
              properties:
                conditions:
                  description: Represents the latest available observations of a sealed secret's current state.
                  type: array
                  items:
                    type: object
                    required:
                      - status
                      - type
                    properties:
                      lastTransitionTime:
                        type: string
                        format: date-time
                      lastUpdateTime:
                        type: string
                        format: date-time
                      message:
                        type: string
                      reason:
                        type: string
                      status:
                        type: string
                      type:
                        type: string
                observedGeneration:
                  type: integer
                  format: int64
apiVersion: v1
kind: Service
metadata:
  name: sealed-secrets-controller
  namespace: kube-system
  labels:
    app.kubernetes.io/name: sealed-secrets
    app.kubernetes.io/component: controller
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  selector:
    app.kubernetes.io/name: sealed-secrets
  ports:
    - name: http
      port: 8080
      targetPort: http
      protocol: TCP
---
apiVersion: v1
kind: Service
metadata:
  name: sealed-secrets-controller-metrics
  namespace: kube-system
  labels:
    app.kubernetes.io/name: sealed-secrets
    app.kubernetes.io/component: controller
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  selector:
    app.kubernetes.io/name: sealed-secrets
  ports:
    - name: metrics
      port: 8081
      targetPort: metrics
      protocol: TCP
apiVersion: v1
kind: ServiceAccount
metadata:
  name: sealed-secrets-controller
  namespace: kube-system
  labels:
    app.kubernetes.io/name: sealed-secrets
    app.kubernetes.io/component: controller
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: alertmanager
  namespace: alertmanager
  labels:
    app.kubernetes.io/name: alertmanager
    app.kubernetes.io/component: alerting
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  minAvailable: 0
  selector:
    matchLabels:
      app.kubernetes.io/name: alertmanager
apiVersion: v1
kind: Namespace
metadata:
  name: alertmanager
  labels:
    app.kubernetes.io/name: alertmanager
    app.kubernetes.io/component: alerting
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: apps/v1
kind: Deployment
metadata:
  name: alertmanager
  namespace: alertmanager
  labels:
    app.kubernetes.io/name: alertmanager
    app.kubernetes.io/component: alerting
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: alertmanager
  template:
    metadata:
      labels:
        app.kubernetes.io/name: alertmanager
        app.kubernetes.io/component: alerting
        app.kubernetes.io/part-of: homelab
    spec:
      securityContext:
        runAsNonRoot: true
        runAsUser: 65534
        fsGroup: 65534
        seccompProfile:
          type: RuntimeDefault
      containers:
        - name: alertmanager
          image: prom/alertmanager@sha256:e13b6ed5cb929eeaee733479dce55e10eb3bc2e9c4586c705a4e8da41e5eacf5
          args:
            - --config.file=/etc/alertmanager/alertmanager.yml
            - --storage.path=/alertmanager
            - --web.external-url=https://alerts.lab.axiomlayer.com
          ports:
            - containerPort: 9093
              name: http
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
            capabilities:
              drop: ["ALL"]
          resources:
            requests:
              cpu: 10m
              memory: 32Mi
            limits:
              cpu: 100m
              memory: 128Mi
          volumeMounts:
            - name: config
              mountPath: /etc/alertmanager
            - name: data
              mountPath: /alertmanager
          livenessProbe:
            httpGet:
              path: /-/healthy
              port: 9093
            initialDelaySeconds: 10
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /-/ready
              port: 9093
            initialDelaySeconds: 5
            periodSeconds: 5
      volumes:
        - name: config
          configMap:
            name: alertmanager-config
        - name: data
          emptyDir: {}
apiVersion: v1
kind: ConfigMap
metadata:
  name: prometheus-alert-rules
  namespace: monitoring
  labels:
    app.kubernetes.io/name: prometheus
    app.kubernetes.io/component: rules
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
data:
  homelab-alerts.yml: |
    groups:
      - name: homelab-node-alerts
        rules:
          - alert: NodeDown
            expr: up{job="node-exporter"} == 0
            for: 2m
            labels:
              severity: critical
            annotations:
              summary: "Node {{ $labels.instance }} is down"
              description: "Node has been unreachable for more than 2 minutes."

          - alert: NodeHighCPU
            expr: 100 - (avg by(instance) (irate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 80
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "High CPU usage on {{ $labels.instance }}"
              description: "CPU usage is above 80% for more than 5 minutes."

          - alert: NodeHighMemory
            expr: (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100 > 85
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "High memory usage on {{ $labels.instance }}"
              description: "Memory usage is above 85% for more than 5 minutes."

          - alert: NodeDiskSpaceLow
            expr: (node_filesystem_avail_bytes{fstype!~"tmpfs|overlay"} / node_filesystem_size_bytes) * 100 < 15
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "Low disk space on {{ $labels.instance }}"
              description: "Disk space is below 15% on {{ $labels.mountpoint }}."

          - alert: NodeDiskSpaceCritical
            expr: (node_filesystem_avail_bytes{fstype!~"tmpfs|overlay"} / node_filesystem_size_bytes) * 100 < 5
            for: 2m
            labels:
              severity: critical
            annotations:
              summary: "Critical disk space on {{ $labels.instance }}"
              description: "Disk space is below 5% on {{ $labels.mountpoint }}."

      - name: homelab-kubernetes-alerts
        rules:
          - alert: PodCrashLooping
            expr: rate(kube_pod_container_status_restarts_total[15m]) * 60 * 15 > 3
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "Pod {{ $labels.namespace }}/{{ $labels.pod }} is crash looping"
              description: "Pod has restarted more than 3 times in the last 15 minutes."

          - alert: PodNotReady
            expr: kube_pod_status_ready{condition="true"} == 0
            for: 10m
            labels:
              severity: warning
            annotations:
              summary: "Pod {{ $labels.namespace }}/{{ $labels.pod }} is not ready"
              description: "Pod has been in a non-ready state for more than 10 minutes."

          - alert: DeploymentReplicasMismatch
            expr: kube_deployment_spec_replicas != kube_deployment_status_replicas_available
            for: 10m
            labels:
              severity: warning
            annotations:
              summary: "Deployment {{ $labels.namespace }}/{{ $labels.deployment }} has mismatched replicas"
              description: "Deployment does not have the expected number of replicas."

          - alert: PersistentVolumeSpaceLow
            expr: kubelet_volume_stats_available_bytes / kubelet_volume_stats_capacity_bytes < 0.15
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "PV {{ $labels.persistentvolumeclaim }} is running low on space"
              description: "Persistent volume has less than 15% space remaining."

      - name: homelab-certificate-alerts
        rules:
          - alert: CertificateExpiringSoon
            expr: certmanager_certificate_expiration_timestamp_seconds - time() < 604800
            for: 1h
            labels:
              severity: warning
            annotations:
              summary: "Certificate {{ $labels.name }} expires in less than 7 days"
              description: "TLS certificate will expire soon, check cert-manager."

          - alert: CertificateExpiryCritical
            expr: certmanager_certificate_expiration_timestamp_seconds - time() < 86400
            for: 10m
            labels:
              severity: critical
            annotations:
              summary: "Certificate {{ $labels.name }} expires in less than 24 hours"
              description: "TLS certificate is about to expire!"

      - name: homelab-longhorn-alerts
        rules:
          - alert: LonghornVolumeHealthy
            expr: longhorn_volume_state{state!="attached"} == 1
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "Longhorn volume {{ $labels.volume }} is not attached"
              description: "Volume is in an unhealthy state."

          - alert: LonghornNodeDown
            expr: longhorn_node_status{condition="ready"} == 0
            for: 5m
            labels:
              severity: critical
            annotations:
              summary: "Longhorn node {{ $labels.node }} is not ready"
              description: "Storage node is down, replication may be affected."
apiVersion: v1
kind: ConfigMap
metadata:
  name: alertmanager-config
  namespace: alertmanager
  labels:
    app.kubernetes.io/name: alertmanager
    app.kubernetes.io/component: alerting
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
data:
  alertmanager.yml: |
    global:
      resolve_timeout: 5m

    route:
      group_by: ['alertname', 'namespace', 'severity']
      group_wait: 30s
      group_interval: 5m
      repeat_interval: 4h
      receiver: 'default'
      routes:
        - match:
            severity: critical
          receiver: 'critical'
          continue: true
        - match:
            severity: warning
          receiver: 'default'

    receivers:
      - name: 'default'
        # Webhook receiver - can integrate with n8n
        webhook_configs:
          - url: 'http://n8n.n8n.svc:5678/webhook/alerts'
            send_resolved: true

      - name: 'critical'
        webhook_configs:
          - url: 'http://n8n.n8n.svc:5678/webhook/alerts-critical'
            send_resolved: true

    inhibit_rules:
      - source_match:
          severity: 'critical'
        target_match:
          severity: 'warning'
        equal: ['alertname', 'namespace']
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: alertmanager
resources:
  - namespace.yaml
  - configmap.yaml
  - deployment.yaml
  - service.yaml
  - certificate.yaml
  - ingress.yaml
  - prometheus-rules.yaml
  - pdb.yaml
  - networkpolicy.yaml
labels:
  - pairs:
      app.kubernetes.io/managed-by: argocd
      app.kubernetes.io/part-of: homelab
    includeSelectors: false
apiVersion: v1
kind: Service
metadata:
  name: alertmanager
  namespace: alertmanager
  labels:
    app.kubernetes.io/name: alertmanager
    app.kubernetes.io/component: alerting
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  selector:
    app.kubernetes.io/name: alertmanager
  ports:
    - port: 9093
      targetPort: 9093
      name: http
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: alertmanager-tls
  namespace: alertmanager
  labels:
    app.kubernetes.io/name: alertmanager
    app.kubernetes.io/component: tls
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  secretName: alertmanager-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - alerts.lab.axiomlayer.com
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: alertmanager-default-deny
  namespace: alertmanager
  labels:
    app.kubernetes.io/name: alertmanager
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: alertmanager-allow-ingress
  namespace: alertmanager
  labels:
    app.kubernetes.io/name: alertmanager
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: alertmanager
  policyTypes:
    - Ingress
  ingress:
    # Allow traffic from Traefik ingress controller
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: kube-system
          podSelector:
            matchLabels:
              app.kubernetes.io/name: traefik
      ports:
        - protocol: TCP
          port: 9093
    # Allow Prometheus to send alerts
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: monitoring
      ports:
        - protocol: TCP
          port: 9093
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: alertmanager-allow-egress
  namespace: alertmanager
  labels:
    app.kubernetes.io/name: alertmanager
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: alertmanager
  policyTypes:
    - Egress
  egress:
    # Allow DNS resolution
    - to:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              k8s-app: kube-dns
      ports:
        - protocol: UDP
          port: 53
        - protocol: TCP
          port: 53
    # Allow external notifications (email, slack, etc.)
    - to:
        - ipBlock:
            cidr: 0.0.0.0/0
            except:
              - 10.0.0.0/8
              - 172.16.0.0/12
              - 192.168.0.0/16
      ports:
        - protocol: TCP
          port: 443
        - protocol: TCP
          port: 587
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: alertmanager
  namespace: alertmanager
  labels:
    app.kubernetes.io/name: alertmanager
    app.kubernetes.io/component: alerting
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
    traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
spec:
  ingressClassName: traefik
  tls:
    - hosts:
        - alerts.lab.axiomlayer.com
      secretName: alertmanager-tls
  rules:
    - host: alerts.lab.axiomlayer.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: alertmanager
                port:
                  number: 9093
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: open-webui
  namespace: open-webui
  labels:
    app.kubernetes.io/name: open-webui
    app.kubernetes.io/component: ai-interface
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  minAvailable: 0
  selector:
    matchLabels:
      app.kubernetes.io/name: open-webui
apiVersion: v1
kind: Namespace
metadata:
  name: open-webui
  labels:
    app.kubernetes.io/name: open-webui
    app.kubernetes.io/component: ai-interface
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: apps/v1
kind: Deployment
metadata:
  name: open-webui
  namespace: open-webui
  labels:
    app.kubernetes.io/name: open-webui
    app.kubernetes.io/component: ai-interface
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: open-webui
  template:
    metadata:
      labels:
        app.kubernetes.io/name: open-webui
        app.kubernetes.io/component: ai-interface
        app.kubernetes.io/part-of: homelab
    spec:
      securityContext:
        runAsNonRoot: true
        runAsUser: 1000
        fsGroup: 1000
        seccompProfile:
          type: RuntimeDefault
      containers:
        - name: open-webui
          image: ghcr.io/open-webui/open-webui@sha256:c0297cf2f76e0ba21d19eb3a21753d3b271c0247694cba3948677d2a97ec559f
          ports:
            - containerPort: 8080
              name: http
          envFrom:
            - configMapRef:
                name: open-webui-config
            - secretRef:
                name: open-webui-secret
          env:
            - name: DATABASE_URL
              valueFrom:
                secretKeyRef:
                  name: open-webui-db-app
                  key: uri
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
            capabilities:
              drop: ["ALL"]
          resources:
            requests:
              cpu: 100m
              memory: 512Mi
            limits:
              cpu: 1000m
              memory: 2Gi
          volumeMounts:
            - name: data
              mountPath: /app/backend/data
            - name: tmp
              mountPath: /tmp
            - name: static
              mountPath: /app/backend/open_webui/static
          livenessProbe:
            httpGet:
              path: /health
              port: 8080
            initialDelaySeconds: 30
            periodSeconds: 30
            timeoutSeconds: 10
          readinessProbe:
            httpGet:
              path: /health
              port: 8080
            initialDelaySeconds: 10
            periodSeconds: 10
            timeoutSeconds: 5
      volumes:
        - name: data
          persistentVolumeClaim:
            claimName: open-webui-data
        - name: tmp
          emptyDir: {}
        - name: static
          emptyDir: {}
apiVersion: v1
kind: ConfigMap
metadata:
  name: open-webui-config
  namespace: open-webui
  labels:
    app.kubernetes.io/name: open-webui
    app.kubernetes.io/component: config
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
data:
  # Ollama connection (siberian workstation via Tailscale)
  OLLAMA_BASE_URL: "http://100.115.3.88:11434"
  # RAG/Embedding configuration (panther node)
  RAG_EMBEDDING_ENGINE: "ollama"
  RAG_EMBEDDING_MODEL: "granite4:3b"
  RAG_OLLAMA_BASE_URL: "http://100.79.124.94:11434"
  # WebUI settings
  WEBUI_NAME: "AxiomLayer AI"
  WEBUI_URL: "https://ai.lab.axiomlayer.com"
  # Auth - allow signup for first user, then disable
  ENABLE_SIGNUP: "true"
  DEFAULT_USER_ROLE: "user"
  # Disable OpenAI by default
  ENABLE_OPENAI_API: "false"
  # Data directory
  DATA_DIR: "/app/backend/data"
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: open-webui
resources:
  - namespace.yaml
  - pvc.yaml
  - configmap.yaml
  - sealed-secret.yaml
  - postgres-cluster.yaml
  - deployment.yaml
  - service.yaml
  - certificate.yaml
  - ingress.yaml
  - networkpolicy.yaml
  - pdb.yaml
labels:
  - pairs:
      app.kubernetes.io/managed-by: argocd
      app.kubernetes.io/part-of: homelab
    includeSelectors: false
apiVersion: v1
kind: Service
metadata:
  name: open-webui
  namespace: open-webui
  labels:
    app.kubernetes.io/name: open-webui
    app.kubernetes.io/component: ai-interface
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  selector:
    app.kubernetes.io/name: open-webui
  ports:
    - port: 8080
      targetPort: 8080
      name: http
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: open-webui-tls
  namespace: open-webui
  labels:
    app.kubernetes.io/name: open-webui
    app.kubernetes.io/component: tls
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  secretName: open-webui-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - ai.lab.axiomlayer.com
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: open-webui-db
  namespace: open-webui
  labels:
    app.kubernetes.io/name: open-webui-db
    app.kubernetes.io/component: database
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  instances: 1

  storage:
    size: 10Gi
    storageClass: longhorn

  postgresql:
    parameters:
      max_connections: "100"
      shared_buffers: "256MB"

  bootstrap:
    initdb:
      database: openwebui
      owner: openwebui

  monitoring:
    enablePodMonitor: true
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: open-webui-default-deny
  namespace: open-webui
  labels:
    app.kubernetes.io/name: open-webui
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: open-webui-allow-ingress
  namespace: open-webui
  labels:
    app.kubernetes.io/name: open-webui
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: open-webui
  policyTypes:
    - Ingress
  ingress:
    # Allow traffic from Traefik ingress controller
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: kube-system
          podSelector:
            matchLabels:
              app.kubernetes.io/name: traefik
      ports:
        - protocol: TCP
          port: 8080
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: open-webui-allow-egress
  namespace: open-webui
  labels:
    app.kubernetes.io/name: open-webui
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: open-webui
  policyTypes:
    - Egress
  egress:
    # Allow DNS resolution
    - to:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              k8s-app: kube-dns
      ports:
        - protocol: UDP
          port: 53
        - protocol: TCP
          port: 53
    # Allow Ollama API on siberian via Tailscale (generation)
    - to:
        - ipBlock:
            cidr: 100.115.3.88/32
      ports:
        - protocol: TCP
          port: 11434
    # Allow Ollama API on panther via Tailscale (embeddings)
    - to:
        - ipBlock:
            cidr: 100.79.124.94/32
      ports:
        - protocol: TCP
          port: 11434
    # Allow Authentik for SSO (in authentik namespace)
    - to:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: authentik
      ports:
        - protocol: TCP
          port: 9000
        - protocol: TCP
          port: 9443
    # Allow PostgreSQL within namespace
    - to:
        - podSelector:
            matchLabels:
              cnpg.io/cluster: open-webui-db
      ports:
        - protocol: TCP
          port: 5432
---
# Allow CloudNativePG pods to receive connections
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: open-webui-db-allow
  namespace: open-webui
  labels:
    app.kubernetes.io/name: open-webui
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      cnpg.io/cluster: open-webui-db
  policyTypes:
    - Ingress
    - Egress
  ingress:
    # Allow open-webui app to connect
    - from:
        - podSelector:
            matchLabels:
              app.kubernetes.io/name: open-webui
      ports:
        - protocol: TCP
          port: 5432
    # Allow CNPG operator
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: cnpg-system
      ports:
        - protocol: TCP
          port: 5432
        - protocol: TCP
          port: 8000
  egress:
    # Allow DNS
    - to:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              k8s-app: kube-dns
      ports:
        - protocol: UDP
          port: 53
        - protocol: TCP
          port: 53
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: open-webui-secrets
  namespace: open-webui
spec:
  encryptedData:
    secret-key: AgB0gRNfotRmeOlISWEW1+Jmzn5ZGddEPaQPUV02FkfHLHf+uWQJveB1saKeWY2PvlNj45fBURcyWy6jg3f2fZfJKMLWbsLSM4HPfkJnqayB9AkA8oaxtucvxOIiIqLEIiF4Q9chIxOfznzy46F0AXmYyNYjsC8RV84hYI13iZ0dRdsKtZqHNHJsOHVPUpuOQL6S2SMnlzceQxhQXmFdaPJ6xUDZmO3ufpN1C7vJpNNDpUQQdoA78f5Q6LVmavHnoJIx/sGa8JFSFjE+1E1t++5IAn6kxEI80Y6ZW8XW3k4GVh8fSpuHrnBMCte2FkSdROmqe42F+qcufSm3LkpqllGkb+PX52izKwvdYAVkW/+GCRLtKHS0l3WhpjSrlYrnq6CusexCZ0TQeltZHETvDvIQ0gjTINSk1nCRV8WfdW/HfsLsFgOjNKlkkSligOWTQubYFAuYT0znhFzE0IML8phCnbxSLYDhcGZTAruhOYH08T27UuY56WOl8IUPkuW0l24QpFSODhOpROfb0T+9c4371rGmxHkiWZOHribdGtKu65aupU8GZO80Z/SVkS9RLEe/hSh/LF5aEg5WGiXaqD8LetdQZdC9TSJrWGGY6kYmhZqPSE770GuHPft5WkIWe0km/tSk7tfOzb/5uIpCtg3HYCNi4z8qkS+nJo7L5kXD0jnwGgYFDYU5ViVuW/I/hBI=
  template:
    metadata:
      name: open-webui-secrets
      namespace: open-webui
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: open-webui-data
  namespace: open-webui
  labels:
    app.kubernetes.io/name: open-webui
    app.kubernetes.io/component: storage
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: longhorn
  resources:
    requests:
      storage: 5Gi
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: open-webui
  namespace: open-webui
  labels:
    app.kubernetes.io/name: open-webui
    app.kubernetes.io/component: ai-interface
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
    traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
spec:
  ingressClassName: traefik
  tls:
    - hosts:
        - ai.lab.axiomlayer.com
      secretName: open-webui-tls
  rules:
    - host: ai.lab.axiomlayer.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: open-webui
                port:
                  number: 8080
---
# Separate ingress for WebSocket without auth (uses session cookie for auth)
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: open-webui-ws
  namespace: open-webui
  labels:
    app.kubernetes.io/name: open-webui
    app.kubernetes.io/component: websocket
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
spec:
  ingressClassName: traefik
  tls:
    - hosts:
        - ai.lab.axiomlayer.com
      secretName: open-webui-tls
  rules:
    - host: ai.lab.axiomlayer.com
      http:
        paths:
          - path: /ws
            pathType: Prefix
            backend:
              service:
                name: open-webui
                port:
                  number: 8080
apiVersion: v1
kind: Namespace
metadata:
  name: longhorn-system
  labels:
    name: longhorn-system
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - certificate.yaml
  - ingress.yaml
labels:
  - pairs:
      app.kubernetes.io/managed-by: argocd
      app.kubernetes.io/part-of: homelab
    includeSelectors: false
# Note: Longhorn installed via Helm
# helm install longhorn longhorn/longhorn -n longhorn-system
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: longhorn-tls
  namespace: longhorn-system
  labels:
    app.kubernetes.io/name: longhorn
    app.kubernetes.io/component: ui
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  secretName: longhorn-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - longhorn.lab.axiomlayer.com
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: longhorn
  namespace: longhorn-system
  labels:
    app.kubernetes.io/name: longhorn
    app.kubernetes.io/component: ui
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
  annotations:
    traefik.ingress.kubernetes.io/router.middlewares: authentik-ak-outpost-forward-auth-outpost@kubernetescrd
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
spec:
  ingressClassName: traefik
  tls:
    - hosts:
        - longhorn.lab.axiomlayer.com
      secretName: longhorn-tls
  rules:
    - host: longhorn.lab.axiomlayer.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: longhorn-frontend
                port:
                  number: 80
apiVersion: v1
kind: Namespace
metadata:
  name: authentik
  labels:
    name: authentik
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ak-outpost-forward-auth-outpost
  namespace: authentik
  labels:
    app.kubernetes.io/name: authentik-outpost
    app.kubernetes.io/component: outpost
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
    goauthentik.io/outpost-name: forward-auth-outpost
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: authentik-outpost
      goauthentik.io/outpost-name: forward-auth-outpost
  template:
    metadata:
      labels:
        app.kubernetes.io/name: authentik-outpost
        goauthentik.io/outpost-name: forward-auth-outpost
    spec:
      containers:
        - name: proxy
          image: ghcr.io/goauthentik/proxy:2025.10.2
          ports:
            - containerPort: 9000
              name: http
              protocol: TCP
            - containerPort: 9443
              name: https
              protocol: TCP
          env:
            - name: AUTHENTIK_HOST
              value: "https://auth.lab.axiomlayer.com"
            - name: AUTHENTIK_INSECURE
              value: "false"
            - name: AUTHENTIK_TOKEN
              valueFrom:
                secretKeyRef:
                  name: authentik-outpost-token
                  key: token
          resources:
            requests:
              cpu: 100m
              memory: 128Mi
            limits:
              cpu: 500m
              memory: 256Mi
          livenessProbe:
            httpGet:
              path: /outpost.goauthentik.io/ping
              port: 9300
            initialDelaySeconds: 10
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /outpost.goauthentik.io/ping
              port: 9300
            initialDelaySeconds: 5
            periodSeconds: 5
---
apiVersion: v1
kind: Service
metadata:
  name: ak-outpost-forward-auth-outpost
  namespace: authentik
  labels:
    app.kubernetes.io/name: authentik-outpost
    app.kubernetes.io/component: outpost
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  type: ClusterIP
  selector:
    app.kubernetes.io/name: authentik-outpost
    goauthentik.io/outpost-name: forward-auth-outpost
  ports:
    - name: http
      port: 9000
      targetPort: http
    - name: https
      port: 9443
      targetPort: https
---
apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: ak-outpost-forward-auth-outpost
  namespace: authentik
  labels:
    app.kubernetes.io/name: authentik-outpost
    app.kubernetes.io/component: middleware
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  forwardAuth:
    address: http://ak-outpost-forward-auth-outpost.authentik.svc.cluster.local:9000/outpost.goauthentik.io/auth/traefik
    trustForwardHeader: true
    authResponseHeaders:
      - X-authentik-username
      - X-authentik-groups
      - X-authentik-email
      - X-authentik-name
      - X-authentik-uid
      - X-authentik-jwt
      - X-authentik-meta-jwks
      - X-authentik-meta-outpost
      - X-authentik-meta-provider
      - X-authentik-meta-app
      - X-authentik-meta-version
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: authentik-outpost-management
  labels:
    app.kubernetes.io/name: authentik
    app.kubernetes.io/component: rbac
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
rules:
  # Core resources for outpost deployment
  - apiGroups: [""]
    resources: ["namespaces", "pods", "services", "secrets", "configmaps", "serviceaccounts"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  # Deployment management
  - apiGroups: ["apps"]
    resources: ["deployments", "statefulsets", "daemonsets", "replicasets"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  # Ingress management
  - apiGroups: ["networking.k8s.io"]
    resources: ["ingresses"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  # RBAC for outpost service accounts
  - apiGroups: ["rbac.authorization.k8s.io"]
    resources: ["roles", "rolebindings"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
  # CRD discovery
  - apiGroups: ["apiextensions.k8s.io"]
    resources: ["customresourcedefinitions"]
    verbs: ["list"]
  # Traefik middleware for forward auth
  - apiGroups: ["traefik.io", "traefik.containo.us"]
    resources: ["middlewares"]
    verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: authentik-outpost-management
  labels:
    app.kubernetes.io/name: authentik
    app.kubernetes.io/component: rbac
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: authentik-outpost-management
subjects:
  - kind: ServiceAccount
    name: authentik
    namespace: authentik
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - certificate.yaml
  - sealed-secret.yaml
  - postgres-cluster.yaml
  - blueprints-configmap.yaml
  - rbac.yaml
  - outpost.yaml
  - outpost-token-sealed-secret.yaml
labels:
  - pairs:
      app.kubernetes.io/managed-by: argocd
      app.kubernetes.io/part-of: homelab
    includeSelectors: false
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: authentik-tls
  namespace: authentik
spec:
  secretName: authentik-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - auth.lab.axiomlayer.com
# Authentik Blueprint for Homelab Applications
# Each application has its own provider for proper isolation
version: 1
metadata:
  name: Homelab Applications
  labels:
    blueprints.goauthentik.io/description: "All homelab application definitions"
entries:
  # ===================
  # User Groups
  # ===================
  - model: authentik_core.group
    id: group-admins
    identifiers:
      name: Homelab Admins
    attrs:
      is_superuser: false

  - model: authentik_core.group
    id: group-users
    identifiers:
      name: Homelab Users
    attrs:
      is_superuser: false

  # ===================
  # Users
  # ===================
  - model: authentik_core.user
    id: user-jasen
    identifiers:
      username: jasen
    attrs:
      name: Jasen
      email: jasen@axiomlayer.com
      is_active: true
      groups:
        - !KeyOf group-admins
        - !KeyOf group-users

  # ===================
  # Proxy Providers (Forward Auth - one per app)
  # ===================
  - model: authentik_providers_proxy.proxyprovider
    id: provider-dashboard
    identifiers:
      name: Dashboard Proxy Provider
    attrs:
      authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
      invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
      mode: forward_single
      external_host: https://db.lab.axiomlayer.com

  - model: authentik_providers_proxy.proxyprovider
    id: provider-n8n
    identifiers:
      name: n8n Proxy Provider
    attrs:
      authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
      invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
      mode: forward_single
      external_host: https://autom8.lab.axiomlayer.com

  - model: authentik_providers_proxy.proxyprovider
    id: provider-open-webui
    identifiers:
      name: Open WebUI Proxy Provider
    attrs:
      authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
      invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
      mode: forward_single
      external_host: https://ai.lab.axiomlayer.com

  - model: authentik_providers_proxy.proxyprovider
    id: provider-campfire
    identifiers:
      name: Campfire Proxy Provider
    attrs:
      authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
      invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
      mode: forward_single
      external_host: https://chat.lab.axiomlayer.com

  - model: authentik_providers_proxy.proxyprovider
    id: provider-alertmanager
    identifiers:
      name: Alertmanager Proxy Provider
    attrs:
      authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
      invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
      mode: forward_single
      external_host: https://alerts.lab.axiomlayer.com

  - model: authentik_providers_proxy.proxyprovider
    id: provider-longhorn
    identifiers:
      name: Longhorn Proxy Provider
    attrs:
      authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
      invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
      mode: forward_single
      external_host: https://longhorn.lab.axiomlayer.com

  - model: authentik_providers_proxy.proxyprovider
    id: provider-telnet
    identifiers:
      name: Telnet Server Proxy Provider
    attrs:
      authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
      invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
      mode: forward_single
      external_host: https://telnet.lab.axiomlayer.com

  # ===================
  # OIDC Providers (Native SSO)
  # ===================
  - model: authentik_providers_oauth2.oauth2provider
    id: provider-argocd
    identifiers:
      name: ArgoCD OIDC Provider
    attrs:
      authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
      invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
      client_type: confidential
      client_id: argocd
      client_secret: "11190a6436c58bfdce05e788c52d38d9a56db18d17417d8b1f31f161b6be622a"
      redirect_uris:
        - matching_mode: strict
          url: https://argocd.lab.axiomlayer.com/auth/callback
      access_token_validity: hours=1
      refresh_token_validity: days=30
      include_claims_in_id_token: true
      sub_mode: user_email
      signing_key: !Find [authentik_crypto.certificatekeypair, [name, authentik Self-signed Certificate]]

  - model: authentik_providers_oauth2.oauth2provider
    id: provider-grafana
    identifiers:
      name: Grafana OAuth2 Provider
    attrs:
      authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
      invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
      client_type: confidential
      client_id: grafana
      client_secret: "b023d23d0199ab3e85ccb1a31dd861ca0e45cebbc8ae5cd992bd93643a4df409"
      redirect_uris:
        - matching_mode: strict
          url: https://grafana.lab.axiomlayer.com/login/generic_oauth
      access_token_validity: hours=1
      refresh_token_validity: days=30
      include_claims_in_id_token: true
      sub_mode: user_email
      signing_key: !Find [authentik_crypto.certificatekeypair, [name, authentik Self-signed Certificate]]

  - model: authentik_providers_oauth2.oauth2provider
    id: provider-outline
    identifiers:
      name: Outline OIDC Provider
    attrs:
      authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
      invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
      client_type: confidential
      client_id: outline
      client_secret: "585d48f4a5e90c66d467c581766f05c13c7fa440e5172b95a144a6bdac232c6b"
      redirect_uris:
        - matching_mode: strict
          url: https://docs.lab.axiomlayer.com/auth/oidc.callback
      access_token_validity: hours=1
      refresh_token_validity: days=30
      include_claims_in_id_token: true
      sub_mode: user_email
      signing_key: !Find [authentik_crypto.certificatekeypair, [name, authentik Self-signed Certificate]]

  - model: authentik_providers_oauth2.oauth2provider
    id: provider-plane
    identifiers:
      name: Plane OIDC Provider
    attrs:
      authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
      invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
      client_type: confidential
      client_id: plane
      client_secret: "plane-oidc-secret-change-me"
      redirect_uris:
        - matching_mode: strict
          url: https://plane.lab.axiomlayer.com/auth/oidc/callback/
      access_token_validity: hours=1
      refresh_token_validity: days=30
      include_claims_in_id_token: true
      sub_mode: user_email
      signing_key: !Find [authentik_crypto.certificatekeypair, [name, authentik Self-signed Certificate]]

  # ===================
  # Kubernetes Service Connection (for outpost deployment)
  # ===================
  - model: authentik_outposts.kubernetesserviceconnection
    id: k8s-local
    identifiers:
      name: Local Kubernetes
    attrs:
      local: true
      verify_ssl: true

  # ===================
  # Outpost (Forward Auth)
  # ===================
  - model: authentik_outposts.outpost
    id: outpost-forward-auth
    identifiers:
      name: forward-auth-outpost
    attrs:
      type: proxy
      service_connection: !KeyOf k8s-local
      providers:
        - !KeyOf provider-dashboard
        - !KeyOf provider-n8n
        - !KeyOf provider-open-webui
        - !KeyOf provider-campfire
        - !KeyOf provider-alertmanager
        - !KeyOf provider-longhorn
        - !KeyOf provider-telnet
      config:
        authentik_host: https://auth.lab.axiomlayer.com
        docker_labels: null
        docker_map_ports: true
        docker_network: null
        container_image: null
        kubernetes_replicas: 1
        kubernetes_namespace: authentik
        kubernetes_ingress_annotations:
          traefik.ingress.kubernetes.io/router.entrypoints: websecure
        kubernetes_ingress_secret_name: ak-outpost-forward-auth-tls
        kubernetes_service_type: ClusterIP
        object_naming_template: ak-outpost-%(name)s

  # ===================
  # Applications - Platform
  # ===================
  - model: authentik_core.application
    id: app-dashboard
    identifiers:
      slug: dashboard
    attrs:
      name: Dashboard
      provider: !KeyOf provider-dashboard
      meta_launch_url: https://db.lab.axiomlayer.com
      meta_icon: https://cdn-icons-png.flaticon.com/512/1828/1828765.png
      meta_description: Homelab service dashboard
      policy_engine_mode: any
      group: Platform

  - model: authentik_core.application
    id: app-argocd
    identifiers:
      slug: argocd
    attrs:
      name: ArgoCD
      provider: !KeyOf provider-argocd
      meta_launch_url: https://argocd.lab.axiomlayer.com
      meta_icon: https://argo-cd.readthedocs.io/en/stable/assets/logo.png
      meta_description: GitOps continuous delivery
      policy_engine_mode: any
      group: Platform

  - model: authentik_core.application
    id: app-authentik
    identifiers:
      slug: authentik
    attrs:
      name: Authentik
      meta_launch_url: https://auth.lab.axiomlayer.com
      meta_icon: https://goauthentik.io/img/icon.png
      meta_description: Identity provider and SSO
      policy_engine_mode: any
      group: Platform

  # ===================
  # Applications - Apps
  # ===================
  - model: authentik_core.application
    id: app-plane
    identifiers:
      slug: plane
    attrs:
      name: Plane
      provider: !KeyOf provider-plane
      meta_launch_url: https://plane.lab.axiomlayer.com
      meta_icon: https://plane.so/favicon.ico
      meta_description: Project management and issue tracking
      policy_engine_mode: any
      group: Applications

  - model: authentik_core.application
    id: app-outline
    identifiers:
      slug: outline
    attrs:
      name: Outline
      provider: !KeyOf provider-outline
      meta_launch_url: https://docs.lab.axiomlayer.com
      meta_icon: https://www.getoutline.com/images/favicon.png
      meta_description: Documentation and knowledge base
      policy_engine_mode: any
      group: Applications

  - model: authentik_core.application
    id: app-n8n
    identifiers:
      slug: n8n
    attrs:
      name: n8n (autom8)
      provider: !KeyOf provider-n8n
      meta_launch_url: https://autom8.lab.axiomlayer.com
      meta_icon: https://n8n.io/favicon.ico
      meta_description: Workflow automation platform
      policy_engine_mode: any
      group: Applications

  - model: authentik_core.application
    id: app-open-webui
    identifiers:
      slug: open-webui
    attrs:
      name: Open WebUI
      provider: !KeyOf provider-open-webui
      meta_launch_url: https://ai.lab.axiomlayer.com
      meta_icon: https://openwebui.com/favicon.png
      meta_description: AI chat interface
      policy_engine_mode: any
      group: Applications

  - model: authentik_core.application
    id: app-campfire
    identifiers:
      slug: campfire
    attrs:
      name: Campfire
      provider: !KeyOf provider-campfire
      meta_launch_url: https://chat.lab.axiomlayer.com
      meta_icon: https://cdn-icons-png.flaticon.com/512/2991/2991148.png
      meta_description: Team chat and communication
      policy_engine_mode: any
      group: Applications

  # ===================
  # Applications - Observability
  # ===================
  - model: authentik_core.application
    id: app-grafana
    identifiers:
      slug: grafana
    attrs:
      name: Grafana
      provider: !KeyOf provider-grafana
      meta_launch_url: https://grafana.lab.axiomlayer.com
      meta_icon: https://grafana.com/static/assets/img/fav32.png
      meta_description: Metrics dashboards and visualization
      policy_engine_mode: any
      group: Observability

  - model: authentik_core.application
    id: app-alertmanager
    identifiers:
      slug: alertmanager
    attrs:
      name: Alertmanager
      provider: !KeyOf provider-alertmanager
      meta_launch_url: https://alerts.lab.axiomlayer.com
      meta_icon: https://prometheus.io/assets/favicons/favicon.ico
      meta_description: Alert management and routing
      policy_engine_mode: any
      group: Observability

  # ===================
  # Applications - Infrastructure
  # ===================
  - model: authentik_core.application
    id: app-longhorn
    identifiers:
      slug: longhorn
    attrs:
      name: Longhorn
      provider: !KeyOf provider-longhorn
      meta_launch_url: https://longhorn.lab.axiomlayer.com
      meta_icon: https://longhorn.io/img/logos/longhorn-icon-color.png
      meta_description: Distributed storage management
      policy_engine_mode: any
      group: Infrastructure

  - model: authentik_core.application
    id: app-telnet
    identifiers:
      slug: telnet-server
    attrs:
      name: Telnet Server
      provider: !KeyOf provider-telnet
      meta_launch_url: https://telnet.lab.axiomlayer.com
      meta_icon: https://cdn-icons-png.flaticon.com/512/900/900618.png
      meta_description: Demo application with SSO
      policy_engine_mode: any
      group: Infrastructure

  # ===================
  # Access Policies
  # ===================
  - model: authentik_policies_expression.expressionpolicy
    id: policy-is-admin
    identifiers:
      name: Is Homelab Admin
    attrs:
      expression: |
        return ak_is_group_member(request.user, name="Homelab Admins")

  - model: authentik_policies_expression.expressionpolicy
    id: policy-is-user
    identifiers:
      name: Is Homelab User
    attrs:
      expression: |
        return ak_is_group_member(request.user, name="Homelab Admins") or ak_is_group_member(request.user, name="Homelab Users")

  # ===================
  # Policy Bindings - ArgoCD (Admin only)
  # ===================
  - model: authentik_policies.policybinding
    id: binding-argocd-admin
    identifiers:
      order: 0
      target: !KeyOf app-argocd
      policy: !KeyOf policy-is-admin
    attrs:
      enabled: true
      timeout: 30

  # ===================
  # Policy Bindings - Grafana (All users)
  # ===================
  - model: authentik_policies.policybinding
    id: binding-grafana-user
    identifiers:
      order: 0
      target: !KeyOf app-grafana
      policy: !KeyOf policy-is-user
    attrs:
      enabled: true
      timeout: 30

  # ===================
  # Policy Bindings - Plane (All users)
  # ===================
  - model: authentik_policies.policybinding
    id: binding-plane-user
    identifiers:
      order: 0
      target: !KeyOf app-plane
      policy: !KeyOf policy-is-user
    attrs:
      enabled: true
      timeout: 30
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: authentik-db
  namespace: authentik
  labels:
    app.kubernetes.io/name: authentik-db
    app.kubernetes.io/component: database
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  instances: 1

  storage:
    size: 5Gi
    storageClass: longhorn

  postgresql:
    parameters:
      max_connections: "100"
      shared_buffers: "128MB"

  bootstrap:
    initdb:
      database: authentik
      owner: authentik

  monitoring:
    enablePodMonitor: true
apiVersion: v1
kind: ConfigMap
metadata:
  name: authentik-blueprints
  namespace: authentik
  labels:
    app.kubernetes.io/name: authentik
    app.kubernetes.io/component: blueprints
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
data:
  homelab-apps.yaml: |
    # Authentik Blueprint for Homelab Applications
    # Each application has its own provider for proper isolation
    version: 1
    metadata:
      name: Homelab Applications
      labels:
        blueprints.goauthentik.io/description: "All homelab application definitions"
    entries:
      # ===================
      # User Groups
      # ===================
      - model: authentik_core.group
        id: group-admins
        identifiers:
          name: Homelab Admins
        attrs:
          is_superuser: false

      - model: authentik_core.group
        id: group-users
        identifiers:
          name: Homelab Users
        attrs:
          is_superuser: false

      # ===================
      # Users
      # ===================
      - model: authentik_core.user
        id: user-jasen
        identifiers:
          username: jasen
        attrs:
          name: Jasen
          email: jasen@axiomlayer.com
          is_active: true
          groups:
            - !KeyOf group-admins
            - !KeyOf group-users

      # ===================
      # Proxy Providers (Forward Auth - one per app)
      # ===================
      - model: authentik_providers_proxy.proxyprovider
        id: provider-dashboard
        identifiers:
          name: Dashboard Proxy Provider
        attrs:
          authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
          invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
          mode: forward_single
          external_host: https://db.lab.axiomlayer.com

      - model: authentik_providers_proxy.proxyprovider
        id: provider-n8n
        identifiers:
          name: n8n Proxy Provider
        attrs:
          authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
          invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
          mode: forward_single
          external_host: https://autom8.lab.axiomlayer.com

      - model: authentik_providers_proxy.proxyprovider
        id: provider-open-webui
        identifiers:
          name: Open WebUI Proxy Provider
        attrs:
          authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
          invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
          mode: forward_single
          external_host: https://ai.lab.axiomlayer.com

      - model: authentik_providers_proxy.proxyprovider
        id: provider-campfire
        identifiers:
          name: Campfire Proxy Provider
        attrs:
          authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
          invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
          mode: forward_single
          external_host: https://chat.lab.axiomlayer.com

      - model: authentik_providers_proxy.proxyprovider
        id: provider-alertmanager
        identifiers:
          name: Alertmanager Proxy Provider
        attrs:
          authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
          invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
          mode: forward_single
          external_host: https://alerts.lab.axiomlayer.com

      - model: authentik_providers_proxy.proxyprovider
        id: provider-longhorn
        identifiers:
          name: Longhorn Proxy Provider
        attrs:
          authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
          invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
          mode: forward_single
          external_host: https://longhorn.lab.axiomlayer.com

      - model: authentik_providers_proxy.proxyprovider
        id: provider-telnet
        identifiers:
          name: Telnet Server Proxy Provider
        attrs:
          authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
          invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
          mode: forward_single
          external_host: https://telnet.lab.axiomlayer.com

      # ===================
      # OIDC Providers (Native SSO)
      # ===================
      - model: authentik_providers_oauth2.oauth2provider
        id: provider-argocd
        identifiers:
          name: ArgoCD OIDC Provider
        attrs:
          authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
          invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
          client_type: confidential
          client_id: argocd
          client_secret: "11190a6436c58bfdce05e788c52d38d9a56db18d17417d8b1f31f161b6be622a"
          redirect_uris:
            - matching_mode: strict
              url: https://argocd.lab.axiomlayer.com/api/dex/callback
          access_token_validity: hours=1
          refresh_token_validity: days=30
          include_claims_in_id_token: true
          sub_mode: user_email
          signing_key: !Find [authentik_crypto.certificatekeypair, [name, authentik Self-signed Certificate]]

      - model: authentik_providers_oauth2.oauth2provider
        id: provider-grafana
        identifiers:
          name: Grafana OAuth2 Provider
        attrs:
          authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
          invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
          client_type: confidential
          client_id: grafana
          client_secret: "b023d23d0199ab3e85ccb1a31dd861ca0e45cebbc8ae5cd992bd93643a4df409"
          redirect_uris:
            - matching_mode: strict
              url: https://grafana.lab.axiomlayer.com/login/generic_oauth
          access_token_validity: hours=1
          refresh_token_validity: days=30
          include_claims_in_id_token: true
          sub_mode: user_email
          signing_key: !Find [authentik_crypto.certificatekeypair, [name, authentik Self-signed Certificate]]

      - model: authentik_providers_oauth2.oauth2provider
        id: provider-outline
        identifiers:
          name: Outline OIDC Provider
        attrs:
          authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
          invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
          client_type: confidential
          client_id: outline
          client_secret: "585d48f4a5e90c66d467c581766f05c13c7fa440e5172b95a144a6bdac232c6b"
          redirect_uris:
            - matching_mode: strict
              url: https://docs.lab.axiomlayer.com/auth/oidc.callback
          access_token_validity: hours=1
          refresh_token_validity: days=30
          include_claims_in_id_token: true
          sub_mode: user_email
          signing_key: !Find [authentik_crypto.certificatekeypair, [name, authentik Self-signed Certificate]]

      - model: authentik_providers_oauth2.oauth2provider
        id: provider-plane
        identifiers:
          name: Plane OIDC Provider
        attrs:
          authorization_flow: !Find [authentik_flows.flow, [slug, default-provider-authorization-implicit-consent]]
          invalidation_flow: !Find [authentik_flows.flow, [slug, default-provider-invalidation-flow]]
          client_type: confidential
          client_id: plane
          client_secret: "plane-oidc-secret-change-me"
          redirect_uris:
            - matching_mode: strict
              url: https://plane.lab.axiomlayer.com/auth/oidc/callback/
          access_token_validity: hours=1
          refresh_token_validity: days=30
          include_claims_in_id_token: true
          sub_mode: user_email
          signing_key: !Find [authentik_crypto.certificatekeypair, [name, authentik Self-signed Certificate]]

      # ===================
      # Kubernetes Service Connection (for outpost deployment)
      # ===================
      - model: authentik_outposts.kubernetesserviceconnection
        id: k8s-local
        identifiers:
          name: Local Kubernetes
        attrs:
          local: true
          verify_ssl: true

      # ===================
      # Outpost (Forward Auth)
      # ===================
      - model: authentik_outposts.outpost
        id: outpost-forward-auth
        identifiers:
          name: forward-auth-outpost
        attrs:
          type: proxy
          service_connection: !KeyOf k8s-local
          providers:
            - !KeyOf provider-dashboard
            - !KeyOf provider-n8n
            - !KeyOf provider-open-webui
            - !KeyOf provider-campfire
            - !KeyOf provider-alertmanager
            - !KeyOf provider-longhorn
            - !KeyOf provider-telnet
          config:
            authentik_host: https://auth.lab.axiomlayer.com
            docker_labels: null
            docker_map_ports: true
            docker_network: null
            container_image: null
            kubernetes_replicas: 1
            kubernetes_namespace: authentik
            kubernetes_ingress_annotations:
              traefik.ingress.kubernetes.io/router.entrypoints: websecure
            kubernetes_ingress_secret_name: ak-outpost-forward-auth-tls
            kubernetes_service_type: ClusterIP
            object_naming_template: ak-outpost-%(name)s

      # ===================
      # Applications - Platform
      # ===================
      - model: authentik_core.application
        id: app-dashboard
        identifiers:
          slug: dashboard
        attrs:
          name: Dashboard
          provider: !KeyOf provider-dashboard
          meta_launch_url: https://db.lab.axiomlayer.com
          meta_icon: https://cdn-icons-png.flaticon.com/512/1828/1828765.png
          meta_description: Homelab service dashboard
          policy_engine_mode: any
          group: Platform

      - model: authentik_core.application
        id: app-argocd
        identifiers:
          slug: argocd
        attrs:
          name: ArgoCD
          provider: !KeyOf provider-argocd
          meta_launch_url: https://argocd.lab.axiomlayer.com
          meta_icon: https://argo-cd.readthedocs.io/en/stable/assets/logo.png
          meta_description: GitOps continuous delivery
          policy_engine_mode: any
          group: Platform

      - model: authentik_core.application
        id: app-authentik
        identifiers:
          slug: authentik
        attrs:
          name: Authentik
          meta_launch_url: https://auth.lab.axiomlayer.com
          meta_icon: https://goauthentik.io/img/icon.png
          meta_description: Identity provider and SSO
          policy_engine_mode: any
          group: Platform

      # ===================
      # Applications - Apps
      # ===================
      - model: authentik_core.application
        id: app-plane
        identifiers:
          slug: plane
        attrs:
          name: Plane
          provider: !KeyOf provider-plane
          meta_launch_url: https://plane.lab.axiomlayer.com
          meta_icon: https://plane.so/favicon.ico
          meta_description: Project management and issue tracking
          policy_engine_mode: any
          group: Applications

      - model: authentik_core.application
        id: app-outline
        identifiers:
          slug: outline
        attrs:
          name: Outline
          provider: !KeyOf provider-outline
          meta_launch_url: https://docs.lab.axiomlayer.com
          meta_icon: https://www.getoutline.com/images/favicon.png
          meta_description: Documentation and knowledge base
          policy_engine_mode: any
          group: Applications

      - model: authentik_core.application
        id: app-n8n
        identifiers:
          slug: n8n
        attrs:
          name: n8n (autom8)
          provider: !KeyOf provider-n8n
          meta_launch_url: https://autom8.lab.axiomlayer.com
          meta_icon: https://n8n.io/favicon.ico
          meta_description: Workflow automation platform
          policy_engine_mode: any
          group: Applications

      - model: authentik_core.application
        id: app-open-webui
        identifiers:
          slug: open-webui
        attrs:
          name: Open WebUI
          provider: !KeyOf provider-open-webui
          meta_launch_url: https://ai.lab.axiomlayer.com
          meta_icon: https://openwebui.com/favicon.png
          meta_description: AI chat interface
          policy_engine_mode: any
          group: Applications

      - model: authentik_core.application
        id: app-campfire
        identifiers:
          slug: campfire
        attrs:
          name: Campfire
          provider: !KeyOf provider-campfire
          meta_launch_url: https://chat.lab.axiomlayer.com
          meta_icon: https://cdn-icons-png.flaticon.com/512/2991/2991148.png
          meta_description: Team chat and communication
          policy_engine_mode: any
          group: Applications

      # ===================
      # Applications - Observability
      # ===================
      - model: authentik_core.application
        id: app-grafana
        identifiers:
          slug: grafana
        attrs:
          name: Grafana
          provider: !KeyOf provider-grafana
          meta_launch_url: https://grafana.lab.axiomlayer.com
          meta_icon: https://grafana.com/static/assets/img/fav32.png
          meta_description: Metrics dashboards and visualization
          policy_engine_mode: any
          group: Observability

      - model: authentik_core.application
        id: app-alertmanager
        identifiers:
          slug: alertmanager
        attrs:
          name: Alertmanager
          provider: !KeyOf provider-alertmanager
          meta_launch_url: https://alerts.lab.axiomlayer.com
          meta_icon: https://prometheus.io/assets/favicons/favicon.ico
          meta_description: Alert management and routing
          policy_engine_mode: any
          group: Observability

      # ===================
      # Applications - Infrastructure
      # ===================
      - model: authentik_core.application
        id: app-longhorn
        identifiers:
          slug: longhorn
        attrs:
          name: Longhorn
          provider: !KeyOf provider-longhorn
          meta_launch_url: https://longhorn.lab.axiomlayer.com
          meta_icon: https://longhorn.io/img/logos/longhorn-icon-color.png
          meta_description: Distributed storage management
          policy_engine_mode: any
          group: Infrastructure

      - model: authentik_core.application
        id: app-telnet
        identifiers:
          slug: telnet-server
        attrs:
          name: Telnet Server
          provider: !KeyOf provider-telnet
          meta_launch_url: https://telnet.lab.axiomlayer.com
          meta_icon: https://cdn-icons-png.flaticon.com/512/900/900618.png
          meta_description: Demo application with SSO
          policy_engine_mode: any
          group: Infrastructure

      # ===================
      # Access Policies
      # ===================
      - model: authentik_policies_expression.expressionpolicy
        id: policy-is-admin
        identifiers:
          name: Is Homelab Admin
        attrs:
          expression: |
            return ak_is_group_member(request.user, name="Homelab Admins")

      - model: authentik_policies_expression.expressionpolicy
        id: policy-is-user
        identifiers:
          name: Is Homelab User
        attrs:
          expression: |
            return ak_is_group_member(request.user, name="Homelab Admins") or ak_is_group_member(request.user, name="Homelab Users")

      # ===================
      # Policy Bindings - ArgoCD (Admin only)
      # ===================
      - model: authentik_policies.policybinding
        id: binding-argocd-admin
        identifiers:
          order: 0
          target: !KeyOf app-argocd
          policy: !KeyOf policy-is-admin
        attrs:
          enabled: true
          timeout: 30

      # ===================
      # Policy Bindings - Grafana (All users)
      # ===================
      - model: authentik_policies.policybinding
        id: binding-grafana-user
        identifiers:
          order: 0
          target: !KeyOf app-grafana
          policy: !KeyOf policy-is-user
        attrs:
          enabled: true
          timeout: 30

      # ===================
      # Policy Bindings - Plane (All users)
      # ===================
      - model: authentik_policies.policybinding
        id: binding-plane-user
        identifiers:
          order: 0
          target: !KeyOf app-plane
          policy: !KeyOf policy-is-user
        attrs:
          enabled: true
          timeout: 30
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: authentik-helm-secrets
  namespace: authentik
spec:
  encryptedData:
    postgresql_password: AgB9FMmjjvVVZ387Fo+h35JX6AheINaNn2W1BgFZc0IkZ9IWEr3VMdMkfV8jxoz3Ir74sa28POCOXHhYKI1RxtymXGrQXovyf//5K5K8TF1Pbm2r/pyoXb8Lx0pabp62HSmGaKwXERyGR1TiZm+2D+6kvTidGCd9ugrcvJl8Th0MXD8klfqeFRXwmMYSRda6F65UEOjeiApYHUzN1auB4i61cMWkUvJk2bOVVvvYDXWMEiipAE1DUVRDjj+5+HD885Mp1jqRzdJ1lfrbkbelPKnRSujAAMqby8or2mQFqaJII4yOgjcJfq+5z/AvTkJsms4cWRhRHLpkzO5PnImHFhZsIEbrOz1I7jfNuaVNJqqI1dFIlwqpKZSuFCA0UJ8+bGluqJmj1WNYKPM7OYfmQyJ5KomLVslmfTSu7JASGZDCaV/kVUAsuCSKJ13kFucR8cqD2+fXVFqkBX0tpNeZ15ttwU9TMv4gUrAWBJW4t7+txcFkJd6vub5lP3MQ+75SJvHykbNRv+LYTuopzkZJWVisXje9zbAdp6mFOHKZ7LNpWQLurlbm1KpNCkQQ8+liqGzYTqcM8vYx1NbDxp8KhcUBNFhH0l2s68NSKLvpID1WNNgIQW5SVdPbzqyX93hkKO9rw4LXA+9d6W0y0qlidfob2rXAgjORD2Yhc0b3fds0iW9HITcH9JUFJZvT/G/JkY4=
    secret_key: AgC34VP8P8SlieRm1uKZGnGSnoO93ZDevbm33RgMmqgPOn3wO0KuO3xgXULEs2L+RqY5MQMvrFA2eUJRxsYAANSTyyAcrKb6B1pZT0Qf7JP8kS9/J1MY2clac42GRrdgqfL5MudU1pmfl+mRDcHKFv8F04SrZGxn1H/qPkcxFAjX87aUrljqP4wcXjvJPCbR+N6BRK2Bbr6uZdDZ4/rbYz9yElwlpXnbM3v7l6KA+xh2N+o/2YY0VWFp/2rPwovWkUquApjeIdwi0mCdQK5PuB0dQ9aiEei71rZgt5wxre6O97mYEGDoCgVV2rmI3TFYQmTCQPcZP8EUoqHQO/RJQXgS62ldOc1+JE4luSSFMa7tlFIxSMCukk1mvb9GqtMpA2Nz9u5KIT+7oxvhH0SgrYvm8sSkbukq1X/IppO7ep0/ZOQxvnaxkZU7AgLyh+ER0NJjQw/b/jTTtvRecY7df4zmMMDsutwoIUFAGRGuZI+dmHxXwV454CFzkEVU114DE0o9DijpV+qpxW2//uxaW5q64DlvBVihLw0NfUP/7nasj5x1+xNBpRW9alv4yloDDreAAagQ778aPxwyEMXbNJwkFwFplMcmQhYhj2zqu3u46lnGGRhdjAsm7wCE/6NmeM4rOmqSwq0fwE41r174BDW10Wi0IsVolTtyjNESySM577R0E39xpCz/kCcU88elCzM=
  template:
    metadata:
      name: authentik-helm-secrets
      namespace: authentik
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: authentik-outpost-token
  namespace: authentik
  labels:
    app.kubernetes.io/name: authentik-outpost
    app.kubernetes.io/component: secret
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  encryptedData:
    token: AgCqMtkfXrOnxJUSECJvRIPjsBsFjCTMW7Vsj1RV+k603SIKXCGNmJboLDEylGiPbqrAkM45ObhCwm0JiRoSqRNN6st1eDegkfHqtcX273PJv15Pmx7kGdU1fUUAon6oNgj0MUF01W7WN11mJsyOEbj7OiT1c6wOJnESbz3LtGtoEkwi5RRXv3BIaVEu20mNrWz2iKNaI7fqsN0oZlx6RtY6vI/7CAK6yUQ1WZmEEcTPykLj6tM5Xyq/cw7wIhFU88LjGAJEUPFS7y5OCudTX35Xp6y/Llc52AKgoin6vF+SM9KWCfUutKQZzFxUIERN8P+MM9TTppei/VLQ0BRy/KrM0MIsHNhHmrTHeB07xiNRNBlpjnJJx7rYcsmv6qA1f/t4IXTVKQV8x1ltaPtrXBg9Bjboy/UkA3e68kN/5OPhlUxLcHxQSAR9HpJpZGGldWvBRd3LymKvijjSkTZVvdmCqgza+k5VHiIm9oZUEeDxf3dTAFQERzFir4MzPljwuPyEXOJjE2wAaHYpUC0o6eIolZcOpmt4li6Z6QY3b8i4DWg9wGDsXSY8QK7bY+7InP/V1l3CG02EVjAoQiOhNR4rl8uzJIvTkuQOSYoYGKkeCenWjQZOAdrEuIfLJ3Hkzj+9/7PHdOtYLsnToBxt30cdtUSJETDQgWvv6sguUbpcR/1iJYWI6Yx0jqxi177JA/9FdF/VXKUWhSY2IOFPvnRk80rTIG5efv6U9tBpTgctsIxgRqDRGsRRUYtOrHix5yIDycn3zoK++3g5HIc=
  template:
    metadata:
      name: authentik-outpost-token
      namespace: authentik
      labels:
        app.kubernetes.io/name: authentik-outpost
        app.kubernetes.io/component: secret
        app.kubernetes.io/part-of: homelab
        app.kubernetes.io/managed-by: argocd
# Authentik Helm Values
# Install with: helm install authentik authentik/authentik -n authentik -f values.yaml

authentik:
  secret_key: "" # Set via --set or secret
  postgresql:
    password: "" # Set via --set or secret

postgresql:
  enabled: true
  auth:
    password: "" # Set via --set or secret

redis:
  enabled: true

server:
  ingress:
    enabled: true
    ingressClassName: traefik
    hosts:
      - auth.lab.axiomlayer.com
    tls:
      - secretName: authentik-tls
        hosts:
          - auth.lab.axiomlayer.com

# Enable service connection for outpost deployment
serviceAccount:
  create: true
  serviceAccountName: authentik

# RBAC for outpost management
rbac:
  create: true
  createClusterRole: true
  createClusterRoleBinding: true
  clusterRoleRules:
    # Permissions needed for outpost deployment
    - apiGroups: [""]
      resources: ["namespaces", "pods", "services", "secrets", "configmaps", "serviceaccounts"]
      verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
    - apiGroups: ["apps"]
      resources: ["deployments", "statefulsets", "daemonsets", "replicasets"]
      verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
    - apiGroups: ["networking.k8s.io"]
      resources: ["ingresses"]
      verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
    - apiGroups: ["rbac.authorization.k8s.io"]
      resources: ["roles", "rolebindings", "clusterroles", "clusterrolebindings"]
      verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
    - apiGroups: ["apiextensions.k8s.io"]
      resources: ["customresourcedefinitions"]
      verbs: ["list"]
    # Allow watching traefik middlewares for forward auth
    - apiGroups: ["traefik.io", "traefik.containo.us"]
      resources: ["middlewares"]
      verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
openapi: 3.0.3
info:
  title: authentik
  version: 2025.12.0-rc1
  description: Making authentication simple.
  contact:
    email: hello@goauthentik.io
  license:
    name: MIT
    url: https://github.com/goauthentik/authentik/blob/main/LICENSE
paths:
  /admin/apps/:
    get:
      operationId: admin_apps_list
      description: Read-only view list all installed apps
      tags:
      - admin
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/App'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /admin/models/:
    get:
      operationId: admin_models_list
      description: Read-only view list all installed models
      tags:
      - admin
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/App'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /admin/settings/:
    get:
      operationId: admin_settings_retrieve
      description: Settings view
      tags:
      - admin
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Settings'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: admin_settings_update
      description: Settings view
      tags:
      - admin
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SettingsRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Settings'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: admin_settings_partial_update
      description: Settings view
      tags:
      - admin
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSettingsRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Settings'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /admin/system/:
    get:
      operationId: admin_system_retrieve
      description: Get system information.
      tags:
      - admin
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemInfo'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: admin_system_create
      description: Get system information.
      tags:
      - admin
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemInfo'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /admin/version/:
    get:
      operationId: admin_version_retrieve
      description: Get running and latest version.
      tags:
      - admin
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Version'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /admin/version/history/:
    get:
      operationId: admin_version_history_list
      description: VersionHistory Viewset
      parameters:
      - in: query
        name: build
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: version
        schema:
          type: string
      tags:
      - admin
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/VersionHistory'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /admin/version/history/{id}/:
    get:
      operationId: admin_version_history_retrieve
      description: VersionHistory Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Version history.
        required: true
      tags:
      - admin
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VersionHistory'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/admin/all/:
    get:
      operationId: authenticators_admin_all_list
      description: Get all devices for current user
      parameters:
      - in: query
        name: user
        schema:
          type: integer
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Device'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/admin/duo/:
    get:
      operationId: authenticators_admin_duo_list
      description: Viewset for Duo authenticator devices (for admins)
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedDuoDeviceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: authenticators_admin_duo_create
      description: Viewset for Duo authenticator devices (for admins)
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DuoDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DuoDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/admin/duo/{id}/:
    get:
      operationId: authenticators_admin_duo_retrieve
      description: Viewset for Duo authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Duo Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DuoDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: authenticators_admin_duo_update
      description: Viewset for Duo authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Duo Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DuoDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DuoDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: authenticators_admin_duo_partial_update
      description: Viewset for Duo authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Duo Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedDuoDeviceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DuoDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: authenticators_admin_duo_destroy
      description: Viewset for Duo authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Duo Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/admin/email/:
    get:
      operationId: authenticators_admin_email_list
      description: Viewset for email authenticator devices (for admins)
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedEmailDeviceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: authenticators_admin_email_create
      description: Viewset for email authenticator devices (for admins)
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EmailDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/admin/email/{id}/:
    get:
      operationId: authenticators_admin_email_retrieve
      description: Viewset for email authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Email Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: authenticators_admin_email_update
      description: Viewset for email authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Email Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EmailDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: authenticators_admin_email_partial_update
      description: Viewset for email authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Email Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedEmailDeviceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: authenticators_admin_email_destroy
      description: Viewset for email authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Email Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/admin/endpoint/:
    get:
      operationId: authenticators_admin_endpoint_list
      description: Viewset for Endpoint authenticator devices (for admins)
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGoogleEndpointDeviceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: authenticators_admin_endpoint_create
      description: Viewset for Endpoint authenticator devices (for admins)
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoogleEndpointDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleEndpointDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/admin/endpoint/{uuid}/:
    get:
      operationId: authenticators_admin_endpoint_retrieve
      description: Viewset for Endpoint authenticator devices (for admins)
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Endpoint Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleEndpointDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: authenticators_admin_endpoint_update
      description: Viewset for Endpoint authenticator devices (for admins)
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Endpoint Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoogleEndpointDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleEndpointDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: authenticators_admin_endpoint_partial_update
      description: Viewset for Endpoint authenticator devices (for admins)
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Endpoint Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedGoogleEndpointDeviceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleEndpointDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: authenticators_admin_endpoint_destroy
      description: Viewset for Endpoint authenticator devices (for admins)
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Endpoint Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/admin/sms/:
    get:
      operationId: authenticators_admin_sms_list
      description: Viewset for sms authenticator devices (for admins)
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSMSDeviceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: authenticators_admin_sms_create
      description: Viewset for sms authenticator devices (for admins)
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SMSDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/admin/sms/{id}/:
    get:
      operationId: authenticators_admin_sms_retrieve
      description: Viewset for sms authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SMS Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: authenticators_admin_sms_update
      description: Viewset for sms authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SMS Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SMSDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: authenticators_admin_sms_partial_update
      description: Viewset for sms authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SMS Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSMSDeviceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: authenticators_admin_sms_destroy
      description: Viewset for sms authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SMS Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/admin/static/:
    get:
      operationId: authenticators_admin_static_list
      description: Viewset for static authenticator devices (for admins)
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedStaticDeviceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: authenticators_admin_static_create
      description: Viewset for static authenticator devices (for admins)
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StaticDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StaticDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/admin/static/{id}/:
    get:
      operationId: authenticators_admin_static_retrieve
      description: Viewset for static authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Static Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StaticDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: authenticators_admin_static_update
      description: Viewset for static authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Static Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StaticDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StaticDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: authenticators_admin_static_partial_update
      description: Viewset for static authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Static Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedStaticDeviceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StaticDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: authenticators_admin_static_destroy
      description: Viewset for static authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Static Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/admin/totp/:
    get:
      operationId: authenticators_admin_totp_list
      description: Viewset for totp authenticator devices (for admins)
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedTOTPDeviceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: authenticators_admin_totp_create
      description: Viewset for totp authenticator devices (for admins)
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TOTPDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TOTPDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/admin/totp/{id}/:
    get:
      operationId: authenticators_admin_totp_retrieve
      description: Viewset for totp authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this TOTP Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TOTPDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: authenticators_admin_totp_update
      description: Viewset for totp authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this TOTP Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TOTPDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TOTPDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: authenticators_admin_totp_partial_update
      description: Viewset for totp authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this TOTP Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedTOTPDeviceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TOTPDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: authenticators_admin_totp_destroy
      description: Viewset for totp authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this TOTP Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/admin/webauthn/:
    get:
      operationId: authenticators_admin_webauthn_list
      description: Viewset for WebAuthn authenticator devices (for admins)
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedWebAuthnDeviceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: authenticators_admin_webauthn_create
      description: Viewset for WebAuthn authenticator devices (for admins)
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WebAuthnDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebAuthnDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/admin/webauthn/{id}/:
    get:
      operationId: authenticators_admin_webauthn_retrieve
      description: Viewset for WebAuthn authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this WebAuthn Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebAuthnDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: authenticators_admin_webauthn_update
      description: Viewset for WebAuthn authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this WebAuthn Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WebAuthnDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebAuthnDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: authenticators_admin_webauthn_partial_update
      description: Viewset for WebAuthn authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this WebAuthn Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedWebAuthnDeviceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebAuthnDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: authenticators_admin_webauthn_destroy
      description: Viewset for WebAuthn authenticator devices (for admins)
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this WebAuthn Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/all/:
    get:
      operationId: authenticators_all_list
      description: Get all devices for current user
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Device'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/duo/:
    get:
      operationId: authenticators_duo_list
      description: Viewset for Duo authenticator devices
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedDuoDeviceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/duo/{id}/:
    get:
      operationId: authenticators_duo_retrieve
      description: Viewset for Duo authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Duo Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DuoDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: authenticators_duo_update
      description: Viewset for Duo authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Duo Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DuoDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DuoDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: authenticators_duo_partial_update
      description: Viewset for Duo authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Duo Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedDuoDeviceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DuoDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: authenticators_duo_destroy
      description: Viewset for Duo authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Duo Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/duo/{id}/used_by/:
    get:
      operationId: authenticators_duo_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Duo Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/email/:
    get:
      operationId: authenticators_email_list
      description: Viewset for email authenticator devices
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedEmailDeviceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/email/{id}/:
    get:
      operationId: authenticators_email_retrieve
      description: Viewset for email authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Email Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: authenticators_email_update
      description: Viewset for email authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Email Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EmailDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: authenticators_email_partial_update
      description: Viewset for email authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Email Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedEmailDeviceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: authenticators_email_destroy
      description: Viewset for email authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Email Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/email/{id}/used_by/:
    get:
      operationId: authenticators_email_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Email Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/endpoint/:
    get:
      operationId: authenticators_endpoint_list
      description: Viewset for Endpoint authenticator devices
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGoogleEndpointDeviceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/endpoint/{uuid}/:
    get:
      operationId: authenticators_endpoint_retrieve
      description: Viewset for Endpoint authenticator devices
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Endpoint Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleEndpointDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/endpoint/{uuid}/used_by/:
    get:
      operationId: authenticators_endpoint_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Endpoint Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/sms/:
    get:
      operationId: authenticators_sms_list
      description: Viewset for sms authenticator devices
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSMSDeviceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/sms/{id}/:
    get:
      operationId: authenticators_sms_retrieve
      description: Viewset for sms authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SMS Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: authenticators_sms_update
      description: Viewset for sms authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SMS Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SMSDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: authenticators_sms_partial_update
      description: Viewset for sms authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SMS Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSMSDeviceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMSDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: authenticators_sms_destroy
      description: Viewset for sms authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SMS Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/sms/{id}/used_by/:
    get:
      operationId: authenticators_sms_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SMS Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/static/:
    get:
      operationId: authenticators_static_list
      description: Viewset for static authenticator devices
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedStaticDeviceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/static/{id}/:
    get:
      operationId: authenticators_static_retrieve
      description: Viewset for static authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Static Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StaticDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: authenticators_static_update
      description: Viewset for static authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Static Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StaticDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StaticDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: authenticators_static_partial_update
      description: Viewset for static authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Static Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedStaticDeviceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StaticDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: authenticators_static_destroy
      description: Viewset for static authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Static Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/static/{id}/used_by/:
    get:
      operationId: authenticators_static_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Static Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/totp/:
    get:
      operationId: authenticators_totp_list
      description: Viewset for totp authenticator devices
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedTOTPDeviceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/totp/{id}/:
    get:
      operationId: authenticators_totp_retrieve
      description: Viewset for totp authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this TOTP Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TOTPDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: authenticators_totp_update
      description: Viewset for totp authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this TOTP Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TOTPDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TOTPDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: authenticators_totp_partial_update
      description: Viewset for totp authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this TOTP Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedTOTPDeviceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TOTPDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: authenticators_totp_destroy
      description: Viewset for totp authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this TOTP Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/totp/{id}/used_by/:
    get:
      operationId: authenticators_totp_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this TOTP Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/webauthn/:
    get:
      operationId: authenticators_webauthn_list
      description: Viewset for WebAuthn authenticator devices
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedWebAuthnDeviceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/webauthn/{id}/:
    get:
      operationId: authenticators_webauthn_retrieve
      description: Viewset for WebAuthn authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this WebAuthn Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebAuthnDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: authenticators_webauthn_update
      description: Viewset for WebAuthn authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this WebAuthn Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WebAuthnDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebAuthnDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: authenticators_webauthn_partial_update
      description: Viewset for WebAuthn authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this WebAuthn Device.
        required: true
      tags:
      - authenticators
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedWebAuthnDeviceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebAuthnDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: authenticators_webauthn_destroy
      description: Viewset for WebAuthn authenticator devices
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this WebAuthn Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /authenticators/webauthn/{id}/used_by/:
    get:
      operationId: authenticators_webauthn_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this WebAuthn Device.
        required: true
      tags:
      - authenticators
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/application_entitlements/:
    get:
      operationId: core_application_entitlements_list
      description: ApplicationEntitlement Viewset
      parameters:
      - in: query
        name: app
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: pbm_uuid
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedApplicationEntitlementList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: core_application_entitlements_create
      description: ApplicationEntitlement Viewset
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplicationEntitlementRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationEntitlement'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/application_entitlements/{pbm_uuid}/:
    get:
      operationId: core_application_entitlements_retrieve
      description: ApplicationEntitlement Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Application Entitlement.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationEntitlement'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: core_application_entitlements_update
      description: ApplicationEntitlement Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Application Entitlement.
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplicationEntitlementRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationEntitlement'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: core_application_entitlements_partial_update
      description: ApplicationEntitlement Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Application Entitlement.
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedApplicationEntitlementRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationEntitlement'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: core_application_entitlements_destroy
      description: ApplicationEntitlement Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Application Entitlement.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/application_entitlements/{pbm_uuid}/used_by/:
    get:
      operationId: core_application_entitlements_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Application Entitlement.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/applications/:
    get:
      operationId: core_applications_list
      description: Custom list method that checks Policy based access instead of guardian
      parameters:
      - in: query
        name: for_user
        schema:
          type: integer
      - in: query
        name: group
        schema:
          type: string
      - in: query
        name: meta_description
        schema:
          type: string
      - in: query
        name: meta_launch_url
        schema:
          type: string
      - in: query
        name: meta_publisher
        schema:
          type: string
      - $ref: '#/components/parameters/QueryName'
      - in: query
        name: only_with_launch_url
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: slug
        schema:
          type: string
      - in: query
        name: superuser_full_list
        schema:
          type: boolean
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedApplicationList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: core_applications_create
      description: Application Viewset
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplicationRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Application'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/applications/{slug}/:
    get:
      operationId: core_applications_retrieve
      description: Application Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal application name, used in URLs.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Application'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: core_applications_update
      description: Application Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal application name, used in URLs.
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplicationRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Application'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: core_applications_partial_update
      description: Application Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal application name, used in URLs.
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedApplicationRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Application'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: core_applications_destroy
      description: Application Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal application name, used in URLs.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/applications/{slug}/check_access/:
    get:
      operationId: core_applications_check_access_retrieve
      description: Check access to a single application by slug
      parameters:
      - in: query
        name: for_user
        schema:
          type: integer
      - in: path
        name: slug
        schema:
          type: string
          description: Internal application name, used in URLs.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PolicyTestResult'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/applications/{slug}/set_icon/:
    post:
      operationId: core_applications_set_icon_create
      description: Set application icon
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal application name, used in URLs.
        required: true
      tags:
      - core
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/FileUploadRequest'
      security:
      - authentik: []
      responses:
        '200':
          description: Success
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/applications/{slug}/set_icon_url/:
    post:
      operationId: core_applications_set_icon_url_create
      description: Set application icon (as URL)
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal application name, used in URLs.
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FilePathRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          description: Success
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/applications/{slug}/used_by/:
    get:
      operationId: core_applications_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal application name, used in URLs.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/authenticated_sessions/:
    get:
      operationId: core_authenticated_sessions_list
      description: AuthenticatedSession Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: session__last_ip
        schema:
          type: string
      - in: query
        name: session__last_user_agent
        schema:
          type: string
      - in: query
        name: user__username
        schema:
          type: string
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedAuthenticatedSessionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/authenticated_sessions/{uuid}/:
    get:
      operationId: core_authenticated_sessions_retrieve
      description: AuthenticatedSession Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatedSession'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: core_authenticated_sessions_destroy
      description: AuthenticatedSession Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/authenticated_sessions/{uuid}/used_by/:
    get:
      operationId: core_authenticated_sessions_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/brands/:
    get:
      operationId: core_brands_list
      description: Brand Viewset
      parameters:
      - in: query
        name: brand_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: branding_default_flow_background
        schema:
          type: string
      - in: query
        name: branding_favicon
        schema:
          type: string
      - in: query
        name: branding_logo
        schema:
          type: string
      - in: query
        name: branding_title
        schema:
          type: string
      - in: query
        name: client_certificates
        schema:
          type: array
          items:
            type: string
            format: uuid
        explode: true
        style: form
      - in: query
        name: default
        schema:
          type: boolean
      - in: query
        name: domain
        schema:
          type: string
      - in: query
        name: flow_authentication
        schema:
          type: string
          format: uuid
      - in: query
        name: flow_device_code
        schema:
          type: string
          format: uuid
      - in: query
        name: flow_invalidation
        schema:
          type: string
          format: uuid
      - in: query
        name: flow_recovery
        schema:
          type: string
          format: uuid
      - in: query
        name: flow_unenrollment
        schema:
          type: string
          format: uuid
      - in: query
        name: flow_user_settings
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: web_certificate
        schema:
          type: string
          format: uuid
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedBrandList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: core_brands_create
      description: Brand Viewset
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BrandRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Brand'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/brands/{brand_uuid}/:
    get:
      operationId: core_brands_retrieve
      description: Brand Viewset
      parameters:
      - in: path
        name: brand_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Brand.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Brand'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: core_brands_update
      description: Brand Viewset
      parameters:
      - in: path
        name: brand_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Brand.
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BrandRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Brand'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: core_brands_partial_update
      description: Brand Viewset
      parameters:
      - in: path
        name: brand_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Brand.
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedBrandRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Brand'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: core_brands_destroy
      description: Brand Viewset
      parameters:
      - in: path
        name: brand_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Brand.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/brands/{brand_uuid}/used_by/:
    get:
      operationId: core_brands_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: brand_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Brand.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/brands/current/:
    get:
      operationId: core_brands_current_retrieve
      description: Get current brand
      tags:
      - core
      security:
      - authentik: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CurrentBrand'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/groups/:
    get:
      operationId: core_groups_list
      description: Group Viewset
      parameters:
      - in: query
        name: attributes
        schema:
          type: string
        description: Attributes
      - in: query
        name: include_children
        schema:
          type: boolean
          default: false
      - in: query
        name: include_users
        schema:
          type: boolean
          default: true
      - in: query
        name: is_superuser
        schema:
          type: boolean
      - in: query
        name: members_by_pk
        schema:
          type: array
          items:
            type: integer
        explode: true
        style: form
      - in: query
        name: members_by_username
        schema:
          type: array
          items:
            type: string
        description: Required. 150 characters or fewer. Letters, digits and @/./+/-/_
          only.
        explode: true
        style: form
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGroupList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: core_groups_create
      description: Group Viewset
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Group'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/groups/{group_uuid}/:
    get:
      operationId: core_groups_retrieve
      description: Group Viewset
      parameters:
      - in: path
        name: group_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Group.
        required: true
      - in: query
        name: include_children
        schema:
          type: boolean
          default: false
      - in: query
        name: include_users
        schema:
          type: boolean
          default: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Group'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: core_groups_update
      description: Group Viewset
      parameters:
      - in: path
        name: group_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Group.
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Group'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: core_groups_partial_update
      description: Group Viewset
      parameters:
      - in: path
        name: group_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Group.
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedGroupRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Group'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: core_groups_destroy
      description: Group Viewset
      parameters:
      - in: path
        name: group_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Group.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/groups/{group_uuid}/add_user/:
    post:
      operationId: core_groups_add_user_create
      description: Add user to group
      parameters:
      - in: path
        name: group_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Group.
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserAccountRequest'
        required: true
      security:
      - authentik: []
      responses:
        '204':
          description: User added
        '404':
          description: User not found
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/groups/{group_uuid}/remove_user/:
    post:
      operationId: core_groups_remove_user_create
      description: Remove user from group
      parameters:
      - in: path
        name: group_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Group.
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserAccountRequest'
        required: true
      security:
      - authentik: []
      responses:
        '204':
          description: User removed
        '404':
          description: User not found
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/groups/{group_uuid}/used_by/:
    get:
      operationId: core_groups_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: group_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Group.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/tokens/:
    get:
      operationId: core_tokens_list
      description: Token Viewset
      parameters:
      - in: query
        name: description
        schema:
          type: string
      - in: query
        name: expires
        schema:
          type: string
          format: date-time
      - in: query
        name: expiring
        schema:
          type: boolean
      - in: query
        name: identifier
        schema:
          type: string
      - in: query
        name: intent
        schema:
          type: string
          enum:
          - api
          - app_password
          - recovery
          - verification
      - in: query
        name: managed
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: user__username
        schema:
          type: string
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedTokenList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: core_tokens_create
      description: Token Viewset
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TokenRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Token'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/tokens/{identifier}/:
    get:
      operationId: core_tokens_retrieve
      description: Token Viewset
      parameters:
      - in: path
        name: identifier
        schema:
          type: string
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Token'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: core_tokens_update
      description: Token Viewset
      parameters:
      - in: path
        name: identifier
        schema:
          type: string
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TokenRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Token'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: core_tokens_partial_update
      description: Token Viewset
      parameters:
      - in: path
        name: identifier
        schema:
          type: string
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedTokenRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Token'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: core_tokens_destroy
      description: Token Viewset
      parameters:
      - in: path
        name: identifier
        schema:
          type: string
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/tokens/{identifier}/set_key/:
    post:
      operationId: core_tokens_set_key_create
      description: |-
        Set token key. Action is logged as event. `authentik_core.set_token_key` permission
        is required.
      parameters:
      - in: path
        name: identifier
        schema:
          type: string
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TokenSetKeyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '204':
          description: Successfully changed key
        '400':
          description: Missing key
        '404':
          description: Token not found or expired
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/tokens/{identifier}/used_by/:
    get:
      operationId: core_tokens_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: identifier
        schema:
          type: string
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/tokens/{identifier}/view_key/:
    get:
      operationId: core_tokens_view_key_retrieve
      description: Return token key and log access
      parameters:
      - in: path
        name: identifier
        schema:
          type: string
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenView'
          description: ''
        '404':
          description: Token not found or expired
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/transactional/applications/:
    put:
      operationId: core_transactional_applications_update
      description: Convert data into a blueprint, validate it and apply it
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TransactionApplicationRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionApplicationResponse'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/user_consent/:
    get:
      operationId: core_user_consent_list
      description: UserConsent Viewset
      parameters:
      - in: query
        name: application
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: user
        schema:
          type: integer
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUserConsentList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/user_consent/{id}/:
    get:
      operationId: core_user_consent_retrieve
      description: UserConsent Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Consent.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserConsent'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: core_user_consent_destroy
      description: UserConsent Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Consent.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/user_consent/{id}/used_by/:
    get:
      operationId: core_user_consent_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Consent.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/users/:
    get:
      operationId: core_users_list
      description: User Viewset
      parameters:
      - in: query
        name: attributes
        schema:
          type: string
        description: Attributes
      - in: query
        name: date_joined
        schema:
          type: string
          format: date-time
      - in: query
        name: date_joined__gt
        schema:
          type: string
          format: date-time
      - in: query
        name: date_joined__lt
        schema:
          type: string
          format: date-time
      - in: query
        name: email
        schema:
          type: string
      - in: query
        name: groups_by_name
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - in: query
        name: groups_by_pk
        schema:
          type: array
          items:
            type: string
            format: uuid
        explode: true
        style: form
      - in: query
        name: include_groups
        schema:
          type: boolean
          default: true
      - in: query
        name: is_active
        schema:
          type: boolean
      - in: query
        name: is_superuser
        schema:
          type: boolean
      - in: query
        name: last_updated
        schema:
          type: string
          format: date-time
      - in: query
        name: last_updated__gt
        schema:
          type: string
          format: date-time
      - in: query
        name: last_updated__lt
        schema:
          type: string
          format: date-time
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: path
        schema:
          type: string
      - in: query
        name: path_startswith
        schema:
          type: string
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: type
        schema:
          type: array
          items:
            type: string
            enum:
            - external
            - internal
            - internal_service_account
            - service_account
        explode: true
        style: form
      - in: query
        name: username
        schema:
          type: string
      - in: query
        name: uuid
        schema:
          type: string
          format: uuid
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUserList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: core_users_create
      description: User Viewset
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/users/{id}/:
    get:
      operationId: core_users_retrieve
      description: User Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: core_users_update
      description: User Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User.
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: core_users_partial_update
      description: User Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User.
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedUserRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: core_users_destroy
      description: User Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/users/{id}/impersonate/:
    post:
      operationId: core_users_impersonate_create
      description: Impersonate a user
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User.
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ImpersonationRequest'
        required: true
      security:
      - authentik: []
      responses:
        '204':
          description: Successfully started impersonation
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/users/{id}/recovery/:
    post:
      operationId: core_users_recovery_create
      description: Create a temporary link that a user can use to recover their account
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Link'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/users/{id}/recovery_email/:
    post:
      operationId: core_users_recovery_email_create
      description: Send an email with a temporary link that a user can use to recover
        their account
      parameters:
      - in: query
        name: email_stage
        schema:
          type: string
        required: true
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '204':
          description: Successfully sent recover email
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/users/{id}/set_password/:
    post:
      operationId: core_users_set_password_create
      description: Set password for user
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User.
        required: true
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserPasswordSetRequest'
        required: true
      security:
      - authentik: []
      responses:
        '204':
          description: Successfully changed password
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/users/{id}/used_by/:
    get:
      operationId: core_users_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User.
        required: true
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/users/impersonate_end/:
    get:
      operationId: core_users_impersonate_end_retrieve
      description: End Impersonation a user
      tags:
      - core
      security:
      - authentik: []
      responses:
        '204':
          description: Successfully ended impersonation
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/users/me/:
    get:
      operationId: core_users_me_retrieve
      description: Get information about current user
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SessionUser'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/users/paths/:
    get:
      operationId: core_users_paths_retrieve
      description: Get all user paths
      parameters:
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - core
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPath'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /core/users/service_account/:
    post:
      operationId: core_users_service_account_create
      description: Create a new user account that is marked as a service account
      tags:
      - core
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserServiceAccountRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserServiceAccountResponse'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /crypto/certificatekeypairs/:
    get:
      operationId: crypto_certificatekeypairs_list
      description: CertificateKeyPair Viewset
      parameters:
      - in: query
        name: has_key
        schema:
          type: boolean
        description: Only return certificate-key pairs with keys
      - in: query
        name: include_details
        schema:
          type: boolean
          default: true
      - in: query
        name: key_type
        schema:
          type: array
          items:
            type: string
            enum:
            - dsa
            - ec
            - ed25519
            - ed448
            - rsa
        description: Filter by key algorithm type (RSA, EC, DSA, etc). Can be specified
          multiple times (e.g. '?key_type=rsa&key_type=ec')
      - in: query
        name: managed
        schema:
          type: string
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - crypto
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedCertificateKeyPairList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: crypto_certificatekeypairs_create
      description: CertificateKeyPair Viewset
      tags:
      - crypto
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CertificateKeyPairRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CertificateKeyPair'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /crypto/certificatekeypairs/{kp_uuid}/:
    get:
      operationId: crypto_certificatekeypairs_retrieve
      description: CertificateKeyPair Viewset
      parameters:
      - in: path
        name: kp_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Certificate-Key Pair.
        required: true
      tags:
      - crypto
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CertificateKeyPair'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: crypto_certificatekeypairs_update
      description: CertificateKeyPair Viewset
      parameters:
      - in: path
        name: kp_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Certificate-Key Pair.
        required: true
      tags:
      - crypto
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CertificateKeyPairRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CertificateKeyPair'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: crypto_certificatekeypairs_partial_update
      description: CertificateKeyPair Viewset
      parameters:
      - in: path
        name: kp_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Certificate-Key Pair.
        required: true
      tags:
      - crypto
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedCertificateKeyPairRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CertificateKeyPair'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: crypto_certificatekeypairs_destroy
      description: CertificateKeyPair Viewset
      parameters:
      - in: path
        name: kp_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Certificate-Key Pair.
        required: true
      tags:
      - crypto
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /crypto/certificatekeypairs/{kp_uuid}/used_by/:
    get:
      operationId: crypto_certificatekeypairs_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: kp_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Certificate-Key Pair.
        required: true
      tags:
      - crypto
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /crypto/certificatekeypairs/{kp_uuid}/view_certificate/:
    get:
      operationId: crypto_certificatekeypairs_view_certificate_retrieve
      description: Return certificate-key pairs certificate and log access
      parameters:
      - in: query
        name: download
        schema:
          type: boolean
      - in: path
        name: kp_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Certificate-Key Pair.
        required: true
      tags:
      - crypto
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CertificateData'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /crypto/certificatekeypairs/{kp_uuid}/view_private_key/:
    get:
      operationId: crypto_certificatekeypairs_view_private_key_retrieve
      description: Return certificate-key pairs private key and log access
      parameters:
      - in: query
        name: download
        schema:
          type: boolean
      - in: path
        name: kp_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Certificate-Key Pair.
        required: true
      tags:
      - crypto
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CertificateData'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /crypto/certificatekeypairs/generate/:
    post:
      operationId: crypto_certificatekeypairs_generate_create
      description: Generate a new, self-signed certificate-key pair
      tags:
      - crypto
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CertificateGenerationRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CertificateKeyPair'
          description: ''
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/agents/connectors/:
    get:
      operationId: endpoints_agents_connectors_list
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: query
        name: enabled
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedAgentConnectorList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: endpoints_agents_connectors_create
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AgentConnectorRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentConnector'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/agents/connectors/{connector_uuid}/:
    get:
      operationId: endpoints_agents_connectors_retrieve
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: connector_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Agent Connector.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentConnector'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: endpoints_agents_connectors_update
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: connector_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Agent Connector.
        required: true
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AgentConnectorRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentConnector'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: endpoints_agents_connectors_partial_update
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: connector_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Agent Connector.
        required: true
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedAgentConnectorRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentConnector'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: endpoints_agents_connectors_destroy
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: connector_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Agent Connector.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/agents/connectors/{connector_uuid}/mdm_config/:
    post:
      operationId: endpoints_agents_connectors_mdm_config_create
      description: Generate configuration for MDM systems to deploy authentik Agent
      parameters:
      - in: path
        name: connector_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Agent Connector.
        required: true
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MDMConfigRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MDMConfigResponse'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/agents/connectors/{connector_uuid}/used_by/:
    get:
      operationId: endpoints_agents_connectors_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: connector_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Agent Connector.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/agents/connectors/agent_config/:
    get:
      operationId: endpoints_agents_connectors_agent_config_retrieve
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      tags:
      - endpoints
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentConfig'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/agents/connectors/auth_fed/:
    post:
      operationId: endpoints_agents_connectors_auth_fed_create
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: query
        name: device
        schema:
          type: string
        required: true
      tags:
      - endpoints
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentTokenResponse'
          description: ''
        '404':
          description: Device not found
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/agents/connectors/auth_ia/:
    post:
      operationId: endpoints_agents_connectors_auth_ia_create
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      tags:
      - endpoints
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentAuthenticationResponse'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/agents/connectors/check_in/:
    post:
      operationId: endpoints_agents_connectors_check_in_create
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeviceFactsRequest'
      responses:
        '204':
          description: Successfully checked in
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/agents/connectors/enroll/:
    post:
      operationId: endpoints_agents_connectors_enroll_create
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EnrollRequest'
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentTokenResponse'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/agents/enrollment_tokens/:
    get:
      operationId: endpoints_agents_enrollment_tokens_list
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: query
        name: connector
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: token_uuid
        schema:
          type: string
          format: uuid
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedEnrollmentTokenList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: endpoints_agents_enrollment_tokens_create
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EnrollmentTokenRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnrollmentToken'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/agents/enrollment_tokens/{token_uuid}/:
    get:
      operationId: endpoints_agents_enrollment_tokens_retrieve
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: token_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Enrollment Token.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnrollmentToken'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: endpoints_agents_enrollment_tokens_update
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: token_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Enrollment Token.
        required: true
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EnrollmentTokenRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnrollmentToken'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: endpoints_agents_enrollment_tokens_partial_update
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: token_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Enrollment Token.
        required: true
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedEnrollmentTokenRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnrollmentToken'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: endpoints_agents_enrollment_tokens_destroy
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: token_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Enrollment Token.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/agents/enrollment_tokens/{token_uuid}/used_by/:
    get:
      operationId: endpoints_agents_enrollment_tokens_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: token_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Enrollment Token.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/agents/enrollment_tokens/{token_uuid}/view_key/:
    get:
      operationId: endpoints_agents_enrollment_tokens_view_key_retrieve
      description: Return token key and log access
      parameters:
      - in: path
        name: token_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Enrollment Token.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenView'
          description: ''
        '404':
          description: Token not found or expired
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/connectors/:
    get:
      operationId: endpoints_connectors_list
      description: Connector Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedConnectorList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/connectors/{connector_uuid}/:
    get:
      operationId: endpoints_connectors_retrieve
      description: Connector Viewset
      parameters:
      - in: path
        name: connector_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this connector.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Connector'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: endpoints_connectors_destroy
      description: Connector Viewset
      parameters:
      - in: path
        name: connector_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this connector.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/connectors/{connector_uuid}/used_by/:
    get:
      operationId: endpoints_connectors_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: connector_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this connector.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/connectors/types/:
    get:
      operationId: endpoints_connectors_types_list
      description: Get all creatable types
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TypeCreate'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/device_access_groups/:
    get:
      operationId: endpoints_device_access_groups_list
      description: DeviceAccessGroup Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: pbm_uuid
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedDeviceAccessGroupList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: endpoints_device_access_groups_create
      description: DeviceAccessGroup Viewset
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeviceAccessGroupRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeviceAccessGroup'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/device_access_groups/{pbm_uuid}/:
    get:
      operationId: endpoints_device_access_groups_retrieve
      description: DeviceAccessGroup Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Device access group.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeviceAccessGroup'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: endpoints_device_access_groups_update
      description: DeviceAccessGroup Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Device access group.
        required: true
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeviceAccessGroupRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeviceAccessGroup'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: endpoints_device_access_groups_partial_update
      description: DeviceAccessGroup Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Device access group.
        required: true
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedDeviceAccessGroupRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeviceAccessGroup'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: endpoints_device_access_groups_destroy
      description: DeviceAccessGroup Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Device access group.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/device_access_groups/{pbm_uuid}/used_by/:
    get:
      operationId: endpoints_device_access_groups_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Device access group.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/device_bindings/:
    get:
      operationId: endpoints_device_bindings_list
      description: PolicyBinding Viewset
      parameters:
      - in: query
        name: enabled
        schema:
          type: boolean
      - in: query
        name: order
        schema:
          type: integer
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: policy
        schema:
          type: string
          format: uuid
      - in: query
        name: policy__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: target
        schema:
          type: string
          format: uuid
      - in: query
        name: target_in
        schema:
          type: array
          items:
            type: string
            format: uuid
        explode: true
        style: form
      - in: query
        name: timeout
        schema:
          type: integer
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedPolicyBindingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: endpoints_device_bindings_create
      description: PolicyBinding Viewset
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PolicyBindingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PolicyBinding'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/device_bindings/{policy_binding_uuid}/:
    get:
      operationId: endpoints_device_bindings_retrieve
      description: PolicyBinding Viewset
      parameters:
      - in: path
        name: policy_binding_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Device User binding.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PolicyBinding'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: endpoints_device_bindings_update
      description: PolicyBinding Viewset
      parameters:
      - in: path
        name: policy_binding_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Device User binding.
        required: true
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PolicyBindingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PolicyBinding'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: endpoints_device_bindings_partial_update
      description: PolicyBinding Viewset
      parameters:
      - in: path
        name: policy_binding_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Device User binding.
        required: true
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedPolicyBindingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PolicyBinding'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: endpoints_device_bindings_destroy
      description: PolicyBinding Viewset
      parameters:
      - in: path
        name: policy_binding_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Device User binding.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/device_bindings/{policy_binding_uuid}/used_by/:
    get:
      operationId: endpoints_device_bindings_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: policy_binding_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Device User binding.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/devices/:
    get:
      operationId: endpoints_devices_list
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: query
        name: identifier
        schema:
          type: string
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedEndpointDeviceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/devices/{device_uuid}/:
    get:
      operationId: endpoints_devices_retrieve
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: device_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Device.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EndpointDeviceDetails'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: endpoints_devices_update
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: device_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Device.
        required: true
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EndpointDeviceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EndpointDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: endpoints_devices_partial_update
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: device_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Device.
        required: true
      tags:
      - endpoints
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedEndpointDeviceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EndpointDevice'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: endpoints_devices_destroy
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: device_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Device.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /endpoints/devices/{device_uuid}/used_by/:
    get:
      operationId: endpoints_devices_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: device_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Device.
        required: true
      tags:
      - endpoints
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /enterprise/license/:
    get:
      operationId: enterprise_license_list
      description: License Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - enterprise
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedLicenseList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: enterprise_license_create
      description: License Viewset
      tags:
      - enterprise
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LicenseRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/License'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /enterprise/license/{license_uuid}/:
    get:
      operationId: enterprise_license_retrieve
      description: License Viewset
      parameters:
      - in: path
        name: license_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this License.
        required: true
      tags:
      - enterprise
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/License'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: enterprise_license_update
      description: License Viewset
      parameters:
      - in: path
        name: license_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this License.
        required: true
      tags:
      - enterprise
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LicenseRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/License'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: enterprise_license_partial_update
      description: License Viewset
      parameters:
      - in: path
        name: license_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this License.
        required: true
      tags:
      - enterprise
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedLicenseRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/License'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: enterprise_license_destroy
      description: License Viewset
      parameters:
      - in: path
        name: license_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this License.
        required: true
      tags:
      - enterprise
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /enterprise/license/{license_uuid}/used_by/:
    get:
      operationId: enterprise_license_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: license_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this License.
        required: true
      tags:
      - enterprise
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /enterprise/license/forecast/:
    get:
      operationId: enterprise_license_forecast_retrieve
      description: Forecast how many users will be required in a year
      tags:
      - enterprise
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LicenseForecast'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /enterprise/license/install_id/:
    get:
      operationId: enterprise_license_install_id_retrieve
      description: Get install_id
      tags:
      - enterprise
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InstallID'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /enterprise/license/summary/:
    get:
      operationId: enterprise_license_summary_retrieve
      description: Get the total license status
      parameters:
      - in: query
        name: cached
        schema:
          type: boolean
          default: true
      tags:
      - enterprise
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LicenseSummary'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/events/:
    get:
      operationId: events_events_list
      description: Event Read-Only Viewset
      parameters:
      - in: query
        name: action
        schema:
          type: string
      - in: query
        name: actions
        schema:
          type: array
          items:
            type: string
            enum:
            - authorize_application
            - configuration_error
            - custom_
            - email_sent
            - flow_execution
            - impersonation_ended
            - impersonation_started
            - invitation_used
            - login
            - login_failed
            - logout
            - model_created
            - model_deleted
            - model_updated
            - password_set
            - policy_exception
            - policy_execution
            - property_mapping_exception
            - secret_rotate
            - secret_view
            - source_linked
            - suspicious_request
            - system_exception
            - system_task_exception
            - system_task_execution
            - update_available
            - user_write
        explode: true
        style: form
      - in: query
        name: brand_name
        schema:
          type: string
        description: Brand name
      - in: query
        name: client_ip
        schema:
          type: string
      - in: query
        name: context_authorized_app
        schema:
          type: string
        description: Context Authorized application
      - in: query
        name: context_model_app
        schema:
          type: string
        description: Context Model App
      - in: query
        name: context_model_name
        schema:
          type: string
        description: Context Model Name
      - in: query
        name: context_model_pk
        schema:
          type: string
        description: Context Model Primary Key
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: username
        schema:
          type: string
        description: Username
      tags:
      - events
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedEventList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: events_events_create
      description: Event Read-Only Viewset
      tags:
      - events
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EventRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Event'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/events/{event_uuid}/:
    get:
      operationId: events_events_retrieve
      description: Event Read-Only Viewset
      parameters:
      - in: path
        name: event_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Event.
        required: true
      tags:
      - events
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Event'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: events_events_update
      description: Event Read-Only Viewset
      parameters:
      - in: path
        name: event_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Event.
        required: true
      tags:
      - events
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EventRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Event'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: events_events_partial_update
      description: Event Read-Only Viewset
      parameters:
      - in: path
        name: event_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Event.
        required: true
      tags:
      - events
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedEventRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Event'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: events_events_destroy
      description: Event Read-Only Viewset
      parameters:
      - in: path
        name: event_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Event.
        required: true
      tags:
      - events
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/events/actions/:
    get:
      operationId: events_events_actions_list
      description: Get all actions
      tags:
      - events
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TypeCreate'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/events/top_per_user/:
    get:
      operationId: events_events_top_per_user_list
      description: Get the top_n events grouped by user count
      parameters:
      - in: query
        name: action
        schema:
          type: string
      - in: query
        name: top_n
        schema:
          type: integer
      tags:
      - events
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/EventTopPerUser'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/events/volume/:
    get:
      operationId: events_events_volume_list
      description: Get event volume for specified filters and timeframe
      parameters:
      - in: query
        name: action
        schema:
          type: string
      - in: query
        name: actions
        schema:
          type: array
          items:
            type: string
            enum:
            - authorize_application
            - configuration_error
            - custom_
            - email_sent
            - flow_execution
            - impersonation_ended
            - impersonation_started
            - invitation_used
            - login
            - login_failed
            - logout
            - model_created
            - model_deleted
            - model_updated
            - password_set
            - policy_exception
            - policy_execution
            - property_mapping_exception
            - secret_rotate
            - secret_view
            - source_linked
            - suspicious_request
            - system_exception
            - system_task_exception
            - system_task_execution
            - update_available
            - user_write
        explode: true
        style: form
      - in: query
        name: brand_name
        schema:
          type: string
        description: Brand name
      - in: query
        name: client_ip
        schema:
          type: string
      - in: query
        name: context_authorized_app
        schema:
          type: string
        description: Context Authorized application
      - in: query
        name: context_model_app
        schema:
          type: string
        description: Context Model App
      - in: query
        name: context_model_name
        schema:
          type: string
        description: Context Model Name
      - in: query
        name: context_model_pk
        schema:
          type: string
        description: Context Model Primary Key
      - in: query
        name: history_days
        schema:
          type: number
          default: 7
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: username
        schema:
          type: string
        description: Username
      tags:
      - events
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/EventVolume'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/notifications/:
    get:
      operationId: events_notifications_list
      description: Notification Viewset
      parameters:
      - in: query
        name: body
        schema:
          type: string
      - in: query
        name: created
        schema:
          type: string
          format: date-time
      - in: query
        name: event
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: seen
        schema:
          type: boolean
      - in: query
        name: severity
        schema:
          type: string
          enum:
          - alert
          - notice
          - warning
      - in: query
        name: user
        schema:
          type: integer
      tags:
      - events
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedNotificationList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/notifications/{uuid}/:
    get:
      operationId: events_notifications_retrieve
      description: Notification Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification.
        required: true
      tags:
      - events
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Notification'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: events_notifications_update
      description: Notification Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification.
        required: true
      tags:
      - events
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NotificationRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Notification'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: events_notifications_partial_update
      description: Notification Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification.
        required: true
      tags:
      - events
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedNotificationRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Notification'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: events_notifications_destroy
      description: Notification Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification.
        required: true
      tags:
      - events
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/notifications/{uuid}/used_by/:
    get:
      operationId: events_notifications_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification.
        required: true
      tags:
      - events
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/notifications/mark_all_seen/:
    post:
      operationId: events_notifications_mark_all_seen_create
      description: Mark all the user's notifications as seen
      tags:
      - events
      security:
      - authentik: []
      responses:
        '204':
          description: Marked tasks as read successfully.
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/rules/:
    get:
      operationId: events_rules_list
      description: NotificationRule Viewset
      parameters:
      - in: query
        name: destination_group__name
        schema:
          type: string
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: severity
        schema:
          type: string
          enum:
          - alert
          - notice
          - warning
        description: |+
          Controls which severity level the created notifications will have.

      tags:
      - events
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedNotificationRuleList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: events_rules_create
      description: NotificationRule Viewset
      tags:
      - events
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NotificationRuleRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationRule'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/rules/{pbm_uuid}/:
    get:
      operationId: events_rules_retrieve
      description: NotificationRule Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification Rule.
        required: true
      tags:
      - events
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationRule'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: events_rules_update
      description: NotificationRule Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification Rule.
        required: true
      tags:
      - events
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NotificationRuleRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationRule'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: events_rules_partial_update
      description: NotificationRule Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification Rule.
        required: true
      tags:
      - events
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedNotificationRuleRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationRule'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: events_rules_destroy
      description: NotificationRule Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification Rule.
        required: true
      tags:
      - events
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/rules/{pbm_uuid}/used_by/:
    get:
      operationId: events_rules_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification Rule.
        required: true
      tags:
      - events
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/transports/:
    get:
      operationId: events_transports_list
      description: NotificationTransport Viewset
      parameters:
      - in: query
        name: mode
        schema:
          type: string
          enum:
          - email
          - local
          - webhook
          - webhook_slack
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: send_once
        schema:
          type: boolean
      - in: query
        name: webhook_url
        schema:
          type: string
      tags:
      - events
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedNotificationTransportList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: events_transports_create
      description: NotificationTransport Viewset
      tags:
      - events
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NotificationTransportRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationTransport'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/transports/{uuid}/:
    get:
      operationId: events_transports_retrieve
      description: NotificationTransport Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification Transport.
        required: true
      tags:
      - events
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationTransport'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: events_transports_update
      description: NotificationTransport Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification Transport.
        required: true
      tags:
      - events
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NotificationTransportRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationTransport'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: events_transports_partial_update
      description: NotificationTransport Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification Transport.
        required: true
      tags:
      - events
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedNotificationTransportRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationTransport'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: events_transports_destroy
      description: NotificationTransport Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification Transport.
        required: true
      tags:
      - events
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/transports/{uuid}/test/:
    post:
      operationId: events_transports_test_create
      description: |-
        Send example notification using selected transport. Requires
        Modify permissions.
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification Transport.
        required: true
      tags:
      - events
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationTransportTest'
          description: ''
        '500':
          description: Failed to test transport
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /events/transports/{uuid}/used_by/:
    get:
      operationId: events_transports_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Notification Transport.
        required: true
      tags:
      - events
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/bindings/:
    get:
      operationId: flows_bindings_list
      description: FlowStageBinding Viewset
      parameters:
      - in: query
        name: evaluate_on_plan
        schema:
          type: boolean
      - in: query
        name: fsb_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: invalid_response_action
        schema:
          type: string
          enum:
          - restart
          - restart_with_context
          - retry
        description: |+
          Configure how the flow executor should handle an invalid response to a challenge. RETRY returns the error message and a similar challenge to the executor. RESTART restarts the flow from the beginning, and RESTART_WITH_CONTEXT restarts the flow while keeping the current context.

      - in: query
        name: order
        schema:
          type: integer
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: pbm_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: policies
        schema:
          type: array
          items:
            type: string
            format: uuid
        explode: true
        style: form
      - in: query
        name: policy_engine_mode
        schema:
          type: string
          enum:
          - all
          - any
      - in: query
        name: re_evaluate_policies
        schema:
          type: boolean
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: stage
        schema:
          type: string
          format: uuid
      - in: query
        name: target
        schema:
          type: string
          format: uuid
      tags:
      - flows
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedFlowStageBindingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: flows_bindings_create
      description: FlowStageBinding Viewset
      tags:
      - flows
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FlowStageBindingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FlowStageBinding'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/bindings/{fsb_uuid}/:
    get:
      operationId: flows_bindings_retrieve
      description: FlowStageBinding Viewset
      parameters:
      - in: path
        name: fsb_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Flow Stage Binding.
        required: true
      tags:
      - flows
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FlowStageBinding'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: flows_bindings_update
      description: FlowStageBinding Viewset
      parameters:
      - in: path
        name: fsb_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Flow Stage Binding.
        required: true
      tags:
      - flows
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FlowStageBindingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FlowStageBinding'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: flows_bindings_partial_update
      description: FlowStageBinding Viewset
      parameters:
      - in: path
        name: fsb_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Flow Stage Binding.
        required: true
      tags:
      - flows
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedFlowStageBindingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FlowStageBinding'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: flows_bindings_destroy
      description: FlowStageBinding Viewset
      parameters:
      - in: path
        name: fsb_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Flow Stage Binding.
        required: true
      tags:
      - flows
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/bindings/{fsb_uuid}/used_by/:
    get:
      operationId: flows_bindings_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: fsb_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Flow Stage Binding.
        required: true
      tags:
      - flows
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/executor/{flow_slug}/:
    get:
      operationId: flows_executor_get
      description: Get the next pending challenge from the currently active flow.
      parameters:
      - in: path
        name: flow_slug
        schema:
          type: string
        required: true
      - in: query
        name: query
        schema:
          type: string
        description: Querystring as received
        required: true
      tags:
      - flows
      security:
      - authentik: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChallengeTypes'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: flows_executor_solve
      description: Solve the previously retrieved challenge and advanced to the next
        stage.
      parameters:
      - in: path
        name: flow_slug
        schema:
          type: string
        required: true
      - in: query
        name: query
        schema:
          type: string
        description: Querystring as received
        required: true
      tags:
      - flows
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FlowChallengeResponseRequest'
      security:
      - authentik: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChallengeTypes'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/inspector/{flow_slug}/:
    get:
      operationId: flows_inspector_get
      description: Get current flow state and record it
      parameters:
      - in: path
        name: flow_slug
        schema:
          type: string
        required: true
      tags:
      - flows
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FlowInspection'
          description: ''
        '400':
          description: No flow plan in session.
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/instances/:
    get:
      operationId: flows_instances_list
      description: Flow Viewset
      parameters:
      - in: query
        name: denied_action
        schema:
          type: string
          enum:
          - continue
          - message
          - message_continue
        description: |+
          Configure what should happen when a flow denies access to a user.

      - in: query
        name: designation
        schema:
          type: string
          enum:
          - authentication
          - authorization
          - enrollment
          - invalidation
          - recovery
          - stage_configuration
          - unenrollment
        description: |+
          Decides what this Flow is used for. For example, the Authentication flow is redirect to when an un-authenticated user visits authentik.

      - in: query
        name: flow_uuid
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: slug
        schema:
          type: string
      tags:
      - flows
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedFlowList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: flows_instances_create
      description: Flow Viewset
      tags:
      - flows
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FlowRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Flow'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/instances/{slug}/:
    get:
      operationId: flows_instances_retrieve
      description: Flow Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Visible in the URL.
        required: true
      tags:
      - flows
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Flow'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: flows_instances_update
      description: Flow Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Visible in the URL.
        required: true
      tags:
      - flows
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FlowRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Flow'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: flows_instances_partial_update
      description: Flow Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Visible in the URL.
        required: true
      tags:
      - flows
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedFlowRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Flow'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: flows_instances_destroy
      description: Flow Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Visible in the URL.
        required: true
      tags:
      - flows
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/instances/{slug}/diagram/:
    get:
      operationId: flows_instances_diagram_retrieve
      description: Return diagram for flow with slug `slug`, in the format used by
        flowchart.js
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Visible in the URL.
        required: true
      tags:
      - flows
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FlowDiagram'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/instances/{slug}/execute/:
    get:
      operationId: flows_instances_execute_retrieve
      description: Execute flow for current user
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Visible in the URL.
        required: true
      tags:
      - flows
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Link'
          description: ''
        '400':
          description: Flow not applicable
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/instances/{slug}/export/:
    get:
      operationId: flows_instances_export_retrieve
      description: Export flow to .yaml file
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Visible in the URL.
        required: true
      tags:
      - flows
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: string
                format: binary
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/instances/{slug}/set_background/:
    post:
      operationId: flows_instances_set_background_create
      description: Set Flow background
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Visible in the URL.
        required: true
      tags:
      - flows
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/FileUploadRequest'
      security:
      - authentik: []
      responses:
        '200':
          description: Success
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/instances/{slug}/set_background_url/:
    post:
      operationId: flows_instances_set_background_url_create
      description: Set Flow background (as URL)
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Visible in the URL.
        required: true
      tags:
      - flows
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FilePathRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          description: Success
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/instances/{slug}/used_by/:
    get:
      operationId: flows_instances_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Visible in the URL.
        required: true
      tags:
      - flows
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/instances/cache_clear/:
    post:
      operationId: flows_instances_cache_clear_create
      description: Clear flow cache
      tags:
      - flows
      security:
      - authentik: []
      responses:
        '204':
          description: Successfully cleared cache
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/instances/cache_info/:
    get:
      operationId: flows_instances_cache_info_retrieve
      description: Info about cached flows
      tags:
      - flows
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cache'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /flows/instances/import/:
    post:
      operationId: flows_instances_import_create
      description: Import flow from .yaml file
      tags:
      - flows
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/FileUploadRequest'
      security:
      - authentik: []
      responses:
        '204':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FlowImportResult'
          description: ''
        '400':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FlowImportResult'
          description: ''
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /managed/blueprints/:
    get:
      operationId: managed_blueprints_list
      description: Blueprint instances
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: path
        schema:
          type: string
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - managed
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedBlueprintInstanceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: managed_blueprints_create
      description: Blueprint instances
      tags:
      - managed
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BlueprintInstanceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BlueprintInstance'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /managed/blueprints/{instance_uuid}/:
    get:
      operationId: managed_blueprints_retrieve
      description: Blueprint instances
      parameters:
      - in: path
        name: instance_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Blueprint Instance.
        required: true
      tags:
      - managed
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BlueprintInstance'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: managed_blueprints_update
      description: Blueprint instances
      parameters:
      - in: path
        name: instance_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Blueprint Instance.
        required: true
      tags:
      - managed
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BlueprintInstanceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BlueprintInstance'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: managed_blueprints_partial_update
      description: Blueprint instances
      parameters:
      - in: path
        name: instance_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Blueprint Instance.
        required: true
      tags:
      - managed
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedBlueprintInstanceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BlueprintInstance'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: managed_blueprints_destroy
      description: Blueprint instances
      parameters:
      - in: path
        name: instance_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Blueprint Instance.
        required: true
      tags:
      - managed
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /managed/blueprints/{instance_uuid}/apply/:
    post:
      operationId: managed_blueprints_apply_create
      description: Apply a blueprint
      parameters:
      - in: path
        name: instance_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Blueprint Instance.
        required: true
      tags:
      - managed
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BlueprintInstance'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /managed/blueprints/{instance_uuid}/used_by/:
    get:
      operationId: managed_blueprints_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: instance_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Blueprint Instance.
        required: true
      tags:
      - managed
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /managed/blueprints/available/:
    get:
      operationId: managed_blueprints_available_list
      description: Get blueprints
      tags:
      - managed
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/BlueprintFile'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /oauth2/access_tokens/:
    get:
      operationId: oauth2_access_tokens_list
      description: AccessToken Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: provider
        schema:
          type: integer
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: user
        schema:
          type: integer
      tags:
      - oauth2
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedTokenModelList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /oauth2/access_tokens/{id}/:
    get:
      operationId: oauth2_access_tokens_retrieve
      description: AccessToken Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this OAuth2 Access Token.
        required: true
      tags:
      - oauth2
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenModel'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: oauth2_access_tokens_destroy
      description: AccessToken Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this OAuth2 Access Token.
        required: true
      tags:
      - oauth2
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /oauth2/access_tokens/{id}/used_by/:
    get:
      operationId: oauth2_access_tokens_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this OAuth2 Access Token.
        required: true
      tags:
      - oauth2
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /oauth2/authorization_codes/:
    get:
      operationId: oauth2_authorization_codes_list
      description: AuthorizationCode Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: provider
        schema:
          type: integer
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: user
        schema:
          type: integer
      tags:
      - oauth2
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedExpiringBaseGrantModelList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /oauth2/authorization_codes/{id}/:
    get:
      operationId: oauth2_authorization_codes_retrieve
      description: AuthorizationCode Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Authorization Code.
        required: true
      tags:
      - oauth2
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExpiringBaseGrantModel'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: oauth2_authorization_codes_destroy
      description: AuthorizationCode Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Authorization Code.
        required: true
      tags:
      - oauth2
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /oauth2/authorization_codes/{id}/used_by/:
    get:
      operationId: oauth2_authorization_codes_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Authorization Code.
        required: true
      tags:
      - oauth2
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /oauth2/refresh_tokens/:
    get:
      operationId: oauth2_refresh_tokens_list
      description: RefreshToken Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: provider
        schema:
          type: integer
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: user
        schema:
          type: integer
      tags:
      - oauth2
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedTokenModelList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /oauth2/refresh_tokens/{id}/:
    get:
      operationId: oauth2_refresh_tokens_retrieve
      description: RefreshToken Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this OAuth2 Refresh Token.
        required: true
      tags:
      - oauth2
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenModel'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: oauth2_refresh_tokens_destroy
      description: RefreshToken Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this OAuth2 Refresh Token.
        required: true
      tags:
      - oauth2
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /oauth2/refresh_tokens/{id}/used_by/:
    get:
      operationId: oauth2_refresh_tokens_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this OAuth2 Refresh Token.
        required: true
      tags:
      - oauth2
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/instances/:
    get:
      operationId: outposts_instances_list
      description: Outpost Viewset
      parameters:
      - in: query
        name: managed__icontains
        schema:
          type: string
      - in: query
        name: managed__iexact
        schema:
          type: string
      - in: query
        name: name__icontains
        schema:
          type: string
      - in: query
        name: name__iexact
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: providers__isnull
        schema:
          type: boolean
      - in: query
        name: providers_by_pk
        schema:
          type: array
          items:
            type: integer
        explode: true
        style: form
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: service_connection__name__icontains
        schema:
          type: string
      - in: query
        name: service_connection__name__iexact
        schema:
          type: string
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedOutpostList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: outposts_instances_create
      description: Outpost Viewset
      tags:
      - outposts
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OutpostRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Outpost'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/instances/{uuid}/:
    get:
      operationId: outposts_instances_retrieve
      description: Outpost Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Outpost.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Outpost'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: outposts_instances_update
      description: Outpost Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Outpost.
        required: true
      tags:
      - outposts
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OutpostRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Outpost'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: outposts_instances_partial_update
      description: Outpost Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Outpost.
        required: true
      tags:
      - outposts
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedOutpostRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Outpost'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: outposts_instances_destroy
      description: Outpost Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Outpost.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/instances/{uuid}/health/:
    get:
      operationId: outposts_instances_health_list
      description: Get outposts current health
      parameters:
      - in: query
        name: managed__icontains
        schema:
          type: string
      - in: query
        name: managed__iexact
        schema:
          type: string
      - in: query
        name: name__icontains
        schema:
          type: string
      - in: query
        name: name__iexact
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - in: query
        name: providers__isnull
        schema:
          type: boolean
      - in: query
        name: providers_by_pk
        schema:
          type: array
          items:
            type: integer
        explode: true
        style: form
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: service_connection__name__icontains
        schema:
          type: string
      - in: query
        name: service_connection__name__iexact
        schema:
          type: string
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Outpost.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OutpostHealth'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/instances/{uuid}/used_by/:
    get:
      operationId: outposts_instances_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Outpost.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/instances/default_settings/:
    get:
      operationId: outposts_instances_default_settings_retrieve
      description: Global default outpost config
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OutpostDefaultConfig'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/ldap/:
    get:
      operationId: outposts_ldap_list
      description: LDAPProvider Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedLDAPOutpostConfigList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/ldap/{id}/check_access/:
    get:
      operationId: outposts_ldap_access_check
      description: Check access to a single application by slug
      parameters:
      - in: query
        name: app_slug
        schema:
          type: string
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this LDAP Provider.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LDAPCheckAccess'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/proxy/:
    get:
      operationId: outposts_proxy_list
      description: ProxyProvider Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedProxyOutpostConfigList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/radius/:
    get:
      operationId: outposts_radius_list
      description: RadiusProvider Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedRadiusOutpostConfigList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/radius/{id}/check_access/:
    get:
      operationId: outposts_radius_access_check
      description: Check access to a single application by slug
      parameters:
      - in: query
        name: app_slug
        schema:
          type: string
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Radius Provider.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RadiusCheckAccess'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/service_connections/all/:
    get:
      operationId: outposts_service_connections_all_list
      description: ServiceConnection Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedServiceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/service_connections/all/{uuid}/:
    get:
      operationId: outposts_service_connections_all_retrieve
      description: ServiceConnection Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Outpost Service-Connection.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: outposts_service_connections_all_destroy
      description: ServiceConnection Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Outpost Service-Connection.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/service_connections/all/{uuid}/state/:
    get:
      operationId: outposts_service_connections_all_state_retrieve
      description: Get the service connection's state
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Outpost Service-Connection.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceConnectionState'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/service_connections/all/{uuid}/used_by/:
    get:
      operationId: outposts_service_connections_all_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Outpost Service-Connection.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/service_connections/all/types/:
    get:
      operationId: outposts_service_connections_all_types_list
      description: Get all creatable types
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TypeCreate'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/service_connections/docker/:
    get:
      operationId: outposts_service_connections_docker_list
      description: DockerServiceConnection Viewset
      parameters:
      - in: query
        name: local
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: tls_authentication
        schema:
          type: string
          format: uuid
      - in: query
        name: tls_verification
        schema:
          type: string
          format: uuid
      - in: query
        name: url
        schema:
          type: string
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedDockerServiceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: outposts_service_connections_docker_create
      description: DockerServiceConnection Viewset
      tags:
      - outposts
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DockerServiceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DockerServiceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/service_connections/docker/{uuid}/:
    get:
      operationId: outposts_service_connections_docker_retrieve
      description: DockerServiceConnection Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Docker Service-Connection.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DockerServiceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: outposts_service_connections_docker_update
      description: DockerServiceConnection Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Docker Service-Connection.
        required: true
      tags:
      - outposts
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DockerServiceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DockerServiceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: outposts_service_connections_docker_partial_update
      description: DockerServiceConnection Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Docker Service-Connection.
        required: true
      tags:
      - outposts
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedDockerServiceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DockerServiceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: outposts_service_connections_docker_destroy
      description: DockerServiceConnection Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Docker Service-Connection.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/service_connections/docker/{uuid}/used_by/:
    get:
      operationId: outposts_service_connections_docker_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Docker Service-Connection.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/service_connections/kubernetes/:
    get:
      operationId: outposts_service_connections_kubernetes_list
      description: KubernetesServiceConnection Viewset
      parameters:
      - in: query
        name: local
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedKubernetesServiceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: outposts_service_connections_kubernetes_create
      description: KubernetesServiceConnection Viewset
      tags:
      - outposts
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/KubernetesServiceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KubernetesServiceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/service_connections/kubernetes/{uuid}/:
    get:
      operationId: outposts_service_connections_kubernetes_retrieve
      description: KubernetesServiceConnection Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Kubernetes Service-Connection.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KubernetesServiceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: outposts_service_connections_kubernetes_update
      description: KubernetesServiceConnection Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Kubernetes Service-Connection.
        required: true
      tags:
      - outposts
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/KubernetesServiceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KubernetesServiceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: outposts_service_connections_kubernetes_partial_update
      description: KubernetesServiceConnection Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Kubernetes Service-Connection.
        required: true
      tags:
      - outposts
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedKubernetesServiceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KubernetesServiceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: outposts_service_connections_kubernetes_destroy
      description: KubernetesServiceConnection Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Kubernetes Service-Connection.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /outposts/service_connections/kubernetes/{uuid}/used_by/:
    get:
      operationId: outposts_service_connections_kubernetes_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Kubernetes Service-Connection.
        required: true
      tags:
      - outposts
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/all/:
    get:
      operationId: policies_all_list
      description: Policy Viewset
      parameters:
      - in: query
        name: bindings__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: promptstage__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedPolicyList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/all/{policy_uuid}/:
    get:
      operationId: policies_all_retrieve
      description: Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Policy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: policies_all_destroy
      description: Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/all/{policy_uuid}/test/:
    post:
      operationId: policies_all_test_create
      description: Test policy
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PolicyTestRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PolicyTestResult'
          description: ''
        '400':
          description: Invalid parameters
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/all/{policy_uuid}/used_by/:
    get:
      operationId: policies_all_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/all/cache_clear/:
    post:
      operationId: policies_all_cache_clear_create
      description: Clear policy cache
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '204':
          description: Successfully cleared cache
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/all/cache_info/:
    get:
      operationId: policies_all_cache_info_retrieve
      description: Info about cached policies
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cache'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/all/types/:
    get:
      operationId: policies_all_types_list
      description: Get all creatable types
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TypeCreate'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/bindings/:
    get:
      operationId: policies_bindings_list
      description: PolicyBinding Viewset
      parameters:
      - in: query
        name: enabled
        schema:
          type: boolean
      - in: query
        name: order
        schema:
          type: integer
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: policy
        schema:
          type: string
          format: uuid
      - in: query
        name: policy__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: target
        schema:
          type: string
          format: uuid
      - in: query
        name: target_in
        schema:
          type: array
          items:
            type: string
            format: uuid
        explode: true
        style: form
      - in: query
        name: timeout
        schema:
          type: integer
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedPolicyBindingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: policies_bindings_create
      description: PolicyBinding Viewset
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PolicyBindingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PolicyBinding'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/bindings/{policy_binding_uuid}/:
    get:
      operationId: policies_bindings_retrieve
      description: PolicyBinding Viewset
      parameters:
      - in: path
        name: policy_binding_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Policy Binding.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PolicyBinding'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: policies_bindings_update
      description: PolicyBinding Viewset
      parameters:
      - in: path
        name: policy_binding_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Policy Binding.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PolicyBindingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PolicyBinding'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: policies_bindings_partial_update
      description: PolicyBinding Viewset
      parameters:
      - in: path
        name: policy_binding_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Policy Binding.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedPolicyBindingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PolicyBinding'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: policies_bindings_destroy
      description: PolicyBinding Viewset
      parameters:
      - in: path
        name: policy_binding_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Policy Binding.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/bindings/{policy_binding_uuid}/used_by/:
    get:
      operationId: policies_bindings_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: policy_binding_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Policy Binding.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/dummy/:
    get:
      operationId: policies_dummy_list
      description: Dummy Viewset
      parameters:
      - in: query
        name: created
        schema:
          type: string
          format: date-time
      - in: query
        name: execution_logging
        schema:
          type: boolean
      - in: query
        name: last_updated
        schema:
          type: string
          format: date-time
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: policy_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: result
        schema:
          type: boolean
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: wait_max
        schema:
          type: integer
      - in: query
        name: wait_min
        schema:
          type: integer
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedDummyPolicyList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: policies_dummy_create
      description: Dummy Viewset
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DummyPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DummyPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/dummy/{policy_uuid}/:
    get:
      operationId: policies_dummy_retrieve
      description: Dummy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Dummy Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DummyPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: policies_dummy_update
      description: Dummy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Dummy Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DummyPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DummyPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: policies_dummy_partial_update
      description: Dummy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Dummy Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedDummyPolicyRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DummyPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: policies_dummy_destroy
      description: Dummy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Dummy Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/dummy/{policy_uuid}/used_by/:
    get:
      operationId: policies_dummy_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Dummy Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/event_matcher/:
    get:
      operationId: policies_event_matcher_list
      description: Event Matcher Policy Viewset
      parameters:
      - in: query
        name: action
        schema:
          type: string
          nullable: true
          enum:
          - authorize_application
          - configuration_error
          - custom_
          - email_sent
          - flow_execution
          - impersonation_ended
          - impersonation_started
          - invitation_used
          - login
          - login_failed
          - logout
          - model_created
          - model_deleted
          - model_updated
          - password_set
          - policy_exception
          - policy_execution
          - property_mapping_exception
          - secret_rotate
          - secret_view
          - source_linked
          - suspicious_request
          - system_exception
          - system_task_exception
          - system_task_execution
          - update_available
          - user_write
        description: |+
          Match created events with this action type. When left empty, all action types will be matched.

      - in: query
        name: app
        schema:
          type: string
      - in: query
        name: client_ip
        schema:
          type: string
      - in: query
        name: created
        schema:
          type: string
          format: date-time
      - in: query
        name: execution_logging
        schema:
          type: boolean
      - in: query
        name: last_updated
        schema:
          type: string
          format: date-time
      - in: query
        name: model
        schema:
          type: string
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: policy_uuid
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedEventMatcherPolicyList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: policies_event_matcher_create
      description: Event Matcher Policy Viewset
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EventMatcherPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EventMatcherPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/event_matcher/{policy_uuid}/:
    get:
      operationId: policies_event_matcher_retrieve
      description: Event Matcher Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Event Matcher Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EventMatcherPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: policies_event_matcher_update
      description: Event Matcher Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Event Matcher Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EventMatcherPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EventMatcherPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: policies_event_matcher_partial_update
      description: Event Matcher Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Event Matcher Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedEventMatcherPolicyRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EventMatcherPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: policies_event_matcher_destroy
      description: Event Matcher Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Event Matcher Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/event_matcher/{policy_uuid}/used_by/:
    get:
      operationId: policies_event_matcher_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Event Matcher Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/expression/:
    get:
      operationId: policies_expression_list
      description: Source Viewset
      parameters:
      - in: query
        name: created
        schema:
          type: string
          format: date-time
      - in: query
        name: execution_logging
        schema:
          type: boolean
      - in: query
        name: expression
        schema:
          type: string
      - in: query
        name: last_updated
        schema:
          type: string
          format: date-time
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: policy_uuid
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedExpressionPolicyList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: policies_expression_create
      description: Source Viewset
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpressionPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExpressionPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/expression/{policy_uuid}/:
    get:
      operationId: policies_expression_retrieve
      description: Source Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Expression Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExpressionPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: policies_expression_update
      description: Source Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Expression Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExpressionPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExpressionPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: policies_expression_partial_update
      description: Source Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Expression Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedExpressionPolicyRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExpressionPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: policies_expression_destroy
      description: Source Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Expression Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/expression/{policy_uuid}/used_by/:
    get:
      operationId: policies_expression_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Expression Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/geoip/:
    get:
      operationId: policies_geoip_list
      description: GeoIP Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGeoIPPolicyList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: policies_geoip_create
      description: GeoIP Viewset
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GeoIPPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GeoIPPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/geoip/{policy_uuid}/:
    get:
      operationId: policies_geoip_retrieve
      description: GeoIP Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this GeoIP Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GeoIPPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: policies_geoip_update
      description: GeoIP Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this GeoIP Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GeoIPPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GeoIPPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: policies_geoip_partial_update
      description: GeoIP Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this GeoIP Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedGeoIPPolicyRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GeoIPPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: policies_geoip_destroy
      description: GeoIP Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this GeoIP Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/geoip/{policy_uuid}/used_by/:
    get:
      operationId: policies_geoip_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this GeoIP Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/geoip_iso3166/:
    get:
      operationId: policies_geoip_iso3166_list
      description: Get all countries in ISO-3166-1
      tags:
      - policies
      security:
      - authentik: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DetailedCountry'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/password/:
    get:
      operationId: policies_password_list
      description: Password Policy Viewset
      parameters:
      - in: query
        name: amount_digits
        schema:
          type: integer
      - in: query
        name: amount_lowercase
        schema:
          type: integer
      - in: query
        name: amount_symbols
        schema:
          type: integer
      - in: query
        name: amount_uppercase
        schema:
          type: integer
      - in: query
        name: check_have_i_been_pwned
        schema:
          type: boolean
      - in: query
        name: check_static_rules
        schema:
          type: boolean
      - in: query
        name: check_zxcvbn
        schema:
          type: boolean
      - in: query
        name: created
        schema:
          type: string
          format: date-time
      - in: query
        name: error_message
        schema:
          type: string
      - in: query
        name: execution_logging
        schema:
          type: boolean
      - in: query
        name: hibp_allowed_count
        schema:
          type: integer
      - in: query
        name: last_updated
        schema:
          type: string
          format: date-time
      - in: query
        name: length_min
        schema:
          type: integer
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: password_field
        schema:
          type: string
      - in: query
        name: policy_uuid
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: symbol_charset
        schema:
          type: string
      - in: query
        name: zxcvbn_score_threshold
        schema:
          type: integer
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedPasswordPolicyList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: policies_password_create
      description: Password Policy Viewset
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/password/{policy_uuid}/:
    get:
      operationId: policies_password_retrieve
      description: Password Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: policies_password_update
      description: Password Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: policies_password_partial_update
      description: Password Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedPasswordPolicyRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: policies_password_destroy
      description: Password Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/password/{policy_uuid}/used_by/:
    get:
      operationId: policies_password_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/password_expiry/:
    get:
      operationId: policies_password_expiry_list
      description: Password Expiry Viewset
      parameters:
      - in: query
        name: created
        schema:
          type: string
          format: date-time
      - in: query
        name: days
        schema:
          type: integer
      - in: query
        name: deny_only
        schema:
          type: boolean
      - in: query
        name: execution_logging
        schema:
          type: boolean
      - in: query
        name: last_updated
        schema:
          type: string
          format: date-time
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: policy_uuid
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedPasswordExpiryPolicyList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: policies_password_expiry_create
      description: Password Expiry Viewset
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordExpiryPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordExpiryPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/password_expiry/{policy_uuid}/:
    get:
      operationId: policies_password_expiry_retrieve
      description: Password Expiry Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Expiry Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordExpiryPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: policies_password_expiry_update
      description: Password Expiry Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Expiry Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordExpiryPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordExpiryPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: policies_password_expiry_partial_update
      description: Password Expiry Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Expiry Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedPasswordExpiryPolicyRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordExpiryPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: policies_password_expiry_destroy
      description: Password Expiry Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Expiry Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/password_expiry/{policy_uuid}/used_by/:
    get:
      operationId: policies_password_expiry_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Expiry Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/reputation/:
    get:
      operationId: policies_reputation_list
      description: Reputation Policy Viewset
      parameters:
      - in: query
        name: check_ip
        schema:
          type: boolean
      - in: query
        name: check_username
        schema:
          type: boolean
      - in: query
        name: created
        schema:
          type: string
          format: date-time
      - in: query
        name: execution_logging
        schema:
          type: boolean
      - in: query
        name: last_updated
        schema:
          type: string
          format: date-time
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: policy_uuid
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: threshold
        schema:
          type: integer
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedReputationPolicyList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: policies_reputation_create
      description: Reputation Policy Viewset
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReputationPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReputationPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/reputation/{policy_uuid}/:
    get:
      operationId: policies_reputation_retrieve
      description: Reputation Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Reputation Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReputationPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: policies_reputation_update
      description: Reputation Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Reputation Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReputationPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReputationPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: policies_reputation_partial_update
      description: Reputation Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Reputation Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedReputationPolicyRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReputationPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: policies_reputation_destroy
      description: Reputation Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Reputation Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/reputation/{policy_uuid}/used_by/:
    get:
      operationId: policies_reputation_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Reputation Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/reputation/scores/:
    get:
      operationId: policies_reputation_scores_list
      description: Reputation Viewset
      parameters:
      - in: query
        name: identifier
        schema:
          type: string
      - in: query
        name: identifier_in
        schema:
          type: array
          items:
            type: string
        description: Multiple values may be separated by commas.
        explode: false
        style: form
      - in: query
        name: ip
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: score
        schema:
          type: integer
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedReputationList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/reputation/scores/{reputation_uuid}/:
    get:
      operationId: policies_reputation_scores_retrieve
      description: Reputation Viewset
      parameters:
      - in: path
        name: reputation_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Reputation Score.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Reputation'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: policies_reputation_scores_destroy
      description: Reputation Viewset
      parameters:
      - in: path
        name: reputation_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Reputation Score.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/reputation/scores/{reputation_uuid}/used_by/:
    get:
      operationId: policies_reputation_scores_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: reputation_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Reputation Score.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/unique_password/:
    get:
      operationId: policies_unique_password_list
      description: Password Uniqueness Policy Viewset
      parameters:
      - in: query
        name: created
        schema:
          type: string
          format: date-time
      - in: query
        name: execution_logging
        schema:
          type: boolean
      - in: query
        name: last_updated
        schema:
          type: string
          format: date-time
      - $ref: '#/components/parameters/QueryName'
      - in: query
        name: num_historical_passwords
        schema:
          type: integer
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: password_field
        schema:
          type: string
      - in: query
        name: policy_uuid
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUniquePasswordPolicyList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: policies_unique_password_create
      description: Password Uniqueness Policy Viewset
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UniquePasswordPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UniquePasswordPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/unique_password/{policy_uuid}/:
    get:
      operationId: policies_unique_password_retrieve
      description: Password Uniqueness Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Uniqueness Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UniquePasswordPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: policies_unique_password_update
      description: Password Uniqueness Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Uniqueness Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UniquePasswordPolicyRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UniquePasswordPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: policies_unique_password_partial_update
      description: Password Uniqueness Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Uniqueness Policy.
        required: true
      tags:
      - policies
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedUniquePasswordPolicyRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UniquePasswordPolicy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: policies_unique_password_destroy
      description: Password Uniqueness Policy Viewset
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Uniqueness Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /policies/unique_password/{policy_uuid}/used_by/:
    get:
      operationId: policies_unique_password_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: policy_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Uniqueness Policy.
        required: true
      tags:
      - policies
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/all/:
    get:
      operationId: propertymappings_all_list
      description: PropertyMapping Viewset
      parameters:
      - in: query
        name: managed
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - in: query
        name: managed__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedPropertyMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/all/{pm_uuid}/:
    get:
      operationId: propertymappings_all_retrieve
      description: PropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_all_destroy
      description: PropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/all/{pm_uuid}/test/:
    post:
      operationId: propertymappings_all_test_create
      description: Test Property Mapping
      parameters:
      - in: query
        name: format_result
        schema:
          type: boolean
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PropertyMappingTestRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PropertyMappingTestResult'
          description: ''
        '400':
          description: Invalid parameters
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/all/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_all_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/all/types/:
    get:
      operationId: propertymappings_all_types_list
      description: Get all creatable types
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TypeCreate'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/notification/:
    get:
      operationId: propertymappings_notification_list
      description: NotificationWebhookMapping Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedNotificationWebhookMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: propertymappings_notification_create
      description: NotificationWebhookMapping Viewset
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NotificationWebhookMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationWebhookMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/notification/{pm_uuid}/:
    get:
      operationId: propertymappings_notification_retrieve
      description: NotificationWebhookMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Webhook Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationWebhookMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: propertymappings_notification_update
      description: NotificationWebhookMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Webhook Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NotificationWebhookMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationWebhookMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: propertymappings_notification_partial_update
      description: NotificationWebhookMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Webhook Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedNotificationWebhookMappingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationWebhookMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_notification_destroy
      description: NotificationWebhookMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Webhook Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/notification/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_notification_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Webhook Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/google_workspace/:
    get:
      operationId: propertymappings_provider_google_workspace_list
      description: GoogleWorkspaceProviderMapping Viewset
      parameters:
      - in: query
        name: expression
        schema:
          type: string
      - in: query
        name: managed
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: pm_uuid
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGoogleWorkspaceProviderMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: propertymappings_provider_google_workspace_create
      description: GoogleWorkspaceProviderMapping Viewset
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoogleWorkspaceProviderMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleWorkspaceProviderMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/google_workspace/{pm_uuid}/:
    get:
      operationId: propertymappings_provider_google_workspace_retrieve
      description: GoogleWorkspaceProviderMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Google Workspace Provider Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleWorkspaceProviderMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: propertymappings_provider_google_workspace_update
      description: GoogleWorkspaceProviderMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Google Workspace Provider Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoogleWorkspaceProviderMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleWorkspaceProviderMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: propertymappings_provider_google_workspace_partial_update
      description: GoogleWorkspaceProviderMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Google Workspace Provider Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedGoogleWorkspaceProviderMappingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleWorkspaceProviderMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_provider_google_workspace_destroy
      description: GoogleWorkspaceProviderMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Google Workspace Provider Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/google_workspace/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_provider_google_workspace_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Google Workspace Provider Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/microsoft_entra/:
    get:
      operationId: propertymappings_provider_microsoft_entra_list
      description: MicrosoftEntraProviderMapping Viewset
      parameters:
      - in: query
        name: expression
        schema:
          type: string
      - in: query
        name: managed
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: pm_uuid
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedMicrosoftEntraProviderMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: propertymappings_provider_microsoft_entra_create
      description: MicrosoftEntraProviderMapping Viewset
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MicrosoftEntraProviderMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MicrosoftEntraProviderMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/microsoft_entra/{pm_uuid}/:
    get:
      operationId: propertymappings_provider_microsoft_entra_retrieve
      description: MicrosoftEntraProviderMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Microsoft Entra Provider Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MicrosoftEntraProviderMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: propertymappings_provider_microsoft_entra_update
      description: MicrosoftEntraProviderMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Microsoft Entra Provider Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MicrosoftEntraProviderMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MicrosoftEntraProviderMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: propertymappings_provider_microsoft_entra_partial_update
      description: MicrosoftEntraProviderMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Microsoft Entra Provider Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedMicrosoftEntraProviderMappingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MicrosoftEntraProviderMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_provider_microsoft_entra_destroy
      description: MicrosoftEntraProviderMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Microsoft Entra Provider Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/microsoft_entra/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_provider_microsoft_entra_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Microsoft Entra Provider Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/rac/:
    get:
      operationId: propertymappings_provider_rac_list
      description: RACPropertyMapping Viewset
      parameters:
      - in: query
        name: managed
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedRACPropertyMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: propertymappings_provider_rac_create
      description: RACPropertyMapping Viewset
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RACPropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RACPropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/rac/{pm_uuid}/:
    get:
      operationId: propertymappings_provider_rac_retrieve
      description: RACPropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this RAC Provider Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RACPropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: propertymappings_provider_rac_update
      description: RACPropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this RAC Provider Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RACPropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RACPropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: propertymappings_provider_rac_partial_update
      description: RACPropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this RAC Provider Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedRACPropertyMappingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RACPropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_provider_rac_destroy
      description: RACPropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this RAC Provider Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/rac/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_provider_rac_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this RAC Provider Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/radius/:
    get:
      operationId: propertymappings_provider_radius_list
      description: RadiusProviderPropertyMapping Viewset
      parameters:
      - in: query
        name: managed
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - in: query
        name: managed__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedRadiusProviderPropertyMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: propertymappings_provider_radius_create
      description: RadiusProviderPropertyMapping Viewset
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RadiusProviderPropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RadiusProviderPropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/radius/{pm_uuid}/:
    get:
      operationId: propertymappings_provider_radius_retrieve
      description: RadiusProviderPropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Radius Provider Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RadiusProviderPropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: propertymappings_provider_radius_update
      description: RadiusProviderPropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Radius Provider Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RadiusProviderPropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RadiusProviderPropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: propertymappings_provider_radius_partial_update
      description: RadiusProviderPropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Radius Provider Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedRadiusProviderPropertyMappingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RadiusProviderPropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_provider_radius_destroy
      description: RadiusProviderPropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Radius Provider Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/radius/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_provider_radius_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Radius Provider Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/saml/:
    get:
      operationId: propertymappings_provider_saml_list
      description: SAMLPropertyMapping Viewset
      parameters:
      - in: query
        name: friendly_name
        schema:
          type: string
      - in: query
        name: managed
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - in: query
        name: managed__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: saml_name
        schema:
          type: string
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSAMLPropertyMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: propertymappings_provider_saml_create
      description: SAMLPropertyMapping Viewset
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SAMLPropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLPropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/saml/{pm_uuid}/:
    get:
      operationId: propertymappings_provider_saml_retrieve
      description: SAMLPropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SAML Provider Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLPropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: propertymappings_provider_saml_update
      description: SAMLPropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SAML Provider Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SAMLPropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLPropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: propertymappings_provider_saml_partial_update
      description: SAMLPropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SAML Provider Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSAMLPropertyMappingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLPropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_provider_saml_destroy
      description: SAMLPropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SAML Provider Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/saml/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_provider_saml_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SAML Provider Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/scim/:
    get:
      operationId: propertymappings_provider_scim_list
      description: SCIMMapping Viewset
      parameters:
      - in: query
        name: managed
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - in: query
        name: managed__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSCIMMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: propertymappings_provider_scim_create
      description: SCIMMapping Viewset
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SCIMMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/scim/{pm_uuid}/:
    get:
      operationId: propertymappings_provider_scim_retrieve
      description: SCIMMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SCIM Provider Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: propertymappings_provider_scim_update
      description: SCIMMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SCIM Provider Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SCIMMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: propertymappings_provider_scim_partial_update
      description: SCIMMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SCIM Provider Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSCIMMappingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_provider_scim_destroy
      description: SCIMMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SCIM Provider Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/scim/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_provider_scim_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SCIM Provider Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/scope/:
    get:
      operationId: propertymappings_provider_scope_list
      description: ScopeMapping Viewset
      parameters:
      - in: query
        name: managed
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - in: query
        name: managed__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: scope_name
        schema:
          type: string
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedScopeMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: propertymappings_provider_scope_create
      description: ScopeMapping Viewset
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ScopeMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScopeMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/scope/{pm_uuid}/:
    get:
      operationId: propertymappings_provider_scope_retrieve
      description: ScopeMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Scope Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScopeMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: propertymappings_provider_scope_update
      description: ScopeMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Scope Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ScopeMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScopeMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: propertymappings_provider_scope_partial_update
      description: ScopeMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Scope Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedScopeMappingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScopeMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_provider_scope_destroy
      description: ScopeMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Scope Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/provider/scope/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_provider_scope_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Scope Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/kerberos/:
    get:
      operationId: propertymappings_source_kerberos_list
      description: KerberosSource PropertyMapping Viewset
      parameters:
      - in: query
        name: managed
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - in: query
        name: managed__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedKerberosSourcePropertyMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: propertymappings_source_kerberos_create
      description: KerberosSource PropertyMapping Viewset
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/KerberosSourcePropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KerberosSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/kerberos/{pm_uuid}/:
    get:
      operationId: propertymappings_source_kerberos_retrieve
      description: KerberosSource PropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Kerberos Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KerberosSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: propertymappings_source_kerberos_update
      description: KerberosSource PropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Kerberos Source Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/KerberosSourcePropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KerberosSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: propertymappings_source_kerberos_partial_update
      description: KerberosSource PropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Kerberos Source Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedKerberosSourcePropertyMappingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KerberosSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_source_kerberos_destroy
      description: KerberosSource PropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Kerberos Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/kerberos/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_source_kerberos_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Kerberos Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/ldap/:
    get:
      operationId: propertymappings_source_ldap_list
      description: LDAP PropertyMapping Viewset
      parameters:
      - in: query
        name: managed
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - in: query
        name: managed__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedLDAPSourcePropertyMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: propertymappings_source_ldap_create
      description: LDAP PropertyMapping Viewset
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LDAPSourcePropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LDAPSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/ldap/{pm_uuid}/:
    get:
      operationId: propertymappings_source_ldap_retrieve
      description: LDAP PropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this LDAP Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LDAPSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: propertymappings_source_ldap_update
      description: LDAP PropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this LDAP Source Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LDAPSourcePropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LDAPSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: propertymappings_source_ldap_partial_update
      description: LDAP PropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this LDAP Source Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedLDAPSourcePropertyMappingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LDAPSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_source_ldap_destroy
      description: LDAP PropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this LDAP Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/ldap/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_source_ldap_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this LDAP Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/oauth/:
    get:
      operationId: propertymappings_source_oauth_list
      description: OAuthSourcePropertyMapping Viewset
      parameters:
      - in: query
        name: managed
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - in: query
        name: managed__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedOAuthSourcePropertyMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: propertymappings_source_oauth_create
      description: OAuthSourcePropertyMapping Viewset
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OAuthSourcePropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/oauth/{pm_uuid}/:
    get:
      operationId: propertymappings_source_oauth_retrieve
      description: OAuthSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this OAuth Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: propertymappings_source_oauth_update
      description: OAuthSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this OAuth Source Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OAuthSourcePropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: propertymappings_source_oauth_partial_update
      description: OAuthSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this OAuth Source Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedOAuthSourcePropertyMappingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_source_oauth_destroy
      description: OAuthSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this OAuth Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/oauth/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_source_oauth_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this OAuth Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/plex/:
    get:
      operationId: propertymappings_source_plex_list
      description: PlexSourcePropertyMapping Viewset
      parameters:
      - in: query
        name: managed
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - in: query
        name: managed__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedPlexSourcePropertyMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: propertymappings_source_plex_create
      description: PlexSourcePropertyMapping Viewset
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PlexSourcePropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlexSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/plex/{pm_uuid}/:
    get:
      operationId: propertymappings_source_plex_retrieve
      description: PlexSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Plex Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlexSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: propertymappings_source_plex_update
      description: PlexSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Plex Source Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PlexSourcePropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlexSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: propertymappings_source_plex_partial_update
      description: PlexSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Plex Source Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedPlexSourcePropertyMappingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlexSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_source_plex_destroy
      description: PlexSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Plex Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/plex/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_source_plex_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Plex Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/saml/:
    get:
      operationId: propertymappings_source_saml_list
      description: SAMLSourcePropertyMapping Viewset
      parameters:
      - in: query
        name: managed
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - in: query
        name: managed__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSAMLSourcePropertyMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: propertymappings_source_saml_create
      description: SAMLSourcePropertyMapping Viewset
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SAMLSourcePropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/saml/{pm_uuid}/:
    get:
      operationId: propertymappings_source_saml_retrieve
      description: SAMLSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SAML Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: propertymappings_source_saml_update
      description: SAMLSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SAML Source Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SAMLSourcePropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: propertymappings_source_saml_partial_update
      description: SAMLSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SAML Source Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSAMLSourcePropertyMappingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_source_saml_destroy
      description: SAMLSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SAML Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/saml/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_source_saml_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SAML Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/scim/:
    get:
      operationId: propertymappings_source_scim_list
      description: SCIMSourcePropertyMapping Viewset
      parameters:
      - in: query
        name: managed
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - in: query
        name: managed__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSCIMSourcePropertyMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: propertymappings_source_scim_create
      description: SCIMSourcePropertyMapping Viewset
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SCIMSourcePropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/scim/{pm_uuid}/:
    get:
      operationId: propertymappings_source_scim_retrieve
      description: SCIMSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SCIM Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: propertymappings_source_scim_update
      description: SCIMSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SCIM Source Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SCIMSourcePropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: propertymappings_source_scim_partial_update
      description: SCIMSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SCIM Source Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSCIMSourcePropertyMappingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_source_scim_destroy
      description: SCIMSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SCIM Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/scim/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_source_scim_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SCIM Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/telegram/:
    get:
      operationId: propertymappings_source_telegram_list
      description: TelegramSourcePropertyMapping Viewset
      parameters:
      - in: query
        name: managed
        schema:
          type: array
          items:
            type: string
        explode: true
        style: form
      - in: query
        name: managed__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedTelegramSourcePropertyMappingList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: propertymappings_source_telegram_create
      description: TelegramSourcePropertyMapping Viewset
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TelegramSourcePropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TelegramSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/telegram/{pm_uuid}/:
    get:
      operationId: propertymappings_source_telegram_retrieve
      description: TelegramSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Telegram Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TelegramSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: propertymappings_source_telegram_update
      description: TelegramSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Telegram Source Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TelegramSourcePropertyMappingRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TelegramSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: propertymappings_source_telegram_partial_update
      description: TelegramSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Telegram Source Property Mapping.
        required: true
      tags:
      - propertymappings
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedTelegramSourcePropertyMappingRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TelegramSourcePropertyMapping'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: propertymappings_source_telegram_destroy
      description: TelegramSourcePropertyMapping Viewset
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Telegram Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /propertymappings/source/telegram/{pm_uuid}/used_by/:
    get:
      operationId: propertymappings_source_telegram_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Telegram Source Property Mapping.
        required: true
      tags:
      - propertymappings
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/all/:
    get:
      operationId: providers_all_list
      description: Provider Viewset
      parameters:
      - in: query
        name: application__isnull
        schema:
          type: boolean
      - in: query
        name: backchannel
        schema:
          type: boolean
        description: When not set all providers are returned. When set to true, only
          backchannel providers are returned. When set to false, backchannel providers
          are excluded
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedProviderList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/all/{id}/:
    get:
      operationId: providers_all_retrieve
      description: Provider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Provider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_all_destroy
      description: Provider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/all/{id}/used_by/:
    get:
      operationId: providers_all_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/all/types/:
    get:
      operationId: providers_all_types_list
      description: Get all creatable types
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TypeCreate'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/google_workspace/:
    get:
      operationId: providers_google_workspace_list
      description: GoogleWorkspaceProvider Viewset
      parameters:
      - in: query
        name: delegated_subject
        schema:
          type: string
      - in: query
        name: exclude_users_service_account
        schema:
          type: boolean
      - in: query
        name: filter_group
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGoogleWorkspaceProviderList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_google_workspace_create
      description: GoogleWorkspaceProvider Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoogleWorkspaceProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleWorkspaceProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/google_workspace/{id}/:
    get:
      operationId: providers_google_workspace_retrieve
      description: GoogleWorkspaceProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Google Workspace Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleWorkspaceProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: providers_google_workspace_update
      description: GoogleWorkspaceProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Google Workspace Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoogleWorkspaceProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleWorkspaceProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: providers_google_workspace_partial_update
      description: GoogleWorkspaceProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Google Workspace Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedGoogleWorkspaceProviderRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleWorkspaceProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_google_workspace_destroy
      description: GoogleWorkspaceProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Google Workspace Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/google_workspace/{id}/sync/object/:
    post:
      operationId: providers_google_workspace_sync_object_create
      description: Sync/Re-sync a single user/group object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Google Workspace Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SyncObjectRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SyncObjectResult'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/google_workspace/{id}/sync/status/:
    get:
      operationId: providers_google_workspace_sync_status_retrieve
      description: Get provider's sync status
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Google Workspace Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SyncStatus'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/google_workspace/{id}/used_by/:
    get:
      operationId: providers_google_workspace_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Google Workspace Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/google_workspace_groups/:
    get:
      operationId: providers_google_workspace_groups_list
      description: GoogleWorkspaceProviderGroup Viewset
      parameters:
      - in: query
        name: group__group_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: group__name
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: provider__id
        schema:
          type: integer
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGoogleWorkspaceProviderGroupList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_google_workspace_groups_create
      description: GoogleWorkspaceProviderGroup Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoogleWorkspaceProviderGroupRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleWorkspaceProviderGroup'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/google_workspace_groups/{id}/:
    get:
      operationId: providers_google_workspace_groups_retrieve
      description: GoogleWorkspaceProviderGroup Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Google Workspace Provider Group.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleWorkspaceProviderGroup'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_google_workspace_groups_destroy
      description: GoogleWorkspaceProviderGroup Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Google Workspace Provider Group.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/google_workspace_groups/{id}/used_by/:
    get:
      operationId: providers_google_workspace_groups_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Google Workspace Provider Group.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/google_workspace_users/:
    get:
      operationId: providers_google_workspace_users_list
      description: GoogleWorkspaceProviderUser Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: provider__id
        schema:
          type: integer
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: user__id
        schema:
          type: integer
      - in: query
        name: user__username
        schema:
          type: string
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGoogleWorkspaceProviderUserList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_google_workspace_users_create
      description: GoogleWorkspaceProviderUser Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoogleWorkspaceProviderUserRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleWorkspaceProviderUser'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/google_workspace_users/{id}/:
    get:
      operationId: providers_google_workspace_users_retrieve
      description: GoogleWorkspaceProviderUser Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Google Workspace Provider User.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleWorkspaceProviderUser'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_google_workspace_users_destroy
      description: GoogleWorkspaceProviderUser Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Google Workspace Provider User.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/google_workspace_users/{id}/used_by/:
    get:
      operationId: providers_google_workspace_users_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Google Workspace Provider User.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/ldap/:
    get:
      operationId: providers_ldap_list
      description: LDAPProvider Viewset
      parameters:
      - in: query
        name: application__isnull
        schema:
          type: boolean
      - in: query
        name: authorization_flow__slug__iexact
        schema:
          type: string
      - in: query
        name: base_dn__iexact
        schema:
          type: string
      - in: query
        name: certificate__kp_uuid__iexact
        schema:
          type: string
          format: uuid
      - in: query
        name: certificate__name__iexact
        schema:
          type: string
      - in: query
        name: gid_start_number__iexact
        schema:
          type: integer
      - in: query
        name: name__iexact
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: tls_server_name__iexact
        schema:
          type: string
      - in: query
        name: uid_start_number__iexact
        schema:
          type: integer
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedLDAPProviderList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_ldap_create
      description: LDAPProvider Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LDAPProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LDAPProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/ldap/{id}/:
    get:
      operationId: providers_ldap_retrieve
      description: LDAPProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this LDAP Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LDAPProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: providers_ldap_update
      description: LDAPProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this LDAP Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LDAPProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LDAPProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: providers_ldap_partial_update
      description: LDAPProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this LDAP Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedLDAPProviderRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LDAPProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_ldap_destroy
      description: LDAPProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this LDAP Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/ldap/{id}/used_by/:
    get:
      operationId: providers_ldap_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this LDAP Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/microsoft_entra/:
    get:
      operationId: providers_microsoft_entra_list
      description: MicrosoftEntraProvider Viewset
      parameters:
      - in: query
        name: exclude_users_service_account
        schema:
          type: boolean
      - in: query
        name: filter_group
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedMicrosoftEntraProviderList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_microsoft_entra_create
      description: MicrosoftEntraProvider Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MicrosoftEntraProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MicrosoftEntraProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/microsoft_entra/{id}/:
    get:
      operationId: providers_microsoft_entra_retrieve
      description: MicrosoftEntraProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Microsoft Entra Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MicrosoftEntraProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: providers_microsoft_entra_update
      description: MicrosoftEntraProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Microsoft Entra Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MicrosoftEntraProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MicrosoftEntraProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: providers_microsoft_entra_partial_update
      description: MicrosoftEntraProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Microsoft Entra Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedMicrosoftEntraProviderRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MicrosoftEntraProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_microsoft_entra_destroy
      description: MicrosoftEntraProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Microsoft Entra Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/microsoft_entra/{id}/sync/object/:
    post:
      operationId: providers_microsoft_entra_sync_object_create
      description: Sync/Re-sync a single user/group object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Microsoft Entra Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SyncObjectRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SyncObjectResult'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/microsoft_entra/{id}/sync/status/:
    get:
      operationId: providers_microsoft_entra_sync_status_retrieve
      description: Get provider's sync status
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Microsoft Entra Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SyncStatus'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/microsoft_entra/{id}/used_by/:
    get:
      operationId: providers_microsoft_entra_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Microsoft Entra Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/microsoft_entra_groups/:
    get:
      operationId: providers_microsoft_entra_groups_list
      description: MicrosoftEntraProviderGroup Viewset
      parameters:
      - in: query
        name: group__group_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: group__name
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: provider__id
        schema:
          type: integer
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedMicrosoftEntraProviderGroupList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_microsoft_entra_groups_create
      description: MicrosoftEntraProviderGroup Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MicrosoftEntraProviderGroupRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MicrosoftEntraProviderGroup'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/microsoft_entra_groups/{id}/:
    get:
      operationId: providers_microsoft_entra_groups_retrieve
      description: MicrosoftEntraProviderGroup Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Microsoft Entra Provider Group.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MicrosoftEntraProviderGroup'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_microsoft_entra_groups_destroy
      description: MicrosoftEntraProviderGroup Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Microsoft Entra Provider Group.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/microsoft_entra_groups/{id}/used_by/:
    get:
      operationId: providers_microsoft_entra_groups_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Microsoft Entra Provider Group.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/microsoft_entra_users/:
    get:
      operationId: providers_microsoft_entra_users_list
      description: MicrosoftEntraProviderUser Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: provider__id
        schema:
          type: integer
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: user__id
        schema:
          type: integer
      - in: query
        name: user__username
        schema:
          type: string
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedMicrosoftEntraProviderUserList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_microsoft_entra_users_create
      description: MicrosoftEntraProviderUser Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MicrosoftEntraProviderUserRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MicrosoftEntraProviderUser'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/microsoft_entra_users/{id}/:
    get:
      operationId: providers_microsoft_entra_users_retrieve
      description: MicrosoftEntraProviderUser Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Microsoft Entra Provider User.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MicrosoftEntraProviderUser'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_microsoft_entra_users_destroy
      description: MicrosoftEntraProviderUser Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Microsoft Entra Provider User.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/microsoft_entra_users/{id}/used_by/:
    get:
      operationId: providers_microsoft_entra_users_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Microsoft Entra Provider User.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/oauth2/:
    get:
      operationId: providers_oauth2_list
      description: OAuth2Provider Viewset
      parameters:
      - in: query
        name: access_code_validity
        schema:
          type: string
      - in: query
        name: access_token_validity
        schema:
          type: string
      - in: query
        name: application
        schema:
          type: string
          format: uuid
      - in: query
        name: authorization_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: client_id
        schema:
          type: string
      - in: query
        name: client_type
        schema:
          type: string
          enum:
          - confidential
          - public
        description: |+
          Confidential clients are capable of maintaining the confidentiality of their credentials. Public clients are incapable

      - in: query
        name: include_claims_in_id_token
        schema:
          type: boolean
      - in: query
        name: issuer_mode
        schema:
          type: string
          enum:
          - global
          - per_provider
        description: |+
          Configure how the issuer field of the ID Token should be filled.

      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: property_mappings
        schema:
          type: array
          items:
            type: string
            format: uuid
        explode: true
        style: form
      - in: query
        name: refresh_token_validity
        schema:
          type: string
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: signing_key
        schema:
          type: string
          format: uuid
      - in: query
        name: sub_mode
        schema:
          type: string
          enum:
          - hashed_user_id
          - user_email
          - user_id
          - user_upn
          - user_username
          - user_uuid
        description: |+
          Configure what data should be used as unique User Identifier. For most cases, the default should be fine.

      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedOAuth2ProviderList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_oauth2_create
      description: OAuth2Provider Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OAuth2ProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuth2Provider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/oauth2/{id}/:
    get:
      operationId: providers_oauth2_retrieve
      description: OAuth2Provider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this OAuth2/OpenID Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuth2Provider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: providers_oauth2_update
      description: OAuth2Provider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this OAuth2/OpenID Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OAuth2ProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuth2Provider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: providers_oauth2_partial_update
      description: OAuth2Provider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this OAuth2/OpenID Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedOAuth2ProviderRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuth2Provider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_oauth2_destroy
      description: OAuth2Provider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this OAuth2/OpenID Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/oauth2/{id}/preview_user/:
    get:
      operationId: providers_oauth2_preview_user_retrieve
      description: Preview user data for provider
      parameters:
      - in: query
        name: for_user
        schema:
          type: integer
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this OAuth2/OpenID Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PropertyMappingPreview'
          description: ''
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/oauth2/{id}/setup_urls/:
    get:
      operationId: providers_oauth2_setup_urls_retrieve
      description: Get Providers setup URLs
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this OAuth2/OpenID Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuth2ProviderSetupURLs'
          description: ''
        '404':
          description: Provider has no application assigned
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/oauth2/{id}/used_by/:
    get:
      operationId: providers_oauth2_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this OAuth2/OpenID Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/proxy/:
    get:
      operationId: providers_proxy_list
      description: ProxyProvider Viewset
      parameters:
      - in: query
        name: application__isnull
        schema:
          type: boolean
      - in: query
        name: authorization_flow__slug__iexact
        schema:
          type: string
      - in: query
        name: basic_auth_enabled__iexact
        schema:
          type: boolean
      - in: query
        name: basic_auth_password_attribute__iexact
        schema:
          type: string
      - in: query
        name: basic_auth_user_attribute__iexact
        schema:
          type: string
      - in: query
        name: certificate__kp_uuid__iexact
        schema:
          type: string
          format: uuid
      - in: query
        name: certificate__name__iexact
        schema:
          type: string
      - in: query
        name: cookie_domain__iexact
        schema:
          type: string
      - in: query
        name: external_host__iexact
        schema:
          type: string
      - in: query
        name: internal_host__iexact
        schema:
          type: string
      - in: query
        name: internal_host_ssl_validation__iexact
        schema:
          type: boolean
      - in: query
        name: mode__iexact
        schema:
          type: string
      - in: query
        name: name__iexact
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: property_mappings__iexact
        schema:
          type: array
          items:
            type: string
            format: uuid
        explode: true
        style: form
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: skip_path_regex__iexact
        schema:
          type: string
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedProxyProviderList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_proxy_create
      description: ProxyProvider Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProxyProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/proxy/{id}/:
    get:
      operationId: providers_proxy_retrieve
      description: ProxyProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Proxy Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: providers_proxy_update
      description: ProxyProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Proxy Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProxyProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: providers_proxy_partial_update
      description: ProxyProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Proxy Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedProxyProviderRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_proxy_destroy
      description: ProxyProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Proxy Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/proxy/{id}/used_by/:
    get:
      operationId: providers_proxy_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Proxy Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/rac/:
    get:
      operationId: providers_rac_list
      description: RACProvider Viewset
      parameters:
      - in: query
        name: application__isnull
        schema:
          type: boolean
      - in: query
        name: name__iexact
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedRACProviderList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_rac_create
      description: RACProvider Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RACProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RACProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/rac/{id}/:
    get:
      operationId: providers_rac_retrieve
      description: RACProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this RAC Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RACProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: providers_rac_update
      description: RACProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this RAC Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RACProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RACProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: providers_rac_partial_update
      description: RACProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this RAC Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedRACProviderRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RACProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_rac_destroy
      description: RACProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this RAC Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/rac/{id}/used_by/:
    get:
      operationId: providers_rac_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this RAC Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/radius/:
    get:
      operationId: providers_radius_list
      description: RadiusProvider Viewset
      parameters:
      - in: query
        name: application__isnull
        schema:
          type: boolean
      - in: query
        name: authorization_flow__slug__iexact
        schema:
          type: string
      - in: query
        name: client_networks__iexact
        schema:
          type: string
      - in: query
        name: name__iexact
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedRadiusProviderList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_radius_create
      description: RadiusProvider Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RadiusProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RadiusProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/radius/{id}/:
    get:
      operationId: providers_radius_retrieve
      description: RadiusProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Radius Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RadiusProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: providers_radius_update
      description: RadiusProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Radius Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RadiusProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RadiusProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: providers_radius_partial_update
      description: RadiusProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Radius Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedRadiusProviderRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RadiusProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_radius_destroy
      description: RadiusProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Radius Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/radius/{id}/used_by/:
    get:
      operationId: providers_radius_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Radius Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/saml/:
    get:
      operationId: providers_saml_list
      description: SAMLProvider Viewset
      parameters:
      - in: query
        name: acs_url
        schema:
          type: string
      - in: query
        name: assertion_valid_not_before
        schema:
          type: string
      - in: query
        name: assertion_valid_not_on_or_after
        schema:
          type: string
      - in: query
        name: audience
        schema:
          type: string
      - in: query
        name: authentication_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: authn_context_class_ref_mapping
        schema:
          type: string
          format: uuid
      - in: query
        name: authorization_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: backchannel_application
        schema:
          type: string
          format: uuid
      - in: query
        name: default_name_id_policy
        schema:
          type: string
          enum:
          - urn:oasis:names:tc:SAML:1.1:nameid-format:X509SubjectName
          - urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress
          - urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified
          - urn:oasis:names:tc:SAML:2.0:nameid-format:WindowsDomainQualifiedName
          - urn:oasis:names:tc:SAML:2.0:nameid-format:persistent
          - urn:oasis:names:tc:SAML:2.0:nameid-format:transient
      - in: query
        name: default_relay_state
        schema:
          type: string
      - in: query
        name: digest_algorithm
        schema:
          type: string
          enum:
          - http://www.w3.org/2000/09/xmldsig#sha1
          - http://www.w3.org/2001/04/xmldsig-more#sha384
          - http://www.w3.org/2001/04/xmlenc#sha256
          - http://www.w3.org/2001/04/xmlenc#sha512
      - in: query
        name: encryption_kp
        schema:
          type: string
          format: uuid
      - in: query
        name: invalidation_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: is_backchannel
        schema:
          type: boolean
      - in: query
        name: issuer
        schema:
          type: string
      - in: query
        name: logout_method
        schema:
          type: string
          enum:
          - backchannel
          - frontchannel_iframe
          - frontchannel_native
        description: |+
          Method to use for logout. Front-channel iframe loads all logout URLs simultaneously in hidden iframes. Front-channel native uses your active browser tab to send post requests and redirect to providers. Back-channel sends logout requests directly from the server without user interaction (requires POST SLS binding).

      - $ref: '#/components/parameters/QueryName'
      - in: query
        name: name_id_mapping
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: property_mappings
        schema:
          type: array
          items:
            type: string
            format: uuid
        explode: true
        style: form
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: session_valid_not_on_or_after
        schema:
          type: string
      - in: query
        name: sign_assertion
        schema:
          type: boolean
      - in: query
        name: sign_logout_request
        schema:
          type: boolean
      - in: query
        name: sign_response
        schema:
          type: boolean
      - in: query
        name: signature_algorithm
        schema:
          type: string
          enum:
          - http://www.w3.org/2000/09/xmldsig#dsa-sha1
          - http://www.w3.org/2000/09/xmldsig#rsa-sha1
          - http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha1
          - http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256
          - http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha384
          - http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha512
          - http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
          - http://www.w3.org/2001/04/xmldsig-more#rsa-sha384
          - http://www.w3.org/2001/04/xmldsig-more#rsa-sha512
      - in: query
        name: signing_kp
        schema:
          type: string
          format: uuid
      - in: query
        name: sls_binding
        schema:
          type: string
          enum:
          - post
          - redirect
        description: |+
          This determines how authentik sends the logout response back to the Service Provider.

      - in: query
        name: sls_url
        schema:
          type: string
      - in: query
        name: sp_binding
        schema:
          type: string
          title: Service Provider Binding
          enum:
          - post
          - redirect
        description: |+
          This determines how authentik sends the response back to the Service Provider.

      - in: query
        name: verification_kp
        schema:
          type: string
          format: uuid
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSAMLProviderList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_saml_create
      description: SAMLProvider Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SAMLProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/saml/{id}/:
    get:
      operationId: providers_saml_retrieve
      description: SAMLProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SAML Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: providers_saml_update
      description: SAMLProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SAML Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SAMLProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: providers_saml_partial_update
      description: SAMLProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SAML Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSAMLProviderRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_saml_destroy
      description: SAMLProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SAML Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/saml/{id}/metadata/:
    get:
      operationId: providers_saml_metadata_retrieve
      description: Return metadata as XML string
      parameters:
      - in: query
        name: download
        schema:
          type: boolean
      - in: query
        name: force_binding
        schema:
          type: string
          enum:
          - urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST
          - urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect
        description: Optionally force the metadata to only include one binding.
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SAML Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLMetadata'
            application/xml:
              schema:
                $ref: '#/components/schemas/SAMLMetadata'
          description: ''
        '404':
          description: Provider has no application assigned
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/saml/{id}/preview_user/:
    get:
      operationId: providers_saml_preview_user_retrieve
      description: Preview user data for provider
      parameters:
      - in: query
        name: for_user
        schema:
          type: integer
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SAML Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PropertyMappingPreview'
          description: ''
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/saml/{id}/used_by/:
    get:
      operationId: providers_saml_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SAML Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/saml/import_metadata/:
    post:
      operationId: providers_saml_import_metadata_create
      description: Create provider from SAML Metadata
      tags:
      - providers
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/SAMLProviderImportRequest'
        required: true
      security:
      - authentik: []
      responses:
        '204':
          description: Successfully imported provider
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/scim/:
    get:
      operationId: providers_scim_list
      description: SCIMProvider Viewset
      parameters:
      - in: query
        name: exclude_users_service_account
        schema:
          type: boolean
      - in: query
        name: filter_group
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: url
        schema:
          type: string
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSCIMProviderList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_scim_create
      description: SCIMProvider Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SCIMProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/scim/{id}/:
    get:
      operationId: providers_scim_retrieve
      description: SCIMProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SCIM Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: providers_scim_update
      description: SCIMProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SCIM Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SCIMProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: providers_scim_partial_update
      description: SCIMProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SCIM Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSCIMProviderRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_scim_destroy
      description: SCIMProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SCIM Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/scim/{id}/sync/object/:
    post:
      operationId: providers_scim_sync_object_create
      description: Sync/Re-sync a single user/group object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SCIM Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SyncObjectRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SyncObjectResult'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/scim/{id}/sync/status/:
    get:
      operationId: providers_scim_sync_status_retrieve
      description: Get provider's sync status
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SCIM Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SyncStatus'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/scim/{id}/used_by/:
    get:
      operationId: providers_scim_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this SCIM Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/scim_groups/:
    get:
      operationId: providers_scim_groups_list
      description: SCIMProviderGroup Viewset
      parameters:
      - in: query
        name: group__group_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: group__name
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: provider__id
        schema:
          type: integer
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSCIMProviderGroupList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_scim_groups_create
      description: SCIMProviderGroup Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SCIMProviderGroupRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMProviderGroup'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/scim_groups/{id}/:
    get:
      operationId: providers_scim_groups_retrieve
      description: SCIMProviderGroup Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this scim provider group.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMProviderGroup'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_scim_groups_destroy
      description: SCIMProviderGroup Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this scim provider group.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/scim_groups/{id}/used_by/:
    get:
      operationId: providers_scim_groups_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this scim provider group.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/scim_users/:
    get:
      operationId: providers_scim_users_list
      description: SCIMProviderUser Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: provider__id
        schema:
          type: integer
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: user__id
        schema:
          type: integer
      - in: query
        name: user__username
        schema:
          type: string
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSCIMProviderUserList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_scim_users_create
      description: SCIMProviderUser Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SCIMProviderUserRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMProviderUser'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/scim_users/{id}/:
    get:
      operationId: providers_scim_users_retrieve
      description: SCIMProviderUser Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this scim provider user.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMProviderUser'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_scim_users_destroy
      description: SCIMProviderUser Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this scim provider user.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/scim_users/{id}/used_by/:
    get:
      operationId: providers_scim_users_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this scim provider user.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/ssf/:
    get:
      operationId: providers_ssf_list
      description: SSFProvider Viewset
      parameters:
      - in: query
        name: application__isnull
        schema:
          type: boolean
      - in: query
        name: name__iexact
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSSFProviderList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: providers_ssf_create
      description: SSFProvider Viewset
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SSFProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SSFProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/ssf/{id}/:
    get:
      operationId: providers_ssf_retrieve
      description: SSFProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Shared Signals Framework
          Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SSFProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: providers_ssf_update
      description: SSFProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Shared Signals Framework
          Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SSFProviderRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SSFProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: providers_ssf_partial_update
      description: SSFProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Shared Signals Framework
          Provider.
        required: true
      tags:
      - providers
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSSFProviderRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SSFProvider'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: providers_ssf_destroy
      description: SSFProvider Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Shared Signals Framework
          Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /providers/ssf/{id}/used_by/:
    get:
      operationId: providers_ssf_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Shared Signals Framework
          Provider.
        required: true
      tags:
      - providers
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rac/connection_tokens/:
    get:
      operationId: rac_connection_tokens_list
      description: ConnectionToken Viewset
      parameters:
      - in: query
        name: endpoint
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: provider
        schema:
          type: integer
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: session__user
        schema:
          type: integer
      tags:
      - rac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedConnectionTokenList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rac/connection_tokens/{connection_token_uuid}/:
    get:
      operationId: rac_connection_tokens_retrieve
      description: ConnectionToken Viewset
      parameters:
      - in: path
        name: connection_token_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this RAC Connection token.
        required: true
      tags:
      - rac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConnectionToken'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: rac_connection_tokens_update
      description: ConnectionToken Viewset
      parameters:
      - in: path
        name: connection_token_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this RAC Connection token.
        required: true
      tags:
      - rac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConnectionTokenRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConnectionToken'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: rac_connection_tokens_partial_update
      description: ConnectionToken Viewset
      parameters:
      - in: path
        name: connection_token_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this RAC Connection token.
        required: true
      tags:
      - rac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedConnectionTokenRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConnectionToken'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: rac_connection_tokens_destroy
      description: ConnectionToken Viewset
      parameters:
      - in: path
        name: connection_token_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this RAC Connection token.
        required: true
      tags:
      - rac
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rac/connection_tokens/{connection_token_uuid}/used_by/:
    get:
      operationId: rac_connection_tokens_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: connection_token_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this RAC Connection token.
        required: true
      tags:
      - rac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rac/endpoints/:
    get:
      operationId: rac_endpoints_list
      description: List accessible endpoints
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: provider
        schema:
          type: integer
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: superuser_full_list
        schema:
          type: boolean
      tags:
      - rac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedEndpointList'
          description: ''
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: rac_endpoints_create
      description: Endpoint Viewset
      tags:
      - rac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EndpointRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Endpoint'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rac/endpoints/{pbm_uuid}/:
    get:
      operationId: rac_endpoints_retrieve
      description: Endpoint Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this RAC Endpoint.
        required: true
      tags:
      - rac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Endpoint'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: rac_endpoints_update
      description: Endpoint Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this RAC Endpoint.
        required: true
      tags:
      - rac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EndpointRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Endpoint'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: rac_endpoints_partial_update
      description: Endpoint Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this RAC Endpoint.
        required: true
      tags:
      - rac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedEndpointRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Endpoint'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: rac_endpoints_destroy
      description: Endpoint Viewset
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this RAC Endpoint.
        required: true
      tags:
      - rac
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rac/endpoints/{pbm_uuid}/used_by/:
    get:
      operationId: rac_endpoints_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: pbm_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this RAC Endpoint.
        required: true
      tags:
      - rac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/initial_permissions/:
    get:
      operationId: rbac_initial_permissions_list
      description: InitialPermissions viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedInitialPermissionsList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: rbac_initial_permissions_create
      description: InitialPermissions viewset
      tags:
      - rbac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InitialPermissionsRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InitialPermissions'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/initial_permissions/{id}/:
    get:
      operationId: rbac_initial_permissions_retrieve
      description: InitialPermissions viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Initial Permissions.
        required: true
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InitialPermissions'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: rbac_initial_permissions_update
      description: InitialPermissions viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Initial Permissions.
        required: true
      tags:
      - rbac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InitialPermissionsRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InitialPermissions'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: rbac_initial_permissions_partial_update
      description: InitialPermissions viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Initial Permissions.
        required: true
      tags:
      - rbac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedInitialPermissionsRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InitialPermissions'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: rbac_initial_permissions_destroy
      description: InitialPermissions viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Initial Permissions.
        required: true
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/initial_permissions/{id}/used_by/:
    get:
      operationId: rbac_initial_permissions_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Initial Permissions.
        required: true
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/permissions/:
    get:
      operationId: rbac_permissions_list
      description: Read-only list of all permissions, filterable by model and app
      parameters:
      - in: query
        name: codename
        schema:
          type: string
      - in: query
        name: content_type__app_label
        schema:
          type: string
      - in: query
        name: content_type__model
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: role
        schema:
          type: string
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: user
        schema:
          type: integer
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedPermissionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/permissions/{id}/:
    get:
      operationId: rbac_permissions_retrieve
      description: Read-only list of all permissions, filterable by model and app
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this permission.
        required: true
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Permission'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/permissions/assigned_by_roles/:
    get:
      operationId: rbac_permissions_assigned_by_roles_list
      description: Get assigned object permissions for a single object
      parameters:
      - in: query
        name: model
        schema:
          type: string
          enum:
          - authentik_blueprints.blueprintinstance
          - authentik_brands.brand
          - authentik_core.application
          - authentik_core.applicationentitlement
          - authentik_core.group
          - authentik_core.token
          - authentik_core.user
          - authentik_crypto.certificatekeypair
          - authentik_endpoints.deviceuserbinding
          - authentik_endpoints.endpointstage
          - authentik_endpoints_connectors_agent.agentconnector
          - authentik_endpoints_connectors_agent.agentdeviceuserbinding
          - authentik_endpoints_connectors_agent.enrollmenttoken
          - authentik_enterprise.license
          - authentik_events.event
          - authentik_events.notification
          - authentik_events.notificationrule
          - authentik_events.notificationtransport
          - authentik_events.notificationwebhookmapping
          - authentik_flows.flow
          - authentik_flows.flowstagebinding
          - authentik_outposts.dockerserviceconnection
          - authentik_outposts.kubernetesserviceconnection
          - authentik_outposts.outpost
          - authentik_policies.policybinding
          - authentik_policies_dummy.dummypolicy
          - authentik_policies_event_matcher.eventmatcherpolicy
          - authentik_policies_expiry.passwordexpirypolicy
          - authentik_policies_expression.expressionpolicy
          - authentik_policies_geoip.geoippolicy
          - authentik_policies_password.passwordpolicy
          - authentik_policies_reputation.reputationpolicy
          - authentik_policies_unique_password.uniquepasswordpolicy
          - authentik_providers_google_workspace.googleworkspaceprovider
          - authentik_providers_google_workspace.googleworkspaceprovidermapping
          - authentik_providers_ldap.ldapprovider
          - authentik_providers_microsoft_entra.microsoftentraprovider
          - authentik_providers_microsoft_entra.microsoftentraprovidermapping
          - authentik_providers_oauth2.oauth2provider
          - authentik_providers_oauth2.scopemapping
          - authentik_providers_proxy.proxyprovider
          - authentik_providers_rac.endpoint
          - authentik_providers_rac.racpropertymapping
          - authentik_providers_rac.racprovider
          - authentik_providers_radius.radiusprovider
          - authentik_providers_radius.radiusproviderpropertymapping
          - authentik_providers_saml.samlpropertymapping
          - authentik_providers_saml.samlprovider
          - authentik_providers_scim.scimmapping
          - authentik_providers_scim.scimprovider
          - authentik_providers_ssf.ssfprovider
          - authentik_rbac.initialpermissions
          - authentik_rbac.role
          - authentik_sources_kerberos.groupkerberossourceconnection
          - authentik_sources_kerberos.kerberossource
          - authentik_sources_kerberos.kerberossourcepropertymapping
          - authentik_sources_kerberos.userkerberossourceconnection
          - authentik_sources_ldap.groupldapsourceconnection
          - authentik_sources_ldap.ldapsource
          - authentik_sources_ldap.ldapsourcepropertymapping
          - authentik_sources_ldap.userldapsourceconnection
          - authentik_sources_oauth.groupoauthsourceconnection
          - authentik_sources_oauth.oauthsource
          - authentik_sources_oauth.oauthsourcepropertymapping
          - authentik_sources_oauth.useroauthsourceconnection
          - authentik_sources_plex.groupplexsourceconnection
          - authentik_sources_plex.plexsource
          - authentik_sources_plex.plexsourcepropertymapping
          - authentik_sources_plex.userplexsourceconnection
          - authentik_sources_saml.groupsamlsourceconnection
          - authentik_sources_saml.samlsource
          - authentik_sources_saml.samlsourcepropertymapping
          - authentik_sources_saml.usersamlsourceconnection
          - authentik_sources_scim.scimsource
          - authentik_sources_scim.scimsourcepropertymapping
          - authentik_sources_telegram.grouptelegramsourceconnection
          - authentik_sources_telegram.telegramsource
          - authentik_sources_telegram.telegramsourcepropertymapping
          - authentik_sources_telegram.usertelegramsourceconnection
          - authentik_stages_authenticator_duo.authenticatorduostage
          - authentik_stages_authenticator_duo.duodevice
          - authentik_stages_authenticator_email.authenticatoremailstage
          - authentik_stages_authenticator_email.emaildevice
          - authentik_stages_authenticator_endpoint_gdtc.authenticatorendpointgdtcstage
          - authentik_stages_authenticator_sms.authenticatorsmsstage
          - authentik_stages_authenticator_sms.smsdevice
          - authentik_stages_authenticator_static.authenticatorstaticstage
          - authentik_stages_authenticator_static.staticdevice
          - authentik_stages_authenticator_totp.authenticatortotpstage
          - authentik_stages_authenticator_totp.totpdevice
          - authentik_stages_authenticator_validate.authenticatorvalidatestage
          - authentik_stages_authenticator_webauthn.authenticatorwebauthnstage
          - authentik_stages_authenticator_webauthn.webauthndevice
          - authentik_stages_captcha.captchastage
          - authentik_stages_consent.consentstage
          - authentik_stages_deny.denystage
          - authentik_stages_dummy.dummystage
          - authentik_stages_email.emailstage
          - authentik_stages_identification.identificationstage
          - authentik_stages_invitation.invitation
          - authentik_stages_invitation.invitationstage
          - authentik_stages_mtls.mutualtlsstage
          - authentik_stages_password.passwordstage
          - authentik_stages_prompt.prompt
          - authentik_stages_prompt.promptstage
          - authentik_stages_redirect.redirectstage
          - authentik_stages_source.sourcestage
          - authentik_stages_user_delete.userdeletestage
          - authentik_stages_user_login.userloginstage
          - authentik_stages_user_logout.userlogoutstage
          - authentik_stages_user_write.userwritestage
          - authentik_tasks_schedules.schedule
          - authentik_tenants.domain
        required: true
      - in: query
        name: object_pk
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedRoleAssignedObjectPermissionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/permissions/assigned_by_roles/{uuid}/assign/:
    post:
      operationId: rbac_permissions_assigned_by_roles_assign
      description: |-
        Assign permission(s) to role. When `object_pk` is set, the permissions
        are only assigned to the specific object, otherwise they are assigned globally.
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Role.
        required: true
      tags:
      - rbac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PermissionAssignRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PermissionAssignResult'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/permissions/assigned_by_roles/{uuid}/unassign/:
    patch:
      operationId: rbac_permissions_assigned_by_roles_unassign_partial_update
      description: |-
        Unassign permission(s) to role. When `object_pk` is set, the permissions
        are only assigned to the specific object, otherwise they are assigned globally.
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Role.
        required: true
      tags:
      - rbac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedPermissionAssignRequest'
      security:
      - authentik: []
      responses:
        '204':
          description: Successfully unassigned
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/permissions/assigned_by_users/:
    get:
      operationId: rbac_permissions_assigned_by_users_list
      description: Get assigned object permissions for a single object
      parameters:
      - in: query
        name: model
        schema:
          type: string
          enum:
          - authentik_blueprints.blueprintinstance
          - authentik_brands.brand
          - authentik_core.application
          - authentik_core.applicationentitlement
          - authentik_core.group
          - authentik_core.token
          - authentik_core.user
          - authentik_crypto.certificatekeypair
          - authentik_endpoints.deviceuserbinding
          - authentik_endpoints.endpointstage
          - authentik_endpoints_connectors_agent.agentconnector
          - authentik_endpoints_connectors_agent.agentdeviceuserbinding
          - authentik_endpoints_connectors_agent.enrollmenttoken
          - authentik_enterprise.license
          - authentik_events.event
          - authentik_events.notification
          - authentik_events.notificationrule
          - authentik_events.notificationtransport
          - authentik_events.notificationwebhookmapping
          - authentik_flows.flow
          - authentik_flows.flowstagebinding
          - authentik_outposts.dockerserviceconnection
          - authentik_outposts.kubernetesserviceconnection
          - authentik_outposts.outpost
          - authentik_policies.policybinding
          - authentik_policies_dummy.dummypolicy
          - authentik_policies_event_matcher.eventmatcherpolicy
          - authentik_policies_expiry.passwordexpirypolicy
          - authentik_policies_expression.expressionpolicy
          - authentik_policies_geoip.geoippolicy
          - authentik_policies_password.passwordpolicy
          - authentik_policies_reputation.reputationpolicy
          - authentik_policies_unique_password.uniquepasswordpolicy
          - authentik_providers_google_workspace.googleworkspaceprovider
          - authentik_providers_google_workspace.googleworkspaceprovidermapping
          - authentik_providers_ldap.ldapprovider
          - authentik_providers_microsoft_entra.microsoftentraprovider
          - authentik_providers_microsoft_entra.microsoftentraprovidermapping
          - authentik_providers_oauth2.oauth2provider
          - authentik_providers_oauth2.scopemapping
          - authentik_providers_proxy.proxyprovider
          - authentik_providers_rac.endpoint
          - authentik_providers_rac.racpropertymapping
          - authentik_providers_rac.racprovider
          - authentik_providers_radius.radiusprovider
          - authentik_providers_radius.radiusproviderpropertymapping
          - authentik_providers_saml.samlpropertymapping
          - authentik_providers_saml.samlprovider
          - authentik_providers_scim.scimmapping
          - authentik_providers_scim.scimprovider
          - authentik_providers_ssf.ssfprovider
          - authentik_rbac.initialpermissions
          - authentik_rbac.role
          - authentik_sources_kerberos.groupkerberossourceconnection
          - authentik_sources_kerberos.kerberossource
          - authentik_sources_kerberos.kerberossourcepropertymapping
          - authentik_sources_kerberos.userkerberossourceconnection
          - authentik_sources_ldap.groupldapsourceconnection
          - authentik_sources_ldap.ldapsource
          - authentik_sources_ldap.ldapsourcepropertymapping
          - authentik_sources_ldap.userldapsourceconnection
          - authentik_sources_oauth.groupoauthsourceconnection
          - authentik_sources_oauth.oauthsource
          - authentik_sources_oauth.oauthsourcepropertymapping
          - authentik_sources_oauth.useroauthsourceconnection
          - authentik_sources_plex.groupplexsourceconnection
          - authentik_sources_plex.plexsource
          - authentik_sources_plex.plexsourcepropertymapping
          - authentik_sources_plex.userplexsourceconnection
          - authentik_sources_saml.groupsamlsourceconnection
          - authentik_sources_saml.samlsource
          - authentik_sources_saml.samlsourcepropertymapping
          - authentik_sources_saml.usersamlsourceconnection
          - authentik_sources_scim.scimsource
          - authentik_sources_scim.scimsourcepropertymapping
          - authentik_sources_telegram.grouptelegramsourceconnection
          - authentik_sources_telegram.telegramsource
          - authentik_sources_telegram.telegramsourcepropertymapping
          - authentik_sources_telegram.usertelegramsourceconnection
          - authentik_stages_authenticator_duo.authenticatorduostage
          - authentik_stages_authenticator_duo.duodevice
          - authentik_stages_authenticator_email.authenticatoremailstage
          - authentik_stages_authenticator_email.emaildevice
          - authentik_stages_authenticator_endpoint_gdtc.authenticatorendpointgdtcstage
          - authentik_stages_authenticator_sms.authenticatorsmsstage
          - authentik_stages_authenticator_sms.smsdevice
          - authentik_stages_authenticator_static.authenticatorstaticstage
          - authentik_stages_authenticator_static.staticdevice
          - authentik_stages_authenticator_totp.authenticatortotpstage
          - authentik_stages_authenticator_totp.totpdevice
          - authentik_stages_authenticator_validate.authenticatorvalidatestage
          - authentik_stages_authenticator_webauthn.authenticatorwebauthnstage
          - authentik_stages_authenticator_webauthn.webauthndevice
          - authentik_stages_captcha.captchastage
          - authentik_stages_consent.consentstage
          - authentik_stages_deny.denystage
          - authentik_stages_dummy.dummystage
          - authentik_stages_email.emailstage
          - authentik_stages_identification.identificationstage
          - authentik_stages_invitation.invitation
          - authentik_stages_invitation.invitationstage
          - authentik_stages_mtls.mutualtlsstage
          - authentik_stages_password.passwordstage
          - authentik_stages_prompt.prompt
          - authentik_stages_prompt.promptstage
          - authentik_stages_redirect.redirectstage
          - authentik_stages_source.sourcestage
          - authentik_stages_user_delete.userdeletestage
          - authentik_stages_user_login.userloginstage
          - authentik_stages_user_logout.userlogoutstage
          - authentik_stages_user_write.userwritestage
          - authentik_tasks_schedules.schedule
          - authentik_tenants.domain
        required: true
      - in: query
        name: object_pk
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUserAssignedObjectPermissionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/permissions/assigned_by_users/{id}/assign/:
    post:
      operationId: rbac_permissions_assigned_by_users_assign
      description: Assign permission(s) to user
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User.
        required: true
      tags:
      - rbac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PermissionAssignRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PermissionAssignResult'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/permissions/assigned_by_users/{id}/unassign/:
    patch:
      operationId: rbac_permissions_assigned_by_users_unassign_partial_update
      description: |-
        Unassign permission(s) to user. When `object_pk` is set, the permissions
        are only assigned to the specific object, otherwise they are assigned globally.
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User.
        required: true
      tags:
      - rbac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedPermissionAssignRequest'
      security:
      - authentik: []
      responses:
        '204':
          description: Successfully unassigned
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/permissions/roles/:
    get:
      operationId: rbac_permissions_roles_list
      description: Get a role's assigned object permissions
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: uuid
        schema:
          type: string
          format: uuid
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedExtraRoleObjectPermissionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/permissions/roles/{id}/:
    get:
      operationId: rbac_permissions_roles_retrieve
      description: Get a role's assigned object permissions
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this group object permission.
        required: true
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExtraRoleObjectPermission'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: rbac_permissions_roles_update
      description: Get a role's assigned object permissions
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this group object permission.
        required: true
      tags:
      - rbac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExtraRoleObjectPermissionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExtraRoleObjectPermission'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: rbac_permissions_roles_partial_update
      description: Get a role's assigned object permissions
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this group object permission.
        required: true
      tags:
      - rbac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedExtraRoleObjectPermissionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExtraRoleObjectPermission'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: rbac_permissions_roles_destroy
      description: Get a role's assigned object permissions
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this group object permission.
        required: true
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/permissions/users/:
    get:
      operationId: rbac_permissions_users_list
      description: Get a users's assigned object permissions
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: user_id
        schema:
          type: integer
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedExtraUserObjectPermissionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/permissions/users/{id}/:
    get:
      operationId: rbac_permissions_users_retrieve
      description: Get a users's assigned object permissions
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this user object permission.
        required: true
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExtraUserObjectPermission'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: rbac_permissions_users_update
      description: Get a users's assigned object permissions
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this user object permission.
        required: true
      tags:
      - rbac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExtraUserObjectPermissionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExtraUserObjectPermission'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: rbac_permissions_users_partial_update
      description: Get a users's assigned object permissions
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this user object permission.
        required: true
      tags:
      - rbac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedExtraUserObjectPermissionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExtraUserObjectPermission'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: rbac_permissions_users_destroy
      description: Get a users's assigned object permissions
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this user object permission.
        required: true
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/roles/:
    get:
      operationId: rbac_roles_list
      description: Role viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedRoleList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: rbac_roles_create
      description: Role viewset
      tags:
      - rbac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RoleRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Role'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/roles/{uuid}/:
    get:
      operationId: rbac_roles_retrieve
      description: Role viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Role.
        required: true
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Role'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: rbac_roles_update
      description: Role viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Role.
        required: true
      tags:
      - rbac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RoleRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Role'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: rbac_roles_partial_update
      description: Role viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Role.
        required: true
      tags:
      - rbac
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedRoleRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Role'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: rbac_roles_destroy
      description: Role viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Role.
        required: true
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /rbac/roles/{uuid}/used_by/:
    get:
      operationId: rbac_roles_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Role.
        required: true
      tags:
      - rbac
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /root/config/:
    get:
      operationId: root_config_retrieve
      description: Retrieve public configuration options
      tags:
      - root
      security:
      - authentik: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Config'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /schema/:
    get:
      operationId: schema_retrieve
      description: |-
        OpenApi3 schema for this API. Format can be selected via content negotiation.

        - YAML: application/vnd.oai.openapi
        - JSON: application/vnd.oai.openapi+json
      parameters:
      - in: query
        name: format
        schema:
          type: string
          enum:
          - json
          - yaml
      - in: query
        name: lang
        schema:
          type: string
          enum:
          - af
          - ar
          - ar-dz
          - ast
          - az
          - be
          - bg
          - bn
          - br
          - bs
          - ca
          - ckb
          - cs
          - cy
          - da
          - de
          - dsb
          - el
          - en
          - en-au
          - en-gb
          - eo
          - es
          - es-ar
          - es-co
          - es-mx
          - es-ni
          - es-ve
          - et
          - eu
          - fa
          - fi
          - fr
          - fy
          - ga
          - gd
          - gl
          - he
          - hi
          - hr
          - hsb
          - hu
          - hy
          - ia
          - id
          - ig
          - io
          - is
          - it
          - ja
          - ka
          - kab
          - kk
          - km
          - kn
          - ko
          - ky
          - lb
          - lt
          - lv
          - mk
          - ml
          - mn
          - mr
          - ms
          - my
          - nb
          - ne
          - nl
          - nn
          - os
          - pa
          - pl
          - pt
          - pt-br
          - ro
          - ru
          - sk
          - sl
          - sq
          - sr
          - sr-latn
          - sv
          - sw
          - ta
          - te
          - tg
          - th
          - tk
          - tr
          - tt
          - udm
          - ug
          - uk
          - ur
          - uz
          - vi
          - zh-hans
          - zh-hant
      tags:
      - schema
      security:
      - authentik: []
      - {}
      responses:
        '200':
          content:
            application/vnd.oai.openapi:
              schema:
                type: object
                additionalProperties: {}
            application/yaml:
              schema:
                type: object
                additionalProperties: {}
            application/vnd.oai.openapi+json:
              schema:
                type: object
                additionalProperties: {}
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/all/:
    get:
      operationId: sources_all_list
      description: Source Viewset
      parameters:
      - in: query
        name: managed
        schema:
          type: string
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: pbm_uuid
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: slug
        schema:
          type: string
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSourceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/all/{slug}/:
    get:
      operationId: sources_all_retrieve
      description: Source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Source'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_all_destroy
      description: Prevent deletion of built-in sources
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/all/{slug}/set_icon/:
    post:
      operationId: sources_all_set_icon_create
      description: Set source icon
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/FileUploadRequest'
      security:
      - authentik: []
      responses:
        '200':
          description: Success
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/all/{slug}/set_icon_url/:
    post:
      operationId: sources_all_set_icon_url_create
      description: Set source icon (as URL)
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FilePathRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          description: Success
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/all/{slug}/used_by/:
    get:
      operationId: sources_all_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/all/types/:
    get:
      operationId: sources_all_types_list
      description: Get all creatable types
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TypeCreate'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/all/user_settings/:
    get:
      operationId: sources_all_user_settings_list
      description: Get all sources the user can configure
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserSetting'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/all/:
    get:
      operationId: sources_group_connections_all_list
      description: Group-source connection Viewset
      parameters:
      - in: query
        name: group
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGroupSourceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/all/{id}/:
    get:
      operationId: sources_group_connections_all_retrieve
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this group source connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_group_connections_all_update
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this group source connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_group_connections_all_partial_update
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this group source connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedGroupSourceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_group_connections_all_destroy
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this group source connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/all/{id}/used_by/:
    get:
      operationId: sources_group_connections_all_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this group source connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/kerberos/:
    get:
      operationId: sources_group_connections_kerberos_list
      description: Group-source connection Viewset
      parameters:
      - in: query
        name: group
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGroupKerberosSourceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_group_connections_kerberos_create
      description: Group-source connection Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupKerberosSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupKerberosSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/kerberos/{id}/:
    get:
      operationId: sources_group_connections_kerberos_retrieve
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group Kerberos Source
          Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupKerberosSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_group_connections_kerberos_update
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group Kerberos Source
          Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupKerberosSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupKerberosSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_group_connections_kerberos_partial_update
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group Kerberos Source
          Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedGroupKerberosSourceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupKerberosSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_group_connections_kerberos_destroy
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group Kerberos Source
          Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/kerberos/{id}/used_by/:
    get:
      operationId: sources_group_connections_kerberos_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group Kerberos Source
          Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/ldap/:
    get:
      operationId: sources_group_connections_ldap_list
      description: Group-source connection Viewset
      parameters:
      - in: query
        name: group
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGroupLDAPSourceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_group_connections_ldap_create
      description: Group-source connection Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupLDAPSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupLDAPSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/ldap/{id}/:
    get:
      operationId: sources_group_connections_ldap_retrieve
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group LDAP Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupLDAPSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_group_connections_ldap_update
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group LDAP Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupLDAPSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupLDAPSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_group_connections_ldap_partial_update
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group LDAP Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedGroupLDAPSourceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupLDAPSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_group_connections_ldap_destroy
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group LDAP Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/ldap/{id}/used_by/:
    get:
      operationId: sources_group_connections_ldap_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group LDAP Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/oauth/:
    get:
      operationId: sources_group_connections_oauth_list
      description: Group-source connection Viewset
      parameters:
      - in: query
        name: group
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGroupOAuthSourceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_group_connections_oauth_create
      description: Group-source connection Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupOAuthSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupOAuthSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/oauth/{id}/:
    get:
      operationId: sources_group_connections_oauth_retrieve
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group OAuth Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupOAuthSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_group_connections_oauth_update
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group OAuth Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupOAuthSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupOAuthSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_group_connections_oauth_partial_update
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group OAuth Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedGroupOAuthSourceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupOAuthSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_group_connections_oauth_destroy
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group OAuth Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/oauth/{id}/used_by/:
    get:
      operationId: sources_group_connections_oauth_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group OAuth Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/plex/:
    get:
      operationId: sources_group_connections_plex_list
      description: Group-source connection Viewset
      parameters:
      - in: query
        name: group
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGroupPlexSourceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_group_connections_plex_create
      description: Group-source connection Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupPlexSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupPlexSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/plex/{id}/:
    get:
      operationId: sources_group_connections_plex_retrieve
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group Plex Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupPlexSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_group_connections_plex_update
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group Plex Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupPlexSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupPlexSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_group_connections_plex_partial_update
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group Plex Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedGroupPlexSourceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupPlexSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_group_connections_plex_destroy
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group Plex Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/plex/{id}/used_by/:
    get:
      operationId: sources_group_connections_plex_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group Plex Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/saml/:
    get:
      operationId: sources_group_connections_saml_list
      description: Group-source connection Viewset
      parameters:
      - in: query
        name: group
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGroupSAMLSourceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_group_connections_saml_create
      description: Group-source connection Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupSAMLSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupSAMLSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/saml/{id}/:
    get:
      operationId: sources_group_connections_saml_retrieve
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group SAML Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupSAMLSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_group_connections_saml_update
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group SAML Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupSAMLSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupSAMLSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_group_connections_saml_partial_update
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group SAML Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedGroupSAMLSourceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupSAMLSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_group_connections_saml_destroy
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group SAML Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/saml/{id}/used_by/:
    get:
      operationId: sources_group_connections_saml_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group SAML Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/telegram/:
    get:
      operationId: sources_group_connections_telegram_list
      description: Group-source connection Viewset
      parameters:
      - in: query
        name: group
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedGroupTelegramSourceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_group_connections_telegram_create
      description: Group-source connection Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupTelegramSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupTelegramSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/telegram/{id}/:
    get:
      operationId: sources_group_connections_telegram_retrieve
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group Telegram Source
          Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupTelegramSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_group_connections_telegram_update
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group Telegram Source
          Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GroupTelegramSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupTelegramSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_group_connections_telegram_partial_update
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group Telegram Source
          Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedGroupTelegramSourceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupTelegramSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_group_connections_telegram_destroy
      description: Group-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group Telegram Source
          Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/group_connections/telegram/{id}/used_by/:
    get:
      operationId: sources_group_connections_telegram_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Group Telegram Source
          Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/kerberos/:
    get:
      operationId: sources_kerberos_list
      description: Kerberos Source Viewset
      parameters:
      - in: query
        name: enabled
        schema:
          type: boolean
      - in: query
        name: kadmin_type
        schema:
          type: string
          enum:
          - Heimdal
          - MIT
          - other
        description: |+
          KAdmin server type

      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: password_login_update_internal_password
        schema:
          type: boolean
      - in: query
        name: pbm_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: realm
        schema:
          type: string
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: slug
        schema:
          type: string
      - in: query
        name: spnego_server_name
        schema:
          type: string
      - in: query
        name: sync_principal
        schema:
          type: string
      - in: query
        name: sync_users
        schema:
          type: boolean
      - in: query
        name: sync_users_password
        schema:
          type: boolean
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedKerberosSourceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_kerberos_create
      description: Kerberos Source Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/KerberosSourceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KerberosSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/kerberos/{slug}/:
    get:
      operationId: sources_kerberos_retrieve
      description: Kerberos Source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KerberosSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_kerberos_update
      description: Kerberos Source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/KerberosSourceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KerberosSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_kerberos_partial_update
      description: Kerberos Source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedKerberosSourceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KerberosSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_kerberos_destroy
      description: Kerberos Source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/kerberos/{slug}/sync/status/:
    get:
      operationId: sources_kerberos_sync_status_retrieve
      description: Get provider's sync status
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SyncStatus'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/kerberos/{slug}/used_by/:
    get:
      operationId: sources_kerberos_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/ldap/:
    get:
      operationId: sources_ldap_list
      description: LDAP Source Viewset
      parameters:
      - in: query
        name: additional_group_dn
        schema:
          type: string
      - in: query
        name: additional_user_dn
        schema:
          type: string
      - in: query
        name: base_dn
        schema:
          type: string
      - in: query
        name: bind_cn
        schema:
          type: string
      - in: query
        name: client_certificate
        schema:
          type: string
          format: uuid
      - in: query
        name: delete_not_found_objects
        schema:
          type: boolean
      - in: query
        name: enabled
        schema:
          type: boolean
      - in: query
        name: group_membership_field
        schema:
          type: string
      - in: query
        name: group_object_filter
        schema:
          type: string
      - in: query
        name: group_property_mappings
        schema:
          type: array
          items:
            type: string
            format: uuid
        explode: true
        style: form
      - in: query
        name: lookup_groups_from_user
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - in: query
        name: object_uniqueness_field
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: password_login_update_internal_password
        schema:
          type: boolean
      - in: query
        name: pbm_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: peer_certificate
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: server_uri
        schema:
          type: string
      - in: query
        name: slug
        schema:
          type: string
      - in: query
        name: sni
        schema:
          type: boolean
      - in: query
        name: start_tls
        schema:
          type: boolean
      - in: query
        name: sync_groups
        schema:
          type: boolean
      - in: query
        name: sync_parent_group
        schema:
          type: string
          format: uuid
      - in: query
        name: sync_users
        schema:
          type: boolean
      - in: query
        name: sync_users_password
        schema:
          type: boolean
      - in: query
        name: user_membership_attribute
        schema:
          type: string
      - in: query
        name: user_object_filter
        schema:
          type: string
      - in: query
        name: user_property_mappings
        schema:
          type: array
          items:
            type: string
            format: uuid
        explode: true
        style: form
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedLDAPSourceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_ldap_create
      description: LDAP Source Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LDAPSourceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LDAPSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/ldap/{slug}/:
    get:
      operationId: sources_ldap_retrieve
      description: LDAP Source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LDAPSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_ldap_update
      description: LDAP Source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LDAPSourceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LDAPSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_ldap_partial_update
      description: LDAP Source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedLDAPSourceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LDAPSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_ldap_destroy
      description: LDAP Source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/ldap/{slug}/debug/:
    get:
      operationId: sources_ldap_debug_retrieve
      description: Get raw LDAP data to debug
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LDAPDebug'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/ldap/{slug}/sync/status/:
    get:
      operationId: sources_ldap_sync_status_retrieve
      description: Get provider's sync status
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SyncStatus'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/ldap/{slug}/used_by/:
    get:
      operationId: sources_ldap_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/oauth/:
    get:
      operationId: sources_oauth_list
      description: Source Viewset
      parameters:
      - in: query
        name: access_token_url
        schema:
          type: string
      - in: query
        name: additional_scopes
        schema:
          type: string
      - in: query
        name: authentication_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: authorization_url
        schema:
          type: string
      - in: query
        name: consumer_key
        schema:
          type: string
      - in: query
        name: enabled
        schema:
          type: boolean
      - in: query
        name: enrollment_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: group_matching_mode
        schema:
          type: string
          enum:
          - identifier
          - name_deny
          - name_link
        description: |+
          How the source determines if an existing group should be used or a new group created.

      - in: query
        name: has_jwks
        schema:
          type: boolean
        description: Only return sources with JWKS data
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: pbm_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: policy_engine_mode
        schema:
          type: string
          enum:
          - all
          - any
      - in: query
        name: profile_url
        schema:
          type: string
      - in: query
        name: provider_type
        schema:
          type: string
      - in: query
        name: request_token_url
        schema:
          type: string
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: slug
        schema:
          type: string
      - in: query
        name: user_matching_mode
        schema:
          type: string
          enum:
          - email_deny
          - email_link
          - identifier
          - username_deny
          - username_link
        description: |+
          How the source determines if an existing user should be authenticated or a new user enrolled.

      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedOAuthSourceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_oauth_create
      description: Source Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OAuthSourceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/oauth/{slug}/:
    get:
      operationId: sources_oauth_retrieve
      description: Source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_oauth_update
      description: Source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OAuthSourceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_oauth_partial_update
      description: Source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedOAuthSourceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_oauth_destroy
      description: Source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/oauth/{slug}/used_by/:
    get:
      operationId: sources_oauth_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/oauth/source_types/:
    get:
      operationId: sources_oauth_source_types_list
      description: |-
        Get all creatable source types. If ?name is set, only returns the type for <name>.
        If <name> isn't found, returns the default type.
      parameters:
      - $ref: '#/components/parameters/QueryName'
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SourceType'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/plex/:
    get:
      operationId: sources_plex_list
      description: Plex source Viewset
      parameters:
      - in: query
        name: allow_friends
        schema:
          type: boolean
      - in: query
        name: authentication_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: client_id
        schema:
          type: string
      - in: query
        name: enabled
        schema:
          type: boolean
      - in: query
        name: enrollment_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: group_matching_mode
        schema:
          type: string
          enum:
          - identifier
          - name_deny
          - name_link
        description: |+
          How the source determines if an existing group should be used or a new group created.

      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: pbm_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: policy_engine_mode
        schema:
          type: string
          enum:
          - all
          - any
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: slug
        schema:
          type: string
      - in: query
        name: user_matching_mode
        schema:
          type: string
          enum:
          - email_deny
          - email_link
          - identifier
          - username_deny
          - username_link
        description: |+
          How the source determines if an existing user should be authenticated or a new user enrolled.

      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedPlexSourceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_plex_create
      description: Plex source Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PlexSourceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlexSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/plex/{slug}/:
    get:
      operationId: sources_plex_retrieve
      description: Plex source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlexSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_plex_update
      description: Plex source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PlexSourceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlexSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_plex_partial_update
      description: Plex source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedPlexSourceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlexSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_plex_destroy
      description: Plex source Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/plex/{slug}/used_by/:
    get:
      operationId: sources_plex_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/plex/redeem_token/:
    post:
      operationId: sources_plex_redeem_token_create
      description: |-
        Redeem a plex token, check it's access to resources against what's allowed
        for the source, and redirect to an authentication/enrollment flow.
      parameters:
      - in: query
        name: slug
        schema:
          type: string
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PlexTokenRedeemRequest'
        required: true
      security:
      - authentik: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RedirectChallenge'
          description: ''
        '400':
          description: Token not found
        '403':
          description: Access denied
  /sources/plex/redeem_token_authenticated/:
    post:
      operationId: sources_plex_redeem_token_authenticated_create
      description: Redeem a plex token for an authenticated user, creating a connection
      parameters:
      - in: query
        name: slug
        schema:
          type: string
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PlexTokenRedeemRequest'
        required: true
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          description: Token not found
        '403':
          description: Access denied
  /sources/saml/:
    get:
      operationId: sources_saml_list
      description: SAMLSource Viewset
      parameters:
      - in: query
        name: allow_idp_initiated
        schema:
          type: boolean
      - in: query
        name: authentication_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: binding_type
        schema:
          type: string
          enum:
          - POST
          - POST_AUTO
          - REDIRECT
      - in: query
        name: digest_algorithm
        schema:
          type: string
          enum:
          - http://www.w3.org/2000/09/xmldsig#sha1
          - http://www.w3.org/2001/04/xmldsig-more#sha384
          - http://www.w3.org/2001/04/xmlenc#sha256
          - http://www.w3.org/2001/04/xmlenc#sha512
      - in: query
        name: enabled
        schema:
          type: boolean
      - in: query
        name: enrollment_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: issuer
        schema:
          type: string
      - in: query
        name: managed
        schema:
          type: string
      - $ref: '#/components/parameters/QueryName'
      - in: query
        name: name_id_policy
        schema:
          type: string
          enum:
          - urn:oasis:names:tc:SAML:1.1:nameid-format:X509SubjectName
          - urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress
          - urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified
          - urn:oasis:names:tc:SAML:2.0:nameid-format:WindowsDomainQualifiedName
          - urn:oasis:names:tc:SAML:2.0:nameid-format:persistent
          - urn:oasis:names:tc:SAML:2.0:nameid-format:transient
        description: |+
          NameID Policy sent to the IdP. Can be unset, in which case no Policy is sent.

      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: pbm_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: policy_engine_mode
        schema:
          type: string
          enum:
          - all
          - any
      - in: query
        name: pre_authentication_flow
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: signature_algorithm
        schema:
          type: string
          enum:
          - http://www.w3.org/2000/09/xmldsig#dsa-sha1
          - http://www.w3.org/2000/09/xmldsig#rsa-sha1
          - http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha1
          - http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256
          - http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha384
          - http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha512
          - http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
          - http://www.w3.org/2001/04/xmldsig-more#rsa-sha384
          - http://www.w3.org/2001/04/xmldsig-more#rsa-sha512
      - in: query
        name: signed_assertion
        schema:
          type: boolean
      - in: query
        name: signed_response
        schema:
          type: boolean
      - in: query
        name: signing_kp
        schema:
          type: string
          format: uuid
      - in: query
        name: slo_url
        schema:
          type: string
      - in: query
        name: slug
        schema:
          type: string
      - in: query
        name: sso_url
        schema:
          type: string
      - in: query
        name: temporary_user_delete_after
        schema:
          type: string
      - in: query
        name: user_matching_mode
        schema:
          type: string
          enum:
          - email_deny
          - email_link
          - identifier
          - username_deny
          - username_link
        description: |+
          How the source determines if an existing user should be authenticated or a new user enrolled.

      - in: query
        name: verification_kp
        schema:
          type: string
          format: uuid
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSAMLSourceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_saml_create
      description: SAMLSource Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SAMLSourceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/saml/{slug}/:
    get:
      operationId: sources_saml_retrieve
      description: SAMLSource Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_saml_update
      description: SAMLSource Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SAMLSourceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_saml_partial_update
      description: SAMLSource Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSAMLSourceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_saml_destroy
      description: SAMLSource Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/saml/{slug}/metadata/:
    get:
      operationId: sources_saml_metadata_retrieve
      description: Return metadata as XML string
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SAMLMetadata'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/saml/{slug}/used_by/:
    get:
      operationId: sources_saml_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/scim/:
    get:
      operationId: sources_scim_list
      description: SCIMSource Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: pbm_uuid
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: slug
        schema:
          type: string
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSCIMSourceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_scim_create
      description: SCIMSource Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SCIMSourceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/scim/{slug}/:
    get:
      operationId: sources_scim_retrieve
      description: SCIMSource Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_scim_update
      description: SCIMSource Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SCIMSourceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_scim_partial_update
      description: SCIMSource Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSCIMSourceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_scim_destroy
      description: SCIMSource Viewset
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/scim/{slug}/used_by/:
    get:
      operationId: sources_scim_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/scim_groups/:
    get:
      operationId: sources_scim_groups_list
      description: SCIMSourceGroup Viewset
      parameters:
      - in: query
        name: group__group_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: group__name
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSCIMSourceGroupList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_scim_groups_create
      description: SCIMSourceGroup Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SCIMSourceGroupRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSourceGroup'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/scim_groups/{id}/:
    get:
      operationId: sources_scim_groups_retrieve
      description: SCIMSourceGroup Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
        description: A unique value identifying this scim source group.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSourceGroup'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_scim_groups_update
      description: SCIMSourceGroup Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
        description: A unique value identifying this scim source group.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SCIMSourceGroupRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSourceGroup'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_scim_groups_partial_update
      description: SCIMSourceGroup Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
        description: A unique value identifying this scim source group.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSCIMSourceGroupRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSourceGroup'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_scim_groups_destroy
      description: SCIMSourceGroup Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
        description: A unique value identifying this scim source group.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/scim_groups/{id}/used_by/:
    get:
      operationId: sources_scim_groups_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: string
        description: A unique value identifying this scim source group.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/scim_users/:
    get:
      operationId: sources_scim_users_list
      description: SCIMSourceUser Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      - in: query
        name: user__id
        schema:
          type: integer
      - in: query
        name: user__username
        schema:
          type: string
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSCIMSourceUserList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_scim_users_create
      description: SCIMSourceUser Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SCIMSourceUserRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSourceUser'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/scim_users/{id}/:
    get:
      operationId: sources_scim_users_retrieve
      description: SCIMSourceUser Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
        description: A unique value identifying this scim source user.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSourceUser'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_scim_users_update
      description: SCIMSourceUser Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
        description: A unique value identifying this scim source user.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SCIMSourceUserRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSourceUser'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_scim_users_partial_update
      description: SCIMSourceUser Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
        description: A unique value identifying this scim source user.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSCIMSourceUserRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SCIMSourceUser'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_scim_users_destroy
      description: SCIMSourceUser Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: string
        description: A unique value identifying this scim source user.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/scim_users/{id}/used_by/:
    get:
      operationId: sources_scim_users_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: string
        description: A unique value identifying this scim source user.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/telegram/:
    get:
      operationId: sources_telegram_list
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: query
        name: authentication_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: bot_username
        schema:
          type: string
      - in: query
        name: enabled
        schema:
          type: boolean
      - in: query
        name: enrollment_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: group_matching_mode
        schema:
          type: string
          enum:
          - identifier
          - name_deny
          - name_link
        description: |+
          How the source determines if an existing group should be used or a new group created.

      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: pbm_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: policy_engine_mode
        schema:
          type: string
          enum:
          - all
          - any
      - in: query
        name: request_message_access
        schema:
          type: boolean
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: slug
        schema:
          type: string
      - in: query
        name: user_matching_mode
        schema:
          type: string
          enum:
          - email_deny
          - email_link
          - identifier
          - username_deny
          - username_link
        description: |+
          How the source determines if an existing user should be authenticated or a new user enrolled.

      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedTelegramSourceList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_telegram_create
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TelegramSourceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TelegramSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/telegram/{slug}/:
    get:
      operationId: sources_telegram_retrieve
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TelegramSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_telegram_update
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TelegramSourceRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TelegramSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_telegram_partial_update
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedTelegramSourceRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TelegramSource'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_telegram_destroy
      description: Mixin to add a used_by endpoint to return a list of all objects
        using this object
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/telegram/{slug}/used_by/:
    get:
      operationId: sources_telegram_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: slug
        schema:
          type: string
          description: Internal source name, used in URLs.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/all/:
    get:
      operationId: sources_user_connections_all_list
      description: User-source connection Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      - in: query
        name: user
        schema:
          type: integer
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUserSourceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/all/{id}/:
    get:
      operationId: sources_user_connections_all_retrieve
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this user source connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_user_connections_all_update
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this user source connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_user_connections_all_partial_update
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this user source connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedUserSourceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_user_connections_all_destroy
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this user source connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/all/{id}/used_by/:
    get:
      operationId: sources_user_connections_all_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this user source connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/kerberos/:
    get:
      operationId: sources_user_connections_kerberos_list
      description: User-source connection Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      - in: query
        name: user
        schema:
          type: integer
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUserKerberosSourceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_user_connections_kerberos_create
      description: User-source connection Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserKerberosSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserKerberosSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/kerberos/{id}/:
    get:
      operationId: sources_user_connections_kerberos_retrieve
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Kerberos Source
          Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserKerberosSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_user_connections_kerberos_update
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Kerberos Source
          Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserKerberosSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserKerberosSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_user_connections_kerberos_partial_update
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Kerberos Source
          Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedUserKerberosSourceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserKerberosSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_user_connections_kerberos_destroy
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Kerberos Source
          Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/kerberos/{id}/used_by/:
    get:
      operationId: sources_user_connections_kerberos_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Kerberos Source
          Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/ldap/:
    get:
      operationId: sources_user_connections_ldap_list
      description: User-source connection Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      - in: query
        name: user
        schema:
          type: integer
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUserLDAPSourceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_user_connections_ldap_create
      description: User-source connection Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserLDAPSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserLDAPSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/ldap/{id}/:
    get:
      operationId: sources_user_connections_ldap_retrieve
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User LDAP Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserLDAPSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_user_connections_ldap_update
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User LDAP Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserLDAPSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserLDAPSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_user_connections_ldap_partial_update
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User LDAP Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedUserLDAPSourceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserLDAPSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_user_connections_ldap_destroy
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User LDAP Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/ldap/{id}/used_by/:
    get:
      operationId: sources_user_connections_ldap_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User LDAP Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/oauth/:
    get:
      operationId: sources_user_connections_oauth_list
      description: User-source connection Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      - in: query
        name: user
        schema:
          type: integer
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUserOAuthSourceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_user_connections_oauth_create
      description: User-source connection Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserOAuthSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserOAuthSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/oauth/{id}/:
    get:
      operationId: sources_user_connections_oauth_retrieve
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User OAuth Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserOAuthSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_user_connections_oauth_update
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User OAuth Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserOAuthSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserOAuthSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_user_connections_oauth_partial_update
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User OAuth Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedUserOAuthSourceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserOAuthSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_user_connections_oauth_destroy
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User OAuth Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/oauth/{id}/used_by/:
    get:
      operationId: sources_user_connections_oauth_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User OAuth Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/plex/:
    get:
      operationId: sources_user_connections_plex_list
      description: User-source connection Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      - in: query
        name: user
        schema:
          type: integer
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUserPlexSourceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_user_connections_plex_create
      description: User-source connection Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserPlexSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPlexSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/plex/{id}/:
    get:
      operationId: sources_user_connections_plex_retrieve
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Plex Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPlexSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_user_connections_plex_update
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Plex Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserPlexSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPlexSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_user_connections_plex_partial_update
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Plex Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedUserPlexSourceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPlexSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_user_connections_plex_destroy
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Plex Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/plex/{id}/used_by/:
    get:
      operationId: sources_user_connections_plex_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Plex Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/saml/:
    get:
      operationId: sources_user_connections_saml_list
      description: User-source connection Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      - in: query
        name: user
        schema:
          type: integer
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUserSAMLSourceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_user_connections_saml_create
      description: User-source connection Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserSAMLSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserSAMLSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/saml/{id}/:
    get:
      operationId: sources_user_connections_saml_retrieve
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User SAML Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserSAMLSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_user_connections_saml_update
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User SAML Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserSAMLSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserSAMLSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_user_connections_saml_partial_update
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User SAML Source Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedUserSAMLSourceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserSAMLSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_user_connections_saml_destroy
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User SAML Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/saml/{id}/used_by/:
    get:
      operationId: sources_user_connections_saml_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User SAML Source Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/telegram/:
    get:
      operationId: sources_user_connections_telegram_list
      description: User-source connection Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source__slug
        schema:
          type: string
      - in: query
        name: user
        schema:
          type: integer
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUserTelegramSourceConnectionList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: sources_user_connections_telegram_create
      description: User-source connection Viewset
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserTelegramSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserTelegramSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/telegram/{id}/:
    get:
      operationId: sources_user_connections_telegram_retrieve
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Telegram Source
          Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserTelegramSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: sources_user_connections_telegram_update
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Telegram Source
          Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserTelegramSourceConnectionRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserTelegramSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: sources_user_connections_telegram_partial_update
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Telegram Source
          Connection.
        required: true
      tags:
      - sources
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedUserTelegramSourceConnectionRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserTelegramSourceConnection'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: sources_user_connections_telegram_destroy
      description: User-source connection Viewset
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Telegram Source
          Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /sources/user_connections/telegram/{id}/used_by/:
    get:
      operationId: sources_user_connections_telegram_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this User Telegram Source
          Connection.
        required: true
      tags:
      - sources
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /ssf/streams/:
    get:
      operationId: ssf_streams_list
      description: SSFStream Viewset
      parameters:
      - in: query
        name: delivery_method
        schema:
          type: string
          enum:
          - https://schemas.openid.net/secevent/risc/delivery-method/poll
          - https://schemas.openid.net/secevent/risc/delivery-method/push
      - in: query
        name: endpoint_url
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: provider
        schema:
          type: integer
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - ssf
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSSFStreamList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /ssf/streams/{uuid}/:
    get:
      operationId: ssf_streams_retrieve
      description: SSFStream Viewset
      parameters:
      - in: path
        name: uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SSF Stream.
        required: true
      tags:
      - ssf
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SSFStream'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/all/:
    get:
      operationId: stages_all_list
      description: Stage Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/all/{stage_uuid}/:
    get:
      operationId: stages_all_retrieve
      description: Stage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Stage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_all_destroy
      description: Stage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/all/{stage_uuid}/used_by/:
    get:
      operationId: stages_all_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/all/types/:
    get:
      operationId: stages_all_types_list
      description: Get all creatable types
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TypeCreate'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/all/user_settings/:
    get:
      operationId: stages_all_user_settings_list
      description: Get all stages the user can configure
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserSetting'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/duo/:
    get:
      operationId: stages_authenticator_duo_list
      description: AuthenticatorDuoStage Viewset
      parameters:
      - in: query
        name: api_hostname
        schema:
          type: string
      - in: query
        name: client_id
        schema:
          type: string
      - in: query
        name: configure_flow
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedAuthenticatorDuoStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_authenticator_duo_create
      description: AuthenticatorDuoStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorDuoStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorDuoStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/duo/{stage_uuid}/:
    get:
      operationId: stages_authenticator_duo_retrieve
      description: AuthenticatorDuoStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Duo Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorDuoStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_authenticator_duo_update
      description: AuthenticatorDuoStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Duo Authenticator Setup Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorDuoStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorDuoStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_authenticator_duo_partial_update
      description: AuthenticatorDuoStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Duo Authenticator Setup Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedAuthenticatorDuoStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorDuoStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_authenticator_duo_destroy
      description: AuthenticatorDuoStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Duo Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/duo/{stage_uuid}/enrollment_status/:
    post:
      operationId: stages_authenticator_duo_enrollment_status_create
      description: Check enrollment status of user details in current session
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Duo Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DuoDeviceEnrollmentStatus'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/duo/{stage_uuid}/import_device_manual/:
    post:
      operationId: stages_authenticator_duo_import_device_manual_create
      description: Import duo devices into authentik
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Duo Authenticator Setup Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorDuoStageManualDeviceImportRequest'
        required: true
      security:
      - authentik: []
      responses:
        '204':
          description: Enrollment successful
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/duo/{stage_uuid}/import_devices_automatic/:
    post:
      operationId: stages_authenticator_duo_import_devices_automatic_create
      description: Import duo devices into authentik
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Duo Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorDuoStageDeviceImportResponse'
          description: ''
        '400':
          description: Bad request
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/duo/{stage_uuid}/used_by/:
    get:
      operationId: stages_authenticator_duo_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Duo Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/email/:
    get:
      operationId: stages_authenticator_email_list
      description: AuthenticatorEmailStage Viewset
      parameters:
      - in: query
        name: configure_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: friendly_name
        schema:
          type: string
      - in: query
        name: from_address
        schema:
          type: string
      - in: query
        name: host
        schema:
          type: string
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: password
        schema:
          type: string
      - in: query
        name: port
        schema:
          type: integer
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: subject
        schema:
          type: string
      - in: query
        name: template
        schema:
          type: string
      - in: query
        name: timeout
        schema:
          type: integer
      - in: query
        name: token_expiry
        schema:
          type: string
      - in: query
        name: use_global_settings
        schema:
          type: boolean
      - in: query
        name: use_ssl
        schema:
          type: boolean
      - in: query
        name: use_tls
        schema:
          type: boolean
      - in: query
        name: username
        schema:
          type: string
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedAuthenticatorEmailStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_authenticator_email_create
      description: AuthenticatorEmailStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorEmailStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorEmailStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/email/{stage_uuid}/:
    get:
      operationId: stages_authenticator_email_retrieve
      description: AuthenticatorEmailStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Email Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorEmailStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_authenticator_email_update
      description: AuthenticatorEmailStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Email Authenticator Setup Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorEmailStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorEmailStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_authenticator_email_partial_update
      description: AuthenticatorEmailStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Email Authenticator Setup Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedAuthenticatorEmailStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorEmailStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_authenticator_email_destroy
      description: AuthenticatorEmailStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Email Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/email/{stage_uuid}/used_by/:
    get:
      operationId: stages_authenticator_email_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Email Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/endpoint_gdtc/:
    get:
      operationId: stages_authenticator_endpoint_gdtc_list
      description: AuthenticatorEndpointGDTCStage Viewset
      parameters:
      - in: query
        name: configure_flow
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedAuthenticatorEndpointGDTCStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_authenticator_endpoint_gdtc_create
      description: AuthenticatorEndpointGDTCStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorEndpointGDTCStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorEndpointGDTCStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/endpoint_gdtc/{stage_uuid}/:
    get:
      operationId: stages_authenticator_endpoint_gdtc_retrieve
      description: AuthenticatorEndpointGDTCStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Endpoint Authenticator Google
          Device Trust Connector Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorEndpointGDTCStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_authenticator_endpoint_gdtc_update
      description: AuthenticatorEndpointGDTCStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Endpoint Authenticator Google
          Device Trust Connector Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorEndpointGDTCStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorEndpointGDTCStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_authenticator_endpoint_gdtc_partial_update
      description: AuthenticatorEndpointGDTCStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Endpoint Authenticator Google
          Device Trust Connector Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedAuthenticatorEndpointGDTCStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorEndpointGDTCStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_authenticator_endpoint_gdtc_destroy
      description: AuthenticatorEndpointGDTCStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Endpoint Authenticator Google
          Device Trust Connector Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/endpoint_gdtc/{stage_uuid}/used_by/:
    get:
      operationId: stages_authenticator_endpoint_gdtc_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Endpoint Authenticator Google
          Device Trust Connector Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/sms/:
    get:
      operationId: stages_authenticator_sms_list
      description: AuthenticatorSMSStage Viewset
      parameters:
      - in: query
        name: account_sid
        schema:
          type: string
      - in: query
        name: auth
        schema:
          type: string
      - in: query
        name: auth_password
        schema:
          type: string
      - in: query
        name: auth_type
        schema:
          type: string
          enum:
          - basic
          - bearer
      - in: query
        name: configure_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: friendly_name
        schema:
          type: string
      - in: query
        name: from_number
        schema:
          type: string
      - in: query
        name: mapping
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: provider
        schema:
          type: string
          enum:
          - generic
          - twilio
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: verify_only
        schema:
          type: boolean
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedAuthenticatorSMSStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_authenticator_sms_create
      description: AuthenticatorSMSStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorSMSStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorSMSStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/sms/{stage_uuid}/:
    get:
      operationId: stages_authenticator_sms_retrieve
      description: AuthenticatorSMSStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SMS Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorSMSStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_authenticator_sms_update
      description: AuthenticatorSMSStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SMS Authenticator Setup Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorSMSStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorSMSStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_authenticator_sms_partial_update
      description: AuthenticatorSMSStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SMS Authenticator Setup Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedAuthenticatorSMSStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorSMSStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_authenticator_sms_destroy
      description: AuthenticatorSMSStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SMS Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/sms/{stage_uuid}/used_by/:
    get:
      operationId: stages_authenticator_sms_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this SMS Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/static/:
    get:
      operationId: stages_authenticator_static_list
      description: AuthenticatorStaticStage Viewset
      parameters:
      - in: query
        name: configure_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: friendly_name
        schema:
          type: string
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: token_count
        schema:
          type: integer
      - in: query
        name: token_length
        schema:
          type: integer
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedAuthenticatorStaticStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_authenticator_static_create
      description: AuthenticatorStaticStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorStaticStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorStaticStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/static/{stage_uuid}/:
    get:
      operationId: stages_authenticator_static_retrieve
      description: AuthenticatorStaticStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Static Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorStaticStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_authenticator_static_update
      description: AuthenticatorStaticStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Static Authenticator Setup Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorStaticStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorStaticStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_authenticator_static_partial_update
      description: AuthenticatorStaticStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Static Authenticator Setup Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedAuthenticatorStaticStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorStaticStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_authenticator_static_destroy
      description: AuthenticatorStaticStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Static Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/static/{stage_uuid}/used_by/:
    get:
      operationId: stages_authenticator_static_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Static Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/totp/:
    get:
      operationId: stages_authenticator_totp_list
      description: AuthenticatorTOTPStage Viewset
      parameters:
      - in: query
        name: configure_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: digits
        schema:
          type: string
          enum:
          - '6'
          - '8'
      - in: query
        name: friendly_name
        schema:
          type: string
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedAuthenticatorTOTPStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_authenticator_totp_create
      description: AuthenticatorTOTPStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorTOTPStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorTOTPStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/totp/{stage_uuid}/:
    get:
      operationId: stages_authenticator_totp_retrieve
      description: AuthenticatorTOTPStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this TOTP Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorTOTPStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_authenticator_totp_update
      description: AuthenticatorTOTPStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this TOTP Authenticator Setup Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorTOTPStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorTOTPStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_authenticator_totp_partial_update
      description: AuthenticatorTOTPStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this TOTP Authenticator Setup Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedAuthenticatorTOTPStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorTOTPStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_authenticator_totp_destroy
      description: AuthenticatorTOTPStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this TOTP Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/totp/{stage_uuid}/used_by/:
    get:
      operationId: stages_authenticator_totp_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this TOTP Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/validate/:
    get:
      operationId: stages_authenticator_validate_list
      description: AuthenticatorValidateStage Viewset
      parameters:
      - in: query
        name: configuration_stages
        schema:
          type: array
          items:
            type: string
            format: uuid
        explode: true
        style: form
      - $ref: '#/components/parameters/QueryName'
      - in: query
        name: not_configured_action
        schema:
          type: string
          enum:
          - configure
          - deny
          - skip
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedAuthenticatorValidateStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_authenticator_validate_create
      description: AuthenticatorValidateStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorValidateStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorValidateStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/validate/{stage_uuid}/:
    get:
      operationId: stages_authenticator_validate_retrieve
      description: AuthenticatorValidateStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Authenticator Validation Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorValidateStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_authenticator_validate_update
      description: AuthenticatorValidateStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Authenticator Validation Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorValidateStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorValidateStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_authenticator_validate_partial_update
      description: AuthenticatorValidateStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Authenticator Validation Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedAuthenticatorValidateStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorValidateStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_authenticator_validate_destroy
      description: AuthenticatorValidateStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Authenticator Validation Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/validate/{stage_uuid}/used_by/:
    get:
      operationId: stages_authenticator_validate_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Authenticator Validation Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/webauthn/:
    get:
      operationId: stages_authenticator_webauthn_list
      description: AuthenticatorWebAuthnStage Viewset
      parameters:
      - in: query
        name: authenticator_attachment
        schema:
          type: string
          nullable: true
          enum:
          - cross-platform
          - platform
      - in: query
        name: configure_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: device_type_restrictions
        schema:
          type: array
          items:
            type: string
            format: uuid
        explode: true
        style: form
      - in: query
        name: friendly_name
        schema:
          type: string
      - in: query
        name: max_attempts
        schema:
          type: integer
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: resident_key_requirement
        schema:
          type: string
          enum:
          - discouraged
          - preferred
          - required
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: user_verification
        schema:
          type: string
          enum:
          - discouraged
          - preferred
          - required
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedAuthenticatorWebAuthnStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_authenticator_webauthn_create
      description: AuthenticatorWebAuthnStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorWebAuthnStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorWebAuthnStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/webauthn/{stage_uuid}/:
    get:
      operationId: stages_authenticator_webauthn_retrieve
      description: AuthenticatorWebAuthnStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this WebAuthn Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorWebAuthnStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_authenticator_webauthn_update
      description: AuthenticatorWebAuthnStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this WebAuthn Authenticator Setup Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticatorWebAuthnStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorWebAuthnStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_authenticator_webauthn_partial_update
      description: AuthenticatorWebAuthnStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this WebAuthn Authenticator Setup Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedAuthenticatorWebAuthnStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticatorWebAuthnStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_authenticator_webauthn_destroy
      description: AuthenticatorWebAuthnStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this WebAuthn Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/webauthn/{stage_uuid}/used_by/:
    get:
      operationId: stages_authenticator_webauthn_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this WebAuthn Authenticator Setup Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/webauthn_device_types/:
    get:
      operationId: stages_authenticator_webauthn_device_types_list
      description: WebAuthnDeviceType Viewset
      parameters:
      - in: query
        name: aaguid
        schema:
          type: string
          format: uuid
      - in: query
        name: description
        schema:
          type: string
      - in: query
        name: icon
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedWebAuthnDeviceTypeList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/authenticator/webauthn_device_types/{aaguid}/:
    get:
      operationId: stages_authenticator_webauthn_device_types_retrieve
      description: WebAuthnDeviceType Viewset
      parameters:
      - in: path
        name: aaguid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this WebAuthn Device type.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebAuthnDeviceType'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/captcha/:
    get:
      operationId: stages_captcha_list
      description: CaptchaStage Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: public_key
        schema:
          type: string
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedCaptchaStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_captcha_create
      description: CaptchaStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CaptchaStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CaptchaStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/captcha/{stage_uuid}/:
    get:
      operationId: stages_captcha_retrieve
      description: CaptchaStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Captcha Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CaptchaStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_captcha_update
      description: CaptchaStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Captcha Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CaptchaStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CaptchaStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_captcha_partial_update
      description: CaptchaStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Captcha Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedCaptchaStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CaptchaStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_captcha_destroy
      description: CaptchaStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Captcha Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/captcha/{stage_uuid}/used_by/:
    get:
      operationId: stages_captcha_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Captcha Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/consent/:
    get:
      operationId: stages_consent_list
      description: ConsentStage Viewset
      parameters:
      - in: query
        name: consent_expire_in
        schema:
          type: string
      - in: query
        name: mode
        schema:
          type: string
          enum:
          - always_require
          - expiring
          - permanent
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedConsentStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_consent_create
      description: ConsentStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConsentStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConsentStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/consent/{stage_uuid}/:
    get:
      operationId: stages_consent_retrieve
      description: ConsentStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Consent Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConsentStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_consent_update
      description: ConsentStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Consent Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConsentStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConsentStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_consent_partial_update
      description: ConsentStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Consent Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedConsentStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConsentStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_consent_destroy
      description: ConsentStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Consent Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/consent/{stage_uuid}/used_by/:
    get:
      operationId: stages_consent_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Consent Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/deny/:
    get:
      operationId: stages_deny_list
      description: DenyStage Viewset
      parameters:
      - in: query
        name: deny_message
        schema:
          type: string
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedDenyStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_deny_create
      description: DenyStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DenyStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DenyStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/deny/{stage_uuid}/:
    get:
      operationId: stages_deny_retrieve
      description: DenyStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Deny Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DenyStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_deny_update
      description: DenyStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Deny Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DenyStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DenyStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_deny_partial_update
      description: DenyStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Deny Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedDenyStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DenyStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_deny_destroy
      description: DenyStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Deny Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/deny/{stage_uuid}/used_by/:
    get:
      operationId: stages_deny_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Deny Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/dummy/:
    get:
      operationId: stages_dummy_list
      description: DummyStage Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: throw_error
        schema:
          type: boolean
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedDummyStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_dummy_create
      description: DummyStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DummyStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DummyStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/dummy/{stage_uuid}/:
    get:
      operationId: stages_dummy_retrieve
      description: DummyStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Dummy Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DummyStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_dummy_update
      description: DummyStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Dummy Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DummyStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DummyStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_dummy_partial_update
      description: DummyStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Dummy Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedDummyStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DummyStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_dummy_destroy
      description: DummyStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Dummy Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/dummy/{stage_uuid}/used_by/:
    get:
      operationId: stages_dummy_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Dummy Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/email/:
    get:
      operationId: stages_email_list
      description: EmailStage Viewset
      parameters:
      - in: query
        name: activate_user_on_success
        schema:
          type: boolean
      - in: query
        name: from_address
        schema:
          type: string
      - in: query
        name: host
        schema:
          type: string
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: port
        schema:
          type: integer
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: subject
        schema:
          type: string
      - in: query
        name: template
        schema:
          type: string
      - in: query
        name: timeout
        schema:
          type: integer
      - in: query
        name: token_expiry
        schema:
          type: string
      - in: query
        name: use_global_settings
        schema:
          type: boolean
      - in: query
        name: use_ssl
        schema:
          type: boolean
      - in: query
        name: use_tls
        schema:
          type: boolean
      - in: query
        name: username
        schema:
          type: string
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedEmailStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_email_create
      description: EmailStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EmailStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/email/{stage_uuid}/:
    get:
      operationId: stages_email_retrieve
      description: EmailStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Email Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_email_update
      description: EmailStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Email Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EmailStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_email_partial_update
      description: EmailStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Email Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedEmailStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_email_destroy
      description: EmailStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Email Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/email/{stage_uuid}/used_by/:
    get:
      operationId: stages_email_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Email Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/email/templates/:
    get:
      operationId: stages_email_templates_list
      description: Get all available templates, including custom templates
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TypeCreate'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/identification/:
    get:
      operationId: stages_identification_list
      description: IdentificationStage Viewset
      parameters:
      - in: query
        name: captcha_stage
        schema:
          type: string
          format: uuid
      - in: query
        name: case_insensitive_matching
        schema:
          type: boolean
      - in: query
        name: enrollment_flow
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: password_stage
        schema:
          type: string
          format: uuid
      - in: query
        name: passwordless_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: recovery_flow
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: show_matched_user
        schema:
          type: boolean
      - in: query
        name: show_source_labels
        schema:
          type: boolean
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedIdentificationStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_identification_create
      description: IdentificationStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IdentificationStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IdentificationStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/identification/{stage_uuid}/:
    get:
      operationId: stages_identification_retrieve
      description: IdentificationStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Identification Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IdentificationStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_identification_update
      description: IdentificationStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Identification Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IdentificationStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IdentificationStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_identification_partial_update
      description: IdentificationStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Identification Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedIdentificationStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IdentificationStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_identification_destroy
      description: IdentificationStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Identification Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/identification/{stage_uuid}/used_by/:
    get:
      operationId: stages_identification_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Identification Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/invitation/invitations/:
    get:
      operationId: stages_invitation_invitations_list
      description: Invitation Viewset
      parameters:
      - in: query
        name: created_by__username
        schema:
          type: string
      - in: query
        name: expires
        schema:
          type: string
          format: date-time
      - in: query
        name: flow__slug
        schema:
          type: string
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedInvitationList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_invitation_invitations_create
      description: Invitation Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InvitationRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Invitation'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/invitation/invitations/{invite_uuid}/:
    get:
      operationId: stages_invitation_invitations_retrieve
      description: Invitation Viewset
      parameters:
      - in: path
        name: invite_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Invitation.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Invitation'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_invitation_invitations_update
      description: Invitation Viewset
      parameters:
      - in: path
        name: invite_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Invitation.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InvitationRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Invitation'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_invitation_invitations_partial_update
      description: Invitation Viewset
      parameters:
      - in: path
        name: invite_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Invitation.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedInvitationRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Invitation'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_invitation_invitations_destroy
      description: Invitation Viewset
      parameters:
      - in: path
        name: invite_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Invitation.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/invitation/invitations/{invite_uuid}/used_by/:
    get:
      operationId: stages_invitation_invitations_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: invite_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Invitation.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/invitation/stages/:
    get:
      operationId: stages_invitation_stages_list
      description: InvitationStage Viewset
      parameters:
      - in: query
        name: continue_flow_without_invitation
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryName'
      - in: query
        name: no_flows
        schema:
          type: boolean
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedInvitationStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_invitation_stages_create
      description: InvitationStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InvitationStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InvitationStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/invitation/stages/{stage_uuid}/:
    get:
      operationId: stages_invitation_stages_retrieve
      description: InvitationStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Invitation Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InvitationStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_invitation_stages_update
      description: InvitationStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Invitation Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InvitationStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InvitationStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_invitation_stages_partial_update
      description: InvitationStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Invitation Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedInvitationStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InvitationStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_invitation_stages_destroy
      description: InvitationStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Invitation Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/invitation/stages/{stage_uuid}/used_by/:
    get:
      operationId: stages_invitation_stages_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Invitation Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/mtls/:
    get:
      operationId: stages_mtls_list
      description: MutualTLSStage Viewset
      parameters:
      - in: query
        name: cert_attribute
        schema:
          type: string
          enum:
          - common_name
          - email
          - subject
      - in: query
        name: certificate_authorities
        schema:
          type: array
          items:
            type: string
            format: uuid
        explode: true
        style: form
      - in: query
        name: mode
        schema:
          type: string
          enum:
          - optional
          - required
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: user_attribute
        schema:
          type: string
          enum:
          - email
          - username
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedMutualTLSStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_mtls_create
      description: MutualTLSStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MutualTLSStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MutualTLSStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/mtls/{stage_uuid}/:
    get:
      operationId: stages_mtls_retrieve
      description: MutualTLSStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Mutual TLS Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MutualTLSStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_mtls_update
      description: MutualTLSStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Mutual TLS Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MutualTLSStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MutualTLSStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_mtls_partial_update
      description: MutualTLSStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Mutual TLS Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedMutualTLSStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MutualTLSStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_mtls_destroy
      description: MutualTLSStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Mutual TLS Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/mtls/{stage_uuid}/used_by/:
    get:
      operationId: stages_mtls_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Mutual TLS Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/password/:
    get:
      operationId: stages_password_list
      description: PasswordStage Viewset
      parameters:
      - in: query
        name: allow_show_password
        schema:
          type: boolean
      - in: query
        name: configure_flow
        schema:
          type: string
          format: uuid
      - in: query
        name: failed_attempts_before_cancel
        schema:
          type: integer
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedPasswordStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_password_create
      description: PasswordStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/password/{stage_uuid}/:
    get:
      operationId: stages_password_retrieve
      description: PasswordStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_password_update
      description: PasswordStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_password_partial_update
      description: PasswordStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedPasswordStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_password_destroy
      description: PasswordStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/password/{stage_uuid}/used_by/:
    get:
      operationId: stages_password_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Password Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/prompt/prompts/:
    get:
      operationId: stages_prompt_prompts_list
      description: Prompt Viewset
      parameters:
      - in: query
        name: field_key
        schema:
          type: string
      - in: query
        name: label
        schema:
          type: string
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: placeholder
        schema:
          type: string
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: type
        schema:
          type: string
          enum:
          - ak-locale
          - checkbox
          - date
          - date-time
          - dropdown
          - email
          - file
          - hidden
          - number
          - password
          - radio-button-group
          - separator
          - static
          - text
          - text_area
          - text_area_read_only
          - text_read_only
          - username
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedPromptList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_prompt_prompts_create
      description: Prompt Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PromptRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Prompt'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/prompt/prompts/{prompt_uuid}/:
    get:
      operationId: stages_prompt_prompts_retrieve
      description: Prompt Viewset
      parameters:
      - in: path
        name: prompt_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Prompt.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Prompt'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_prompt_prompts_update
      description: Prompt Viewset
      parameters:
      - in: path
        name: prompt_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Prompt.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PromptRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Prompt'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_prompt_prompts_partial_update
      description: Prompt Viewset
      parameters:
      - in: path
        name: prompt_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Prompt.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedPromptRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Prompt'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_prompt_prompts_destroy
      description: Prompt Viewset
      parameters:
      - in: path
        name: prompt_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Prompt.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/prompt/prompts/{prompt_uuid}/used_by/:
    get:
      operationId: stages_prompt_prompts_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: prompt_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Prompt.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/prompt/prompts/preview/:
    post:
      operationId: stages_prompt_prompts_preview_create
      description: Preview a prompt as a challenge, just like a flow would receive
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PromptRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PromptChallenge'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/prompt/stages/:
    get:
      operationId: stages_prompt_stages_list
      description: PromptStage Viewset
      parameters:
      - in: query
        name: fields
        schema:
          type: array
          items:
            type: string
            format: uuid
        explode: true
        style: form
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: validation_policies
        schema:
          type: array
          items:
            type: string
            format: uuid
        explode: true
        style: form
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedPromptStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_prompt_stages_create
      description: PromptStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PromptStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PromptStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/prompt/stages/{stage_uuid}/:
    get:
      operationId: stages_prompt_stages_retrieve
      description: PromptStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Prompt Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PromptStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_prompt_stages_update
      description: PromptStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Prompt Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PromptStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PromptStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_prompt_stages_partial_update
      description: PromptStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Prompt Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedPromptStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PromptStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_prompt_stages_destroy
      description: PromptStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Prompt Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/prompt/stages/{stage_uuid}/used_by/:
    get:
      operationId: stages_prompt_stages_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Prompt Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/redirect/:
    get:
      operationId: stages_redirect_list
      description: RedirectStage Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedRedirectStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_redirect_create
      description: RedirectStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RedirectStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RedirectStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/redirect/{stage_uuid}/:
    get:
      operationId: stages_redirect_retrieve
      description: RedirectStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Redirect Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RedirectStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_redirect_update
      description: RedirectStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Redirect Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RedirectStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RedirectStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_redirect_partial_update
      description: RedirectStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Redirect Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedRedirectStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RedirectStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_redirect_destroy
      description: RedirectStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Redirect Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/redirect/{stage_uuid}/used_by/:
    get:
      operationId: stages_redirect_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Redirect Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/source/:
    get:
      operationId: stages_source_list
      description: SourceStage Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: resume_timeout
        schema:
          type: string
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: source
        schema:
          type: string
          format: uuid
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedSourceStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_source_create
      description: SourceStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SourceStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SourceStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/source/{stage_uuid}/:
    get:
      operationId: stages_source_retrieve
      description: SourceStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Source Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SourceStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_source_update
      description: SourceStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Source Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SourceStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SourceStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_source_partial_update
      description: SourceStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Source Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedSourceStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SourceStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_source_destroy
      description: SourceStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Source Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/source/{stage_uuid}/used_by/:
    get:
      operationId: stages_source_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Source Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/user_delete/:
    get:
      operationId: stages_user_delete_list
      description: UserDeleteStage Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUserDeleteStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_user_delete_create
      description: UserDeleteStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserDeleteStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserDeleteStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/user_delete/{stage_uuid}/:
    get:
      operationId: stages_user_delete_retrieve
      description: UserDeleteStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Delete Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserDeleteStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_user_delete_update
      description: UserDeleteStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Delete Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserDeleteStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserDeleteStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_user_delete_partial_update
      description: UserDeleteStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Delete Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedUserDeleteStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserDeleteStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_user_delete_destroy
      description: UserDeleteStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Delete Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/user_delete/{stage_uuid}/used_by/:
    get:
      operationId: stages_user_delete_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Delete Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/user_login/:
    get:
      operationId: stages_user_login_list
      description: UserLoginStage Viewset
      parameters:
      - in: query
        name: geoip_binding
        schema:
          type: string
          enum:
          - bind_continent
          - bind_continent_country
          - bind_continent_country_city
          - no_binding
        description: |+
          Bind sessions created by this stage to the configured GeoIP location

      - $ref: '#/components/parameters/QueryName'
      - in: query
        name: network_binding
        schema:
          type: string
          enum:
          - bind_asn
          - bind_asn_network
          - bind_asn_network_ip
          - no_binding
        description: |+
          Bind sessions created by this stage to the configured network

      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: remember_device
        schema:
          type: string
      - in: query
        name: remember_me_offset
        schema:
          type: string
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: session_duration
        schema:
          type: string
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: terminate_other_sessions
        schema:
          type: boolean
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUserLoginStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_user_login_create
      description: UserLoginStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserLoginStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserLoginStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/user_login/{stage_uuid}/:
    get:
      operationId: stages_user_login_retrieve
      description: UserLoginStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Login Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserLoginStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_user_login_update
      description: UserLoginStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Login Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserLoginStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserLoginStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_user_login_partial_update
      description: UserLoginStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Login Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedUserLoginStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserLoginStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_user_login_destroy
      description: UserLoginStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Login Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/user_login/{stage_uuid}/used_by/:
    get:
      operationId: stages_user_login_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Login Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/user_logout/:
    get:
      operationId: stages_user_logout_list
      description: UserLogoutStage Viewset
      parameters:
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUserLogoutStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_user_logout_create
      description: UserLogoutStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserLogoutStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserLogoutStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/user_logout/{stage_uuid}/:
    get:
      operationId: stages_user_logout_retrieve
      description: UserLogoutStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Logout Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserLogoutStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_user_logout_update
      description: UserLogoutStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Logout Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserLogoutStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserLogoutStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_user_logout_partial_update
      description: UserLogoutStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Logout Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedUserLogoutStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserLogoutStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_user_logout_destroy
      description: UserLogoutStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Logout Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/user_logout/{stage_uuid}/used_by/:
    get:
      operationId: stages_user_logout_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Logout Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/user_write/:
    get:
      operationId: stages_user_write_list
      description: UserWriteStage Viewset
      parameters:
      - in: query
        name: create_users_as_inactive
        schema:
          type: boolean
      - in: query
        name: create_users_group
        schema:
          type: string
          format: uuid
      - $ref: '#/components/parameters/QueryName'
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: stage_uuid
        schema:
          type: string
          format: uuid
      - in: query
        name: user_creation_mode
        schema:
          type: string
          enum:
          - always_create
          - create_when_required
          - never_create
      - in: query
        name: user_path_template
        schema:
          type: string
      - in: query
        name: user_type
        schema:
          type: string
          enum:
          - external
          - internal
          - internal_service_account
          - service_account
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUserWriteStageList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: stages_user_write_create
      description: UserWriteStage Viewset
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserWriteStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserWriteStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/user_write/{stage_uuid}/:
    get:
      operationId: stages_user_write_retrieve
      description: UserWriteStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Write Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserWriteStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: stages_user_write_update
      description: UserWriteStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Write Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserWriteStageRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserWriteStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: stages_user_write_partial_update
      description: UserWriteStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Write Stage.
        required: true
      tags:
      - stages
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedUserWriteStageRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserWriteStage'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: stages_user_write_destroy
      description: UserWriteStage Viewset
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Write Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /stages/user_write/{stage_uuid}/used_by/:
    get:
      operationId: stages_user_write_used_by_list
      description: Get a list of all objects that use this object
      parameters:
      - in: path
        name: stage_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User Write Stage.
        required: true
      tags:
      - stages
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UsedBy'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /tasks/schedules/:
    get:
      operationId: tasks_schedules_list
      parameters:
      - in: query
        name: actor_name
        schema:
          type: string
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: paused
        schema:
          type: boolean
      - in: query
        name: rel_obj_content_type__app_label
        schema:
          type: string
      - in: query
        name: rel_obj_content_type__model
        schema:
          type: string
      - in: query
        name: rel_obj_id
        schema:
          type: string
      - in: query
        name: rel_obj_id__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - tasks
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedScheduleList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /tasks/schedules/{id}/:
    get:
      operationId: tasks_schedules_retrieve
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Schedule.
        required: true
      tags:
      - tasks
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Schedule'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: tasks_schedules_update
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Schedule.
        required: true
      tags:
      - tasks
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ScheduleRequest'
        required: true
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Schedule'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: tasks_schedules_partial_update
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Schedule.
        required: true
      tags:
      - tasks
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedScheduleRequest'
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Schedule'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /tasks/schedules/{id}/send/:
    post:
      operationId: tasks_schedules_send_create
      description: Trigger this schedule now
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Schedule.
        required: true
      tags:
      - tasks
      security:
      - authentik: []
      responses:
        '204':
          description: Schedule sent successfully
        '404':
          description: Schedule not found
        '500':
          description: Failed to send schedule
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /tasks/tasks/:
    get:
      operationId: tasks_tasks_list
      parameters:
      - in: query
        name: actor_name
        schema:
          type: string
      - in: query
        name: aggregated_status
        schema:
          type: array
          items:
            type: string
            enum:
            - consumed
            - done
            - error
            - info
            - postprocess
            - preprocess
            - queued
            - rejected
            - running
            - warning
        explode: true
        style: form
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - in: query
        name: queue_name
        schema:
          type: string
      - in: query
        name: rel_obj_content_type__app_label
        schema:
          type: string
      - in: query
        name: rel_obj_content_type__model
        schema:
          type: string
      - in: query
        name: rel_obj_id
        schema:
          type: string
      - in: query
        name: rel_obj_id__isnull
        schema:
          type: boolean
      - $ref: '#/components/parameters/QuerySearch'
      - in: query
        name: state
        schema:
          type: string
          enum:
          - consumed
          - done
          - postprocess
          - preprocess
          - queued
          - rejected
          - running
        description: |+
          Task status

      tags:
      - tasks
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedTaskList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /tasks/tasks/{message_id}/:
    get:
      operationId: tasks_tasks_retrieve
      parameters:
      - in: path
        name: message_id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Task.
        required: true
      tags:
      - tasks
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Task'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /tasks/tasks/{message_id}/retry/:
    post:
      operationId: tasks_tasks_retry_create
      description: Retry task
      parameters:
      - in: path
        name: message_id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Task.
        required: true
      tags:
      - tasks
      security:
      - authentik: []
      responses:
        '204':
          description: Task retried successfully
        '400':
          description: Task is not in a retryable state
        '404':
          description: Task not found
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /tasks/tasks/status/:
    get:
      operationId: tasks_tasks_status_retrieve
      description: Global status summary for all tasks
      tags:
      - tasks
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GlobalTaskStatus'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /tasks/workers:
    get:
      operationId: tasks_workers_list
      description: Get currently connected worker count.
      tags:
      - tasks
      security:
      - authentik: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Worker'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /tenants/domains/:
    get:
      operationId: tenants_domains_list
      description: Domain ViewSet
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - tenants
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedDomainList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: tenants_domains_create
      description: Domain ViewSet
      tags:
      - tenants
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DomainRequest'
        required: true
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Domain'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /tenants/domains/{id}/:
    get:
      operationId: tenants_domains_retrieve
      description: Domain ViewSet
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Domain.
        required: true
      tags:
      - tenants
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Domain'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: tenants_domains_update
      description: Domain ViewSet
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Domain.
        required: true
      tags:
      - tenants
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DomainRequest'
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Domain'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: tenants_domains_partial_update
      description: Domain ViewSet
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Domain.
        required: true
      tags:
      - tenants
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedDomainRequest'
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Domain'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: tenants_domains_destroy
      description: Domain ViewSet
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        description: A unique integer value identifying this Domain.
        required: true
      tags:
      - tenants
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /tenants/tenants/:
    get:
      operationId: tenants_tenants_list
      description: Tenant Viewset
      parameters:
      - $ref: '#/components/parameters/QueryPaginationOrdering'
      - $ref: '#/components/parameters/QueryPaginationPage'
      - $ref: '#/components/parameters/QueryPaginationPageSize'
      - $ref: '#/components/parameters/QuerySearch'
      tags:
      - tenants
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedTenantList'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    post:
      operationId: tenants_tenants_create
      description: Tenant Viewset
      tags:
      - tenants
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TenantRequest'
        required: true
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tenant'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /tenants/tenants/{tenant_uuid}/:
    get:
      operationId: tenants_tenants_retrieve
      description: Tenant Viewset
      parameters:
      - in: path
        name: tenant_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Tenant.
        required: true
      tags:
      - tenants
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tenant'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    put:
      operationId: tenants_tenants_update
      description: Tenant Viewset
      parameters:
      - in: path
        name: tenant_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Tenant.
        required: true
      tags:
      - tenants
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TenantRequest'
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tenant'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    patch:
      operationId: tenants_tenants_partial_update
      description: Tenant Viewset
      parameters:
      - in: path
        name: tenant_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Tenant.
        required: true
      tags:
      - tenants
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedTenantRequest'
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tenant'
          description: ''
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
    delete:
      operationId: tenants_tenants_destroy
      description: Tenant Viewset
      parameters:
      - in: path
        name: tenant_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Tenant.
        required: true
      tags:
      - tenants
      responses:
        '204':
          description: No response body
        '400':
          $ref: '#/components/responses/ValidationErrorResponse'
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /tenants/tenants/{tenant_uuid}/create_admin_group/:
    post:
      operationId: tenants_tenants_create_admin_group_create
      description: Create admin group and add user to it.
      parameters:
      - in: path
        name: tenant_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Tenant.
        required: true
      tags:
      - tenants
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TenantAdminGroupRequestRequest'
        required: true
      responses:
        '204':
          description: Group created successfully.
        '400':
          description: Bad request
        '404':
          description: User not found
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
  /tenants/tenants/{tenant_uuid}/create_recovery_key/:
    post:
      operationId: tenants_tenants_create_recovery_key_create
      description: Create recovery key for user.
      parameters:
      - in: path
        name: tenant_uuid
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Tenant.
        required: true
      tags:
      - tenants
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TenantRecoveryKeyRequestRequest'
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TenantRecoveryKeyResponse'
          description: ''
        '400':
          description: Bad request
        '404':
          description: User not found
        '403':
          $ref: '#/components/responses/GenericErrorResponse'
components:
  parameters:
    QueryName:
      in: query
      name: name
      schema:
        type: string
    QueryPaginationOrdering:
      in: query
      name: ordering
      schema:
        type: string
      description: Which field to use when ordering the results.
    QueryPaginationPage:
      in: query
      name: page
      schema:
        type: integer
      description: A page number within the paginated result set.
    QueryPaginationPageSize:
      in: query
      name: page_size
      schema:
        type: integer
      description: Number of results to return per page.
    QuerySearch:
      in: query
      name: search
      schema:
        type: string
      description: A search term.
  responses:
    GenericErrorResponse:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/GenericError'
      description: ''
    ValidationErrorResponse:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ValidationError'
      description: ''
  schemas:
    AccessDeniedChallenge:
      type: object
      description: Challenge when a flow's active stage calls `stage_invalid()`.
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-access-denied
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        pending_user:
          type: string
        pending_user_avatar:
          type: string
        error_message:
          type: string
      required:
      - pending_user
      - pending_user_avatar
    AgentAuthenticationResponse:
      type: object
      description: Base serializer class which doesn't implement create/update methods
      properties:
        url:
          type: string
      required:
      - url
    AgentConfig:
      type: object
      description: Base serializer class which doesn't implement create/update methods
      properties:
        device_id:
          type: string
          readOnly: true
        refresh_interval:
          type: integer
          readOnly: true
        authorization_flow:
          type: string
        jwks:
          type: object
          additionalProperties: {}
          readOnly: true
        nss_uid_offset:
          type: integer
        nss_gid_offset:
          type: integer
        auth_terminate_session_on_expiry:
          type: boolean
        system_config:
          allOf:
          - $ref: '#/components/schemas/Config'
          readOnly: true
      required:
      - auth_terminate_session_on_expiry
      - authorization_flow
      - device_id
      - jwks
      - nss_gid_offset
      - nss_uid_offset
      - refresh_interval
      - system_config
    AgentConnector:
      type: object
      properties:
        connector_uuid:
          type: string
          format: uuid
        name:
          type: string
        enabled:
          type: boolean
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        snapshot_expiry:
          type: string
        auth_terminate_session_on_expiry:
          type: boolean
        refresh_interval:
          type: string
        authorization_flow:
          type: string
          format: uuid
          nullable: true
        nss_uid_offset:
          type: integer
          maximum: 2147483647
          minimum: 0
        nss_gid_offset:
          type: integer
          maximum: 2147483647
          minimum: 0
        challenge_key:
          type: string
          format: uuid
          nullable: true
        jwt_federation_providers:
          type: array
          items:
            type: integer
      required:
      - component
      - meta_model_name
      - name
      - verbose_name
      - verbose_name_plural
    AgentConnectorRequest:
      type: object
      properties:
        connector_uuid:
          type: string
          format: uuid
        name:
          type: string
          minLength: 1
        enabled:
          type: boolean
        snapshot_expiry:
          type: string
          minLength: 1
        auth_terminate_session_on_expiry:
          type: boolean
        refresh_interval:
          type: string
          minLength: 1
        authorization_flow:
          type: string
          format: uuid
          nullable: true
        nss_uid_offset:
          type: integer
          maximum: 2147483647
          minimum: 0
        nss_gid_offset:
          type: integer
          maximum: 2147483647
          minimum: 0
        challenge_key:
          type: string
          format: uuid
          nullable: true
        jwt_federation_providers:
          type: array
          items:
            type: integer
      required:
      - name
    AgentTokenResponse:
      type: object
      description: Base serializer class which doesn't implement create/update methods
      properties:
        token:
          type: string
        expires_in:
          type: integer
      required:
      - token
    AlgEnum:
      enum:
      - rsa
      - ecdsa
      type: string
    App:
      type: object
      description: Serialize Application info
      properties:
        name:
          type: string
        label:
          type: string
      required:
      - label
      - name
    AppEnum:
      enum:
      - authentik.commands
      - authentik.tenants
      - authentik.tasks
      - authentik.admin
      - authentik.api
      - authentik.core
      - authentik.crypto
      - authentik.endpoints
      - authentik.endpoints.connectors.agent
      - authentik.enterprise
      - authentik.events
      - authentik.flows
      - authentik.outposts
      - authentik.policies.dummy
      - authentik.policies.event_matcher
      - authentik.policies.expiry
      - authentik.policies.expression
      - authentik.policies.geoip
      - authentik.policies.password
      - authentik.policies.reputation
      - authentik.policies
      - authentik.providers.ldap
      - authentik.providers.oauth2
      - authentik.providers.proxy
      - authentik.providers.rac
      - authentik.providers.radius
      - authentik.providers.saml
      - authentik.providers.scim
      - authentik.rbac
      - authentik.recovery
      - authentik.sources.kerberos
      - authentik.sources.ldap
      - authentik.sources.oauth
      - authentik.sources.plex
      - authentik.sources.saml
      - authentik.sources.scim
      - authentik.sources.telegram
      - authentik.stages.authenticator
      - authentik.stages.authenticator_duo
      - authentik.stages.authenticator_email
      - authentik.stages.authenticator_sms
      - authentik.stages.authenticator_static
      - authentik.stages.authenticator_totp
      - authentik.stages.authenticator_validate
      - authentik.stages.authenticator_webauthn
      - authentik.stages.captcha
      - authentik.stages.consent
      - authentik.stages.deny
      - authentik.stages.dummy
      - authentik.stages.email
      - authentik.stages.identification
      - authentik.stages.invitation
      - authentik.stages.password
      - authentik.stages.prompt
      - authentik.stages.redirect
      - authentik.stages.user_delete
      - authentik.stages.user_login
      - authentik.stages.user_logout
      - authentik.stages.user_write
      - authentik.tasks.schedules
      - authentik.brands
      - authentik.blueprints
      - authentik.enterprise.audit
      - authentik.enterprise.endpoints.connectors.agent
      - authentik.enterprise.policies.unique_password
      - authentik.enterprise.providers.google_workspace
      - authentik.enterprise.providers.microsoft_entra
      - authentik.enterprise.providers.radius
      - authentik.enterprise.providers.scim
      - authentik.enterprise.providers.ssf
      - authentik.enterprise.search
      - authentik.enterprise.stages.authenticator_endpoint_gdtc
      - authentik.enterprise.stages.mtls
      - authentik.enterprise.stages.source
      type: string
    AppleChallengeResponseRequest:
      type: object
      description: Pseudo class for apple response
      properties:
        component:
          type: string
          minLength: 1
          default: ak-source-oauth-apple
    AppleLoginChallenge:
      type: object
      description: Special challenge for apple-native authentication flow, which happens
        on the client.
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-source-oauth-apple
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        client_id:
          type: string
        scope:
          type: string
        redirect_uri:
          type: string
        state:
          type: string
      required:
      - client_id
      - redirect_uri
      - scope
      - state
    Application:
      type: object
      description: Application Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pbm uuid
        name:
          type: string
          description: Application's display Name.
        slug:
          type: string
          description: Internal application name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        provider:
          type: integer
          nullable: true
        provider_obj:
          allOf:
          - $ref: '#/components/schemas/Provider'
          readOnly: true
        backchannel_providers:
          type: array
          items:
            type: integer
        backchannel_providers_obj:
          type: array
          items:
            $ref: '#/components/schemas/Provider'
          readOnly: true
        launch_url:
          type: string
          nullable: true
          description: Allow formatting of launch URL
          readOnly: true
        open_in_new_tab:
          type: boolean
          description: Open launch URL in a new browser tab or window.
        meta_launch_url:
          type: string
          format: uri
        meta_icon:
          type: string
          nullable: true
          description: |-
            Get the URL to the App Icon image. If the name is /static or starts with http
            it is returned as-is
          readOnly: true
        meta_description:
          type: string
        meta_publisher:
          type: string
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        group:
          type: string
      required:
      - backchannel_providers_obj
      - launch_url
      - meta_icon
      - name
      - pk
      - provider_obj
      - slug
    ApplicationEntitlement:
      type: object
      description: ApplicationEntitlement Serializer
      properties:
        pbm_uuid:
          type: string
          format: uuid
          readOnly: true
        name:
          type: string
        app:
          type: string
          format: uuid
        attributes:
          type: object
          additionalProperties: {}
      required:
      - app
      - name
      - pbm_uuid
    ApplicationEntitlementRequest:
      type: object
      description: ApplicationEntitlement Serializer
      properties:
        name:
          type: string
          minLength: 1
        app:
          type: string
          format: uuid
        attributes:
          type: object
          additionalProperties: {}
      required:
      - app
      - name
    ApplicationRequest:
      type: object
      description: Application Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Application's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal application name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        provider:
          type: integer
          nullable: true
        backchannel_providers:
          type: array
          items:
            type: integer
        open_in_new_tab:
          type: boolean
          description: Open launch URL in a new browser tab or window.
        meta_launch_url:
          type: string
          format: uri
        meta_description:
          type: string
        meta_publisher:
          type: string
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        group:
          type: string
      required:
      - name
      - slug
    AuthTypeEnum:
      enum:
      - basic
      - bearer
      type: string
    AuthenticatedSession:
      type: object
      description: AuthenticatedSession Serializer
      properties:
        uuid:
          type: string
          format: uuid
        current:
          type: boolean
          description: Check if session is currently active session
          readOnly: true
        user_agent:
          type: object
          description: Get parsed user agent
          properties:
            device:
              type: object
              description: User agent device
              properties:
                brand:
                  type: string
                family:
                  type: string
                model:
                  type: string
              required:
              - brand
              - family
              - model
            os:
              type: object
              description: User agent os
              properties:
                family:
                  type: string
                major:
                  type: string
                minor:
                  type: string
                patch:
                  type: string
                patch_minor:
                  type: string
              required:
              - family
              - major
              - minor
              - patch
              - patch_minor
            user_agent:
              type: object
              description: User agent browser
              properties:
                family:
                  type: string
                major:
                  type: string
                minor:
                  type: string
                patch:
                  type: string
              required:
              - family
              - major
              - minor
              - patch
            string:
              type: string
          required:
          - device
          - os
          - string
          - user_agent
          readOnly: true
        geo_ip:
          type: object
          description: Get GeoIP Data
          properties:
            continent:
              type: string
              nullable: true
            country:
              type: string
              nullable: true
            lat:
              type: number
              format: double
              nullable: true
            long:
              type: number
              format: double
              nullable: true
            city:
              type: string
          required:
          - city
          - continent
          - country
          - lat
          - long
          nullable: true
          readOnly: true
        asn:
          type: object
          description: Get ASN Data
          properties:
            asn:
              type: integer
              nullable: true
            as_org:
              type: string
              nullable: true
            network:
              type: string
              nullable: true
          required:
          - as_org
          - asn
          - network
          nullable: true
          readOnly: true
        user:
          type: integer
        last_ip:
          type: string
          readOnly: true
        last_user_agent:
          type: string
          readOnly: true
        last_used:
          type: string
          format: date-time
          readOnly: true
        expires:
          type: string
          format: date-time
          readOnly: true
      required:
      - asn
      - current
      - expires
      - geo_ip
      - last_ip
      - last_used
      - last_user_agent
      - user
      - user_agent
    AuthenticationEnum:
      enum:
      - none
      - require_authenticated
      - require_unauthenticated
      - require_superuser
      - require_redirect
      - require_outpost
      type: string
    AuthenticatorAttachmentEnum:
      enum:
      - platform
      - cross-platform
      type: string
    AuthenticatorDuoChallenge:
      type: object
      description: Duo Challenge
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-authenticator-duo
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        pending_user:
          type: string
        pending_user_avatar:
          type: string
        activation_barcode:
          type: string
        activation_code:
          type: string
        stage_uuid:
          type: string
      required:
      - activation_barcode
      - activation_code
      - pending_user
      - pending_user_avatar
      - stage_uuid
    AuthenticatorDuoChallengeResponseRequest:
      type: object
      description: Pseudo class for duo response
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-authenticator-duo
    AuthenticatorDuoStage:
      type: object
      description: AuthenticatorDuoStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        client_id:
          type: string
        api_hostname:
          type: string
        admin_integration_key:
          type: string
      required:
      - api_hostname
      - client_id
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    AuthenticatorDuoStageDeviceImportResponse:
      type: object
      properties:
        count:
          type: integer
          readOnly: true
        error:
          type: string
          readOnly: true
      required:
      - count
      - error
    AuthenticatorDuoStageManualDeviceImportRequest:
      type: object
      properties:
        duo_user_id:
          type: string
          minLength: 1
        username:
          type: string
          minLength: 1
      required:
      - duo_user_id
      - username
    AuthenticatorDuoStageRequest:
      type: object
      description: AuthenticatorDuoStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        client_id:
          type: string
          minLength: 1
        client_secret:
          type: string
          writeOnly: true
          minLength: 1
        api_hostname:
          type: string
          minLength: 1
        admin_integration_key:
          type: string
        admin_secret_key:
          type: string
          writeOnly: true
      required:
      - api_hostname
      - client_id
      - client_secret
      - name
    AuthenticatorEmailChallenge:
      type: object
      description: Authenticator Email Setup challenge
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-authenticator-email
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        pending_user:
          type: string
        pending_user_avatar:
          type: string
        email:
          type: string
          nullable: true
        email_required:
          type: boolean
          default: true
      required:
      - pending_user
      - pending_user_avatar
    AuthenticatorEmailChallengeResponseRequest:
      type: object
      description: Authenticator Email Challenge response, device is set by get_response_instance
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-authenticator-email
        code:
          type: integer
        email:
          type: string
          minLength: 1
    AuthenticatorEmailStage:
      type: object
      description: AuthenticatorEmailStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        use_global_settings:
          type: boolean
          description: When enabled, global Email connection settings will be used
            and connection settings below will be ignored.
        host:
          type: string
        port:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        username:
          type: string
        password:
          type: string
        use_tls:
          type: boolean
        use_ssl:
          type: boolean
        timeout:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        from_address:
          type: string
          format: email
          maxLength: 254
        subject:
          type: string
        token_expiry:
          type: string
          description: 'Time the token sent is valid (Format: hours=3,minutes=17,seconds=300).'
        template:
          type: string
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    AuthenticatorEmailStageRequest:
      type: object
      description: AuthenticatorEmailStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        use_global_settings:
          type: boolean
          description: When enabled, global Email connection settings will be used
            and connection settings below will be ignored.
        host:
          type: string
          minLength: 1
        port:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        username:
          type: string
        password:
          type: string
        use_tls:
          type: boolean
        use_ssl:
          type: boolean
        timeout:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        from_address:
          type: string
          format: email
          minLength: 1
          maxLength: 254
        subject:
          type: string
          minLength: 1
        token_expiry:
          type: string
          minLength: 1
          description: 'Time the token sent is valid (Format: hours=3,minutes=17,seconds=300).'
        template:
          type: string
          minLength: 1
      required:
      - name
    AuthenticatorEndpointGDTCStage:
      type: object
      description: AuthenticatorEndpointGDTCStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        credentials:
          type: object
          additionalProperties: {}
      required:
      - component
      - credentials
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    AuthenticatorEndpointGDTCStageRequest:
      type: object
      description: AuthenticatorEndpointGDTCStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        credentials:
          type: object
          additionalProperties: {}
      required:
      - credentials
      - name
    AuthenticatorSMSChallenge:
      type: object
      description: SMS Setup challenge
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-authenticator-sms
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        pending_user:
          type: string
        pending_user_avatar:
          type: string
        phone_number_required:
          type: boolean
          default: true
      required:
      - pending_user
      - pending_user_avatar
    AuthenticatorSMSChallengeResponseRequest:
      type: object
      description: SMS Challenge response, device is set by get_response_instance
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-authenticator-sms
        code:
          type: integer
        phone_number:
          type: string
          minLength: 1
    AuthenticatorSMSStage:
      type: object
      description: AuthenticatorSMSStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        provider:
          $ref: '#/components/schemas/ProviderEnum'
        from_number:
          type: string
        account_sid:
          type: string
        auth:
          type: string
        auth_password:
          type: string
        auth_type:
          $ref: '#/components/schemas/AuthTypeEnum'
        verify_only:
          type: boolean
          description: When enabled, the Phone number is only used during enrollment
            to verify the users authenticity. Only a hash of the phone number is saved
            to ensure it is not reused in the future.
        mapping:
          type: string
          format: uuid
          nullable: true
          description: Optionally modify the payload being sent to custom providers.
      required:
      - account_sid
      - auth
      - component
      - from_number
      - meta_model_name
      - name
      - pk
      - provider
      - verbose_name
      - verbose_name_plural
    AuthenticatorSMSStageRequest:
      type: object
      description: AuthenticatorSMSStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        provider:
          $ref: '#/components/schemas/ProviderEnum'
        from_number:
          type: string
          minLength: 1
        account_sid:
          type: string
          minLength: 1
        auth:
          type: string
          minLength: 1
        auth_password:
          type: string
        auth_type:
          $ref: '#/components/schemas/AuthTypeEnum'
        verify_only:
          type: boolean
          description: When enabled, the Phone number is only used during enrollment
            to verify the users authenticity. Only a hash of the phone number is saved
            to ensure it is not reused in the future.
        mapping:
          type: string
          format: uuid
          nullable: true
          description: Optionally modify the payload being sent to custom providers.
      required:
      - account_sid
      - auth
      - from_number
      - name
      - provider
    AuthenticatorStaticChallenge:
      type: object
      description: Static authenticator challenge
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-authenticator-static
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        pending_user:
          type: string
        pending_user_avatar:
          type: string
        codes:
          type: array
          items:
            type: string
      required:
      - codes
      - pending_user
      - pending_user_avatar
    AuthenticatorStaticChallengeResponseRequest:
      type: object
      description: Pseudo class for static response
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-authenticator-static
    AuthenticatorStaticStage:
      type: object
      description: AuthenticatorStaticStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        token_count:
          type: integer
          maximum: 2147483647
          minimum: 0
        token_length:
          type: integer
          maximum: 2147483647
          minimum: 0
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    AuthenticatorStaticStageRequest:
      type: object
      description: AuthenticatorStaticStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        token_count:
          type: integer
          maximum: 2147483647
          minimum: 0
        token_length:
          type: integer
          maximum: 2147483647
          minimum: 0
      required:
      - name
    AuthenticatorTOTPChallenge:
      type: object
      description: TOTP Setup challenge
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-authenticator-totp
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        pending_user:
          type: string
        pending_user_avatar:
          type: string
        config_url:
          type: string
      required:
      - config_url
      - pending_user
      - pending_user_avatar
    AuthenticatorTOTPChallengeResponseRequest:
      type: object
      description: TOTP Challenge response, device is set by get_response_instance
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-authenticator-totp
        code:
          type: integer
      required:
      - code
    AuthenticatorTOTPStage:
      type: object
      description: AuthenticatorTOTPStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        digits:
          $ref: '#/components/schemas/DigitsEnum'
      required:
      - component
      - digits
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    AuthenticatorTOTPStageRequest:
      type: object
      description: AuthenticatorTOTPStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        digits:
          $ref: '#/components/schemas/DigitsEnum'
      required:
      - digits
      - name
    AuthenticatorValidateStage:
      type: object
      description: AuthenticatorValidateStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        not_configured_action:
          $ref: '#/components/schemas/NotConfiguredActionEnum'
        device_classes:
          type: array
          items:
            $ref: '#/components/schemas/DeviceClassesEnum'
          description: Device classes which can be used to authenticate
        configuration_stages:
          type: array
          items:
            type: string
            format: uuid
          description: Stages used to configure Authenticator when user doesn't have
            any compatible devices. After this configuration Stage passes, the user
            is not prompted again.
        last_auth_threshold:
          type: string
          description: If any of the user's device has been used within this threshold,
            this stage will be skipped
        webauthn_user_verification:
          allOf:
          - $ref: '#/components/schemas/UserVerificationEnum'
          description: Enforce user verification for WebAuthn devices.
        webauthn_allowed_device_types:
          type: array
          items:
            type: string
            format: uuid
        webauthn_allowed_device_types_obj:
          type: array
          items:
            $ref: '#/components/schemas/WebAuthnDeviceType'
          readOnly: true
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
      - webauthn_allowed_device_types_obj
    AuthenticatorValidateStageRequest:
      type: object
      description: AuthenticatorValidateStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        not_configured_action:
          $ref: '#/components/schemas/NotConfiguredActionEnum'
        device_classes:
          type: array
          items:
            $ref: '#/components/schemas/DeviceClassesEnum'
          description: Device classes which can be used to authenticate
        configuration_stages:
          type: array
          items:
            type: string
            format: uuid
          description: Stages used to configure Authenticator when user doesn't have
            any compatible devices. After this configuration Stage passes, the user
            is not prompted again.
        last_auth_threshold:
          type: string
          minLength: 1
          description: If any of the user's device has been used within this threshold,
            this stage will be skipped
        webauthn_user_verification:
          allOf:
          - $ref: '#/components/schemas/UserVerificationEnum'
          description: Enforce user verification for WebAuthn devices.
        webauthn_allowed_device_types:
          type: array
          items:
            type: string
            format: uuid
      required:
      - name
    AuthenticatorValidationChallenge:
      type: object
      description: Authenticator challenge
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-authenticator-validate
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        pending_user:
          type: string
        pending_user_avatar:
          type: string
        device_challenges:
          type: array
          items:
            $ref: '#/components/schemas/DeviceChallenge'
        configuration_stages:
          type: array
          items:
            $ref: '#/components/schemas/SelectableStage'
      required:
      - configuration_stages
      - device_challenges
      - pending_user
      - pending_user_avatar
    AuthenticatorValidationChallengeResponseRequest:
      type: object
      description: Challenge used for Code-based and WebAuthn authenticators
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-authenticator-validate
        selected_challenge:
          $ref: '#/components/schemas/DeviceChallengeRequest'
        selected_stage:
          type: string
          minLength: 1
        code:
          type: string
          minLength: 1
        webauthn:
          type: object
          additionalProperties: {}
        duo:
          type: integer
    AuthenticatorWebAuthnChallenge:
      type: object
      description: WebAuthn Challenge
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-authenticator-webauthn
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        pending_user:
          type: string
        pending_user_avatar:
          type: string
        registration:
          type: object
          additionalProperties: {}
      required:
      - pending_user
      - pending_user_avatar
      - registration
    AuthenticatorWebAuthnChallengeResponseRequest:
      type: object
      description: WebAuthn Challenge response
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-authenticator-webauthn
        response:
          type: object
          additionalProperties: {}
      required:
      - response
    AuthenticatorWebAuthnStage:
      type: object
      description: AuthenticatorWebAuthnStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        user_verification:
          $ref: '#/components/schemas/UserVerificationEnum'
        authenticator_attachment:
          allOf:
          - $ref: '#/components/schemas/AuthenticatorAttachmentEnum'
          nullable: true
        resident_key_requirement:
          $ref: '#/components/schemas/ResidentKeyRequirementEnum'
        device_type_restrictions:
          type: array
          items:
            type: string
            format: uuid
        device_type_restrictions_obj:
          type: array
          items:
            $ref: '#/components/schemas/WebAuthnDeviceType'
          readOnly: true
        max_attempts:
          type: integer
          maximum: 2147483647
          minimum: 0
      required:
      - component
      - device_type_restrictions_obj
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    AuthenticatorWebAuthnStageRequest:
      type: object
      description: AuthenticatorWebAuthnStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        user_verification:
          $ref: '#/components/schemas/UserVerificationEnum'
        authenticator_attachment:
          allOf:
          - $ref: '#/components/schemas/AuthenticatorAttachmentEnum'
          nullable: true
        resident_key_requirement:
          $ref: '#/components/schemas/ResidentKeyRequirementEnum'
        device_type_restrictions:
          type: array
          items:
            type: string
            format: uuid
        max_attempts:
          type: integer
          maximum: 2147483647
          minimum: 0
      required:
      - name
    AuthorizationCodeAuthMethodEnum:
      enum:
      - basic_auth
      - post_body
      type: string
    AutoSubmitChallengeResponseRequest:
      type: object
      description: Pseudo class for autosubmit response
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-autosubmit
    Autocomplete:
      type: object
      additionalProperties: {}
    AutosubmitChallenge:
      type: object
      description: Autosubmit challenge used to send and navigate a POST request
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-autosubmit
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        url:
          type: string
        attrs:
          type: object
          additionalProperties:
            type: string
        title:
          type: string
      required:
      - attrs
      - url
    BackendsEnum:
      enum:
      - authentik.core.auth.InbuiltBackend
      - authentik.core.auth.TokenBackend
      - authentik.sources.ldap.auth.LDAPBackend
      - authentik.sources.kerberos.auth.KerberosBackend
      type: string
    BindingTypeEnum:
      enum:
      - REDIRECT
      - POST
      - POST_AUTO
      type: string
    BlueprintFile:
      type: object
      properties:
        path:
          type: string
        last_m:
          type: string
          format: date-time
        hash:
          type: string
        meta:
          allOf:
          - $ref: '#/components/schemas/Metadata'
          readOnly: true
      required:
      - hash
      - last_m
      - meta
      - path
    BlueprintInstance:
      type: object
      description: Info about a single blueprint instance file
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Instance uuid
        name:
          type: string
        path:
          type: string
          default: ''
        context:
          type: object
          additionalProperties: {}
        last_applied:
          type: string
          format: date-time
          readOnly: true
        last_applied_hash:
          type: string
          readOnly: true
        status:
          allOf:
          - $ref: '#/components/schemas/BlueprintInstanceStatusEnum'
          readOnly: true
        enabled:
          type: boolean
        managed_models:
          type: array
          items:
            type: string
          readOnly: true
        metadata:
          type: object
          additionalProperties: {}
          readOnly: true
        content:
          type: string
      required:
      - last_applied
      - last_applied_hash
      - managed_models
      - metadata
      - name
      - pk
      - status
    BlueprintInstanceRequest:
      type: object
      description: Info about a single blueprint instance file
      properties:
        name:
          type: string
          minLength: 1
        path:
          type: string
          default: ''
        context:
          type: object
          additionalProperties: {}
        enabled:
          type: boolean
        content:
          type: string
      required:
      - name
    BlueprintInstanceStatusEnum:
      enum:
      - successful
      - warning
      - error
      - orphaned
      - unknown
      type: string
    Brand:
      type: object
      description: Brand Serializer
      properties:
        brand_uuid:
          type: string
          format: uuid
          readOnly: true
        domain:
          type: string
          description: Domain that activates this brand. Can be a superset, i.e. `a.b`
            for `aa.b` and `ba.b`
        default:
          type: boolean
        branding_title:
          type: string
        branding_logo:
          type: string
        branding_favicon:
          type: string
        branding_custom_css:
          type: string
        branding_default_flow_background:
          type: string
        flow_authentication:
          type: string
          format: uuid
          nullable: true
        flow_invalidation:
          type: string
          format: uuid
          nullable: true
        flow_recovery:
          type: string
          format: uuid
          nullable: true
        flow_unenrollment:
          type: string
          format: uuid
          nullable: true
        flow_user_settings:
          type: string
          format: uuid
          nullable: true
        flow_device_code:
          type: string
          format: uuid
          nullable: true
        default_application:
          type: string
          format: uuid
          nullable: true
          description: When set, external users will be redirected to this application
            after authenticating.
        web_certificate:
          type: string
          format: uuid
          nullable: true
          description: Web Certificate used by the authentik Core webserver.
        client_certificates:
          type: array
          items:
            type: string
            format: uuid
          description: Certificates used for client authentication.
        attributes:
          type: object
          additionalProperties: {}
      required:
      - brand_uuid
      - domain
    BrandRequest:
      type: object
      description: Brand Serializer
      properties:
        domain:
          type: string
          minLength: 1
          description: Domain that activates this brand. Can be a superset, i.e. `a.b`
            for `aa.b` and `ba.b`
        default:
          type: boolean
        branding_title:
          type: string
          minLength: 1
        branding_logo:
          type: string
          minLength: 1
        branding_favicon:
          type: string
          minLength: 1
        branding_custom_css:
          type: string
        branding_default_flow_background:
          type: string
          minLength: 1
        flow_authentication:
          type: string
          format: uuid
          nullable: true
        flow_invalidation:
          type: string
          format: uuid
          nullable: true
        flow_recovery:
          type: string
          format: uuid
          nullable: true
        flow_unenrollment:
          type: string
          format: uuid
          nullable: true
        flow_user_settings:
          type: string
          format: uuid
          nullable: true
        flow_device_code:
          type: string
          format: uuid
          nullable: true
        default_application:
          type: string
          format: uuid
          nullable: true
          description: When set, external users will be redirected to this application
            after authenticating.
        web_certificate:
          type: string
          format: uuid
          nullable: true
          description: Web Certificate used by the authentik Core webserver.
        client_certificates:
          type: array
          items:
            type: string
            format: uuid
          description: Certificates used for client authentication.
        attributes:
          type: object
          additionalProperties: {}
      required:
      - domain
    Cache:
      type: object
      description: Generic cache stats for an object
      properties:
        count:
          type: integer
          readOnly: true
      required:
      - count
    CapabilitiesEnum:
      enum:
      - can_save_media
      - can_geo_ip
      - can_asn
      - can_impersonate
      - can_debug
      - is_enterprise
      type: string
    CaptchaChallenge:
      type: object
      description: Site public key
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-captcha
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        pending_user:
          type: string
        pending_user_avatar:
          type: string
        site_key:
          type: string
        js_url:
          type: string
        interactive:
          type: boolean
      required:
      - interactive
      - js_url
      - pending_user
      - pending_user_avatar
      - site_key
    CaptchaChallengeResponseRequest:
      type: object
      description: Validate captcha token
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-captcha
        token:
          type: string
          minLength: 1
      required:
      - token
    CaptchaStage:
      type: object
      description: CaptchaStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        public_key:
          type: string
          description: Public key, acquired your captcha Provider.
        js_url:
          type: string
        api_url:
          type: string
        interactive:
          type: boolean
        score_min_threshold:
          type: number
          format: double
        score_max_threshold:
          type: number
          format: double
        error_on_invalid_score:
          type: boolean
          description: When enabled and the received captcha score is outside of the
            given threshold, the stage will show an error message. When not enabled,
            the flow will continue, but the data from the captcha will be available
            in the context for policy decisions
      required:
      - component
      - meta_model_name
      - name
      - pk
      - public_key
      - verbose_name
      - verbose_name_plural
    CaptchaStageRequest:
      type: object
      description: CaptchaStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        public_key:
          type: string
          minLength: 1
          description: Public key, acquired your captcha Provider.
        private_key:
          type: string
          writeOnly: true
          minLength: 1
          description: Private key, acquired your captcha Provider.
        js_url:
          type: string
          minLength: 1
        api_url:
          type: string
          minLength: 1
        interactive:
          type: boolean
        score_min_threshold:
          type: number
          format: double
        score_max_threshold:
          type: number
          format: double
        error_on_invalid_score:
          type: boolean
          description: When enabled and the received captcha score is outside of the
            given threshold, the stage will show an error message. When not enabled,
            the flow will continue, but the data from the captcha will be available
            in the context for policy decisions
      required:
      - name
      - private_key
      - public_key
    CertAttributeEnum:
      enum:
      - subject
      - common_name
      - email
      type: string
    CertificateData:
      type: object
      description: Get CertificateKeyPair's data
      properties:
        data:
          type: string
          readOnly: true
      required:
      - data
    CertificateGenerationRequest:
      type: object
      description: Certificate generation parameters
      properties:
        common_name:
          type: string
          minLength: 1
        subject_alt_name:
          type: string
        validity_days:
          type: integer
        alg:
          allOf:
          - $ref: '#/components/schemas/AlgEnum'
          default: rsa
      required:
      - common_name
      - validity_days
    CertificateKeyPair:
      type: object
      description: CertificateKeyPair Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Kp uuid
        name:
          type: string
        fingerprint_sha256:
          type: string
          nullable: true
          description: Get certificate Hash (SHA256)
          readOnly: true
        fingerprint_sha1:
          type: string
          nullable: true
          description: Get certificate Hash (SHA1)
          readOnly: true
        cert_expiry:
          type: string
          format: date-time
          nullable: true
          description: Get certificate expiry
          readOnly: true
        cert_subject:
          type: string
          nullable: true
          description: Get certificate subject as full rfc4514
          readOnly: true
        private_key_available:
          type: boolean
          description: Show if this keypair has a private key configured or not
          readOnly: true
        key_type:
          allOf:
          - $ref: '#/components/schemas/KeyTypeEnum'
          nullable: true
          readOnly: true
        certificate_download_url:
          type: string
          description: Get URL to download certificate
          readOnly: true
        private_key_download_url:
          type: string
          description: Get URL to download private key
          readOnly: true
        managed:
          type: string
          readOnly: true
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
      required:
      - cert_expiry
      - cert_subject
      - certificate_download_url
      - fingerprint_sha1
      - fingerprint_sha256
      - key_type
      - managed
      - name
      - pk
      - private_key_available
      - private_key_download_url
    CertificateKeyPairRequest:
      type: object
      description: CertificateKeyPair Serializer
      properties:
        name:
          type: string
          minLength: 1
        certificate_data:
          type: string
          writeOnly: true
          minLength: 1
          description: PEM-encoded Certificate data
        key_data:
          type: string
          writeOnly: true
          description: Optional Private Key. If this is set, you can use this keypair
            for encryption.
      required:
      - certificate_data
      - name
    ChallengeTypes:
      oneOf:
      - $ref: '#/components/schemas/AccessDeniedChallenge'
      - $ref: '#/components/schemas/AppleLoginChallenge'
      - $ref: '#/components/schemas/AuthenticatorDuoChallenge'
      - $ref: '#/components/schemas/AuthenticatorEmailChallenge'
      - $ref: '#/components/schemas/AuthenticatorSMSChallenge'
      - $ref: '#/components/schemas/AuthenticatorStaticChallenge'
      - $ref: '#/components/schemas/AuthenticatorTOTPChallenge'
      - $ref: '#/components/schemas/AuthenticatorValidationChallenge'
      - $ref: '#/components/schemas/AuthenticatorWebAuthnChallenge'
      - $ref: '#/components/schemas/AutosubmitChallenge'
      - $ref: '#/components/schemas/CaptchaChallenge'
      - $ref: '#/components/schemas/ConsentChallenge'
      - $ref: '#/components/schemas/DummyChallenge'
      - $ref: '#/components/schemas/EmailChallenge'
      - $ref: '#/components/schemas/FlowErrorChallenge'
      - $ref: '#/components/schemas/FrameChallenge'
      - $ref: '#/components/schemas/IdentificationChallenge'
      - $ref: '#/components/schemas/IframeLogoutChallenge'
      - $ref: '#/components/schemas/NativeLogoutChallenge'
      - $ref: '#/components/schemas/OAuthDeviceCodeChallenge'
      - $ref: '#/components/schemas/OAuthDeviceCodeFinishChallenge'
      - $ref: '#/components/schemas/PasswordChallenge'
      - $ref: '#/components/schemas/PlexAuthenticationChallenge'
      - $ref: '#/components/schemas/PromptChallenge'
      - $ref: '#/components/schemas/RedirectChallenge'
      - $ref: '#/components/schemas/SessionEndChallenge'
      - $ref: '#/components/schemas/ShellChallenge'
      - $ref: '#/components/schemas/TelegramLoginChallenge'
      - $ref: '#/components/schemas/UserLoginChallenge'
      discriminator:
        propertyName: component
        mapping:
          ak-stage-access-denied: '#/components/schemas/AccessDeniedChallenge'
          ak-source-oauth-apple: '#/components/schemas/AppleLoginChallenge'
          ak-stage-authenticator-duo: '#/components/schemas/AuthenticatorDuoChallenge'
          ak-stage-authenticator-email: '#/components/schemas/AuthenticatorEmailChallenge'
          ak-stage-authenticator-sms: '#/components/schemas/AuthenticatorSMSChallenge'
          ak-stage-authenticator-static: '#/components/schemas/AuthenticatorStaticChallenge'
          ak-stage-authenticator-totp: '#/components/schemas/AuthenticatorTOTPChallenge'
          ak-stage-authenticator-validate: '#/components/schemas/AuthenticatorValidationChallenge'
          ak-stage-authenticator-webauthn: '#/components/schemas/AuthenticatorWebAuthnChallenge'
          ak-stage-autosubmit: '#/components/schemas/AutosubmitChallenge'
          ak-stage-captcha: '#/components/schemas/CaptchaChallenge'
          ak-stage-consent: '#/components/schemas/ConsentChallenge'
          ak-stage-dummy: '#/components/schemas/DummyChallenge'
          ak-stage-email: '#/components/schemas/EmailChallenge'
          ak-stage-flow-error: '#/components/schemas/FlowErrorChallenge'
          xak-flow-frame: '#/components/schemas/FrameChallenge'
          ak-stage-identification: '#/components/schemas/IdentificationChallenge'
          ak-provider-iframe-logout: '#/components/schemas/IframeLogoutChallenge'
          ak-provider-saml-native-logout: '#/components/schemas/NativeLogoutChallenge'
          ak-provider-oauth2-device-code: '#/components/schemas/OAuthDeviceCodeChallenge'
          ak-provider-oauth2-device-code-finish: '#/components/schemas/OAuthDeviceCodeFinishChallenge'
          ak-stage-password: '#/components/schemas/PasswordChallenge'
          ak-source-plex: '#/components/schemas/PlexAuthenticationChallenge'
          ak-stage-prompt: '#/components/schemas/PromptChallenge'
          xak-flow-redirect: '#/components/schemas/RedirectChallenge'
          ak-stage-session-end: '#/components/schemas/SessionEndChallenge'
          xak-flow-shell: '#/components/schemas/ShellChallenge'
          ak-source-telegram: '#/components/schemas/TelegramLoginChallenge'
          ak-stage-user-login: '#/components/schemas/UserLoginChallenge'
    ClientTypeEnum:
      enum:
      - confidential
      - public
      type: string
    CompatibilityModeEnum:
      enum:
      - default
      - aws
      - slack
      - sfdc
      type: string
    Config:
      type: object
      description: Serialize authentik Config into DRF Object
      properties:
        error_reporting:
          $ref: '#/components/schemas/ErrorReportingConfig'
        capabilities:
          type: array
          items:
            $ref: '#/components/schemas/CapabilitiesEnum'
        cache_timeout:
          type: integer
        cache_timeout_flows:
          type: integer
        cache_timeout_policies:
          type: integer
      required:
      - cache_timeout
      - cache_timeout_flows
      - cache_timeout_policies
      - capabilities
      - error_reporting
    ConnectionToken:
      type: object
      description: ConnectionToken Serializer
      properties:
        pk:
          type: string
          format: uuid
          title: Connection token uuid
        provider:
          type: integer
        provider_obj:
          allOf:
          - $ref: '#/components/schemas/RACProvider'
          readOnly: true
        endpoint:
          type: string
          format: uuid
        endpoint_obj:
          allOf:
          - $ref: '#/components/schemas/Endpoint'
          readOnly: true
        user:
          allOf:
          - $ref: '#/components/schemas/PartialUser'
          readOnly: true
      required:
      - endpoint
      - endpoint_obj
      - provider
      - provider_obj
      - user
    ConnectionTokenRequest:
      type: object
      description: ConnectionToken Serializer
      properties:
        pk:
          type: string
          format: uuid
          title: Connection token uuid
        provider:
          type: integer
        endpoint:
          type: string
          format: uuid
      required:
      - endpoint
      - provider
    Connector:
      type: object
      properties:
        connector_uuid:
          type: string
          format: uuid
        name:
          type: string
        enabled:
          type: boolean
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
      required:
      - component
      - meta_model_name
      - name
      - verbose_name
      - verbose_name_plural
    ConsentChallenge:
      type: object
      description: Challenge info for consent screens
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-consent
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        pending_user:
          type: string
        pending_user_avatar:
          type: string
        header_text:
          type: string
        permissions:
          type: array
          items:
            $ref: '#/components/schemas/ConsentPermission'
        additional_permissions:
          type: array
          items:
            $ref: '#/components/schemas/ConsentPermission'
        token:
          type: string
      required:
      - additional_permissions
      - pending_user
      - pending_user_avatar
      - permissions
      - token
    ConsentChallengeResponseRequest:
      type: object
      description: Consent challenge response, any valid response request is valid
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-consent
        token:
          type: string
          minLength: 1
      required:
      - token
    ConsentPermission:
      type: object
      description: Permission used for consent
      properties:
        name:
          type: string
        id:
          type: string
      required:
      - id
      - name
    ConsentStage:
      type: object
      description: ConsentStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        mode:
          $ref: '#/components/schemas/ConsentStageModeEnum'
        consent_expire_in:
          type: string
          title: Consent expires in
          description: 'Offset after which consent expires. (Format: hours=1;minutes=2;seconds=3).'
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    ConsentStageModeEnum:
      enum:
      - always_require
      - permanent
      - expiring
      type: string
    ConsentStageRequest:
      type: object
      description: ConsentStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        mode:
          $ref: '#/components/schemas/ConsentStageModeEnum'
        consent_expire_in:
          type: string
          minLength: 1
          title: Consent expires in
          description: 'Offset after which consent expires. (Format: hours=1;minutes=2;seconds=3).'
      required:
      - name
    ContextualFlowInfo:
      type: object
      description: Contextual flow information for a challenge
      properties:
        title:
          type: string
        background:
          type: string
        cancel_url:
          type: string
        layout:
          $ref: '#/components/schemas/ContextualFlowInfoLayoutEnum'
      required:
      - cancel_url
      - layout
    ContextualFlowInfoLayoutEnum:
      enum:
      - stacked
      - content_left
      - content_right
      - sidebar_left
      - sidebar_right
      type: string
    CountryCodeEnum:
      enum:
      - AF
      - AX
      - AL
      - DZ
      - AS
      - AD
      - AO
      - AI
      - AQ
      - AG
      - AR
      - AM
      - AW
      - AU
      - AT
      - AZ
      - BS
      - BH
      - BD
      - BB
      - BY
      - BE
      - BZ
      - BJ
      - BM
      - BT
      - BO
      - BQ
      - BA
      - BW
      - BV
      - BR
      - IO
      - BN
      - BG
      - BF
      - BI
      - CV
      - KH
      - CM
      - CA
      - KY
      - CF
      - TD
      - CL
      - CN
      - CX
      - CC
      - CO
      - KM
      - CG
      - CD
      - CK
      - CR
      - CI
      - HR
      - CU
      - CW
      - CY
      - CZ
      - DK
      - DJ
      - DM
      - DO
      - EC
      - EG
      - SV
      - GQ
      - ER
      - EE
      - SZ
      - ET
      - FK
      - FO
      - FJ
      - FI
      - FR
      - GF
      - PF
      - TF
      - GA
      - GM
      - GE
      - DE
      - GH
      - GI
      - GR
      - GL
      - GD
      - GP
      - GU
      - GT
      - GG
      - GN
      - GW
      - GY
      - HT
      - HM
      - VA
      - HN
      - HK
      - HU
      - IS
      - IN
      - ID
      - IR
      - IQ
      - IE
      - IM
      - IL
      - IT
      - JM
      - JP
      - JE
      - JO
      - KZ
      - KE
      - KI
      - KW
      - KG
      - LA
      - LV
      - LB
      - LS
      - LR
      - LY
      - LI
      - LT
      - LU
      - MO
      - MG
      - MW
      - MY
      - MV
      - ML
      - MT
      - MH
      - MQ
      - MR
      - MU
      - YT
      - MX
      - FM
      - MD
      - MC
      - MN
      - ME
      - MS
      - MA
      - MZ
      - MM
      - NA
      - NR
      - NP
      - NL
      - NC
      - NZ
      - NI
      - NE
      - NG
      - NU
      - NF
      - KP
      - MK
      - MP
      - 'NO'
      - OM
      - PK
      - PW
      - PS
      - PA
      - PG
      - PY
      - PE
      - PH
      - PN
      - PL
      - PT
      - PR
      - QA
      - RE
      - RO
      - RU
      - RW
      - BL
      - SH
      - KN
      - LC
      - MF
      - PM
      - VC
      - WS
      - SM
      - ST
      - SA
      - SN
      - RS
      - SC
      - SL
      - SG
      - SX
      - SK
      - SI
      - SB
      - SO
      - ZA
      - GS
      - KR
      - SS
      - ES
      - LK
      - SD
      - SR
      - SJ
      - SE
      - CH
      - SY
      - TW
      - TJ
      - TZ
      - TH
      - TL
      - TG
      - TK
      - TO
      - TT
      - TN
      - TR
      - TM
      - TC
      - TV
      - UG
      - UA
      - AE
      - GB
      - UM
      - US
      - UY
      - UZ
      - VU
      - VE
      - VN
      - VG
      - VI
      - WF
      - EH
      - YE
      - ZM
      - ZW
      type: string
    CurrentBrand:
      type: object
      description: Partial brand information for styling
      properties:
        matched_domain:
          type: string
        branding_title:
          type: string
        branding_logo:
          type: string
        branding_favicon:
          type: string
        branding_custom_css:
          type: string
        ui_footer_links:
          type: array
          items:
            $ref: '#/components/schemas/FooterLink'
          readOnly: true
        ui_theme:
          allOf:
          - $ref: '#/components/schemas/UiThemeEnum'
          readOnly: true
          default: automatic
        flow_authentication:
          type: string
        flow_invalidation:
          type: string
        flow_recovery:
          type: string
        flow_unenrollment:
          type: string
        flow_user_settings:
          type: string
        flow_device_code:
          type: string
        default_locale:
          type: string
          readOnly: true
        flags:
          type: object
          properties:
            policies_buffered_access_view:
              type: boolean
          required:
          - policies_buffered_access_view
          readOnly: true
      required:
      - branding_custom_css
      - branding_favicon
      - branding_logo
      - branding_title
      - default_locale
      - flags
      - matched_domain
      - ui_footer_links
      - ui_theme
    DeliveryMethodEnum:
      enum:
      - https://schemas.openid.net/secevent/risc/delivery-method/push
      - https://schemas.openid.net/secevent/risc/delivery-method/poll
      type: string
    DeniedActionEnum:
      enum:
      - message_continue
      - message
      - continue
      type: string
    DenyStage:
      type: object
      description: DenyStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        deny_message:
          type: string
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    DenyStageRequest:
      type: object
      description: DenyStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        deny_message:
          type: string
      required:
      - name
    DetailedCountry:
      type: object
      properties:
        code:
          $ref: '#/components/schemas/CountryCodeEnum'
        name:
          type: string
      required:
      - code
      - name
    DetailedCountryField:
      type: object
      properties:
        code:
          $ref: '#/components/schemas/CountryCodeEnum'
        name:
          type: string
      required:
      - code
      - name
    Device:
      type: object
      description: Serializer for authenticator devices
      properties:
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        pk:
          type: string
        name:
          type: string
        type:
          type: string
          description: Get type of device
          readOnly: true
        confirmed:
          type: boolean
        created:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
        last_used:
          type: string
          format: date-time
          readOnly: true
          nullable: true
        extra_description:
          type: string
          nullable: true
          description: Get extra description
          readOnly: true
        external_id:
          type: string
          nullable: true
          description: Get external Device ID
          readOnly: true
      required:
      - confirmed
      - created
      - external_id
      - extra_description
      - last_updated
      - last_used
      - meta_model_name
      - name
      - pk
      - type
      - verbose_name
      - verbose_name_plural
    DeviceAccessGroup:
      type: object
      properties:
        pbm_uuid:
          type: string
          format: uuid
          readOnly: true
        name:
          type: string
      required:
      - name
      - pbm_uuid
    DeviceAccessGroupRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
      required:
      - name
    DeviceChallenge:
      type: object
      description: Single device challenge
      properties:
        device_class:
          $ref: '#/components/schemas/DeviceClassesEnum'
        device_uid:
          type: string
        challenge:
          type: object
          additionalProperties: {}
        last_used:
          type: string
          format: date-time
          nullable: true
      required:
      - challenge
      - device_class
      - device_uid
      - last_used
    DeviceChallengeRequest:
      type: object
      description: Single device challenge
      properties:
        device_class:
          $ref: '#/components/schemas/DeviceClassesEnum'
        device_uid:
          type: string
          minLength: 1
        challenge:
          type: object
          additionalProperties: {}
        last_used:
          type: string
          format: date-time
          nullable: true
      required:
      - challenge
      - device_class
      - device_uid
      - last_used
    DeviceClassesEnum:
      enum:
      - static
      - totp
      - webauthn
      - duo
      - sms
      - email
      type: string
    DeviceConnection:
      type: object
      properties:
        device:
          type: string
          format: uuid
        connector:
          type: string
          format: uuid
        connector_obj:
          allOf:
          - $ref: '#/components/schemas/Connector'
          readOnly: true
        latest_snapshot:
          allOf:
          - $ref: '#/components/schemas/DeviceFactSnapshot'
          readOnly: true
          nullable: true
      required:
      - connector
      - connector_obj
      - device
      - latest_snapshot
    DeviceFactSnapshot:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/DeviceFacts'
        connection:
          type: string
          format: uuid
        created:
          type: string
          format: date-time
          readOnly: true
        expires:
          type: string
          format: date-time
          readOnly: true
          nullable: true
      required:
      - connection
      - created
      - data
      - expires
    DeviceFacts:
      type: object
      properties:
        os:
          allOf:
          - $ref: '#/components/schemas/OperatingSystem'
          nullable: true
        disks:
          type: array
          items:
            $ref: '#/components/schemas/Disk'
          nullable: true
        network:
          allOf:
          - $ref: '#/components/schemas/Network'
          nullable: true
        hardware:
          allOf:
          - $ref: '#/components/schemas/Hardware'
          nullable: true
        software:
          type: array
          items:
            $ref: '#/components/schemas/Software'
          nullable: true
        processes:
          type: array
          items:
            $ref: '#/components/schemas/Process'
          nullable: true
        users:
          type: array
          items:
            $ref: '#/components/schemas/DeviceUser'
          nullable: true
        groups:
          type: array
          items:
            $ref: '#/components/schemas/DeviceGroup'
          nullable: true
        vendor:
          type: object
          additionalProperties: {}
    DeviceFactsOSFamily:
      enum:
      - linux
      - unix
      - bsd
      - windows
      - mac_os
      - android
      - i_os
      - other
      type: string
    DeviceFactsRequest:
      type: object
      properties:
        os:
          allOf:
          - $ref: '#/components/schemas/OperatingSystemRequest'
          nullable: true
        disks:
          type: array
          items:
            $ref: '#/components/schemas/DiskRequest'
          nullable: true
        network:
          allOf:
          - $ref: '#/components/schemas/NetworkRequest'
          nullable: true
        hardware:
          allOf:
          - $ref: '#/components/schemas/HardwareRequest'
          nullable: true
        software:
          type: array
          items:
            $ref: '#/components/schemas/SoftwareRequest'
          nullable: true
        processes:
          type: array
          items:
            $ref: '#/components/schemas/ProcessRequest'
          nullable: true
        users:
          type: array
          items:
            $ref: '#/components/schemas/DeviceUserRequest'
          nullable: true
        groups:
          type: array
          items:
            $ref: '#/components/schemas/DeviceGroupRequest'
          nullable: true
        vendor:
          type: object
          additionalProperties: {}
    DeviceGroup:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
      required:
      - id
    DeviceGroupRequest:
      type: object
      properties:
        id:
          type: string
          minLength: 1
        name:
          type: string
          minLength: 1
      required:
      - id
    DeviceUser:
      type: object
      properties:
        id:
          type: string
        username:
          type: string
        name:
          type: string
        home:
          type: string
      required:
      - id
    DeviceUserRequest:
      type: object
      properties:
        id:
          type: string
          minLength: 1
        username:
          type: string
          minLength: 1
        name:
          type: string
          minLength: 1
        home:
          type: string
          minLength: 1
      required:
      - id
    DigestAlgorithmEnum:
      enum:
      - http://www.w3.org/2000/09/xmldsig#sha1
      - http://www.w3.org/2001/04/xmlenc#sha256
      - http://www.w3.org/2001/04/xmldsig-more#sha384
      - http://www.w3.org/2001/04/xmlenc#sha512
      type: string
    DigitsEnum:
      enum:
      - '6'
      - '8'
      type: string
    Disk:
      type: object
      properties:
        name:
          type: string
        mountpoint:
          type: string
        label:
          type: string
        capacity_total_bytes:
          type: integer
          format: int64
        capacity_used_bytes:
          type: integer
          format: int64
        encryption_enabled:
          type: boolean
          default: false
      required:
      - mountpoint
      - name
    DiskRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
        mountpoint:
          type: string
          minLength: 1
        label:
          type: string
        capacity_total_bytes:
          type: integer
          format: int64
        capacity_used_bytes:
          type: integer
          format: int64
        encryption_enabled:
          type: boolean
          default: false
      required:
      - mountpoint
      - name
    DockerServiceConnection:
      type: object
      description: DockerServiceConnection Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Uuid
        name:
          type: string
        local:
          type: boolean
          description: If enabled, use the local connection. Required Docker socket/Kubernetes
            Integration
        component:
          type: string
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        url:
          type: string
          description: Can be in the format of 'unix://<path>' when connecting to
            a local docker daemon, or 'https://<hostname>:2376' when connecting to
            a remote system.
        tls_verification:
          type: string
          format: uuid
          nullable: true
          description: CA which the endpoint's Certificate is verified against. Can
            be left empty for no validation.
        tls_authentication:
          type: string
          format: uuid
          nullable: true
          description: Certificate/Key used for authentication. Can be left empty
            for no authentication.
      required:
      - component
      - meta_model_name
      - name
      - pk
      - url
      - verbose_name
      - verbose_name_plural
    DockerServiceConnectionRequest:
      type: object
      description: DockerServiceConnection Serializer
      properties:
        name:
          type: string
          minLength: 1
        local:
          type: boolean
          description: If enabled, use the local connection. Required Docker socket/Kubernetes
            Integration
        url:
          type: string
          minLength: 1
          description: Can be in the format of 'unix://<path>' when connecting to
            a local docker daemon, or 'https://<hostname>:2376' when connecting to
            a remote system.
        tls_verification:
          type: string
          format: uuid
          nullable: true
          description: CA which the endpoint's Certificate is verified against. Can
            be left empty for no validation.
        tls_authentication:
          type: string
          format: uuid
          nullable: true
          description: Certificate/Key used for authentication. Can be left empty
            for no authentication.
      required:
      - name
      - url
    Domain:
      type: object
      description: Domain Serializer
      properties:
        id:
          type: integer
          readOnly: true
        domain:
          type: string
          maxLength: 253
        is_primary:
          type: boolean
        tenant:
          type: string
          format: uuid
      required:
      - domain
      - id
      - tenant
    DomainRequest:
      type: object
      description: Domain Serializer
      properties:
        domain:
          type: string
          minLength: 1
          maxLength: 253
        is_primary:
          type: boolean
        tenant:
          type: string
          format: uuid
      required:
      - domain
      - tenant
    DummyChallenge:
      type: object
      description: Dummy challenge
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-dummy
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        name:
          type: string
      required:
      - name
    DummyChallengeResponseRequest:
      type: object
      description: Dummy challenge response
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-dummy
    DummyPolicy:
      type: object
      description: Dummy Policy Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Policy uuid
        name:
          type: string
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        bound_to:
          type: integer
          description: Return objects policy is bound to
          readOnly: true
        result:
          type: boolean
        wait_min:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        wait_max:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
      required:
      - bound_to
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    DummyPolicyRequest:
      type: object
      description: Dummy Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        result:
          type: boolean
        wait_min:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        wait_max:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
      required:
      - name
    DummyStage:
      type: object
      description: DummyStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        throw_error:
          type: boolean
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    DummyStageRequest:
      type: object
      description: DummyStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        throw_error:
          type: boolean
      required:
      - name
    DuoDevice:
      type: object
      description: Serializer for Duo authenticator devices
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
          description: The human-readable name of this device.
          maxLength: 64
        user:
          allOf:
          - $ref: '#/components/schemas/PartialUser'
          readOnly: true
      required:
      - name
      - pk
      - user
    DuoDeviceEnrollmentStatus:
      type: object
      properties:
        duo_response:
          $ref: '#/components/schemas/DuoResponseEnum'
      required:
      - duo_response
    DuoDeviceRequest:
      type: object
      description: Serializer for Duo authenticator devices
      properties:
        name:
          type: string
          minLength: 1
          description: The human-readable name of this device.
          maxLength: 64
      required:
      - name
    DuoResponseEnum:
      enum:
      - success
      - waiting
      - invalid
      type: string
    EmailChallenge:
      type: object
      description: Email challenge
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-email
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
    EmailChallengeResponseRequest:
      type: object
      description: |-
        Email challenge resposen. No fields. This challenge is
        always declared invalid to give the user a chance to retry
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-email
    EmailDevice:
      type: object
      description: Serializer for email authenticator devices
      properties:
        name:
          type: string
          description: The human-readable name of this device.
          maxLength: 64
        pk:
          type: integer
          readOnly: true
          title: ID
        email:
          type: string
          format: email
          readOnly: true
        user:
          allOf:
          - $ref: '#/components/schemas/PartialUser'
          readOnly: true
      required:
      - email
      - name
      - pk
      - user
    EmailDeviceRequest:
      type: object
      description: Serializer for email authenticator devices
      properties:
        name:
          type: string
          minLength: 1
          description: The human-readable name of this device.
          maxLength: 64
      required:
      - name
    EmailStage:
      type: object
      description: EmailStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        use_global_settings:
          type: boolean
          description: When enabled, global Email connection settings will be used
            and connection settings below will be ignored.
        host:
          type: string
        port:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        username:
          type: string
        use_tls:
          type: boolean
        use_ssl:
          type: boolean
        timeout:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        from_address:
          type: string
          format: email
          maxLength: 254
        token_expiry:
          type: string
          description: 'Time the token sent is valid (Format: hours=3,minutes=17,seconds=300).'
        subject:
          type: string
        template:
          type: string
        activate_user_on_success:
          type: boolean
          description: Activate users upon completion of stage.
        recovery_max_attempts:
          type: integer
          maximum: 2147483647
          minimum: 0
        recovery_cache_timeout:
          type: string
          description: 'The time window used to count recent account recovery attempts.
            If the number of attempts exceed recovery_max_attempts within this period,
            further attempts will be rate-limited. (Format: hours=1;minutes=2;seconds=3).'
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    EmailStageRequest:
      type: object
      description: EmailStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        use_global_settings:
          type: boolean
          description: When enabled, global Email connection settings will be used
            and connection settings below will be ignored.
        host:
          type: string
          minLength: 1
        port:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        username:
          type: string
        password:
          type: string
          writeOnly: true
        use_tls:
          type: boolean
        use_ssl:
          type: boolean
        timeout:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        from_address:
          type: string
          format: email
          minLength: 1
          maxLength: 254
        token_expiry:
          type: string
          minLength: 1
          description: 'Time the token sent is valid (Format: hours=3,minutes=17,seconds=300).'
        subject:
          type: string
          minLength: 1
        template:
          type: string
          minLength: 1
        activate_user_on_success:
          type: boolean
          description: Activate users upon completion of stage.
        recovery_max_attempts:
          type: integer
          maximum: 2147483647
          minimum: 0
        recovery_cache_timeout:
          type: string
          minLength: 1
          description: 'The time window used to count recent account recovery attempts.
            If the number of attempts exceed recovery_max_attempts within this period,
            further attempts will be rate-limited. (Format: hours=1;minutes=2;seconds=3).'
      required:
      - name
    Endpoint:
      type: object
      description: Endpoint Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pbm uuid
        name:
          type: string
        provider:
          type: integer
        provider_obj:
          allOf:
          - $ref: '#/components/schemas/RACProvider'
          readOnly: true
        protocol:
          $ref: '#/components/schemas/ProtocolEnum'
        host:
          type: string
        settings:
          type: object
          additionalProperties: {}
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        auth_mode:
          $ref: '#/components/schemas/EndpointAuthModeEnum'
        launch_url:
          type: string
          nullable: true
          description: |-
            Build actual launch URL (the provider itself does not have one, just
            individual endpoints)
          readOnly: true
        maximum_connections:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
      required:
      - auth_mode
      - host
      - launch_url
      - name
      - pk
      - protocol
      - provider
      - provider_obj
    EndpointAuthModeEnum:
      enum:
      - static
      - prompt
      type: string
    EndpointDevice:
      type: object
      properties:
        device_uuid:
          type: string
          format: uuid
        pbm_uuid:
          type: string
          format: uuid
          readOnly: true
        name:
          type: string
        access_group:
          type: string
          format: uuid
          nullable: true
        access_group_obj:
          $ref: '#/components/schemas/DeviceAccessGroup'
        expiring:
          type: boolean
        expires:
          type: string
          format: date-time
          nullable: true
        facts:
          allOf:
          - $ref: '#/components/schemas/DeviceFactSnapshot'
          readOnly: true
        attributes:
          type: object
          additionalProperties: {}
      required:
      - access_group_obj
      - facts
      - name
      - pbm_uuid
    EndpointDeviceDetails:
      type: object
      properties:
        device_uuid:
          type: string
          format: uuid
        pbm_uuid:
          type: string
          format: uuid
          readOnly: true
        name:
          type: string
        access_group:
          type: string
          format: uuid
          nullable: true
        access_group_obj:
          $ref: '#/components/schemas/DeviceAccessGroup'
        expiring:
          type: boolean
        expires:
          type: string
          format: date-time
          nullable: true
        facts:
          allOf:
          - $ref: '#/components/schemas/DeviceFactSnapshot'
          readOnly: true
        attributes:
          type: object
          additionalProperties: {}
        connections_obj:
          type: array
          items:
            $ref: '#/components/schemas/DeviceConnection'
        policies:
          type: array
          items:
            type: string
            format: uuid
          readOnly: true
        connections:
          type: array
          items:
            type: string
            format: uuid
          readOnly: true
      required:
      - access_group_obj
      - connections
      - connections_obj
      - facts
      - name
      - pbm_uuid
      - policies
    EndpointDeviceRequest:
      type: object
      properties:
        device_uuid:
          type: string
          format: uuid
        name:
          type: string
          minLength: 1
        access_group:
          type: string
          format: uuid
          nullable: true
        access_group_obj:
          $ref: '#/components/schemas/DeviceAccessGroupRequest'
        expiring:
          type: boolean
        expires:
          type: string
          format: date-time
          nullable: true
        attributes:
          type: object
          additionalProperties: {}
      required:
      - access_group_obj
      - name
    EndpointRequest:
      type: object
      description: Endpoint Serializer
      properties:
        name:
          type: string
          minLength: 1
        provider:
          type: integer
        protocol:
          $ref: '#/components/schemas/ProtocolEnum'
        host:
          type: string
          minLength: 1
        settings:
          type: object
          additionalProperties: {}
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        auth_mode:
          $ref: '#/components/schemas/EndpointAuthModeEnum'
        maximum_connections:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
      required:
      - auth_mode
      - host
      - name
      - protocol
      - provider
    EnrollRequest:
      type: object
      description: Base serializer class which doesn't implement create/update methods
      properties:
        device_serial:
          type: string
          minLength: 1
        device_name:
          type: string
          minLength: 1
      required:
      - device_name
      - device_serial
    EnrollmentToken:
      type: object
      properties:
        token_uuid:
          type: string
          format: uuid
          readOnly: true
        device_group:
          type: string
          format: uuid
          nullable: true
        device_group_obj:
          allOf:
          - $ref: '#/components/schemas/DeviceAccessGroup'
          readOnly: true
        connector:
          type: string
          format: uuid
        name:
          type: string
        expiring:
          type: boolean
        expires:
          type: string
          format: date-time
          nullable: true
      required:
      - connector
      - device_group_obj
      - name
      - token_uuid
    EnrollmentTokenRequest:
      type: object
      properties:
        device_group:
          type: string
          format: uuid
          nullable: true
        connector:
          type: string
          format: uuid
        name:
          type: string
          minLength: 1
        expiring:
          type: boolean
        expires:
          type: string
          format: date-time
          nullable: true
      required:
      - connector
      - name
    ErrorDetail:
      type: object
      description: Serializer for rest_framework's error messages
      properties:
        string:
          type: string
        code:
          type: string
      required:
      - code
      - string
    ErrorReportingConfig:
      type: object
      description: Config for error reporting
      properties:
        enabled:
          type: boolean
          readOnly: true
        sentry_dsn:
          type: string
          readOnly: true
        environment:
          type: string
          readOnly: true
        send_pii:
          type: boolean
          readOnly: true
        traces_sample_rate:
          type: number
          format: double
          readOnly: true
      required:
      - enabled
      - environment
      - send_pii
      - sentry_dsn
      - traces_sample_rate
    Event:
      type: object
      description: Event Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Event uuid
        user:
          type: object
          additionalProperties: {}
        action:
          $ref: '#/components/schemas/EventActions'
        app:
          type: string
        context:
          type: object
          additionalProperties: {}
        client_ip:
          type: string
          nullable: true
        created:
          type: string
          format: date-time
          readOnly: true
        expires:
          type: string
          format: date-time
        brand:
          type: object
          additionalProperties: {}
      required:
      - action
      - app
      - created
      - pk
    EventActions:
      enum:
      - login
      - login_failed
      - logout
      - user_write
      - suspicious_request
      - password_set
      - secret_view
      - secret_rotate
      - invitation_used
      - authorize_application
      - source_linked
      - impersonation_started
      - impersonation_ended
      - flow_execution
      - policy_execution
      - policy_exception
      - property_mapping_exception
      - system_task_execution
      - system_task_exception
      - system_exception
      - configuration_error
      - model_created
      - model_updated
      - model_deleted
      - email_sent
      - update_available
      - custom_
      type: string
    EventMatcherPolicy:
      type: object
      description: Event Matcher Policy Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Policy uuid
        name:
          type: string
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        bound_to:
          type: integer
          description: Return objects policy is bound to
          readOnly: true
        action:
          allOf:
          - $ref: '#/components/schemas/EventActions'
          nullable: true
          description: Match created events with this action type. When left empty,
            all action types will be matched.
        client_ip:
          type: string
          nullable: true
          description: Matches Event's Client IP (strict matching, for network matching
            use an Expression Policy)
        app:
          allOf:
          - $ref: '#/components/schemas/AppEnum'
          nullable: true
          description: Match events created by selected application. When left empty,
            all applications are matched.
        model:
          allOf:
          - $ref: '#/components/schemas/ModelEnum'
          nullable: true
          description: Match events created by selected model. When left empty, all
            models are matched. When an app is selected, all the application's models
            are matched.
      required:
      - bound_to
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    EventMatcherPolicyRequest:
      type: object
      description: Event Matcher Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        action:
          allOf:
          - $ref: '#/components/schemas/EventActions'
          nullable: true
          description: Match created events with this action type. When left empty,
            all action types will be matched.
        client_ip:
          type: string
          nullable: true
          minLength: 1
          description: Matches Event's Client IP (strict matching, for network matching
            use an Expression Policy)
        app:
          allOf:
          - $ref: '#/components/schemas/AppEnum'
          nullable: true
          description: Match events created by selected application. When left empty,
            all applications are matched.
        model:
          allOf:
          - $ref: '#/components/schemas/ModelEnum'
          nullable: true
          description: Match events created by selected model. When left empty, all
            models are matched. When an app is selected, all the application's models
            are matched.
      required:
      - name
    EventRequest:
      type: object
      description: Event Serializer
      properties:
        user:
          type: object
          additionalProperties: {}
        action:
          $ref: '#/components/schemas/EventActions'
        app:
          type: string
          minLength: 1
        context:
          type: object
          additionalProperties: {}
        client_ip:
          type: string
          nullable: true
          minLength: 1
        expires:
          type: string
          format: date-time
        brand:
          type: object
          additionalProperties: {}
      required:
      - action
      - app
    EventTopPerUser:
      type: object
      description: Response object of Event's top_per_user
      properties:
        application:
          type: object
          additionalProperties: {}
        counted_events:
          type: integer
        unique_users:
          type: integer
      required:
      - application
      - counted_events
      - unique_users
    EventVolume:
      type: object
      description: Count of events of action created on day
      properties:
        action:
          $ref: '#/components/schemas/EventActions'
        time:
          type: string
          format: date-time
        count:
          type: integer
      required:
      - action
      - count
      - time
    EventsRequestedEnum:
      enum:
      - https://schemas.openid.net/secevent/caep/event-type/session-revoked
      - https://schemas.openid.net/secevent/caep/event-type/credential-change
      - https://schemas.openid.net/secevent/ssf/event-type/verification
      type: string
    ExpiringBaseGrantModel:
      type: object
      description: Serializer for BaseGrantModel and ExpiringBaseGrant
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        provider:
          $ref: '#/components/schemas/OAuth2Provider'
        user:
          $ref: '#/components/schemas/User'
        is_expired:
          type: boolean
          description: Check if token is expired yet.
          readOnly: true
        expires:
          type: string
          format: date-time
          nullable: true
        scope:
          type: array
          items:
            type: string
      required:
      - is_expired
      - pk
      - provider
      - scope
      - user
    ExpressionPolicy:
      type: object
      description: Group Membership Policy Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Policy uuid
        name:
          type: string
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        bound_to:
          type: integer
          description: Return objects policy is bound to
          readOnly: true
        expression:
          type: string
      required:
      - bound_to
      - component
      - expression
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    ExpressionPolicyRequest:
      type: object
      description: Group Membership Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        expression:
          type: string
          minLength: 1
      required:
      - expression
      - name
    ExtraRoleObjectPermission:
      type: object
      description: User permission with additional object-related data
      properties:
        id:
          type: integer
          readOnly: true
        codename:
          type: string
          readOnly: true
        model:
          type: string
          title: Python model class name
          readOnly: true
        app_label:
          type: string
          readOnly: true
        object_pk:
          type: string
        name:
          type: string
          readOnly: true
        app_label_verbose:
          type: string
          description: Get app label from permission's model
          readOnly: true
        model_verbose:
          type: string
          description: Get model label from permission's model
          readOnly: true
        object_description:
          type: string
          nullable: true
          description: |-
            Get model description from attached model. This operation takes at least
            one additional query, and the description is only shown if the user/role has the
            view_ permission on the object
          readOnly: true
      required:
      - app_label
      - app_label_verbose
      - codename
      - id
      - model
      - model_verbose
      - name
      - object_description
      - object_pk
    ExtraRoleObjectPermissionRequest:
      type: object
      description: User permission with additional object-related data
      properties:
        object_pk:
          type: string
          minLength: 1
      required:
      - object_pk
    ExtraUserObjectPermission:
      type: object
      description: User permission with additional object-related data
      properties:
        id:
          type: integer
          readOnly: true
        codename:
          type: string
          readOnly: true
        model:
          type: string
          title: Python model class name
          readOnly: true
        app_label:
          type: string
          readOnly: true
        object_pk:
          type: string
        name:
          type: string
          readOnly: true
        app_label_verbose:
          type: string
          description: Get app label from permission's model
          readOnly: true
        model_verbose:
          type: string
          description: Get model label from permission's model
          readOnly: true
        object_description:
          type: string
          nullable: true
          description: |-
            Get model description from attached model. This operation takes at least
            one additional query, and the description is only shown if the user/role has the
            view_ permission on the object
          readOnly: true
      required:
      - app_label
      - app_label_verbose
      - codename
      - id
      - model
      - model_verbose
      - name
      - object_description
      - object_pk
    ExtraUserObjectPermissionRequest:
      type: object
      description: User permission with additional object-related data
      properties:
        object_pk:
          type: string
          minLength: 1
      required:
      - object_pk
    FilePathRequest:
      type: object
      description: Serializer to upload file
      properties:
        url:
          type: string
          minLength: 1
      required:
      - url
    FileUploadRequest:
      type: object
      description: Serializer to upload file
      properties:
        file:
          type: string
          format: binary
        clear:
          type: boolean
          default: false
    Flow:
      type: object
      description: Flow Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Flow uuid
        policybindingmodel_ptr_id:
          type: string
          format: uuid
          readOnly: true
        name:
          type: string
        slug:
          type: string
          description: Visible in the URL.
          pattern: ^[-a-zA-Z0-9_]+$
        title:
          type: string
          description: Shown as the Title in Flow pages.
        designation:
          allOf:
          - $ref: '#/components/schemas/FlowDesignationEnum'
          description: Decides what this Flow is used for. For example, the Authentication
            flow is redirect to when an un-authenticated user visits authentik.
        background:
          type: string
          description: |-
            Get the URL to the background image. If the name is /static or starts with http
            it is returned as-is
          readOnly: true
        stages:
          type: array
          items:
            type: string
            format: uuid
          readOnly: true
        policies:
          type: array
          items:
            type: string
            format: uuid
          readOnly: true
        cache_count:
          type: integer
          description: Get count of cached flows
          readOnly: true
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        compatibility_mode:
          type: boolean
          description: Enable compatibility mode, increases compatibility with password
            managers on mobile devices.
        export_url:
          type: string
          description: Get export URL for flow
          readOnly: true
        layout:
          $ref: '#/components/schemas/FlowLayoutEnum'
        denied_action:
          allOf:
          - $ref: '#/components/schemas/DeniedActionEnum'
          description: Configure what should happen when a flow denies access to a
            user.
        authentication:
          allOf:
          - $ref: '#/components/schemas/AuthenticationEnum'
          description: Required level of authentication and authorization to access
            a flow.
      required:
      - background
      - cache_count
      - designation
      - export_url
      - name
      - pk
      - policies
      - policybindingmodel_ptr_id
      - slug
      - stages
      - title
    FlowChallengeResponseRequest:
      oneOf:
      - $ref: '#/components/schemas/AppleChallengeResponseRequest'
      - $ref: '#/components/schemas/AuthenticatorDuoChallengeResponseRequest'
      - $ref: '#/components/schemas/AuthenticatorEmailChallengeResponseRequest'
      - $ref: '#/components/schemas/AuthenticatorSMSChallengeResponseRequest'
      - $ref: '#/components/schemas/AuthenticatorStaticChallengeResponseRequest'
      - $ref: '#/components/schemas/AuthenticatorTOTPChallengeResponseRequest'
      - $ref: '#/components/schemas/AuthenticatorValidationChallengeResponseRequest'
      - $ref: '#/components/schemas/AuthenticatorWebAuthnChallengeResponseRequest'
      - $ref: '#/components/schemas/AutoSubmitChallengeResponseRequest'
      - $ref: '#/components/schemas/CaptchaChallengeResponseRequest'
      - $ref: '#/components/schemas/ConsentChallengeResponseRequest'
      - $ref: '#/components/schemas/DummyChallengeResponseRequest'
      - $ref: '#/components/schemas/EmailChallengeResponseRequest'
      - $ref: '#/components/schemas/FrameChallengeResponseRequest'
      - $ref: '#/components/schemas/IdentificationChallengeResponseRequest'
      - $ref: '#/components/schemas/IframeLogoutChallengeResponseRequest'
      - $ref: '#/components/schemas/NativeLogoutChallengeResponseRequest'
      - $ref: '#/components/schemas/OAuthDeviceCodeChallengeResponseRequest'
      - $ref: '#/components/schemas/OAuthDeviceCodeFinishChallengeResponseRequest'
      - $ref: '#/components/schemas/PasswordChallengeResponseRequest'
      - $ref: '#/components/schemas/PlexAuthenticationChallengeResponseRequest'
      - $ref: '#/components/schemas/PromptChallengeResponseRequest'
      - $ref: '#/components/schemas/RedirectChallengeResponseRequest'
      - $ref: '#/components/schemas/TelegramChallengeResponseRequest'
      - $ref: '#/components/schemas/UserLoginChallengeResponseRequest'
      discriminator:
        propertyName: component
        mapping:
          ak-source-oauth-apple: '#/components/schemas/AppleChallengeResponseRequest'
          ak-stage-authenticator-duo: '#/components/schemas/AuthenticatorDuoChallengeResponseRequest'
          ak-stage-authenticator-email: '#/components/schemas/AuthenticatorEmailChallengeResponseRequest'
          ak-stage-authenticator-sms: '#/components/schemas/AuthenticatorSMSChallengeResponseRequest'
          ak-stage-authenticator-static: '#/components/schemas/AuthenticatorStaticChallengeResponseRequest'
          ak-stage-authenticator-totp: '#/components/schemas/AuthenticatorTOTPChallengeResponseRequest'
          ak-stage-authenticator-validate: '#/components/schemas/AuthenticatorValidationChallengeResponseRequest'
          ak-stage-authenticator-webauthn: '#/components/schemas/AuthenticatorWebAuthnChallengeResponseRequest'
          ak-stage-autosubmit: '#/components/schemas/AutoSubmitChallengeResponseRequest'
          ak-stage-captcha: '#/components/schemas/CaptchaChallengeResponseRequest'
          ak-stage-consent: '#/components/schemas/ConsentChallengeResponseRequest'
          ak-stage-dummy: '#/components/schemas/DummyChallengeResponseRequest'
          ak-stage-email: '#/components/schemas/EmailChallengeResponseRequest'
          xak-flow-frame: '#/components/schemas/FrameChallengeResponseRequest'
          ak-stage-identification: '#/components/schemas/IdentificationChallengeResponseRequest'
          ak-provider-iframe-logout: '#/components/schemas/IframeLogoutChallengeResponseRequest'
          ak-provider-saml-native-logout: '#/components/schemas/NativeLogoutChallengeResponseRequest'
          ak-provider-oauth2-device-code: '#/components/schemas/OAuthDeviceCodeChallengeResponseRequest'
          ak-provider-oauth2-device-code-finish: '#/components/schemas/OAuthDeviceCodeFinishChallengeResponseRequest'
          ak-stage-password: '#/components/schemas/PasswordChallengeResponseRequest'
          ak-source-plex: '#/components/schemas/PlexAuthenticationChallengeResponseRequest'
          ak-stage-prompt: '#/components/schemas/PromptChallengeResponseRequest'
          xak-flow-redirect: '#/components/schemas/RedirectChallengeResponseRequest'
          ak-source-telegram: '#/components/schemas/TelegramChallengeResponseRequest'
          ak-stage-user-login: '#/components/schemas/UserLoginChallengeResponseRequest'
    FlowDesignationEnum:
      enum:
      - authentication
      - authorization
      - invalidation
      - enrollment
      - unenrollment
      - recovery
      - stage_configuration
      type: string
    FlowDiagram:
      type: object
      description: response of the flow's diagram action
      properties:
        diagram:
          type: string
          readOnly: true
      required:
      - diagram
    FlowErrorChallenge:
      type: object
      description: |-
        Challenge class when an unhandled error occurs during a stage. Normal users
        are shown an error message, superusers are shown a full stacktrace.
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-flow-error
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        request_id:
          type: string
        error:
          type: string
        traceback:
          type: string
      required:
      - request_id
    FlowImportResult:
      type: object
      description: Logs of an attempted flow import
      properties:
        logs:
          type: array
          items:
            $ref: '#/components/schemas/LogEvent'
          readOnly: true
        success:
          type: boolean
          readOnly: true
      required:
      - logs
      - success
    FlowInspection:
      type: object
      description: Serializer for inspect endpoint
      properties:
        plans:
          type: array
          items:
            $ref: '#/components/schemas/FlowInspectorPlan'
        current_plan:
          $ref: '#/components/schemas/FlowInspectorPlan'
        is_completed:
          type: boolean
      required:
      - is_completed
      - plans
    FlowInspectorPlan:
      type: object
      description: Serializer for an active FlowPlan
      properties:
        current_stage:
          allOf:
          - $ref: '#/components/schemas/FlowStageBinding'
          readOnly: true
        next_planned_stage:
          allOf:
          - $ref: '#/components/schemas/FlowStageBinding'
          readOnly: true
        plan_context:
          type: object
          additionalProperties: {}
          description: Get the plan's context, sanitized
          readOnly: true
        session_id:
          type: string
          description: Get a unique session ID
          readOnly: true
      required:
      - current_stage
      - next_planned_stage
      - plan_context
      - session_id
    FlowLayoutEnum:
      enum:
      - stacked
      - content_left
      - content_right
      - sidebar_left
      - sidebar_right
      type: string
    FlowRequest:
      type: object
      description: Flow Serializer
      properties:
        name:
          type: string
          minLength: 1
        slug:
          type: string
          minLength: 1
          description: Visible in the URL.
          pattern: ^[-a-zA-Z0-9_]+$
        title:
          type: string
          minLength: 1
          description: Shown as the Title in Flow pages.
        designation:
          allOf:
          - $ref: '#/components/schemas/FlowDesignationEnum'
          description: Decides what this Flow is used for. For example, the Authentication
            flow is redirect to when an un-authenticated user visits authentik.
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        compatibility_mode:
          type: boolean
          description: Enable compatibility mode, increases compatibility with password
            managers on mobile devices.
        layout:
          $ref: '#/components/schemas/FlowLayoutEnum'
        denied_action:
          allOf:
          - $ref: '#/components/schemas/DeniedActionEnum'
          description: Configure what should happen when a flow denies access to a
            user.
        authentication:
          allOf:
          - $ref: '#/components/schemas/AuthenticationEnum'
          description: Required level of authentication and authorization to access
            a flow.
      required:
      - designation
      - name
      - slug
      - title
    FlowSet:
      type: object
      description: Stripped down flow serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Flow uuid
        policybindingmodel_ptr_id:
          type: string
          format: uuid
          readOnly: true
        name:
          type: string
        slug:
          type: string
          description: Visible in the URL.
          pattern: ^[-a-zA-Z0-9_]+$
        title:
          type: string
          description: Shown as the Title in Flow pages.
        designation:
          allOf:
          - $ref: '#/components/schemas/FlowDesignationEnum'
          description: Decides what this Flow is used for. For example, the Authentication
            flow is redirect to when an un-authenticated user visits authentik.
        background:
          type: string
          description: |-
            Get the URL to the background image. If the name is /static or starts with http
            it is returned as-is
          readOnly: true
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        compatibility_mode:
          type: boolean
          description: Enable compatibility mode, increases compatibility with password
            managers on mobile devices.
        export_url:
          type: string
          description: Get export URL for flow
          readOnly: true
        layout:
          $ref: '#/components/schemas/FlowLayoutEnum'
        denied_action:
          allOf:
          - $ref: '#/components/schemas/DeniedActionEnum'
          description: Configure what should happen when a flow denies access to a
            user.
      required:
      - background
      - designation
      - export_url
      - name
      - pk
      - policybindingmodel_ptr_id
      - slug
      - title
    FlowSetRequest:
      type: object
      description: Stripped down flow serializer
      properties:
        name:
          type: string
          minLength: 1
        slug:
          type: string
          minLength: 1
          description: Visible in the URL.
          pattern: ^[-a-zA-Z0-9_]+$
        title:
          type: string
          minLength: 1
          description: Shown as the Title in Flow pages.
        designation:
          allOf:
          - $ref: '#/components/schemas/FlowDesignationEnum'
          description: Decides what this Flow is used for. For example, the Authentication
            flow is redirect to when an un-authenticated user visits authentik.
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        compatibility_mode:
          type: boolean
          description: Enable compatibility mode, increases compatibility with password
            managers on mobile devices.
        layout:
          $ref: '#/components/schemas/FlowLayoutEnum'
        denied_action:
          allOf:
          - $ref: '#/components/schemas/DeniedActionEnum'
          description: Configure what should happen when a flow denies access to a
            user.
      required:
      - designation
      - name
      - slug
      - title
    FlowStageBinding:
      type: object
      description: FlowStageBinding Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Fsb uuid
        policybindingmodel_ptr_id:
          type: string
          format: uuid
          readOnly: true
        target:
          type: string
          format: uuid
        stage:
          type: string
          format: uuid
        stage_obj:
          allOf:
          - $ref: '#/components/schemas/Stage'
          readOnly: true
        evaluate_on_plan:
          type: boolean
          description: Evaluate policies during the Flow planning process.
        re_evaluate_policies:
          type: boolean
          description: Evaluate policies when the Stage is presented to the user.
        order:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        invalid_response_action:
          allOf:
          - $ref: '#/components/schemas/InvalidResponseActionEnum'
          description: Configure how the flow executor should handle an invalid response
            to a challenge. RETRY returns the error message and a similar challenge
            to the executor. RESTART restarts the flow from the beginning, and RESTART_WITH_CONTEXT
            restarts the flow while keeping the current context.
      required:
      - order
      - pk
      - policybindingmodel_ptr_id
      - stage
      - stage_obj
      - target
    FlowStageBindingRequest:
      type: object
      description: FlowStageBinding Serializer
      properties:
        target:
          type: string
          format: uuid
        stage:
          type: string
          format: uuid
        evaluate_on_plan:
          type: boolean
          description: Evaluate policies during the Flow planning process.
        re_evaluate_policies:
          type: boolean
          description: Evaluate policies when the Stage is presented to the user.
        order:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        invalid_response_action:
          allOf:
          - $ref: '#/components/schemas/InvalidResponseActionEnum'
          description: Configure how the flow executor should handle an invalid response
            to a challenge. RETRY returns the error message and a similar challenge
            to the executor. RESTART restarts the flow from the beginning, and RESTART_WITH_CONTEXT
            restarts the flow while keeping the current context.
      required:
      - order
      - stage
      - target
    FooterLink:
      type: object
      description: Links returned in Config API
      properties:
        href:
          type: string
          readOnly: true
          nullable: true
        name:
          type: string
          readOnly: true
      required:
      - href
      - name
    FrameChallenge:
      type: object
      description: Challenge type to render a frame
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: xak-flow-frame
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        url:
          type: string
        loading_overlay:
          type: boolean
          default: false
        loading_text:
          type: string
      required:
      - loading_text
      - url
    FrameChallengeResponseRequest:
      type: object
      description: Base class for all challenge responses
      properties:
        component:
          type: string
          minLength: 1
          default: xak-flow-frame
    GenericError:
      type: object
      description: Generic API Error
      properties:
        detail:
          type: string
        code:
          type: string
      required:
      - detail
    GeoIPPolicy:
      type: object
      description: GeoIP Policy Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Policy uuid
        name:
          type: string
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        bound_to:
          type: integer
          description: Return objects policy is bound to
          readOnly: true
        asns:
          type: array
          items:
            type: integer
            maximum: 2147483647
            minimum: -2147483648
        countries:
          type: array
          items:
            $ref: '#/components/schemas/CountryCodeEnum'
          maxItems: 249
        countries_obj:
          type: array
          items:
            $ref: '#/components/schemas/DetailedCountryField'
          readOnly: true
        check_history_distance:
          type: boolean
        history_max_distance_km:
          type: integer
          maximum: 9223372036854775807
          minimum: 0
          format: int64
        distance_tolerance_km:
          type: integer
          maximum: 2147483647
          minimum: 0
        history_login_count:
          type: integer
          maximum: 2147483647
          minimum: 0
        check_impossible_travel:
          type: boolean
        impossible_tolerance_km:
          type: integer
          maximum: 2147483647
          minimum: 0
      required:
      - bound_to
      - component
      - countries
      - countries_obj
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    GeoIPPolicyRequest:
      type: object
      description: GeoIP Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        asns:
          type: array
          items:
            type: integer
            maximum: 2147483647
            minimum: -2147483648
        countries:
          type: array
          items:
            $ref: '#/components/schemas/CountryCodeEnum'
          maxItems: 249
        check_history_distance:
          type: boolean
        history_max_distance_km:
          type: integer
          maximum: 9223372036854775807
          minimum: 0
          format: int64
        distance_tolerance_km:
          type: integer
          maximum: 2147483647
          minimum: 0
        history_login_count:
          type: integer
          maximum: 2147483647
          minimum: 0
        check_impossible_travel:
          type: boolean
        impossible_tolerance_km:
          type: integer
          maximum: 2147483647
          minimum: 0
      required:
      - countries
      - name
    GeoipBindingEnum:
      enum:
      - no_binding
      - bind_continent
      - bind_continent_country
      - bind_continent_country_city
      type: string
    GlobalTaskStatus:
      type: object
      properties:
        queued:
          type: integer
          readOnly: true
        consumed:
          type: integer
          readOnly: true
        preprocess:
          type: integer
          readOnly: true
        running:
          type: integer
          readOnly: true
        postprocess:
          type: integer
          readOnly: true
        rejected:
          type: integer
          readOnly: true
        done:
          type: integer
          readOnly: true
        info:
          type: integer
          readOnly: true
        warning:
          type: integer
          readOnly: true
        error:
          type: integer
          readOnly: true
      required:
      - consumed
      - done
      - error
      - info
      - postprocess
      - preprocess
      - queued
      - rejected
      - running
      - warning
    GoogleEndpointDevice:
      type: object
      description: Serializer for Endpoint authenticator devices
      properties:
        pk:
          type: string
          format: uuid
          title: Uuid
        name:
          type: string
          description: The human-readable name of this device.
          maxLength: 64
      required:
      - name
    GoogleEndpointDeviceRequest:
      type: object
      description: Serializer for Endpoint authenticator devices
      properties:
        pk:
          type: string
          format: uuid
          title: Uuid
        name:
          type: string
          minLength: 1
          description: The human-readable name of this device.
          maxLength: 64
      required:
      - name
    GoogleWorkspaceProvider:
      type: object
      description: GoogleWorkspaceProvider Serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        property_mappings_group:
          type: array
          items:
            type: string
            format: uuid
          description: Property mappings used for group creation/updating.
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        assigned_backchannel_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_backchannel_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        delegated_subject:
          type: string
          format: email
          maxLength: 254
        credentials:
          type: object
          additionalProperties: {}
        scopes:
          type: string
        exclude_users_service_account:
          type: boolean
        filter_group:
          type: string
          format: uuid
          nullable: true
        user_delete_action:
          $ref: '#/components/schemas/OutgoingSyncDeleteAction'
        group_delete_action:
          $ref: '#/components/schemas/OutgoingSyncDeleteAction'
        default_group_email_domain:
          type: string
        sync_page_size:
          type: integer
          maximum: 2147483647
          minimum: 1
          description: Controls the number of objects synced in a single task
        sync_page_timeout:
          type: string
          description: Timeout for synchronization of a single page
        dry_run:
          type: boolean
          description: When enabled, provider will not modify or create objects in
            the remote system.
      required:
      - assigned_backchannel_application_name
      - assigned_backchannel_application_slug
      - component
      - credentials
      - default_group_email_domain
      - delegated_subject
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    GoogleWorkspaceProviderGroup:
      type: object
      description: GoogleWorkspaceProviderGroup Serializer
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        google_id:
          type: string
        group:
          type: string
          format: uuid
        group_obj:
          allOf:
          - $ref: '#/components/schemas/PartialGroup'
          readOnly: true
        provider:
          type: integer
        attributes:
          type: object
          additionalProperties: {}
          readOnly: true
      required:
      - attributes
      - google_id
      - group
      - group_obj
      - id
      - provider
    GoogleWorkspaceProviderGroupRequest:
      type: object
      description: GoogleWorkspaceProviderGroup Serializer
      properties:
        google_id:
          type: string
          minLength: 1
        group:
          type: string
          format: uuid
        provider:
          type: integer
      required:
      - google_id
      - group
      - provider
    GoogleWorkspaceProviderMapping:
      type: object
      description: GoogleWorkspaceProviderMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
        expression:
          type: string
        component:
          type: string
          description: Get object's component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
      required:
      - component
      - expression
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    GoogleWorkspaceProviderMappingRequest:
      type: object
      description: GoogleWorkspaceProviderMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
      required:
      - expression
      - name
    GoogleWorkspaceProviderRequest:
      type: object
      description: GoogleWorkspaceProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        property_mappings_group:
          type: array
          items:
            type: string
            format: uuid
          description: Property mappings used for group creation/updating.
        delegated_subject:
          type: string
          format: email
          minLength: 1
          maxLength: 254
        credentials:
          type: object
          additionalProperties: {}
        scopes:
          type: string
          minLength: 1
        exclude_users_service_account:
          type: boolean
        filter_group:
          type: string
          format: uuid
          nullable: true
        user_delete_action:
          $ref: '#/components/schemas/OutgoingSyncDeleteAction'
        group_delete_action:
          $ref: '#/components/schemas/OutgoingSyncDeleteAction'
        default_group_email_domain:
          type: string
          minLength: 1
        sync_page_size:
          type: integer
          maximum: 2147483647
          minimum: 1
          description: Controls the number of objects synced in a single task
        sync_page_timeout:
          type: string
          minLength: 1
          description: Timeout for synchronization of a single page
        dry_run:
          type: boolean
          description: When enabled, provider will not modify or create objects in
            the remote system.
      required:
      - credentials
      - default_group_email_domain
      - delegated_subject
      - name
    GoogleWorkspaceProviderUser:
      type: object
      description: GoogleWorkspaceProviderUser Serializer
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        google_id:
          type: string
        user:
          type: integer
        user_obj:
          allOf:
          - $ref: '#/components/schemas/PartialUser'
          readOnly: true
        provider:
          type: integer
        attributes:
          type: object
          additionalProperties: {}
          readOnly: true
      required:
      - attributes
      - google_id
      - id
      - provider
      - user
      - user_obj
    GoogleWorkspaceProviderUserRequest:
      type: object
      description: GoogleWorkspaceProviderUser Serializer
      properties:
        google_id:
          type: string
          minLength: 1
        user:
          type: integer
        provider:
          type: integer
      required:
      - google_id
      - provider
      - user
    Group:
      type: object
      description: Group Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Group uuid
        num_pk:
          type: integer
          readOnly: true
        name:
          type: string
        is_superuser:
          type: boolean
          description: Users added to this group will be superusers.
        parent:
          type: string
          format: uuid
          nullable: true
        parent_name:
          type: string
          readOnly: true
          nullable: true
        users:
          type: array
          items:
            type: integer
        users_obj:
          type: array
          items:
            $ref: '#/components/schemas/PartialUser'
          readOnly: true
          nullable: true
        attributes:
          type: object
          additionalProperties: {}
        roles:
          type: array
          items:
            type: string
            format: uuid
        roles_obj:
          type: array
          items:
            $ref: '#/components/schemas/Role'
          readOnly: true
        children:
          type: array
          items:
            type: string
            format: uuid
        children_obj:
          type: array
          items:
            $ref: '#/components/schemas/GroupChild'
          readOnly: true
          nullable: true
      required:
      - children_obj
      - name
      - num_pk
      - parent_name
      - pk
      - roles_obj
      - users_obj
    GroupChild:
      type: object
      description: Stripped down group serializer to show relevant children for groups
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Group uuid
        name:
          type: string
        is_superuser:
          type: boolean
          description: Users added to this group will be superusers.
        attributes:
          type: object
          additionalProperties: {}
        group_uuid:
          type: string
          format: uuid
          readOnly: true
      required:
      - group_uuid
      - name
      - pk
    GroupKerberosSourceConnection:
      type: object
      description: Group Source Connection
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        source_obj:
          allOf:
          - $ref: '#/components/schemas/Source'
          readOnly: true
        identifier:
          type: string
        created:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
      required:
      - created
      - group
      - identifier
      - last_updated
      - pk
      - source
      - source_obj
    GroupKerberosSourceConnectionRequest:
      type: object
      description: Group Source Connection
      properties:
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
      required:
      - group
      - identifier
      - source
    GroupLDAPSourceConnection:
      type: object
      description: Group Source Connection
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        source_obj:
          allOf:
          - $ref: '#/components/schemas/Source'
          readOnly: true
        identifier:
          type: string
        created:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
      required:
      - created
      - group
      - identifier
      - last_updated
      - pk
      - source
      - source_obj
    GroupLDAPSourceConnectionRequest:
      type: object
      description: Group Source Connection
      properties:
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
      required:
      - group
      - identifier
      - source
    GroupMatchingModeEnum:
      enum:
      - identifier
      - name_link
      - name_deny
      type: string
    GroupOAuthSourceConnection:
      type: object
      description: Group Source Connection
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        source_obj:
          allOf:
          - $ref: '#/components/schemas/Source'
          readOnly: true
        identifier:
          type: string
        created:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
      required:
      - created
      - group
      - identifier
      - last_updated
      - pk
      - source
      - source_obj
    GroupOAuthSourceConnectionRequest:
      type: object
      description: Group Source Connection
      properties:
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
      required:
      - group
      - identifier
      - source
    GroupPlexSourceConnection:
      type: object
      description: Group Source Connection
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        source_obj:
          allOf:
          - $ref: '#/components/schemas/Source'
          readOnly: true
        identifier:
          type: string
        created:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
      required:
      - created
      - group
      - identifier
      - last_updated
      - pk
      - source
      - source_obj
    GroupPlexSourceConnectionRequest:
      type: object
      description: Group Source Connection
      properties:
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
      required:
      - group
      - identifier
      - source
    GroupRequest:
      type: object
      description: Group Serializer
      properties:
        name:
          type: string
          minLength: 1
        is_superuser:
          type: boolean
          description: Users added to this group will be superusers.
        parent:
          type: string
          format: uuid
          nullable: true
        users:
          type: array
          items:
            type: integer
        attributes:
          type: object
          additionalProperties: {}
        roles:
          type: array
          items:
            type: string
            format: uuid
        children:
          type: array
          items:
            type: string
            format: uuid
      required:
      - name
    GroupSAMLSourceConnection:
      type: object
      description: Group Source Connection
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        source_obj:
          allOf:
          - $ref: '#/components/schemas/Source'
          readOnly: true
        identifier:
          type: string
        created:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
      required:
      - created
      - group
      - identifier
      - last_updated
      - pk
      - source
      - source_obj
    GroupSAMLSourceConnectionRequest:
      type: object
      description: Group Source Connection
      properties:
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
      required:
      - group
      - identifier
      - source
    GroupSourceConnection:
      type: object
      description: Group Source Connection
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        source_obj:
          allOf:
          - $ref: '#/components/schemas/Source'
          readOnly: true
        identifier:
          type: string
        created:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
      required:
      - created
      - group
      - identifier
      - last_updated
      - pk
      - source
      - source_obj
    GroupSourceConnectionRequest:
      type: object
      description: Group Source Connection
      properties:
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
      required:
      - group
      - identifier
      - source
    GroupTelegramSourceConnection:
      type: object
      description: Group Source Connection
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        source_obj:
          allOf:
          - $ref: '#/components/schemas/Source'
          readOnly: true
        identifier:
          type: string
        created:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
      required:
      - created
      - group
      - identifier
      - last_updated
      - pk
      - source
      - source_obj
    GroupTelegramSourceConnectionRequest:
      type: object
      description: Group Source Connection
      properties:
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
      required:
      - group
      - identifier
      - source
    Hardware:
      type: object
      properties:
        model:
          type: string
        manufacturer:
          type: string
        serial:
          type: string
        cpu_name:
          type: string
        cpu_count:
          type: integer
        memory_bytes:
          type: integer
          format: int64
      required:
      - manufacturer
      - model
      - serial
    HardwareRequest:
      type: object
      properties:
        model:
          type: string
          minLength: 1
        manufacturer:
          type: string
          minLength: 1
        serial:
          type: string
        cpu_name:
          type: string
          minLength: 1
        cpu_count:
          type: integer
        memory_bytes:
          type: integer
          format: int64
      required:
      - manufacturer
      - model
      - serial
    IdentificationChallenge:
      type: object
      description: Identification challenges with all UI elements
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-identification
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        user_fields:
          type: array
          items:
            type: string
          nullable: true
        password_fields:
          type: boolean
        allow_show_password:
          type: boolean
          default: false
        application_pre:
          type: string
        flow_designation:
          $ref: '#/components/schemas/FlowDesignationEnum'
        captcha_stage:
          allOf:
          - $ref: '#/components/schemas/CaptchaChallenge'
          nullable: true
        enroll_url:
          type: string
        recovery_url:
          type: string
        passwordless_url:
          type: string
        primary_action:
          type: string
        sources:
          type: array
          items:
            $ref: '#/components/schemas/LoginSource'
        show_source_labels:
          type: boolean
        enable_remember_me:
          type: boolean
          default: true
      required:
      - flow_designation
      - password_fields
      - primary_action
      - show_source_labels
      - user_fields
    IdentificationChallengeResponseRequest:
      type: object
      description: Identification challenge
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-identification
        uid_field:
          type: string
          minLength: 1
        password:
          type: string
          nullable: true
        captcha_token:
          type: string
          nullable: true
      required:
      - uid_field
    IdentificationStage:
      type: object
      description: IdentificationStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        user_fields:
          type: array
          items:
            $ref: '#/components/schemas/UserFieldsEnum'
          description: Fields of the user object to match against. (Hold shift to
            select multiple options)
        password_stage:
          type: string
          format: uuid
          nullable: true
          description: When set, shows a password field, instead of showing the password
            field as separate step.
        captcha_stage:
          type: string
          format: uuid
          nullable: true
          description: When set, adds functionality exactly like a Captcha stage,
            but baked into the Identification stage.
        case_insensitive_matching:
          type: boolean
          description: When enabled, user fields are matched regardless of their casing.
        show_matched_user:
          type: boolean
          description: When a valid username/email has been entered, and this option
            is enabled, the user's username and avatar will be shown. Otherwise, the
            text that the user entered will be shown
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Optional enrollment flow, which is linked at the bottom of
            the page.
        recovery_flow:
          type: string
          format: uuid
          nullable: true
          description: Optional recovery flow, which is linked at the bottom of the
            page.
        passwordless_flow:
          type: string
          format: uuid
          nullable: true
          description: Optional passwordless flow, which is linked at the bottom of
            the page.
        sources:
          type: array
          items:
            type: string
            format: uuid
          description: Specify which sources should be shown.
        show_source_labels:
          type: boolean
        pretend_user_exists:
          type: boolean
          description: When enabled, the stage will succeed and continue even when
            incorrect user info is entered.
        enable_remember_me:
          type: boolean
          description: Show the user the 'Remember me on this device' toggle, allowing
            repeat users to skip straight to entering their password.
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    IdentificationStageRequest:
      type: object
      description: IdentificationStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        user_fields:
          type: array
          items:
            $ref: '#/components/schemas/UserFieldsEnum'
          description: Fields of the user object to match against. (Hold shift to
            select multiple options)
        password_stage:
          type: string
          format: uuid
          nullable: true
          description: When set, shows a password field, instead of showing the password
            field as separate step.
        captcha_stage:
          type: string
          format: uuid
          nullable: true
          description: When set, adds functionality exactly like a Captcha stage,
            but baked into the Identification stage.
        case_insensitive_matching:
          type: boolean
          description: When enabled, user fields are matched regardless of their casing.
        show_matched_user:
          type: boolean
          description: When a valid username/email has been entered, and this option
            is enabled, the user's username and avatar will be shown. Otherwise, the
            text that the user entered will be shown
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Optional enrollment flow, which is linked at the bottom of
            the page.
        recovery_flow:
          type: string
          format: uuid
          nullable: true
          description: Optional recovery flow, which is linked at the bottom of the
            page.
        passwordless_flow:
          type: string
          format: uuid
          nullable: true
          description: Optional passwordless flow, which is linked at the bottom of
            the page.
        sources:
          type: array
          items:
            type: string
            format: uuid
          description: Specify which sources should be shown.
        show_source_labels:
          type: boolean
        pretend_user_exists:
          type: boolean
          description: When enabled, the stage will succeed and continue even when
            incorrect user info is entered.
        enable_remember_me:
          type: boolean
          description: Show the user the 'Remember me on this device' toggle, allowing
            repeat users to skip straight to entering their password.
      required:
      - name
    IframeLogoutChallenge:
      type: object
      description: Challenge for iframe logout
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-provider-iframe-logout
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        logout_urls:
          type: array
          items:
            type: object
            additionalProperties: {}
    IframeLogoutChallengeResponseRequest:
      type: object
      description: Response for iframe logout
      properties:
        component:
          type: string
          minLength: 1
          default: ak-provider-iframe-logout
    ImpersonationRequest:
      type: object
      properties:
        reason:
          type: string
          minLength: 1
      required:
      - reason
    InitialPermissions:
      type: object
      description: InitialPermissions serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
          maxLength: 150
        mode:
          $ref: '#/components/schemas/InitialPermissionsModeEnum'
        role:
          type: string
          format: uuid
        permissions:
          type: array
          items:
            type: integer
        permissions_obj:
          type: array
          items:
            $ref: '#/components/schemas/Permission'
          readOnly: true
      required:
      - mode
      - name
      - permissions_obj
      - pk
      - role
    InitialPermissionsModeEnum:
      enum:
      - user
      - role
      type: string
    InitialPermissionsRequest:
      type: object
      description: InitialPermissions serializer
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 150
        mode:
          $ref: '#/components/schemas/InitialPermissionsModeEnum'
        role:
          type: string
          format: uuid
        permissions:
          type: array
          items:
            type: integer
      required:
      - mode
      - name
      - role
    InstallID:
      type: object
      properties:
        install_id:
          type: string
      required:
      - install_id
    IntentEnum:
      enum:
      - verification
      - api
      - recovery
      - app_password
      type: string
    InvalidResponseActionEnum:
      enum:
      - retry
      - restart
      - restart_with_context
      type: string
    Invitation:
      type: object
      description: Invitation Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Invite uuid
        name:
          type: string
          pattern: ^[-a-zA-Z0-9_]+$
        expires:
          type: string
          format: date-time
          nullable: true
        fixed_data:
          type: object
          additionalProperties: {}
        created_by:
          allOf:
          - $ref: '#/components/schemas/PartialUser'
          readOnly: true
        single_use:
          type: boolean
          description: When enabled, the invitation will be deleted after usage.
        flow:
          type: string
          format: uuid
          nullable: true
          description: When set, only the configured flow can use this invitation.
        flow_obj:
          allOf:
          - $ref: '#/components/schemas/Flow'
          readOnly: true
      required:
      - created_by
      - flow_obj
      - name
      - pk
    InvitationRequest:
      type: object
      description: Invitation Serializer
      properties:
        name:
          type: string
          minLength: 1
          pattern: ^[-a-zA-Z0-9_]+$
        expires:
          type: string
          format: date-time
          nullable: true
        fixed_data:
          type: object
          additionalProperties: {}
        single_use:
          type: boolean
          description: When enabled, the invitation will be deleted after usage.
        flow:
          type: string
          format: uuid
          nullable: true
          description: When set, only the configured flow can use this invitation.
      required:
      - name
    InvitationStage:
      type: object
      description: InvitationStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        continue_flow_without_invitation:
          type: boolean
          description: If this flag is set, this Stage will jump to the next Stage
            when no Invitation is given. By default this Stage will cancel the Flow
            when no invitation is given.
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    InvitationStageRequest:
      type: object
      description: InvitationStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        continue_flow_without_invitation:
          type: boolean
          description: If this flag is set, this Stage will jump to the next Stage
            when no Invitation is given. By default this Stage will cancel the Flow
            when no invitation is given.
      required:
      - name
    IssuerModeEnum:
      enum:
      - global
      - per_provider
      type: string
    KadminTypeEnum:
      enum:
      - MIT
      - Heimdal
      - other
      type: string
    KerberosSource:
      type: object
      description: Kerberos Source Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pbm uuid
        name:
          type: string
          description: Source's display Name.
        slug:
          type: string
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
          readOnly: true
        user_path_template:
          type: string
        icon:
          type: string
          readOnly: true
        group_matching_mode:
          allOf:
          - $ref: '#/components/schemas/GroupMatchingModeEnum'
          description: How the source determines if an existing group should be used
            or a new group created.
        realm:
          type: string
          description: Kerberos realm
        krb5_conf:
          type: string
          description: Custom krb5.conf to use. Uses the system one by default
        kadmin_type:
          allOf:
          - $ref: '#/components/schemas/KadminTypeEnum'
          description: KAdmin server type
        sync_users:
          type: boolean
          description: Sync users from Kerberos into authentik
        sync_users_password:
          type: boolean
          description: When a user changes their password, sync it back to Kerberos
        sync_principal:
          type: string
          description: Principal to authenticate to kadmin for sync.
        sync_ccache:
          type: string
          description: Credentials cache to authenticate to kadmin for sync. Must
            be in the form TYPE:residual
        connectivity:
          type: object
          additionalProperties:
            type: string
          nullable: true
          description: Get cached source connectivity
          readOnly: true
        spnego_server_name:
          type: string
          description: Force the use of a specific server name for SPNEGO. Must be
            in the form HTTP@hostname
        spnego_ccache:
          type: string
          description: Credential cache to use for SPNEGO in form type:residual
        password_login_update_internal_password:
          type: boolean
          description: If enabled, the authentik-stored password will be updated upon
            login with the Kerberos password backend
      required:
      - component
      - connectivity
      - icon
      - managed
      - meta_model_name
      - name
      - pk
      - realm
      - slug
      - verbose_name
      - verbose_name_plural
    KerberosSourcePropertyMapping:
      type: object
      description: Kerberos PropertyMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
        expression:
          type: string
        component:
          type: string
          description: Get object's component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
      required:
      - component
      - expression
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    KerberosSourcePropertyMappingRequest:
      type: object
      description: Kerberos PropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
      required:
      - expression
      - name
    KerberosSourceRequest:
      type: object
      description: Kerberos Source Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Source's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        user_path_template:
          type: string
          minLength: 1
        group_matching_mode:
          allOf:
          - $ref: '#/components/schemas/GroupMatchingModeEnum'
          description: How the source determines if an existing group should be used
            or a new group created.
        realm:
          type: string
          minLength: 1
          description: Kerberos realm
        krb5_conf:
          type: string
          description: Custom krb5.conf to use. Uses the system one by default
        kadmin_type:
          allOf:
          - $ref: '#/components/schemas/KadminTypeEnum'
          description: KAdmin server type
        sync_users:
          type: boolean
          description: Sync users from Kerberos into authentik
        sync_users_password:
          type: boolean
          description: When a user changes their password, sync it back to Kerberos
        sync_principal:
          type: string
          description: Principal to authenticate to kadmin for sync.
        sync_password:
          type: string
          writeOnly: true
          description: Password to authenticate to kadmin for sync
        sync_keytab:
          type: string
          writeOnly: true
          description: Keytab to authenticate to kadmin for sync. Must be base64-encoded
            or in the form TYPE:residual
        sync_ccache:
          type: string
          description: Credentials cache to authenticate to kadmin for sync. Must
            be in the form TYPE:residual
        spnego_server_name:
          type: string
          description: Force the use of a specific server name for SPNEGO. Must be
            in the form HTTP@hostname
        spnego_keytab:
          type: string
          writeOnly: true
          description: SPNEGO keytab base64-encoded or path to keytab in the form
            FILE:path
        spnego_ccache:
          type: string
          description: Credential cache to use for SPNEGO in form type:residual
        password_login_update_internal_password:
          type: boolean
          description: If enabled, the authentik-stored password will be updated upon
            login with the Kerberos password backend
      required:
      - name
      - realm
      - slug
    KeyTypeEnum:
      enum:
      - rsa
      - ec
      - dsa
      - ed25519
      - ed448
      type: string
    KubernetesServiceConnection:
      type: object
      description: KubernetesServiceConnection Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Uuid
        name:
          type: string
        local:
          type: boolean
          description: If enabled, use the local connection. Required Docker socket/Kubernetes
            Integration
        component:
          type: string
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        kubeconfig:
          type: object
          additionalProperties: {}
          description: Paste your kubeconfig here. authentik will automatically use
            the currently selected context.
        verify_ssl:
          type: boolean
          description: Verify SSL Certificates of the Kubernetes API endpoint
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    KubernetesServiceConnectionRequest:
      type: object
      description: KubernetesServiceConnection Serializer
      properties:
        name:
          type: string
          minLength: 1
        local:
          type: boolean
          description: If enabled, use the local connection. Required Docker socket/Kubernetes
            Integration
        kubeconfig:
          type: object
          additionalProperties: {}
          description: Paste your kubeconfig here. authentik will automatically use
            the currently selected context.
        verify_ssl:
          type: boolean
          description: Verify SSL Certificates of the Kubernetes API endpoint
      required:
      - name
    LDAPAPIAccessMode:
      enum:
      - direct
      - cached
      type: string
    LDAPCheckAccess:
      type: object
      description: Base serializer class which doesn't implement create/update methods
      properties:
        has_search_permission:
          type: boolean
        access:
          $ref: '#/components/schemas/PolicyTestResult'
      required:
      - access
    LDAPDebug:
      type: object
      properties:
        user:
          type: array
          items:
            type: object
            additionalProperties: {}
          readOnly: true
        group:
          type: array
          items:
            type: object
            additionalProperties: {}
          readOnly: true
        membership:
          type: array
          items:
            type: object
            additionalProperties: {}
          readOnly: true
      required:
      - group
      - membership
      - user
    LDAPOutpostConfig:
      type: object
      description: LDAPProvider Serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
        base_dn:
          type: string
          description: DN under which objects are accessible.
        bind_flow_slug:
          type: string
        unbind_flow_slug:
          type: string
          nullable: true
          description: Get slug for unbind flow, defaulting to brand's default flow.
          readOnly: true
        application_slug:
          type: string
          description: Prioritise backchannel slug over direct application slug
          readOnly: true
        certificate:
          type: string
          format: uuid
          nullable: true
        tls_server_name:
          type: string
        uid_start_number:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: The start for uidNumbers, this number is added to the user.pk
            to make sure that the numbers aren't too low for POSIX users. Default
            is 2000 to ensure that we don't collide with local users uidNumber
        gid_start_number:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: The start for gidNumbers, this number is added to a number
            generated from the group.pk to make sure that the numbers aren't too low
            for POSIX groups. Default is 4000 to ensure that we don't collide with
            local groups or users primary groups gidNumber
        search_mode:
          $ref: '#/components/schemas/LDAPAPIAccessMode'
        bind_mode:
          $ref: '#/components/schemas/LDAPAPIAccessMode'
        mfa_support:
          type: boolean
          description: When enabled, code-based multi-factor authentication can be
            used by appending a semicolon and the TOTP code to the password. This
            should only be enabled if all users that will bind to this provider have
            a TOTP device configured, as otherwise a password may incorrectly be rejected
            if it contains a semicolon.
      required:
      - application_slug
      - bind_flow_slug
      - name
      - pk
      - unbind_flow_slug
    LDAPProvider:
      type: object
      description: LDAPProvider Serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        assigned_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        assigned_backchannel_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_backchannel_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        base_dn:
          type: string
          description: DN under which objects are accessible.
        certificate:
          type: string
          format: uuid
          nullable: true
        tls_server_name:
          type: string
        uid_start_number:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: The start for uidNumbers, this number is added to the user.pk
            to make sure that the numbers aren't too low for POSIX users. Default
            is 2000 to ensure that we don't collide with local users uidNumber
        gid_start_number:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: The start for gidNumbers, this number is added to a number
            generated from the group.pk to make sure that the numbers aren't too low
            for POSIX groups. Default is 4000 to ensure that we don't collide with
            local groups or users primary groups gidNumber
        outpost_set:
          type: array
          items:
            type: string
          readOnly: true
        search_mode:
          $ref: '#/components/schemas/LDAPAPIAccessMode'
        bind_mode:
          $ref: '#/components/schemas/LDAPAPIAccessMode'
        mfa_support:
          type: boolean
          description: When enabled, code-based multi-factor authentication can be
            used by appending a semicolon and the TOTP code to the password. This
            should only be enabled if all users that will bind to this provider have
            a TOTP device configured, as otherwise a password may incorrectly be rejected
            if it contains a semicolon.
      required:
      - assigned_application_name
      - assigned_application_slug
      - assigned_backchannel_application_name
      - assigned_backchannel_application_slug
      - authorization_flow
      - component
      - invalidation_flow
      - meta_model_name
      - name
      - outpost_set
      - pk
      - verbose_name
      - verbose_name_plural
    LDAPProviderRequest:
      type: object
      description: LDAPProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        base_dn:
          type: string
          minLength: 1
          description: DN under which objects are accessible.
        certificate:
          type: string
          format: uuid
          nullable: true
        tls_server_name:
          type: string
        uid_start_number:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: The start for uidNumbers, this number is added to the user.pk
            to make sure that the numbers aren't too low for POSIX users. Default
            is 2000 to ensure that we don't collide with local users uidNumber
        gid_start_number:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: The start for gidNumbers, this number is added to a number
            generated from the group.pk to make sure that the numbers aren't too low
            for POSIX groups. Default is 4000 to ensure that we don't collide with
            local groups or users primary groups gidNumber
        search_mode:
          $ref: '#/components/schemas/LDAPAPIAccessMode'
        bind_mode:
          $ref: '#/components/schemas/LDAPAPIAccessMode'
        mfa_support:
          type: boolean
          description: When enabled, code-based multi-factor authentication can be
            used by appending a semicolon and the TOTP code to the password. This
            should only be enabled if all users that will bind to this provider have
            a TOTP device configured, as otherwise a password may incorrectly be rejected
            if it contains a semicolon.
      required:
      - authorization_flow
      - invalidation_flow
      - name
    LDAPSource:
      type: object
      description: LDAP Source Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pbm uuid
        name:
          type: string
          description: Source's display Name.
        slug:
          type: string
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
          readOnly: true
        user_path_template:
          type: string
        icon:
          type: string
          readOnly: true
        server_uri:
          type: string
          format: uri
        peer_certificate:
          type: string
          format: uuid
          nullable: true
          description: Optionally verify the LDAP Server's Certificate against the
            CA Chain in this keypair.
        client_certificate:
          type: string
          format: uuid
          nullable: true
          description: Client certificate to authenticate against the LDAP Server's
            Certificate.
        bind_cn:
          type: string
        start_tls:
          type: boolean
          title: Enable Start TLS
        sni:
          type: boolean
          title: Use Server URI for SNI verification
        base_dn:
          type: string
        additional_user_dn:
          type: string
          title: Addition User DN
          description: Prepended to Base DN for User-queries.
        additional_group_dn:
          type: string
          title: Addition Group DN
          description: Prepended to Base DN for Group-queries.
        user_object_filter:
          type: string
          description: Consider Objects matching this filter to be Users.
        group_object_filter:
          type: string
          description: Consider Objects matching this filter to be Groups.
        group_membership_field:
          type: string
          description: Field which contains members of a group.
        user_membership_attribute:
          type: string
          description: Attribute which matches the value of `group_membership_field`.
        object_uniqueness_field:
          type: string
          description: Field which contains a unique Identifier.
        password_login_update_internal_password:
          type: boolean
          description: Update internal authentik password when login succeeds with
            LDAP
        sync_users:
          type: boolean
        sync_users_password:
          type: boolean
          description: When a user changes their password, sync it back to LDAP. This
            can only be enabled on a single LDAP source.
        sync_groups:
          type: boolean
        sync_parent_group:
          type: string
          format: uuid
          nullable: true
        connectivity:
          type: object
          additionalProperties:
            type: object
            additionalProperties:
              type: string
          nullable: true
          description: Get cached source connectivity
          readOnly: true
        lookup_groups_from_user:
          type: boolean
          description: Lookup group membership based on a user attribute instead of
            a group attribute. This allows nested group resolution on systems like
            FreeIPA and Active Directory
        delete_not_found_objects:
          type: boolean
          description: Delete authentik users and groups which were previously supplied
            by this source, but are now missing from it.
      required:
      - base_dn
      - component
      - connectivity
      - icon
      - managed
      - meta_model_name
      - name
      - pk
      - server_uri
      - slug
      - verbose_name
      - verbose_name_plural
    LDAPSourcePropertyMapping:
      type: object
      description: LDAP PropertyMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
        expression:
          type: string
        component:
          type: string
          description: Get object's component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
      required:
      - component
      - expression
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    LDAPSourcePropertyMappingRequest:
      type: object
      description: LDAP PropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
      required:
      - expression
      - name
    LDAPSourceRequest:
      type: object
      description: LDAP Source Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Source's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        user_path_template:
          type: string
          minLength: 1
        server_uri:
          type: string
          minLength: 1
          format: uri
        peer_certificate:
          type: string
          format: uuid
          nullable: true
          description: Optionally verify the LDAP Server's Certificate against the
            CA Chain in this keypair.
        client_certificate:
          type: string
          format: uuid
          nullable: true
          description: Client certificate to authenticate against the LDAP Server's
            Certificate.
        bind_cn:
          type: string
        bind_password:
          type: string
          writeOnly: true
        start_tls:
          type: boolean
          title: Enable Start TLS
        sni:
          type: boolean
          title: Use Server URI for SNI verification
        base_dn:
          type: string
          minLength: 1
        additional_user_dn:
          type: string
          title: Addition User DN
          description: Prepended to Base DN for User-queries.
        additional_group_dn:
          type: string
          title: Addition Group DN
          description: Prepended to Base DN for Group-queries.
        user_object_filter:
          type: string
          minLength: 1
          description: Consider Objects matching this filter to be Users.
        group_object_filter:
          type: string
          minLength: 1
          description: Consider Objects matching this filter to be Groups.
        group_membership_field:
          type: string
          minLength: 1
          description: Field which contains members of a group.
        user_membership_attribute:
          type: string
          minLength: 1
          description: Attribute which matches the value of `group_membership_field`.
        object_uniqueness_field:
          type: string
          minLength: 1
          description: Field which contains a unique Identifier.
        password_login_update_internal_password:
          type: boolean
          description: Update internal authentik password when login succeeds with
            LDAP
        sync_users:
          type: boolean
        sync_users_password:
          type: boolean
          description: When a user changes their password, sync it back to LDAP. This
            can only be enabled on a single LDAP source.
        sync_groups:
          type: boolean
        sync_parent_group:
          type: string
          format: uuid
          nullable: true
        lookup_groups_from_user:
          type: boolean
          description: Lookup group membership based on a user attribute instead of
            a group attribute. This allows nested group resolution on systems like
            FreeIPA and Active Directory
        delete_not_found_objects:
          type: boolean
          description: Delete authentik users and groups which were previously supplied
            by this source, but are now missing from it.
      required:
      - base_dn
      - name
      - server_uri
      - slug
    LastTaskStatusEnum:
      enum:
      - queued
      - consumed
      - preprocess
      - running
      - postprocess
      - rejected
      - done
      - info
      - warning
      - error
      type: string
    License:
      type: object
      description: License Serializer
      properties:
        license_uuid:
          type: string
          format: uuid
          readOnly: true
        name:
          type: string
          readOnly: true
        key:
          type: string
        expiry:
          type: string
          format: date-time
          readOnly: true
        internal_users:
          type: integer
          readOnly: true
        external_users:
          type: integer
          readOnly: true
      required:
      - expiry
      - external_users
      - internal_users
      - key
      - license_uuid
      - name
    LicenseFlagsEnum:
      enum:
      - trial
      - non_production
      type: string
    LicenseForecast:
      type: object
      description: Serializer for license forecast
      properties:
        internal_users:
          type: integer
        external_users:
          type: integer
        forecasted_internal_users:
          type: integer
        forecasted_external_users:
          type: integer
      required:
      - external_users
      - forecasted_external_users
      - forecasted_internal_users
      - internal_users
    LicenseRequest:
      type: object
      description: License Serializer
      properties:
        key:
          type: string
          minLength: 1
      required:
      - key
    LicenseSummary:
      type: object
      description: Serializer for license status
      properties:
        internal_users:
          type: integer
        external_users:
          type: integer
        status:
          $ref: '#/components/schemas/LicenseSummaryStatusEnum'
        latest_valid:
          type: string
          format: date-time
        license_flags:
          type: array
          items:
            $ref: '#/components/schemas/LicenseFlagsEnum'
      required:
      - external_users
      - internal_users
      - latest_valid
      - license_flags
      - status
    LicenseSummaryStatusEnum:
      enum:
      - unlicensed
      - valid
      - expired
      - expiry_soon
      - limit_exceeded_admin
      - limit_exceeded_user
      - read_only
      type: string
    Link:
      type: object
      description: Returns a single link
      properties:
        link:
          type: string
      required:
      - link
    LogEvent:
      type: object
      description: Single log message with all context logged.
      properties:
        timestamp:
          type: string
          format: date-time
        log_level:
          $ref: '#/components/schemas/LogLevelEnum'
        logger:
          type: string
        event:
          type: string
        attributes:
          type: object
          additionalProperties: {}
      required:
      - attributes
      - event
      - log_level
      - logger
      - timestamp
    LogLevelEnum:
      enum:
      - critical
      - exception
      - error
      - warn
      - warning
      - info
      - debug
      - notset
      type: string
    LoginChallengeTypes:
      oneOf:
      - $ref: '#/components/schemas/RedirectChallenge'
      - $ref: '#/components/schemas/AppleLoginChallenge'
      - $ref: '#/components/schemas/PlexAuthenticationChallenge'
      - $ref: '#/components/schemas/TelegramLoginChallenge'
      discriminator:
        propertyName: component
        mapping:
          xak-flow-redirect: '#/components/schemas/RedirectChallenge'
          ak-source-oauth-apple: '#/components/schemas/AppleLoginChallenge'
          ak-source-plex: '#/components/schemas/PlexAuthenticationChallenge'
          ak-source-telegram: '#/components/schemas/TelegramLoginChallenge'
    LoginSource:
      type: object
      description: Serializer for Login buttons of sources
      properties:
        name:
          type: string
        icon_url:
          type: string
          nullable: true
        promoted:
          type: boolean
          default: false
        challenge:
          $ref: '#/components/schemas/LoginChallengeTypes'
      required:
      - challenge
      - name
    MDMConfigRequest:
      type: object
      description: Base serializer class which doesn't implement create/update methods
      properties:
        platform:
          $ref: '#/components/schemas/DeviceFactsOSFamily'
        enrollment_token:
          type: string
          format: uuid
      required:
      - enrollment_token
      - platform
    MDMConfigResponse:
      type: object
      description: Base serializer class which doesn't implement create/update methods
      properties:
        config:
          type: string
      required:
      - config
    MatchingModeEnum:
      enum:
      - strict
      - regex
      type: string
    Metadata:
      type: object
      description: Serializer for blueprint metadata
      properties:
        name:
          type: string
        labels:
          type: object
          additionalProperties: {}
      required:
      - labels
      - name
    MicrosoftEntraProvider:
      type: object
      description: MicrosoftEntraProvider Serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        property_mappings_group:
          type: array
          items:
            type: string
            format: uuid
          description: Property mappings used for group creation/updating.
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        assigned_backchannel_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_backchannel_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        client_id:
          type: string
        client_secret:
          type: string
        tenant_id:
          type: string
        exclude_users_service_account:
          type: boolean
        filter_group:
          type: string
          format: uuid
          nullable: true
        user_delete_action:
          $ref: '#/components/schemas/OutgoingSyncDeleteAction'
        group_delete_action:
          $ref: '#/components/schemas/OutgoingSyncDeleteAction'
        sync_page_size:
          type: integer
          maximum: 2147483647
          minimum: 1
          description: Controls the number of objects synced in a single task
        sync_page_timeout:
          type: string
          description: Timeout for synchronization of a single page
        dry_run:
          type: boolean
          description: When enabled, provider will not modify or create objects in
            the remote system.
      required:
      - assigned_backchannel_application_name
      - assigned_backchannel_application_slug
      - client_id
      - client_secret
      - component
      - meta_model_name
      - name
      - pk
      - tenant_id
      - verbose_name
      - verbose_name_plural
    MicrosoftEntraProviderGroup:
      type: object
      description: MicrosoftEntraProviderGroup Serializer
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        microsoft_id:
          type: string
        group:
          type: string
          format: uuid
        group_obj:
          allOf:
          - $ref: '#/components/schemas/PartialGroup'
          readOnly: true
        provider:
          type: integer
        attributes:
          type: object
          additionalProperties: {}
          readOnly: true
      required:
      - attributes
      - group
      - group_obj
      - id
      - microsoft_id
      - provider
    MicrosoftEntraProviderGroupRequest:
      type: object
      description: MicrosoftEntraProviderGroup Serializer
      properties:
        microsoft_id:
          type: string
          minLength: 1
        group:
          type: string
          format: uuid
        provider:
          type: integer
      required:
      - group
      - microsoft_id
      - provider
    MicrosoftEntraProviderMapping:
      type: object
      description: MicrosoftEntraProviderMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
        expression:
          type: string
        component:
          type: string
          description: Get object's component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
      required:
      - component
      - expression
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    MicrosoftEntraProviderMappingRequest:
      type: object
      description: MicrosoftEntraProviderMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
      required:
      - expression
      - name
    MicrosoftEntraProviderRequest:
      type: object
      description: MicrosoftEntraProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        property_mappings_group:
          type: array
          items:
            type: string
            format: uuid
          description: Property mappings used for group creation/updating.
        client_id:
          type: string
          minLength: 1
        client_secret:
          type: string
          minLength: 1
        tenant_id:
          type: string
          minLength: 1
        exclude_users_service_account:
          type: boolean
        filter_group:
          type: string
          format: uuid
          nullable: true
        user_delete_action:
          $ref: '#/components/schemas/OutgoingSyncDeleteAction'
        group_delete_action:
          $ref: '#/components/schemas/OutgoingSyncDeleteAction'
        sync_page_size:
          type: integer
          maximum: 2147483647
          minimum: 1
          description: Controls the number of objects synced in a single task
        sync_page_timeout:
          type: string
          minLength: 1
          description: Timeout for synchronization of a single page
        dry_run:
          type: boolean
          description: When enabled, provider will not modify or create objects in
            the remote system.
      required:
      - client_id
      - client_secret
      - name
      - tenant_id
    MicrosoftEntraProviderUser:
      type: object
      description: MicrosoftEntraProviderUser Serializer
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        microsoft_id:
          type: string
        user:
          type: integer
        user_obj:
          allOf:
          - $ref: '#/components/schemas/PartialUser'
          readOnly: true
        provider:
          type: integer
        attributes:
          type: object
          additionalProperties: {}
          readOnly: true
      required:
      - attributes
      - id
      - microsoft_id
      - provider
      - user
      - user_obj
    MicrosoftEntraProviderUserRequest:
      type: object
      description: MicrosoftEntraProviderUser Serializer
      properties:
        microsoft_id:
          type: string
          minLength: 1
        user:
          type: integer
        provider:
          type: integer
      required:
      - microsoft_id
      - provider
      - user
    ModelEnum:
      enum:
      - authentik_tenants.domain
      - authentik_core.group
      - authentik_core.user
      - authentik_core.application
      - authentik_core.applicationentitlement
      - authentik_core.token
      - authentik_crypto.certificatekeypair
      - authentik_endpoints.deviceuserbinding
      - authentik_endpoints.endpointstage
      - authentik_endpoints_connectors_agent.agentconnector
      - authentik_endpoints_connectors_agent.agentdeviceuserbinding
      - authentik_endpoints_connectors_agent.enrollmenttoken
      - authentik_enterprise.license
      - authentik_events.event
      - authentik_events.notificationtransport
      - authentik_events.notification
      - authentik_events.notificationrule
      - authentik_events.notificationwebhookmapping
      - authentik_flows.flow
      - authentik_flows.flowstagebinding
      - authentik_outposts.dockerserviceconnection
      - authentik_outposts.kubernetesserviceconnection
      - authentik_outposts.outpost
      - authentik_policies_dummy.dummypolicy
      - authentik_policies_event_matcher.eventmatcherpolicy
      - authentik_policies_expiry.passwordexpirypolicy
      - authentik_policies_expression.expressionpolicy
      - authentik_policies_geoip.geoippolicy
      - authentik_policies_password.passwordpolicy
      - authentik_policies_reputation.reputationpolicy
      - authentik_policies.policybinding
      - authentik_providers_ldap.ldapprovider
      - authentik_providers_oauth2.scopemapping
      - authentik_providers_oauth2.oauth2provider
      - authentik_providers_proxy.proxyprovider
      - authentik_providers_rac.racprovider
      - authentik_providers_rac.endpoint
      - authentik_providers_rac.racpropertymapping
      - authentik_providers_radius.radiusprovider
      - authentik_providers_radius.radiusproviderpropertymapping
      - authentik_providers_saml.samlprovider
      - authentik_providers_saml.samlpropertymapping
      - authentik_providers_scim.scimprovider
      - authentik_providers_scim.scimmapping
      - authentik_rbac.role
      - authentik_rbac.initialpermissions
      - authentik_sources_kerberos.kerberossource
      - authentik_sources_kerberos.kerberossourcepropertymapping
      - authentik_sources_kerberos.userkerberossourceconnection
      - authentik_sources_kerberos.groupkerberossourceconnection
      - authentik_sources_ldap.ldapsource
      - authentik_sources_ldap.ldapsourcepropertymapping
      - authentik_sources_ldap.userldapsourceconnection
      - authentik_sources_ldap.groupldapsourceconnection
      - authentik_sources_oauth.oauthsource
      - authentik_sources_oauth.oauthsourcepropertymapping
      - authentik_sources_oauth.useroauthsourceconnection
      - authentik_sources_oauth.groupoauthsourceconnection
      - authentik_sources_plex.plexsource
      - authentik_sources_plex.plexsourcepropertymapping
      - authentik_sources_plex.userplexsourceconnection
      - authentik_sources_plex.groupplexsourceconnection
      - authentik_sources_saml.samlsource
      - authentik_sources_saml.samlsourcepropertymapping
      - authentik_sources_saml.usersamlsourceconnection
      - authentik_sources_saml.groupsamlsourceconnection
      - authentik_sources_scim.scimsource
      - authentik_sources_scim.scimsourcepropertymapping
      - authentik_sources_telegram.telegramsource
      - authentik_sources_telegram.telegramsourcepropertymapping
      - authentik_sources_telegram.usertelegramsourceconnection
      - authentik_sources_telegram.grouptelegramsourceconnection
      - authentik_stages_authenticator_duo.authenticatorduostage
      - authentik_stages_authenticator_duo.duodevice
      - authentik_stages_authenticator_email.authenticatoremailstage
      - authentik_stages_authenticator_email.emaildevice
      - authentik_stages_authenticator_sms.authenticatorsmsstage
      - authentik_stages_authenticator_sms.smsdevice
      - authentik_stages_authenticator_static.authenticatorstaticstage
      - authentik_stages_authenticator_static.staticdevice
      - authentik_stages_authenticator_totp.authenticatortotpstage
      - authentik_stages_authenticator_totp.totpdevice
      - authentik_stages_authenticator_validate.authenticatorvalidatestage
      - authentik_stages_authenticator_webauthn.authenticatorwebauthnstage
      - authentik_stages_authenticator_webauthn.webauthndevice
      - authentik_stages_captcha.captchastage
      - authentik_stages_consent.consentstage
      - authentik_stages_deny.denystage
      - authentik_stages_dummy.dummystage
      - authentik_stages_email.emailstage
      - authentik_stages_identification.identificationstage
      - authentik_stages_invitation.invitationstage
      - authentik_stages_invitation.invitation
      - authentik_stages_password.passwordstage
      - authentik_stages_prompt.prompt
      - authentik_stages_prompt.promptstage
      - authentik_stages_redirect.redirectstage
      - authentik_stages_user_delete.userdeletestage
      - authentik_stages_user_login.userloginstage
      - authentik_stages_user_logout.userlogoutstage
      - authentik_stages_user_write.userwritestage
      - authentik_tasks_schedules.schedule
      - authentik_brands.brand
      - authentik_blueprints.blueprintinstance
      - authentik_policies_unique_password.uniquepasswordpolicy
      - authentik_providers_google_workspace.googleworkspaceprovider
      - authentik_providers_google_workspace.googleworkspaceprovidermapping
      - authentik_providers_microsoft_entra.microsoftentraprovider
      - authentik_providers_microsoft_entra.microsoftentraprovidermapping
      - authentik_providers_ssf.ssfprovider
      - authentik_stages_authenticator_endpoint_gdtc.authenticatorendpointgdtcstage
      - authentik_stages_mtls.mutualtlsstage
      - authentik_stages_source.sourcestage
      type: string
    MutualTLSStage:
      type: object
      description: MutualTLSStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        mode:
          $ref: '#/components/schemas/MutualTLSStageModeEnum'
        certificate_authorities:
          type: array
          items:
            type: string
            format: uuid
          description: Configure certificate authorities to validate the certificate
            against. This option has a higher priority than the `client_certificate`
            option on `Brand`.
        cert_attribute:
          $ref: '#/components/schemas/CertAttributeEnum'
        user_attribute:
          $ref: '#/components/schemas/UserAttributeEnum'
      required:
      - cert_attribute
      - component
      - meta_model_name
      - mode
      - name
      - pk
      - user_attribute
      - verbose_name
      - verbose_name_plural
    MutualTLSStageModeEnum:
      enum:
      - optional
      - required
      type: string
    MutualTLSStageRequest:
      type: object
      description: MutualTLSStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        mode:
          $ref: '#/components/schemas/MutualTLSStageModeEnum'
        certificate_authorities:
          type: array
          items:
            type: string
            format: uuid
          description: Configure certificate authorities to validate the certificate
            against. This option has a higher priority than the `client_certificate`
            option on `Brand`.
        cert_attribute:
          $ref: '#/components/schemas/CertAttributeEnum'
        user_attribute:
          $ref: '#/components/schemas/UserAttributeEnum'
      required:
      - cert_attribute
      - mode
      - name
      - user_attribute
    NativeLogoutChallenge:
      type: object
      description: Challenge for native browser logout
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-provider-saml-native-logout
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        post_url:
          type: string
        saml_request:
          type: string
        relay_state:
          type: string
        provider_name:
          type: string
        binding:
          type: string
        redirect_url:
          type: string
        is_complete:
          type: boolean
          default: false
    NativeLogoutChallengeResponseRequest:
      type: object
      description: Response for native browser logout
      properties:
        component:
          type: string
          minLength: 1
          default: ak-provider-saml-native-logout
    Network:
      type: object
      properties:
        hostname:
          type: string
        firewall_enabled:
          type: boolean
        interfaces:
          type: array
          items:
            $ref: '#/components/schemas/NetworkInterface'
        gateway:
          type: string
      required:
      - hostname
      - interfaces
    NetworkBindingEnum:
      enum:
      - no_binding
      - bind_asn
      - bind_asn_network
      - bind_asn_network_ip
      type: string
    NetworkInterface:
      type: object
      properties:
        name:
          type: string
        hardware_address:
          type: string
        ip_addresses:
          type: array
          items:
            type: string
        dns_servers:
          type: array
          items:
            type: string
      required:
      - hardware_address
      - name
    NetworkInterfaceRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
        hardware_address:
          type: string
          minLength: 1
        ip_addresses:
          type: array
          items:
            type: string
            minLength: 1
        dns_servers:
          type: array
          items:
            type: string
            minLength: 1
      required:
      - hardware_address
      - name
    NetworkRequest:
      type: object
      properties:
        hostname:
          type: string
          minLength: 1
        firewall_enabled:
          type: boolean
        interfaces:
          type: array
          items:
            $ref: '#/components/schemas/NetworkInterfaceRequest'
        gateway:
          type: string
          minLength: 1
      required:
      - hostname
      - interfaces
    NotConfiguredActionEnum:
      enum:
      - skip
      - deny
      - configure
      type: string
    Notification:
      type: object
      description: Notification Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Uuid
        severity:
          allOf:
          - $ref: '#/components/schemas/SeverityEnum'
          readOnly: true
        body:
          type: string
          readOnly: true
        created:
          type: string
          format: date-time
          readOnly: true
        event:
          $ref: '#/components/schemas/Event'
        seen:
          type: boolean
      required:
      - body
      - created
      - pk
      - severity
    NotificationRequest:
      type: object
      description: Notification Serializer
      properties:
        event:
          $ref: '#/components/schemas/EventRequest'
        seen:
          type: boolean
    NotificationRule:
      type: object
      description: NotificationRule Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pbm uuid
        name:
          type: string
        transports:
          type: array
          items:
            type: string
            format: uuid
          description: Select which transports should be used to notify the user.
            If none are selected, the notification will only be shown in the authentik
            UI.
        severity:
          allOf:
          - $ref: '#/components/schemas/SeverityEnum'
          description: Controls which severity level the created notifications will
            have.
        destination_group:
          type: string
          format: uuid
          nullable: true
          description: Define which group of users this notification should be sent
            and shown to. If left empty, Notification won't ben sent.
        destination_group_obj:
          allOf:
          - $ref: '#/components/schemas/Group'
          readOnly: true
        destination_event_user:
          type: boolean
          description: When enabled, notification will be sent to user the user that
            triggered the event.When destination_group is configured, notification
            is sent to both.
      required:
      - destination_group_obj
      - name
      - pk
    NotificationRuleRequest:
      type: object
      description: NotificationRule Serializer
      properties:
        name:
          type: string
          minLength: 1
        transports:
          type: array
          items:
            type: string
            format: uuid
          description: Select which transports should be used to notify the user.
            If none are selected, the notification will only be shown in the authentik
            UI.
        severity:
          allOf:
          - $ref: '#/components/schemas/SeverityEnum'
          description: Controls which severity level the created notifications will
            have.
        destination_group:
          type: string
          format: uuid
          nullable: true
          description: Define which group of users this notification should be sent
            and shown to. If left empty, Notification won't ben sent.
        destination_event_user:
          type: boolean
          description: When enabled, notification will be sent to user the user that
            triggered the event.When destination_group is configured, notification
            is sent to both.
      required:
      - name
    NotificationTransport:
      type: object
      description: NotificationTransport Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Uuid
        name:
          type: string
        mode:
          $ref: '#/components/schemas/NotificationTransportModeEnum'
        mode_verbose:
          type: string
          description: Return selected mode with a UI Label
          readOnly: true
        webhook_url:
          type: string
          format: uri
        webhook_mapping_body:
          type: string
          format: uuid
          nullable: true
          description: Customize the body of the request. Mapping should return data
            that is JSON-serializable.
        webhook_mapping_headers:
          type: string
          format: uuid
          nullable: true
          description: Configure additional headers to be sent. Mapping should return
            a dictionary of key-value pairs
        email_subject_prefix:
          type: string
        email_template:
          type: string
        send_once:
          type: boolean
          description: Only send notification once, for example when sending a webhook
            into a chat channel.
      required:
      - mode_verbose
      - name
      - pk
    NotificationTransportModeEnum:
      enum:
      - local
      - webhook
      - webhook_slack
      - email
      type: string
    NotificationTransportRequest:
      type: object
      description: NotificationTransport Serializer
      properties:
        name:
          type: string
          minLength: 1
        mode:
          $ref: '#/components/schemas/NotificationTransportModeEnum'
        webhook_url:
          type: string
          format: uri
        webhook_mapping_body:
          type: string
          format: uuid
          nullable: true
          description: Customize the body of the request. Mapping should return data
            that is JSON-serializable.
        webhook_mapping_headers:
          type: string
          format: uuid
          nullable: true
          description: Configure additional headers to be sent. Mapping should return
            a dictionary of key-value pairs
        email_subject_prefix:
          type: string
        email_template:
          type: string
          minLength: 1
        send_once:
          type: boolean
          description: Only send notification once, for example when sending a webhook
            into a chat channel.
      required:
      - name
    NotificationTransportTest:
      type: object
      description: Notification test serializer
      properties:
        messages:
          type: array
          items:
            type: string
      required:
      - messages
    NotificationWebhookMapping:
      type: object
      description: NotificationWebhookMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        name:
          type: string
        expression:
          type: string
      required:
      - expression
      - name
      - pk
    NotificationWebhookMappingRequest:
      type: object
      description: NotificationWebhookMapping Serializer
      properties:
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
      required:
      - expression
      - name
    OAuth2Provider:
      type: object
      description: OAuth2Provider Serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        assigned_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        assigned_backchannel_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_backchannel_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        client_type:
          allOf:
          - $ref: '#/components/schemas/ClientTypeEnum'
          description: Confidential clients are capable of maintaining the confidentiality
            of their credentials. Public clients are incapable
        client_id:
          type: string
          maxLength: 255
        client_secret:
          type: string
          maxLength: 255
        access_code_validity:
          type: string
          description: 'Access codes not valid on or after current time + this value
            (Format: hours=1;minutes=2;seconds=3).'
        access_token_validity:
          type: string
          description: 'Tokens not valid on or after current time + this value (Format:
            hours=1;minutes=2;seconds=3).'
        refresh_token_validity:
          type: string
          description: 'Tokens not valid on or after current time + this value (Format:
            hours=1;minutes=2;seconds=3).'
        refresh_token_threshold:
          type: string
          description: 'When refreshing a token, if the refresh token is valid for
            less than this duration, it will be renewed. When set to seconds=0, token
            will always be renewed. (Format: hours=1;minutes=2;seconds=3).'
        include_claims_in_id_token:
          type: boolean
          description: Include User claims from scopes in the id_token, for applications
            that don't access the userinfo endpoint.
        signing_key:
          type: string
          format: uuid
          nullable: true
          description: Key used to sign the tokens.
        encryption_key:
          type: string
          format: uuid
          nullable: true
          description: Key used to encrypt the tokens. When set, tokens will be encrypted
            and returned as JWEs.
        redirect_uris:
          type: array
          items:
            $ref: '#/components/schemas/RedirectURI'
        logout_uri:
          type: string
          format: uri
        logout_method:
          allOf:
          - $ref: '#/components/schemas/OAuth2ProviderLogoutMethodEnum'
          description: Backchannel logs out with server to server calls. Frontchannel
            uses iframes in your browser
        sub_mode:
          allOf:
          - $ref: '#/components/schemas/SubModeEnum'
          description: Configure what data should be used as unique User Identifier.
            For most cases, the default should be fine.
        issuer_mode:
          allOf:
          - $ref: '#/components/schemas/IssuerModeEnum'
          description: Configure how the issuer field of the ID Token should be filled.
        jwt_federation_sources:
          type: array
          items:
            type: string
            format: uuid
            title: Any JWT signed by the JWK of the selected source can be used to
              authenticate.
          title: Any JWT signed by the JWK of the selected source can be used to authenticate.
        jwt_federation_providers:
          type: array
          items:
            type: integer
      required:
      - assigned_application_name
      - assigned_application_slug
      - assigned_backchannel_application_name
      - assigned_backchannel_application_slug
      - authorization_flow
      - component
      - invalidation_flow
      - meta_model_name
      - name
      - pk
      - redirect_uris
      - verbose_name
      - verbose_name_plural
    OAuth2ProviderLogoutMethodEnum:
      enum:
      - backchannel
      - frontchannel
      type: string
    OAuth2ProviderRequest:
      type: object
      description: OAuth2Provider Serializer
      properties:
        name:
          type: string
          minLength: 1
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        client_type:
          allOf:
          - $ref: '#/components/schemas/ClientTypeEnum'
          description: Confidential clients are capable of maintaining the confidentiality
            of their credentials. Public clients are incapable
        client_id:
          type: string
          minLength: 1
          maxLength: 255
        client_secret:
          type: string
          maxLength: 255
        access_code_validity:
          type: string
          minLength: 1
          description: 'Access codes not valid on or after current time + this value
            (Format: hours=1;minutes=2;seconds=3).'
        access_token_validity:
          type: string
          minLength: 1
          description: 'Tokens not valid on or after current time + this value (Format:
            hours=1;minutes=2;seconds=3).'
        refresh_token_validity:
          type: string
          minLength: 1
          description: 'Tokens not valid on or after current time + this value (Format:
            hours=1;minutes=2;seconds=3).'
        refresh_token_threshold:
          type: string
          minLength: 1
          description: 'When refreshing a token, if the refresh token is valid for
            less than this duration, it will be renewed. When set to seconds=0, token
            will always be renewed. (Format: hours=1;minutes=2;seconds=3).'
        include_claims_in_id_token:
          type: boolean
          description: Include User claims from scopes in the id_token, for applications
            that don't access the userinfo endpoint.
        signing_key:
          type: string
          format: uuid
          nullable: true
          description: Key used to sign the tokens.
        encryption_key:
          type: string
          format: uuid
          nullable: true
          description: Key used to encrypt the tokens. When set, tokens will be encrypted
            and returned as JWEs.
        redirect_uris:
          type: array
          items:
            $ref: '#/components/schemas/RedirectURIRequest'
        logout_uri:
          type: string
          format: uri
        logout_method:
          allOf:
          - $ref: '#/components/schemas/OAuth2ProviderLogoutMethodEnum'
          description: Backchannel logs out with server to server calls. Frontchannel
            uses iframes in your browser
        sub_mode:
          allOf:
          - $ref: '#/components/schemas/SubModeEnum'
          description: Configure what data should be used as unique User Identifier.
            For most cases, the default should be fine.
        issuer_mode:
          allOf:
          - $ref: '#/components/schemas/IssuerModeEnum'
          description: Configure how the issuer field of the ID Token should be filled.
        jwt_federation_sources:
          type: array
          items:
            type: string
            format: uuid
            title: Any JWT signed by the JWK of the selected source can be used to
              authenticate.
          title: Any JWT signed by the JWK of the selected source can be used to authenticate.
        jwt_federation_providers:
          type: array
          items:
            type: integer
      required:
      - authorization_flow
      - invalidation_flow
      - name
      - redirect_uris
    OAuth2ProviderSetupURLs:
      type: object
      description: OAuth2 Provider Metadata serializer
      properties:
        issuer:
          type: string
          readOnly: true
        authorize:
          type: string
          readOnly: true
        token:
          type: string
          readOnly: true
        user_info:
          type: string
          readOnly: true
        provider_info:
          type: string
          readOnly: true
        logout:
          type: string
          readOnly: true
        jwks:
          type: string
          readOnly: true
      required:
      - authorize
      - issuer
      - jwks
      - logout
      - provider_info
      - token
      - user_info
    OAuthDeviceCodeChallenge:
      type: object
      description: OAuth Device code challenge
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-provider-oauth2-device-code
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
    OAuthDeviceCodeChallengeResponseRequest:
      type: object
      description: Response that includes the user-entered device code
      properties:
        component:
          type: string
          minLength: 1
          default: ak-provider-oauth2-device-code
        code:
          type: string
          minLength: 1
      required:
      - code
    OAuthDeviceCodeFinishChallenge:
      type: object
      description: Final challenge after user enters their code
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-provider-oauth2-device-code-finish
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
    OAuthDeviceCodeFinishChallengeResponseRequest:
      type: object
      description: Response that device has been authenticated and tab can be closed
      properties:
        component:
          type: string
          minLength: 1
          default: ak-provider-oauth2-device-code-finish
    OAuthSource:
      type: object
      description: OAuth Source Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pbm uuid
        name:
          type: string
          description: Source's display Name.
        slug:
          type: string
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
          readOnly: true
        user_path_template:
          type: string
        icon:
          type: string
          nullable: true
          readOnly: true
        group_matching_mode:
          allOf:
          - $ref: '#/components/schemas/GroupMatchingModeEnum'
          description: How the source determines if an existing group should be used
            or a new group created.
        provider_type:
          $ref: '#/components/schemas/ProviderTypeEnum'
        request_token_url:
          type: string
          nullable: true
          description: URL used to request the initial token. This URL is only required
            for OAuth 1.
          maxLength: 255
        authorization_url:
          type: string
          nullable: true
          description: URL the user is redirect to to conest the flow.
          maxLength: 255
        access_token_url:
          type: string
          nullable: true
          description: URL used by authentik to retrieve tokens.
          maxLength: 255
        profile_url:
          type: string
          nullable: true
          description: URL used by authentik to get user information.
          maxLength: 255
        pkce:
          $ref: '#/components/schemas/PKCEMethodEnum'
        consumer_key:
          type: string
        callback_url:
          type: string
          description: Get OAuth Callback URL
          readOnly: true
        additional_scopes:
          type: string
        type:
          allOf:
          - $ref: '#/components/schemas/SourceType'
          readOnly: true
        oidc_well_known_url:
          type: string
        oidc_jwks_url:
          type: string
        oidc_jwks:
          type: object
          additionalProperties: {}
        authorization_code_auth_method:
          allOf:
          - $ref: '#/components/schemas/AuthorizationCodeAuthMethodEnum'
          description: How to perform authentication during an authorization_code
            token request flow
      required:
      - callback_url
      - component
      - consumer_key
      - icon
      - managed
      - meta_model_name
      - name
      - pk
      - provider_type
      - slug
      - type
      - verbose_name
      - verbose_name_plural
    OAuthSourcePropertyMapping:
      type: object
      description: OAuthSourcePropertyMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
        expression:
          type: string
        component:
          type: string
          description: Get object's component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
      required:
      - component
      - expression
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    OAuthSourcePropertyMappingRequest:
      type: object
      description: OAuthSourcePropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
      required:
      - expression
      - name
    OAuthSourceRequest:
      type: object
      description: OAuth Source Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Source's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        user_path_template:
          type: string
          minLength: 1
        group_matching_mode:
          allOf:
          - $ref: '#/components/schemas/GroupMatchingModeEnum'
          description: How the source determines if an existing group should be used
            or a new group created.
        provider_type:
          $ref: '#/components/schemas/ProviderTypeEnum'
        request_token_url:
          type: string
          nullable: true
          description: URL used to request the initial token. This URL is only required
            for OAuth 1.
          maxLength: 255
        authorization_url:
          type: string
          nullable: true
          description: URL the user is redirect to to conest the flow.
          maxLength: 255
        access_token_url:
          type: string
          nullable: true
          description: URL used by authentik to retrieve tokens.
          maxLength: 255
        profile_url:
          type: string
          nullable: true
          description: URL used by authentik to get user information.
          maxLength: 255
        pkce:
          $ref: '#/components/schemas/PKCEMethodEnum'
        consumer_key:
          type: string
          minLength: 1
        consumer_secret:
          type: string
          writeOnly: true
          minLength: 1
        additional_scopes:
          type: string
        oidc_well_known_url:
          type: string
        oidc_jwks_url:
          type: string
        oidc_jwks:
          type: object
          additionalProperties: {}
        authorization_code_auth_method:
          allOf:
          - $ref: '#/components/schemas/AuthorizationCodeAuthMethodEnum'
          description: How to perform authentication during an authorization_code
            token request flow
      required:
      - consumer_key
      - consumer_secret
      - name
      - provider_type
      - slug
    OpenIDConnectConfiguration:
      type: object
      description: rest_framework Serializer for OIDC Configuration
      properties:
        issuer:
          type: string
        authorization_endpoint:
          type: string
        token_endpoint:
          type: string
        userinfo_endpoint:
          type: string
        end_session_endpoint:
          type: string
        introspection_endpoint:
          type: string
        jwks_uri:
          type: string
        response_types_supported:
          type: array
          items:
            type: string
        id_token_signing_alg_values_supported:
          type: array
          items:
            type: string
        subject_types_supported:
          type: array
          items:
            type: string
        token_endpoint_auth_methods_supported:
          type: array
          items:
            type: string
      required:
      - authorization_endpoint
      - end_session_endpoint
      - id_token_signing_alg_values_supported
      - introspection_endpoint
      - issuer
      - jwks_uri
      - response_types_supported
      - subject_types_supported
      - token_endpoint
      - token_endpoint_auth_methods_supported
      - userinfo_endpoint
    OperatingSystem:
      type: object
      properties:
        family:
          $ref: '#/components/schemas/DeviceFactsOSFamily'
        name:
          type: string
        version:
          type: string
        arch:
          type: string
      required:
      - arch
      - family
    OperatingSystemRequest:
      type: object
      properties:
        family:
          $ref: '#/components/schemas/DeviceFactsOSFamily'
        name:
          type: string
          minLength: 1
        version:
          type: string
          minLength: 1
        arch:
          type: string
          minLength: 1
      required:
      - arch
      - family
    OutgoingSyncDeleteAction:
      enum:
      - do_nothing
      - delete
      - suspend
      type: string
    Outpost:
      type: object
      description: Outpost Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Uuid
        name:
          type: string
        type:
          $ref: '#/components/schemas/OutpostTypeEnum'
        providers:
          type: array
          items:
            type: integer
        providers_obj:
          type: array
          items:
            $ref: '#/components/schemas/Provider'
          readOnly: true
        service_connection:
          type: string
          format: uuid
          nullable: true
          description: Select Service-Connection authentik should use to manage this
            outpost. Leave empty if authentik should not handle the deployment.
        service_connection_obj:
          allOf:
          - $ref: '#/components/schemas/ServiceConnection'
          readOnly: true
        refresh_interval_s:
          type: integer
          readOnly: true
        token_identifier:
          type: string
          description: Get Token identifier
          readOnly: true
        config:
          type: object
          additionalProperties: {}
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
      required:
      - config
      - name
      - pk
      - providers
      - providers_obj
      - refresh_interval_s
      - service_connection_obj
      - token_identifier
      - type
    OutpostDefaultConfig:
      type: object
      description: Global default outpost config
      properties:
        config:
          type: object
          additionalProperties: {}
          readOnly: true
      required:
      - config
    OutpostHealth:
      type: object
      description: Outpost health status
      properties:
        uid:
          type: string
          readOnly: true
        last_seen:
          type: string
          format: date-time
          readOnly: true
        version:
          type: string
          readOnly: true
        golang_version:
          type: string
          readOnly: true
        openssl_enabled:
          type: boolean
          readOnly: true
        openssl_version:
          type: string
          readOnly: true
        fips_enabled:
          type: boolean
          nullable: true
          description: Get FIPS enabled
          readOnly: true
        version_should:
          type: string
          readOnly: true
        version_outdated:
          type: boolean
          readOnly: true
        build_hash:
          type: string
          readOnly: true
        build_hash_should:
          type: string
          readOnly: true
        hostname:
          type: string
          readOnly: true
      required:
      - build_hash
      - build_hash_should
      - fips_enabled
      - golang_version
      - hostname
      - last_seen
      - openssl_enabled
      - openssl_version
      - uid
      - version
      - version_outdated
      - version_should
    OutpostRequest:
      type: object
      description: Outpost Serializer
      properties:
        name:
          type: string
          minLength: 1
        type:
          $ref: '#/components/schemas/OutpostTypeEnum'
        providers:
          type: array
          items:
            type: integer
        service_connection:
          type: string
          format: uuid
          nullable: true
          description: Select Service-Connection authentik should use to manage this
            outpost. Leave empty if authentik should not handle the deployment.
        config:
          type: object
          additionalProperties: {}
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
      required:
      - config
      - name
      - providers
      - type
    OutpostTypeEnum:
      enum:
      - proxy
      - ldap
      - radius
      - rac
      type: string
    PKCEMethodEnum:
      enum:
      - none
      - plain
      - S256
      type: string
    PaginatedAgentConnectorList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/AgentConnector'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedApplicationEntitlementList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/ApplicationEntitlement'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedApplicationList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Application'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedAuthenticatedSessionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/AuthenticatedSession'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedAuthenticatorDuoStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/AuthenticatorDuoStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedAuthenticatorEmailStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/AuthenticatorEmailStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedAuthenticatorEndpointGDTCStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/AuthenticatorEndpointGDTCStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedAuthenticatorSMSStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/AuthenticatorSMSStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedAuthenticatorStaticStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/AuthenticatorStaticStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedAuthenticatorTOTPStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/AuthenticatorTOTPStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedAuthenticatorValidateStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/AuthenticatorValidateStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedAuthenticatorWebAuthnStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/AuthenticatorWebAuthnStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedBlueprintInstanceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/BlueprintInstance'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedBrandList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Brand'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedCaptchaStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/CaptchaStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedCertificateKeyPairList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/CertificateKeyPair'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedConnectionTokenList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/ConnectionToken'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedConnectorList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Connector'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedConsentStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/ConsentStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedDenyStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/DenyStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedDeviceAccessGroupList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/DeviceAccessGroup'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedDockerServiceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/DockerServiceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedDomainList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Domain'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedDummyPolicyList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/DummyPolicy'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedDummyStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/DummyStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedDuoDeviceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/DuoDevice'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedEmailDeviceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/EmailDevice'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedEmailStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/EmailStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedEndpointDeviceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/EndpointDevice'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedEndpointList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Endpoint'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedEnrollmentTokenList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/EnrollmentToken'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedEventList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Event'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedEventMatcherPolicyList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/EventMatcherPolicy'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedExpiringBaseGrantModelList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/ExpiringBaseGrantModel'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedExpressionPolicyList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/ExpressionPolicy'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedExtraRoleObjectPermissionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/ExtraRoleObjectPermission'
      required:
      - pagination
      - results
    PaginatedExtraUserObjectPermissionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/ExtraUserObjectPermission'
      required:
      - pagination
      - results
    PaginatedFlowList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Flow'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedFlowStageBindingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/FlowStageBinding'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedGeoIPPolicyList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/GeoIPPolicy'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedGoogleEndpointDeviceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/GoogleEndpointDevice'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedGoogleWorkspaceProviderGroupList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/GoogleWorkspaceProviderGroup'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedGoogleWorkspaceProviderList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/GoogleWorkspaceProvider'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedGoogleWorkspaceProviderMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/GoogleWorkspaceProviderMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedGoogleWorkspaceProviderUserList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/GoogleWorkspaceProviderUser'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedGroupKerberosSourceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/GroupKerberosSourceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedGroupLDAPSourceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/GroupLDAPSourceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedGroupList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Group'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedGroupOAuthSourceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/GroupOAuthSourceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedGroupPlexSourceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/GroupPlexSourceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedGroupSAMLSourceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/GroupSAMLSourceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedGroupSourceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/GroupSourceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedGroupTelegramSourceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/GroupTelegramSourceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedIdentificationStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/IdentificationStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedInitialPermissionsList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/InitialPermissions'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedInvitationList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Invitation'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedInvitationStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/InvitationStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedKerberosSourceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/KerberosSource'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedKerberosSourcePropertyMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/KerberosSourcePropertyMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedKubernetesServiceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/KubernetesServiceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedLDAPOutpostConfigList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/LDAPOutpostConfig'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedLDAPProviderList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/LDAPProvider'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedLDAPSourceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/LDAPSource'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedLDAPSourcePropertyMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/LDAPSourcePropertyMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedLicenseList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/License'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedMicrosoftEntraProviderGroupList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/MicrosoftEntraProviderGroup'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedMicrosoftEntraProviderList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/MicrosoftEntraProvider'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedMicrosoftEntraProviderMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/MicrosoftEntraProviderMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedMicrosoftEntraProviderUserList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/MicrosoftEntraProviderUser'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedMutualTLSStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/MutualTLSStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedNotificationList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Notification'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedNotificationRuleList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/NotificationRule'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedNotificationTransportList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/NotificationTransport'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedNotificationWebhookMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/NotificationWebhookMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedOAuth2ProviderList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/OAuth2Provider'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedOAuthSourceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/OAuthSource'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedOAuthSourcePropertyMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/OAuthSourcePropertyMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedOutpostList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Outpost'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedPasswordExpiryPolicyList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/PasswordExpiryPolicy'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedPasswordPolicyList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/PasswordPolicy'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedPasswordStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/PasswordStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedPermissionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Permission'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedPlexSourceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/PlexSource'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedPlexSourcePropertyMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/PlexSourcePropertyMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedPolicyBindingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/PolicyBinding'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedPolicyList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Policy'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedPromptList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Prompt'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedPromptStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/PromptStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedPropertyMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/PropertyMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedProviderList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Provider'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedProxyOutpostConfigList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/ProxyOutpostConfig'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedProxyProviderList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/ProxyProvider'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedRACPropertyMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/RACPropertyMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedRACProviderList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/RACProvider'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedRadiusOutpostConfigList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/RadiusOutpostConfig'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedRadiusProviderList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/RadiusProvider'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedRadiusProviderPropertyMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/RadiusProviderPropertyMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedRedirectStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/RedirectStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedReputationList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Reputation'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedReputationPolicyList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/ReputationPolicy'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedRoleAssignedObjectPermissionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/RoleAssignedObjectPermission'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedRoleList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Role'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSAMLPropertyMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SAMLPropertyMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSAMLProviderList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SAMLProvider'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSAMLSourceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SAMLSource'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSAMLSourcePropertyMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SAMLSourcePropertyMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSCIMMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SCIMMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSCIMProviderGroupList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SCIMProviderGroup'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSCIMProviderList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SCIMProvider'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSCIMProviderUserList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SCIMProviderUser'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSCIMSourceGroupList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SCIMSourceGroup'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSCIMSourceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SCIMSource'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSCIMSourcePropertyMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SCIMSourcePropertyMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSCIMSourceUserList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SCIMSourceUser'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSMSDeviceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SMSDevice'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSSFProviderList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SSFProvider'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSSFStreamList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SSFStream'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedScheduleList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Schedule'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedScopeMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/ScopeMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedServiceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/ServiceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSourceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Source'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedSourceStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/SourceStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Stage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedStaticDeviceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/StaticDevice'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedTOTPDeviceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/TOTPDevice'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedTaskList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Task'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedTelegramSourceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/TelegramSource'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedTelegramSourcePropertyMappingList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/TelegramSourcePropertyMapping'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedTenantList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Tenant'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedTokenList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/Token'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedTokenModelList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/TokenModel'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedUniquePasswordPolicyList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/UniquePasswordPolicy'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedUserAssignedObjectPermissionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/UserAssignedObjectPermission'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedUserConsentList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/UserConsent'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedUserDeleteStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/UserDeleteStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedUserKerberosSourceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/UserKerberosSourceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedUserLDAPSourceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/UserLDAPSourceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedUserList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/User'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedUserLoginStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/UserLoginStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedUserLogoutStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/UserLogoutStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedUserOAuthSourceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/UserOAuthSourceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedUserPlexSourceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/UserPlexSourceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedUserSAMLSourceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/UserSAMLSourceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedUserSourceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/UserSourceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedUserTelegramSourceConnectionList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/UserTelegramSourceConnection'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedUserWriteStageList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/UserWriteStage'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedWebAuthnDeviceList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/WebAuthnDevice'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    PaginatedWebAuthnDeviceTypeList:
      type: object
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        results:
          type: array
          items:
            $ref: '#/components/schemas/WebAuthnDeviceType'
        autocomplete:
          $ref: '#/components/schemas/Autocomplete'
      required:
      - pagination
      - results
      - autocomplete
    Pagination:
      type: object
      properties:
        next:
          type: number
        previous:
          type: number
        count:
          type: number
        current:
          type: number
        total_pages:
          type: number
        start_index:
          type: number
        end_index:
          type: number
      required:
      - count
      - current
      - end_index
      - next
      - previous
      - start_index
      - total_pages
    PartialGroup:
      type: object
      description: Partial Group Serializer, does not include child relations.
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Group uuid
        num_pk:
          type: integer
          description: Get a numerical, int32 ID for the group
          readOnly: true
        name:
          type: string
        is_superuser:
          type: boolean
          description: Users added to this group will be superusers.
        parent:
          type: string
          format: uuid
          nullable: true
        parent_name:
          type: string
          readOnly: true
          nullable: true
        attributes:
          type: object
          additionalProperties: {}
      required:
      - name
      - num_pk
      - parent_name
      - pk
    PartialUser:
      type: object
      description: Partial User Serializer, does not include child relations.
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        username:
          type: string
          description: Required. 150 characters or fewer. Letters, digits and @/./+/-/_
            only.
          pattern: ^[\w.@+-]+$
          maxLength: 150
        name:
          type: string
          description: User's display name.
        is_active:
          type: boolean
          title: Active
          description: Designates whether this user should be treated as active. Unselect
            this instead of deleting accounts.
        last_login:
          type: string
          format: date-time
          nullable: true
        email:
          type: string
          format: email
          title: Email address
          maxLength: 254
        attributes:
          type: object
          additionalProperties: {}
        uid:
          type: string
          readOnly: true
      required:
      - name
      - pk
      - uid
      - username
    PasswordChallenge:
      type: object
      description: Password challenge UI fields
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-password
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        pending_user:
          type: string
        pending_user_avatar:
          type: string
        recovery_url:
          type: string
        allow_show_password:
          type: boolean
          default: false
      required:
      - pending_user
      - pending_user_avatar
    PasswordChallengeResponseRequest:
      type: object
      description: Password challenge response
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-password
        password:
          type: string
          minLength: 1
      required:
      - password
    PasswordExpiryPolicy:
      type: object
      description: Password Expiry Policy Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Policy uuid
        name:
          type: string
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        bound_to:
          type: integer
          description: Return objects policy is bound to
          readOnly: true
        days:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        deny_only:
          type: boolean
      required:
      - bound_to
      - component
      - days
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    PasswordExpiryPolicyRequest:
      type: object
      description: Password Expiry Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        days:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        deny_only:
          type: boolean
      required:
      - days
      - name
    PasswordPolicy:
      type: object
      description: Password Policy Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Policy uuid
        name:
          type: string
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        bound_to:
          type: integer
          description: Return objects policy is bound to
          readOnly: true
        password_field:
          type: string
          description: Field key to check, field keys defined in Prompt stages are
            available.
        amount_digits:
          type: integer
          maximum: 2147483647
          minimum: 0
        amount_uppercase:
          type: integer
          maximum: 2147483647
          minimum: 0
        amount_lowercase:
          type: integer
          maximum: 2147483647
          minimum: 0
        amount_symbols:
          type: integer
          maximum: 2147483647
          minimum: 0
        length_min:
          type: integer
          maximum: 2147483647
          minimum: 0
        symbol_charset:
          type: string
        error_message:
          type: string
        check_static_rules:
          type: boolean
        check_have_i_been_pwned:
          type: boolean
        check_zxcvbn:
          type: boolean
        hibp_allowed_count:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: How many times the password hash is allowed to be on haveibeenpwned
        zxcvbn_score_threshold:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: If the zxcvbn score is equal or less than this value, the policy
            will fail.
      required:
      - bound_to
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    PasswordPolicyRequest:
      type: object
      description: Password Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        password_field:
          type: string
          minLength: 1
          description: Field key to check, field keys defined in Prompt stages are
            available.
        amount_digits:
          type: integer
          maximum: 2147483647
          minimum: 0
        amount_uppercase:
          type: integer
          maximum: 2147483647
          minimum: 0
        amount_lowercase:
          type: integer
          maximum: 2147483647
          minimum: 0
        amount_symbols:
          type: integer
          maximum: 2147483647
          minimum: 0
        length_min:
          type: integer
          maximum: 2147483647
          minimum: 0
        symbol_charset:
          type: string
          minLength: 1
        error_message:
          type: string
        check_static_rules:
          type: boolean
        check_have_i_been_pwned:
          type: boolean
        check_zxcvbn:
          type: boolean
        hibp_allowed_count:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: How many times the password hash is allowed to be on haveibeenpwned
        zxcvbn_score_threshold:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: If the zxcvbn score is equal or less than this value, the policy
            will fail.
      required:
      - name
    PasswordStage:
      type: object
      description: PasswordStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        backends:
          type: array
          items:
            $ref: '#/components/schemas/BackendsEnum'
          description: Selection of backends to test the password against.
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        failed_attempts_before_cancel:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: How many attempts a user has before the flow is canceled. To
            lock the user out, use a reputation policy and a user_write stage.
        allow_show_password:
          type: boolean
          description: When enabled, provides a 'show password' button with the password
            input field.
      required:
      - backends
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    PasswordStageRequest:
      type: object
      description: PasswordStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        backends:
          type: array
          items:
            $ref: '#/components/schemas/BackendsEnum'
          description: Selection of backends to test the password against.
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        failed_attempts_before_cancel:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: How many attempts a user has before the flow is canceled. To
            lock the user out, use a reputation policy and a user_write stage.
        allow_show_password:
          type: boolean
          description: When enabled, provides a 'show password' button with the password
            input field.
      required:
      - backends
      - name
    PatchedAgentConnectorRequest:
      type: object
      properties:
        connector_uuid:
          type: string
          format: uuid
        name:
          type: string
          minLength: 1
        enabled:
          type: boolean
        snapshot_expiry:
          type: string
          minLength: 1
        auth_terminate_session_on_expiry:
          type: boolean
        refresh_interval:
          type: string
          minLength: 1
        authorization_flow:
          type: string
          format: uuid
          nullable: true
        nss_uid_offset:
          type: integer
          maximum: 2147483647
          minimum: 0
        nss_gid_offset:
          type: integer
          maximum: 2147483647
          minimum: 0
        challenge_key:
          type: string
          format: uuid
          nullable: true
        jwt_federation_providers:
          type: array
          items:
            type: integer
    PatchedApplicationEntitlementRequest:
      type: object
      description: ApplicationEntitlement Serializer
      properties:
        name:
          type: string
          minLength: 1
        app:
          type: string
          format: uuid
        attributes:
          type: object
          additionalProperties: {}
    PatchedApplicationRequest:
      type: object
      description: Application Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Application's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal application name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        provider:
          type: integer
          nullable: true
        backchannel_providers:
          type: array
          items:
            type: integer
        open_in_new_tab:
          type: boolean
          description: Open launch URL in a new browser tab or window.
        meta_launch_url:
          type: string
          format: uri
        meta_description:
          type: string
        meta_publisher:
          type: string
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        group:
          type: string
    PatchedAuthenticatorDuoStageRequest:
      type: object
      description: AuthenticatorDuoStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        client_id:
          type: string
          minLength: 1
        client_secret:
          type: string
          writeOnly: true
          minLength: 1
        api_hostname:
          type: string
          minLength: 1
        admin_integration_key:
          type: string
        admin_secret_key:
          type: string
          writeOnly: true
    PatchedAuthenticatorEmailStageRequest:
      type: object
      description: AuthenticatorEmailStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        use_global_settings:
          type: boolean
          description: When enabled, global Email connection settings will be used
            and connection settings below will be ignored.
        host:
          type: string
          minLength: 1
        port:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        username:
          type: string
        password:
          type: string
        use_tls:
          type: boolean
        use_ssl:
          type: boolean
        timeout:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        from_address:
          type: string
          format: email
          minLength: 1
          maxLength: 254
        subject:
          type: string
          minLength: 1
        token_expiry:
          type: string
          minLength: 1
          description: 'Time the token sent is valid (Format: hours=3,minutes=17,seconds=300).'
        template:
          type: string
          minLength: 1
    PatchedAuthenticatorEndpointGDTCStageRequest:
      type: object
      description: AuthenticatorEndpointGDTCStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        credentials:
          type: object
          additionalProperties: {}
    PatchedAuthenticatorSMSStageRequest:
      type: object
      description: AuthenticatorSMSStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        provider:
          $ref: '#/components/schemas/ProviderEnum'
        from_number:
          type: string
          minLength: 1
        account_sid:
          type: string
          minLength: 1
        auth:
          type: string
          minLength: 1
        auth_password:
          type: string
        auth_type:
          $ref: '#/components/schemas/AuthTypeEnum'
        verify_only:
          type: boolean
          description: When enabled, the Phone number is only used during enrollment
            to verify the users authenticity. Only a hash of the phone number is saved
            to ensure it is not reused in the future.
        mapping:
          type: string
          format: uuid
          nullable: true
          description: Optionally modify the payload being sent to custom providers.
    PatchedAuthenticatorStaticStageRequest:
      type: object
      description: AuthenticatorStaticStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        token_count:
          type: integer
          maximum: 2147483647
          minimum: 0
        token_length:
          type: integer
          maximum: 2147483647
          minimum: 0
    PatchedAuthenticatorTOTPStageRequest:
      type: object
      description: AuthenticatorTOTPStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        digits:
          $ref: '#/components/schemas/DigitsEnum'
    PatchedAuthenticatorValidateStageRequest:
      type: object
      description: AuthenticatorValidateStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        not_configured_action:
          $ref: '#/components/schemas/NotConfiguredActionEnum'
        device_classes:
          type: array
          items:
            $ref: '#/components/schemas/DeviceClassesEnum'
          description: Device classes which can be used to authenticate
        configuration_stages:
          type: array
          items:
            type: string
            format: uuid
          description: Stages used to configure Authenticator when user doesn't have
            any compatible devices. After this configuration Stage passes, the user
            is not prompted again.
        last_auth_threshold:
          type: string
          minLength: 1
          description: If any of the user's device has been used within this threshold,
            this stage will be skipped
        webauthn_user_verification:
          allOf:
          - $ref: '#/components/schemas/UserVerificationEnum'
          description: Enforce user verification for WebAuthn devices.
        webauthn_allowed_device_types:
          type: array
          items:
            type: string
            format: uuid
    PatchedAuthenticatorWebAuthnStageRequest:
      type: object
      description: AuthenticatorWebAuthnStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        friendly_name:
          type: string
        user_verification:
          $ref: '#/components/schemas/UserVerificationEnum'
        authenticator_attachment:
          allOf:
          - $ref: '#/components/schemas/AuthenticatorAttachmentEnum'
          nullable: true
        resident_key_requirement:
          $ref: '#/components/schemas/ResidentKeyRequirementEnum'
        device_type_restrictions:
          type: array
          items:
            type: string
            format: uuid
        max_attempts:
          type: integer
          maximum: 2147483647
          minimum: 0
    PatchedBlueprintInstanceRequest:
      type: object
      description: Info about a single blueprint instance file
      properties:
        name:
          type: string
          minLength: 1
        path:
          type: string
          default: ''
        context:
          type: object
          additionalProperties: {}
        enabled:
          type: boolean
        content:
          type: string
    PatchedBrandRequest:
      type: object
      description: Brand Serializer
      properties:
        domain:
          type: string
          minLength: 1
          description: Domain that activates this brand. Can be a superset, i.e. `a.b`
            for `aa.b` and `ba.b`
        default:
          type: boolean
        branding_title:
          type: string
          minLength: 1
        branding_logo:
          type: string
          minLength: 1
        branding_favicon:
          type: string
          minLength: 1
        branding_custom_css:
          type: string
        branding_default_flow_background:
          type: string
          minLength: 1
        flow_authentication:
          type: string
          format: uuid
          nullable: true
        flow_invalidation:
          type: string
          format: uuid
          nullable: true
        flow_recovery:
          type: string
          format: uuid
          nullable: true
        flow_unenrollment:
          type: string
          format: uuid
          nullable: true
        flow_user_settings:
          type: string
          format: uuid
          nullable: true
        flow_device_code:
          type: string
          format: uuid
          nullable: true
        default_application:
          type: string
          format: uuid
          nullable: true
          description: When set, external users will be redirected to this application
            after authenticating.
        web_certificate:
          type: string
          format: uuid
          nullable: true
          description: Web Certificate used by the authentik Core webserver.
        client_certificates:
          type: array
          items:
            type: string
            format: uuid
          description: Certificates used for client authentication.
        attributes:
          type: object
          additionalProperties: {}
    PatchedCaptchaStageRequest:
      type: object
      description: CaptchaStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        public_key:
          type: string
          minLength: 1
          description: Public key, acquired your captcha Provider.
        private_key:
          type: string
          writeOnly: true
          minLength: 1
          description: Private key, acquired your captcha Provider.
        js_url:
          type: string
          minLength: 1
        api_url:
          type: string
          minLength: 1
        interactive:
          type: boolean
        score_min_threshold:
          type: number
          format: double
        score_max_threshold:
          type: number
          format: double
        error_on_invalid_score:
          type: boolean
          description: When enabled and the received captcha score is outside of the
            given threshold, the stage will show an error message. When not enabled,
            the flow will continue, but the data from the captcha will be available
            in the context for policy decisions
    PatchedCertificateKeyPairRequest:
      type: object
      description: CertificateKeyPair Serializer
      properties:
        name:
          type: string
          minLength: 1
        certificate_data:
          type: string
          writeOnly: true
          minLength: 1
          description: PEM-encoded Certificate data
        key_data:
          type: string
          writeOnly: true
          description: Optional Private Key. If this is set, you can use this keypair
            for encryption.
    PatchedConnectionTokenRequest:
      type: object
      description: ConnectionToken Serializer
      properties:
        pk:
          type: string
          format: uuid
          title: Connection token uuid
        provider:
          type: integer
        endpoint:
          type: string
          format: uuid
    PatchedConsentStageRequest:
      type: object
      description: ConsentStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        mode:
          $ref: '#/components/schemas/ConsentStageModeEnum'
        consent_expire_in:
          type: string
          minLength: 1
          title: Consent expires in
          description: 'Offset after which consent expires. (Format: hours=1;minutes=2;seconds=3).'
    PatchedDenyStageRequest:
      type: object
      description: DenyStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        deny_message:
          type: string
    PatchedDeviceAccessGroupRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
    PatchedDockerServiceConnectionRequest:
      type: object
      description: DockerServiceConnection Serializer
      properties:
        name:
          type: string
          minLength: 1
        local:
          type: boolean
          description: If enabled, use the local connection. Required Docker socket/Kubernetes
            Integration
        url:
          type: string
          minLength: 1
          description: Can be in the format of 'unix://<path>' when connecting to
            a local docker daemon, or 'https://<hostname>:2376' when connecting to
            a remote system.
        tls_verification:
          type: string
          format: uuid
          nullable: true
          description: CA which the endpoint's Certificate is verified against. Can
            be left empty for no validation.
        tls_authentication:
          type: string
          format: uuid
          nullable: true
          description: Certificate/Key used for authentication. Can be left empty
            for no authentication.
    PatchedDomainRequest:
      type: object
      description: Domain Serializer
      properties:
        domain:
          type: string
          minLength: 1
          maxLength: 253
        is_primary:
          type: boolean
        tenant:
          type: string
          format: uuid
    PatchedDummyPolicyRequest:
      type: object
      description: Dummy Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        result:
          type: boolean
        wait_min:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        wait_max:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
    PatchedDummyStageRequest:
      type: object
      description: DummyStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        throw_error:
          type: boolean
    PatchedDuoDeviceRequest:
      type: object
      description: Serializer for Duo authenticator devices
      properties:
        name:
          type: string
          minLength: 1
          description: The human-readable name of this device.
          maxLength: 64
    PatchedEmailDeviceRequest:
      type: object
      description: Serializer for email authenticator devices
      properties:
        name:
          type: string
          minLength: 1
          description: The human-readable name of this device.
          maxLength: 64
    PatchedEmailStageRequest:
      type: object
      description: EmailStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        use_global_settings:
          type: boolean
          description: When enabled, global Email connection settings will be used
            and connection settings below will be ignored.
        host:
          type: string
          minLength: 1
        port:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        username:
          type: string
        password:
          type: string
          writeOnly: true
        use_tls:
          type: boolean
        use_ssl:
          type: boolean
        timeout:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        from_address:
          type: string
          format: email
          minLength: 1
          maxLength: 254
        token_expiry:
          type: string
          minLength: 1
          description: 'Time the token sent is valid (Format: hours=3,minutes=17,seconds=300).'
        subject:
          type: string
          minLength: 1
        template:
          type: string
          minLength: 1
        activate_user_on_success:
          type: boolean
          description: Activate users upon completion of stage.
        recovery_max_attempts:
          type: integer
          maximum: 2147483647
          minimum: 0
        recovery_cache_timeout:
          type: string
          minLength: 1
          description: 'The time window used to count recent account recovery attempts.
            If the number of attempts exceed recovery_max_attempts within this period,
            further attempts will be rate-limited. (Format: hours=1;minutes=2;seconds=3).'
    PatchedEndpointDeviceRequest:
      type: object
      properties:
        device_uuid:
          type: string
          format: uuid
        name:
          type: string
          minLength: 1
        access_group:
          type: string
          format: uuid
          nullable: true
        access_group_obj:
          $ref: '#/components/schemas/DeviceAccessGroupRequest'
        expiring:
          type: boolean
        expires:
          type: string
          format: date-time
          nullable: true
        attributes:
          type: object
          additionalProperties: {}
    PatchedEndpointRequest:
      type: object
      description: Endpoint Serializer
      properties:
        name:
          type: string
          minLength: 1
        provider:
          type: integer
        protocol:
          $ref: '#/components/schemas/ProtocolEnum'
        host:
          type: string
          minLength: 1
        settings:
          type: object
          additionalProperties: {}
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        auth_mode:
          $ref: '#/components/schemas/EndpointAuthModeEnum'
        maximum_connections:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
    PatchedEnrollmentTokenRequest:
      type: object
      properties:
        device_group:
          type: string
          format: uuid
          nullable: true
        connector:
          type: string
          format: uuid
        name:
          type: string
          minLength: 1
        expiring:
          type: boolean
        expires:
          type: string
          format: date-time
          nullable: true
    PatchedEventMatcherPolicyRequest:
      type: object
      description: Event Matcher Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        action:
          allOf:
          - $ref: '#/components/schemas/EventActions'
          nullable: true
          description: Match created events with this action type. When left empty,
            all action types will be matched.
        client_ip:
          type: string
          nullable: true
          minLength: 1
          description: Matches Event's Client IP (strict matching, for network matching
            use an Expression Policy)
        app:
          allOf:
          - $ref: '#/components/schemas/AppEnum'
          nullable: true
          description: Match events created by selected application. When left empty,
            all applications are matched.
        model:
          allOf:
          - $ref: '#/components/schemas/ModelEnum'
          nullable: true
          description: Match events created by selected model. When left empty, all
            models are matched. When an app is selected, all the application's models
            are matched.
    PatchedEventRequest:
      type: object
      description: Event Serializer
      properties:
        user:
          type: object
          additionalProperties: {}
        action:
          $ref: '#/components/schemas/EventActions'
        app:
          type: string
          minLength: 1
        context:
          type: object
          additionalProperties: {}
        client_ip:
          type: string
          nullable: true
          minLength: 1
        expires:
          type: string
          format: date-time
        brand:
          type: object
          additionalProperties: {}
    PatchedExpressionPolicyRequest:
      type: object
      description: Group Membership Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        expression:
          type: string
          minLength: 1
    PatchedExtraRoleObjectPermissionRequest:
      type: object
      description: User permission with additional object-related data
      properties:
        object_pk:
          type: string
          minLength: 1
    PatchedExtraUserObjectPermissionRequest:
      type: object
      description: User permission with additional object-related data
      properties:
        object_pk:
          type: string
          minLength: 1
    PatchedFlowRequest:
      type: object
      description: Flow Serializer
      properties:
        name:
          type: string
          minLength: 1
        slug:
          type: string
          minLength: 1
          description: Visible in the URL.
          pattern: ^[-a-zA-Z0-9_]+$
        title:
          type: string
          minLength: 1
          description: Shown as the Title in Flow pages.
        designation:
          allOf:
          - $ref: '#/components/schemas/FlowDesignationEnum'
          description: Decides what this Flow is used for. For example, the Authentication
            flow is redirect to when an un-authenticated user visits authentik.
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        compatibility_mode:
          type: boolean
          description: Enable compatibility mode, increases compatibility with password
            managers on mobile devices.
        layout:
          $ref: '#/components/schemas/FlowLayoutEnum'
        denied_action:
          allOf:
          - $ref: '#/components/schemas/DeniedActionEnum'
          description: Configure what should happen when a flow denies access to a
            user.
        authentication:
          allOf:
          - $ref: '#/components/schemas/AuthenticationEnum'
          description: Required level of authentication and authorization to access
            a flow.
    PatchedFlowStageBindingRequest:
      type: object
      description: FlowStageBinding Serializer
      properties:
        target:
          type: string
          format: uuid
        stage:
          type: string
          format: uuid
        evaluate_on_plan:
          type: boolean
          description: Evaluate policies during the Flow planning process.
        re_evaluate_policies:
          type: boolean
          description: Evaluate policies when the Stage is presented to the user.
        order:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        invalid_response_action:
          allOf:
          - $ref: '#/components/schemas/InvalidResponseActionEnum'
          description: Configure how the flow executor should handle an invalid response
            to a challenge. RETRY returns the error message and a similar challenge
            to the executor. RESTART restarts the flow from the beginning, and RESTART_WITH_CONTEXT
            restarts the flow while keeping the current context.
    PatchedGeoIPPolicyRequest:
      type: object
      description: GeoIP Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        asns:
          type: array
          items:
            type: integer
            maximum: 2147483647
            minimum: -2147483648
        countries:
          type: array
          items:
            $ref: '#/components/schemas/CountryCodeEnum'
          maxItems: 249
        check_history_distance:
          type: boolean
        history_max_distance_km:
          type: integer
          maximum: 9223372036854775807
          minimum: 0
          format: int64
        distance_tolerance_km:
          type: integer
          maximum: 2147483647
          minimum: 0
        history_login_count:
          type: integer
          maximum: 2147483647
          minimum: 0
        check_impossible_travel:
          type: boolean
        impossible_tolerance_km:
          type: integer
          maximum: 2147483647
          minimum: 0
    PatchedGoogleEndpointDeviceRequest:
      type: object
      description: Serializer for Endpoint authenticator devices
      properties:
        pk:
          type: string
          format: uuid
          title: Uuid
        name:
          type: string
          minLength: 1
          description: The human-readable name of this device.
          maxLength: 64
    PatchedGoogleWorkspaceProviderMappingRequest:
      type: object
      description: GoogleWorkspaceProviderMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
    PatchedGoogleWorkspaceProviderRequest:
      type: object
      description: GoogleWorkspaceProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        property_mappings_group:
          type: array
          items:
            type: string
            format: uuid
          description: Property mappings used for group creation/updating.
        delegated_subject:
          type: string
          format: email
          minLength: 1
          maxLength: 254
        credentials:
          type: object
          additionalProperties: {}
        scopes:
          type: string
          minLength: 1
        exclude_users_service_account:
          type: boolean
        filter_group:
          type: string
          format: uuid
          nullable: true
        user_delete_action:
          $ref: '#/components/schemas/OutgoingSyncDeleteAction'
        group_delete_action:
          $ref: '#/components/schemas/OutgoingSyncDeleteAction'
        default_group_email_domain:
          type: string
          minLength: 1
        sync_page_size:
          type: integer
          maximum: 2147483647
          minimum: 1
          description: Controls the number of objects synced in a single task
        sync_page_timeout:
          type: string
          minLength: 1
          description: Timeout for synchronization of a single page
        dry_run:
          type: boolean
          description: When enabled, provider will not modify or create objects in
            the remote system.
    PatchedGroupKerberosSourceConnectionRequest:
      type: object
      description: Group Source Connection
      properties:
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
    PatchedGroupLDAPSourceConnectionRequest:
      type: object
      description: Group Source Connection
      properties:
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
    PatchedGroupOAuthSourceConnectionRequest:
      type: object
      description: Group Source Connection
      properties:
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
    PatchedGroupPlexSourceConnectionRequest:
      type: object
      description: Group Source Connection
      properties:
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
    PatchedGroupRequest:
      type: object
      description: Group Serializer
      properties:
        name:
          type: string
          minLength: 1
        is_superuser:
          type: boolean
          description: Users added to this group will be superusers.
        parent:
          type: string
          format: uuid
          nullable: true
        users:
          type: array
          items:
            type: integer
        attributes:
          type: object
          additionalProperties: {}
        roles:
          type: array
          items:
            type: string
            format: uuid
        children:
          type: array
          items:
            type: string
            format: uuid
    PatchedGroupSAMLSourceConnectionRequest:
      type: object
      description: Group Source Connection
      properties:
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
    PatchedGroupSourceConnectionRequest:
      type: object
      description: Group Source Connection
      properties:
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
    PatchedGroupTelegramSourceConnectionRequest:
      type: object
      description: Group Source Connection
      properties:
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
    PatchedIdentificationStageRequest:
      type: object
      description: IdentificationStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        user_fields:
          type: array
          items:
            $ref: '#/components/schemas/UserFieldsEnum'
          description: Fields of the user object to match against. (Hold shift to
            select multiple options)
        password_stage:
          type: string
          format: uuid
          nullable: true
          description: When set, shows a password field, instead of showing the password
            field as separate step.
        captcha_stage:
          type: string
          format: uuid
          nullable: true
          description: When set, adds functionality exactly like a Captcha stage,
            but baked into the Identification stage.
        case_insensitive_matching:
          type: boolean
          description: When enabled, user fields are matched regardless of their casing.
        show_matched_user:
          type: boolean
          description: When a valid username/email has been entered, and this option
            is enabled, the user's username and avatar will be shown. Otherwise, the
            text that the user entered will be shown
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Optional enrollment flow, which is linked at the bottom of
            the page.
        recovery_flow:
          type: string
          format: uuid
          nullable: true
          description: Optional recovery flow, which is linked at the bottom of the
            page.
        passwordless_flow:
          type: string
          format: uuid
          nullable: true
          description: Optional passwordless flow, which is linked at the bottom of
            the page.
        sources:
          type: array
          items:
            type: string
            format: uuid
          description: Specify which sources should be shown.
        show_source_labels:
          type: boolean
        pretend_user_exists:
          type: boolean
          description: When enabled, the stage will succeed and continue even when
            incorrect user info is entered.
        enable_remember_me:
          type: boolean
          description: Show the user the 'Remember me on this device' toggle, allowing
            repeat users to skip straight to entering their password.
    PatchedInitialPermissionsRequest:
      type: object
      description: InitialPermissions serializer
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 150
        mode:
          $ref: '#/components/schemas/InitialPermissionsModeEnum'
        role:
          type: string
          format: uuid
        permissions:
          type: array
          items:
            type: integer
    PatchedInvitationRequest:
      type: object
      description: Invitation Serializer
      properties:
        name:
          type: string
          minLength: 1
          pattern: ^[-a-zA-Z0-9_]+$
        expires:
          type: string
          format: date-time
          nullable: true
        fixed_data:
          type: object
          additionalProperties: {}
        single_use:
          type: boolean
          description: When enabled, the invitation will be deleted after usage.
        flow:
          type: string
          format: uuid
          nullable: true
          description: When set, only the configured flow can use this invitation.
    PatchedInvitationStageRequest:
      type: object
      description: InvitationStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        continue_flow_without_invitation:
          type: boolean
          description: If this flag is set, this Stage will jump to the next Stage
            when no Invitation is given. By default this Stage will cancel the Flow
            when no invitation is given.
    PatchedKerberosSourcePropertyMappingRequest:
      type: object
      description: Kerberos PropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
    PatchedKerberosSourceRequest:
      type: object
      description: Kerberos Source Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Source's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        user_path_template:
          type: string
          minLength: 1
        group_matching_mode:
          allOf:
          - $ref: '#/components/schemas/GroupMatchingModeEnum'
          description: How the source determines if an existing group should be used
            or a new group created.
        realm:
          type: string
          minLength: 1
          description: Kerberos realm
        krb5_conf:
          type: string
          description: Custom krb5.conf to use. Uses the system one by default
        kadmin_type:
          allOf:
          - $ref: '#/components/schemas/KadminTypeEnum'
          description: KAdmin server type
        sync_users:
          type: boolean
          description: Sync users from Kerberos into authentik
        sync_users_password:
          type: boolean
          description: When a user changes their password, sync it back to Kerberos
        sync_principal:
          type: string
          description: Principal to authenticate to kadmin for sync.
        sync_password:
          type: string
          writeOnly: true
          description: Password to authenticate to kadmin for sync
        sync_keytab:
          type: string
          writeOnly: true
          description: Keytab to authenticate to kadmin for sync. Must be base64-encoded
            or in the form TYPE:residual
        sync_ccache:
          type: string
          description: Credentials cache to authenticate to kadmin for sync. Must
            be in the form TYPE:residual
        spnego_server_name:
          type: string
          description: Force the use of a specific server name for SPNEGO. Must be
            in the form HTTP@hostname
        spnego_keytab:
          type: string
          writeOnly: true
          description: SPNEGO keytab base64-encoded or path to keytab in the form
            FILE:path
        spnego_ccache:
          type: string
          description: Credential cache to use for SPNEGO in form type:residual
        password_login_update_internal_password:
          type: boolean
          description: If enabled, the authentik-stored password will be updated upon
            login with the Kerberos password backend
    PatchedKubernetesServiceConnectionRequest:
      type: object
      description: KubernetesServiceConnection Serializer
      properties:
        name:
          type: string
          minLength: 1
        local:
          type: boolean
          description: If enabled, use the local connection. Required Docker socket/Kubernetes
            Integration
        kubeconfig:
          type: object
          additionalProperties: {}
          description: Paste your kubeconfig here. authentik will automatically use
            the currently selected context.
        verify_ssl:
          type: boolean
          description: Verify SSL Certificates of the Kubernetes API endpoint
    PatchedLDAPProviderRequest:
      type: object
      description: LDAPProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        base_dn:
          type: string
          minLength: 1
          description: DN under which objects are accessible.
        certificate:
          type: string
          format: uuid
          nullable: true
        tls_server_name:
          type: string
        uid_start_number:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: The start for uidNumbers, this number is added to the user.pk
            to make sure that the numbers aren't too low for POSIX users. Default
            is 2000 to ensure that we don't collide with local users uidNumber
        gid_start_number:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: The start for gidNumbers, this number is added to a number
            generated from the group.pk to make sure that the numbers aren't too low
            for POSIX groups. Default is 4000 to ensure that we don't collide with
            local groups or users primary groups gidNumber
        search_mode:
          $ref: '#/components/schemas/LDAPAPIAccessMode'
        bind_mode:
          $ref: '#/components/schemas/LDAPAPIAccessMode'
        mfa_support:
          type: boolean
          description: When enabled, code-based multi-factor authentication can be
            used by appending a semicolon and the TOTP code to the password. This
            should only be enabled if all users that will bind to this provider have
            a TOTP device configured, as otherwise a password may incorrectly be rejected
            if it contains a semicolon.
    PatchedLDAPSourcePropertyMappingRequest:
      type: object
      description: LDAP PropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
    PatchedLDAPSourceRequest:
      type: object
      description: LDAP Source Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Source's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        user_path_template:
          type: string
          minLength: 1
        server_uri:
          type: string
          minLength: 1
          format: uri
        peer_certificate:
          type: string
          format: uuid
          nullable: true
          description: Optionally verify the LDAP Server's Certificate against the
            CA Chain in this keypair.
        client_certificate:
          type: string
          format: uuid
          nullable: true
          description: Client certificate to authenticate against the LDAP Server's
            Certificate.
        bind_cn:
          type: string
        bind_password:
          type: string
          writeOnly: true
        start_tls:
          type: boolean
          title: Enable Start TLS
        sni:
          type: boolean
          title: Use Server URI for SNI verification
        base_dn:
          type: string
          minLength: 1
        additional_user_dn:
          type: string
          title: Addition User DN
          description: Prepended to Base DN for User-queries.
        additional_group_dn:
          type: string
          title: Addition Group DN
          description: Prepended to Base DN for Group-queries.
        user_object_filter:
          type: string
          minLength: 1
          description: Consider Objects matching this filter to be Users.
        group_object_filter:
          type: string
          minLength: 1
          description: Consider Objects matching this filter to be Groups.
        group_membership_field:
          type: string
          minLength: 1
          description: Field which contains members of a group.
        user_membership_attribute:
          type: string
          minLength: 1
          description: Attribute which matches the value of `group_membership_field`.
        object_uniqueness_field:
          type: string
          minLength: 1
          description: Field which contains a unique Identifier.
        password_login_update_internal_password:
          type: boolean
          description: Update internal authentik password when login succeeds with
            LDAP
        sync_users:
          type: boolean
        sync_users_password:
          type: boolean
          description: When a user changes their password, sync it back to LDAP. This
            can only be enabled on a single LDAP source.
        sync_groups:
          type: boolean
        sync_parent_group:
          type: string
          format: uuid
          nullable: true
        lookup_groups_from_user:
          type: boolean
          description: Lookup group membership based on a user attribute instead of
            a group attribute. This allows nested group resolution on systems like
            FreeIPA and Active Directory
        delete_not_found_objects:
          type: boolean
          description: Delete authentik users and groups which were previously supplied
            by this source, but are now missing from it.
    PatchedLicenseRequest:
      type: object
      description: License Serializer
      properties:
        key:
          type: string
          minLength: 1
    PatchedMicrosoftEntraProviderMappingRequest:
      type: object
      description: MicrosoftEntraProviderMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
    PatchedMicrosoftEntraProviderRequest:
      type: object
      description: MicrosoftEntraProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        property_mappings_group:
          type: array
          items:
            type: string
            format: uuid
          description: Property mappings used for group creation/updating.
        client_id:
          type: string
          minLength: 1
        client_secret:
          type: string
          minLength: 1
        tenant_id:
          type: string
          minLength: 1
        exclude_users_service_account:
          type: boolean
        filter_group:
          type: string
          format: uuid
          nullable: true
        user_delete_action:
          $ref: '#/components/schemas/OutgoingSyncDeleteAction'
        group_delete_action:
          $ref: '#/components/schemas/OutgoingSyncDeleteAction'
        sync_page_size:
          type: integer
          maximum: 2147483647
          minimum: 1
          description: Controls the number of objects synced in a single task
        sync_page_timeout:
          type: string
          minLength: 1
          description: Timeout for synchronization of a single page
        dry_run:
          type: boolean
          description: When enabled, provider will not modify or create objects in
            the remote system.
    PatchedMutualTLSStageRequest:
      type: object
      description: MutualTLSStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        mode:
          $ref: '#/components/schemas/MutualTLSStageModeEnum'
        certificate_authorities:
          type: array
          items:
            type: string
            format: uuid
          description: Configure certificate authorities to validate the certificate
            against. This option has a higher priority than the `client_certificate`
            option on `Brand`.
        cert_attribute:
          $ref: '#/components/schemas/CertAttributeEnum'
        user_attribute:
          $ref: '#/components/schemas/UserAttributeEnum'
    PatchedNotificationRequest:
      type: object
      description: Notification Serializer
      properties:
        event:
          $ref: '#/components/schemas/EventRequest'
        seen:
          type: boolean
    PatchedNotificationRuleRequest:
      type: object
      description: NotificationRule Serializer
      properties:
        name:
          type: string
          minLength: 1
        transports:
          type: array
          items:
            type: string
            format: uuid
          description: Select which transports should be used to notify the user.
            If none are selected, the notification will only be shown in the authentik
            UI.
        severity:
          allOf:
          - $ref: '#/components/schemas/SeverityEnum'
          description: Controls which severity level the created notifications will
            have.
        destination_group:
          type: string
          format: uuid
          nullable: true
          description: Define which group of users this notification should be sent
            and shown to. If left empty, Notification won't ben sent.
        destination_event_user:
          type: boolean
          description: When enabled, notification will be sent to user the user that
            triggered the event.When destination_group is configured, notification
            is sent to both.
    PatchedNotificationTransportRequest:
      type: object
      description: NotificationTransport Serializer
      properties:
        name:
          type: string
          minLength: 1
        mode:
          $ref: '#/components/schemas/NotificationTransportModeEnum'
        webhook_url:
          type: string
          format: uri
        webhook_mapping_body:
          type: string
          format: uuid
          nullable: true
          description: Customize the body of the request. Mapping should return data
            that is JSON-serializable.
        webhook_mapping_headers:
          type: string
          format: uuid
          nullable: true
          description: Configure additional headers to be sent. Mapping should return
            a dictionary of key-value pairs
        email_subject_prefix:
          type: string
        email_template:
          type: string
          minLength: 1
        send_once:
          type: boolean
          description: Only send notification once, for example when sending a webhook
            into a chat channel.
    PatchedNotificationWebhookMappingRequest:
      type: object
      description: NotificationWebhookMapping Serializer
      properties:
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
    PatchedOAuth2ProviderRequest:
      type: object
      description: OAuth2Provider Serializer
      properties:
        name:
          type: string
          minLength: 1
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        client_type:
          allOf:
          - $ref: '#/components/schemas/ClientTypeEnum'
          description: Confidential clients are capable of maintaining the confidentiality
            of their credentials. Public clients are incapable
        client_id:
          type: string
          minLength: 1
          maxLength: 255
        client_secret:
          type: string
          maxLength: 255
        access_code_validity:
          type: string
          minLength: 1
          description: 'Access codes not valid on or after current time + this value
            (Format: hours=1;minutes=2;seconds=3).'
        access_token_validity:
          type: string
          minLength: 1
          description: 'Tokens not valid on or after current time + this value (Format:
            hours=1;minutes=2;seconds=3).'
        refresh_token_validity:
          type: string
          minLength: 1
          description: 'Tokens not valid on or after current time + this value (Format:
            hours=1;minutes=2;seconds=3).'
        refresh_token_threshold:
          type: string
          minLength: 1
          description: 'When refreshing a token, if the refresh token is valid for
            less than this duration, it will be renewed. When set to seconds=0, token
            will always be renewed. (Format: hours=1;minutes=2;seconds=3).'
        include_claims_in_id_token:
          type: boolean
          description: Include User claims from scopes in the id_token, for applications
            that don't access the userinfo endpoint.
        signing_key:
          type: string
          format: uuid
          nullable: true
          description: Key used to sign the tokens.
        encryption_key:
          type: string
          format: uuid
          nullable: true
          description: Key used to encrypt the tokens. When set, tokens will be encrypted
            and returned as JWEs.
        redirect_uris:
          type: array
          items:
            $ref: '#/components/schemas/RedirectURIRequest'
        logout_uri:
          type: string
          format: uri
        logout_method:
          allOf:
          - $ref: '#/components/schemas/OAuth2ProviderLogoutMethodEnum'
          description: Backchannel logs out with server to server calls. Frontchannel
            uses iframes in your browser
        sub_mode:
          allOf:
          - $ref: '#/components/schemas/SubModeEnum'
          description: Configure what data should be used as unique User Identifier.
            For most cases, the default should be fine.
        issuer_mode:
          allOf:
          - $ref: '#/components/schemas/IssuerModeEnum'
          description: Configure how the issuer field of the ID Token should be filled.
        jwt_federation_sources:
          type: array
          items:
            type: string
            format: uuid
            title: Any JWT signed by the JWK of the selected source can be used to
              authenticate.
          title: Any JWT signed by the JWK of the selected source can be used to authenticate.
        jwt_federation_providers:
          type: array
          items:
            type: integer
    PatchedOAuthSourcePropertyMappingRequest:
      type: object
      description: OAuthSourcePropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
    PatchedOAuthSourceRequest:
      type: object
      description: OAuth Source Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Source's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        user_path_template:
          type: string
          minLength: 1
        group_matching_mode:
          allOf:
          - $ref: '#/components/schemas/GroupMatchingModeEnum'
          description: How the source determines if an existing group should be used
            or a new group created.
        provider_type:
          $ref: '#/components/schemas/ProviderTypeEnum'
        request_token_url:
          type: string
          nullable: true
          description: URL used to request the initial token. This URL is only required
            for OAuth 1.
          maxLength: 255
        authorization_url:
          type: string
          nullable: true
          description: URL the user is redirect to to conest the flow.
          maxLength: 255
        access_token_url:
          type: string
          nullable: true
          description: URL used by authentik to retrieve tokens.
          maxLength: 255
        profile_url:
          type: string
          nullable: true
          description: URL used by authentik to get user information.
          maxLength: 255
        pkce:
          $ref: '#/components/schemas/PKCEMethodEnum'
        consumer_key:
          type: string
          minLength: 1
        consumer_secret:
          type: string
          writeOnly: true
          minLength: 1
        additional_scopes:
          type: string
        oidc_well_known_url:
          type: string
        oidc_jwks_url:
          type: string
        oidc_jwks:
          type: object
          additionalProperties: {}
        authorization_code_auth_method:
          allOf:
          - $ref: '#/components/schemas/AuthorizationCodeAuthMethodEnum'
          description: How to perform authentication during an authorization_code
            token request flow
    PatchedOutpostRequest:
      type: object
      description: Outpost Serializer
      properties:
        name:
          type: string
          minLength: 1
        type:
          $ref: '#/components/schemas/OutpostTypeEnum'
        providers:
          type: array
          items:
            type: integer
        service_connection:
          type: string
          format: uuid
          nullable: true
          description: Select Service-Connection authentik should use to manage this
            outpost. Leave empty if authentik should not handle the deployment.
        config:
          type: object
          additionalProperties: {}
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
    PatchedPasswordExpiryPolicyRequest:
      type: object
      description: Password Expiry Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        days:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        deny_only:
          type: boolean
    PatchedPasswordPolicyRequest:
      type: object
      description: Password Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        password_field:
          type: string
          minLength: 1
          description: Field key to check, field keys defined in Prompt stages are
            available.
        amount_digits:
          type: integer
          maximum: 2147483647
          minimum: 0
        amount_uppercase:
          type: integer
          maximum: 2147483647
          minimum: 0
        amount_lowercase:
          type: integer
          maximum: 2147483647
          minimum: 0
        amount_symbols:
          type: integer
          maximum: 2147483647
          minimum: 0
        length_min:
          type: integer
          maximum: 2147483647
          minimum: 0
        symbol_charset:
          type: string
          minLength: 1
        error_message:
          type: string
        check_static_rules:
          type: boolean
        check_have_i_been_pwned:
          type: boolean
        check_zxcvbn:
          type: boolean
        hibp_allowed_count:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: How many times the password hash is allowed to be on haveibeenpwned
        zxcvbn_score_threshold:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: If the zxcvbn score is equal or less than this value, the policy
            will fail.
    PatchedPasswordStageRequest:
      type: object
      description: PasswordStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        backends:
          type: array
          items:
            $ref: '#/components/schemas/BackendsEnum'
          description: Selection of backends to test the password against.
        configure_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used by an authenticated user to configure this Stage.
            If empty, user will not be able to configure this stage.
        failed_attempts_before_cancel:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
          description: How many attempts a user has before the flow is canceled. To
            lock the user out, use a reputation policy and a user_write stage.
        allow_show_password:
          type: boolean
          description: When enabled, provides a 'show password' button with the password
            input field.
    PatchedPermissionAssignRequest:
      type: object
      description: Request to assign a new permission
      properties:
        permissions:
          type: array
          items:
            type: string
            minLength: 1
        model:
          $ref: '#/components/schemas/ModelEnum'
        object_pk:
          type: string
          minLength: 1
    PatchedPlexSourcePropertyMappingRequest:
      type: object
      description: PlexSourcePropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
    PatchedPlexSourceRequest:
      type: object
      description: Plex Source Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Source's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        user_path_template:
          type: string
          minLength: 1
        group_matching_mode:
          allOf:
          - $ref: '#/components/schemas/GroupMatchingModeEnum'
          description: How the source determines if an existing group should be used
            or a new group created.
        client_id:
          type: string
          minLength: 1
          description: Client identifier used to talk to Plex.
        allowed_servers:
          type: array
          items:
            type: string
            minLength: 1
          description: Which servers a user has to be a member of to be granted access.
            Empty list allows every server.
        allow_friends:
          type: boolean
          description: Allow friends to authenticate, even if you don't share a server.
        plex_token:
          type: string
          minLength: 1
          description: Plex token used to check friends
    PatchedPolicyBindingRequest:
      type: object
      description: PolicyBinding Serializer
      properties:
        policy:
          type: string
          format: uuid
          nullable: true
        group:
          type: string
          format: uuid
          nullable: true
        user:
          type: integer
          nullable: true
        target:
          type: string
          format: uuid
        negate:
          type: boolean
          description: Negates the outcome of the policy. Messages are unaffected.
        enabled:
          type: boolean
        order:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        timeout:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: Timeout after which Policy execution is terminated.
        failure_result:
          type: boolean
          description: Result if the Policy execution fails.
    PatchedPromptRequest:
      type: object
      description: Prompt Serializer
      properties:
        name:
          type: string
          minLength: 1
        field_key:
          type: string
          minLength: 1
          description: Name of the form field, also used to store the value
        label:
          type: string
          minLength: 1
        type:
          $ref: '#/components/schemas/PromptTypeEnum'
        required:
          type: boolean
        placeholder:
          type: string
          description: Optionally provide a short hint that describes the expected
            input value. When creating a fixed choice field, enable interpreting as
            expression and return a list to return multiple choices.
        initial_value:
          type: string
          description: Optionally pre-fill the input with an initial value. When creating
            a fixed choice field, enable interpreting as expression and return a list
            to return multiple default choices.
        order:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        sub_text:
          type: string
        placeholder_expression:
          type: boolean
        initial_value_expression:
          type: boolean
    PatchedPromptStageRequest:
      type: object
      description: PromptStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        fields:
          type: array
          items:
            type: string
            format: uuid
        validation_policies:
          type: array
          items:
            type: string
            format: uuid
    PatchedProxyProviderRequest:
      type: object
      description: ProxyProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        internal_host:
          type: string
          format: uri
        external_host:
          type: string
          minLength: 1
          format: uri
        internal_host_ssl_validation:
          type: boolean
          description: Validate SSL Certificates of upstream servers
        certificate:
          type: string
          format: uuid
          nullable: true
        skip_path_regex:
          type: string
          description: Regular expressions for which authentication is not required.
            Each new line is interpreted as a new Regular Expression.
        basic_auth_enabled:
          type: boolean
          title: Set HTTP-Basic Authentication
          description: Set a custom HTTP-Basic Authentication header based on values
            from authentik.
        basic_auth_password_attribute:
          type: string
          title: HTTP-Basic Password Key
          description: User/Group Attribute used for the password part of the HTTP-Basic
            Header.
        basic_auth_user_attribute:
          type: string
          title: HTTP-Basic Username Key
          description: User/Group Attribute used for the user part of the HTTP-Basic
            Header. If not set, the user's Email address is used.
        mode:
          allOf:
          - $ref: '#/components/schemas/ProxyMode'
          description: Enable support for forwardAuth in traefik and nginx auth_request.
            Exclusive with internal_host.
        intercept_header_auth:
          type: boolean
          description: When enabled, this provider will intercept the authorization
            header and authenticate requests based on its value.
        cookie_domain:
          type: string
        jwt_federation_sources:
          type: array
          items:
            type: string
            format: uuid
            title: Any JWT signed by the JWK of the selected source can be used to
              authenticate.
          title: Any JWT signed by the JWK of the selected source can be used to authenticate.
        jwt_federation_providers:
          type: array
          items:
            type: integer
        access_token_validity:
          type: string
          minLength: 1
          description: 'Tokens not valid on or after current time + this value (Format:
            hours=1;minutes=2;seconds=3).'
        refresh_token_validity:
          type: string
          minLength: 1
          description: 'Tokens not valid on or after current time + this value (Format:
            hours=1;minutes=2;seconds=3).'
    PatchedRACPropertyMappingRequest:
      type: object
      description: RACPropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
        static_settings:
          type: object
          additionalProperties: {}
    PatchedRACProviderRequest:
      type: object
      description: RACProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        settings:
          type: object
          additionalProperties: {}
        connection_expiry:
          type: string
          minLength: 1
          description: 'Determines how long a session lasts. Default of 0 means that
            the sessions lasts until the browser is closed. (Format: hours=-1;minutes=-2;seconds=-3)'
        delete_token_on_disconnect:
          type: boolean
          description: When set to true, connection tokens will be deleted upon disconnect.
    PatchedRadiusProviderPropertyMappingRequest:
      type: object
      description: RadiusProviderPropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
    PatchedRadiusProviderRequest:
      type: object
      description: RadiusProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        client_networks:
          type: string
          minLength: 1
          description: List of CIDRs (comma-separated) that clients can connect from.
            A more specific CIDR will match before a looser one. Clients connecting
            from a non-specified CIDR will be dropped.
        shared_secret:
          type: string
          minLength: 1
          description: Shared secret between clients and server to hash packets.
        mfa_support:
          type: boolean
          description: When enabled, code-based multi-factor authentication can be
            used by appending a semicolon and the TOTP code to the password. This
            should only be enabled if all users that will bind to this provider have
            a TOTP device configured, as otherwise a password may incorrectly be rejected
            if it contains a semicolon.
        certificate:
          type: string
          format: uuid
          nullable: true
    PatchedRedirectStageRequest:
      type: object
      description: RedirectStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        keep_context:
          type: boolean
        mode:
          $ref: '#/components/schemas/RedirectStageModeEnum'
        target_static:
          type: string
        target_flow:
          type: string
          format: uuid
          nullable: true
    PatchedReputationPolicyRequest:
      type: object
      description: Reputation Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        check_ip:
          type: boolean
        check_username:
          type: boolean
        threshold:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
    PatchedRoleRequest:
      type: object
      description: Role serializer
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 150
    PatchedSAMLPropertyMappingRequest:
      type: object
      description: SAMLPropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
        saml_name:
          type: string
          minLength: 1
        friendly_name:
          type: string
          nullable: true
    PatchedSAMLProviderRequest:
      type: object
      description: SAMLProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        acs_url:
          type: string
          minLength: 1
          format: uri
        sls_url:
          type: string
          description: Single Logout Service URL where the logout response should
            be sent.
          format: uri
        audience:
          type: string
          description: Value of the audience restriction field of the assertion. When
            left empty, no audience restriction will be added.
        issuer:
          type: string
          minLength: 1
          description: Also known as EntityID
        assertion_valid_not_before:
          type: string
          minLength: 1
          description: 'Assertion valid not before current time + this value (Format:
            hours=-1;minutes=-2;seconds=-3).'
        assertion_valid_not_on_or_after:
          type: string
          minLength: 1
          description: 'Assertion not valid on or after current time + this value
            (Format: hours=1;minutes=2;seconds=3).'
        session_valid_not_on_or_after:
          type: string
          minLength: 1
          description: 'Session not valid on or after current time + this value (Format:
            hours=1;minutes=2;seconds=3).'
        name_id_mapping:
          type: string
          format: uuid
          nullable: true
          title: NameID Property Mapping
          description: Configure how the NameID value will be created. When left empty,
            the NameIDPolicy of the incoming request will be considered
        authn_context_class_ref_mapping:
          type: string
          format: uuid
          nullable: true
          title: AuthnContextClassRef Property Mapping
          description: Configure how the AuthnContextClassRef value will be created.
            When left empty, the AuthnContextClassRef will be set based on which authentication
            methods the user used to authenticate.
        digest_algorithm:
          $ref: '#/components/schemas/DigestAlgorithmEnum'
        signature_algorithm:
          $ref: '#/components/schemas/SignatureAlgorithmEnum'
        signing_kp:
          type: string
          format: uuid
          nullable: true
          title: Signing Keypair
          description: Keypair used to sign outgoing Responses going to the Service
            Provider.
        verification_kp:
          type: string
          format: uuid
          nullable: true
          title: Verification Certificate
          description: When selected, incoming assertion's Signatures will be validated
            against this certificate. To allow unsigned Requests, leave on default.
        encryption_kp:
          type: string
          format: uuid
          nullable: true
          title: Encryption Keypair
          description: When selected, incoming assertions are encrypted by the IdP
            using the public key of the encryption keypair. The assertion is decrypted
            by the SP using the the private key.
        sign_assertion:
          type: boolean
        sign_response:
          type: boolean
        sign_logout_request:
          type: boolean
        sp_binding:
          allOf:
          - $ref: '#/components/schemas/SAMLBindingsEnum'
          title: Service Provider Binding
          description: This determines how authentik sends the response back to the
            Service Provider.
        sls_binding:
          allOf:
          - $ref: '#/components/schemas/SAMLBindingsEnum'
          description: This determines how authentik sends the logout response back
            to the Service Provider.
        logout_method:
          allOf:
          - $ref: '#/components/schemas/SAMLProviderLogoutMethodEnum'
          description: Method to use for logout. Front-channel iframe loads all logout
            URLs simultaneously in hidden iframes. Front-channel native uses your
            active browser tab to send post requests and redirect to providers. Back-channel
            sends logout requests directly from the server without user interaction
            (requires POST SLS binding).
        default_relay_state:
          type: string
          description: Default relay_state value for IDP-initiated logins
        default_name_id_policy:
          $ref: '#/components/schemas/SAMLNameIDPolicyEnum'
    PatchedSAMLSourcePropertyMappingRequest:
      type: object
      description: SAMLSourcePropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
    PatchedSAMLSourceRequest:
      type: object
      description: SAMLSource Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Source's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        user_path_template:
          type: string
          minLength: 1
        group_matching_mode:
          allOf:
          - $ref: '#/components/schemas/GroupMatchingModeEnum'
          description: How the source determines if an existing group should be used
            or a new group created.
        pre_authentication_flow:
          type: string
          format: uuid
          description: Flow used before authentication.
        issuer:
          type: string
          description: Also known as Entity ID. Defaults the Metadata URL.
        sso_url:
          type: string
          minLength: 1
          description: URL that the initial Login request is sent to.
          format: uri
        slo_url:
          type: string
          nullable: true
          description: Optional URL if your IDP supports Single-Logout.
          format: uri
        allow_idp_initiated:
          type: boolean
          description: Allows authentication flows initiated by the IdP. This can
            be a security risk, as no validation of the request ID is done.
        name_id_policy:
          allOf:
          - $ref: '#/components/schemas/SAMLNameIDPolicyEnum'
          description: NameID Policy sent to the IdP. Can be unset, in which case
            no Policy is sent.
        binding_type:
          $ref: '#/components/schemas/BindingTypeEnum'
        verification_kp:
          type: string
          format: uuid
          nullable: true
          title: Verification Certificate
          description: When selected, incoming assertion's Signatures will be validated
            against this certificate. To allow unsigned Requests, leave on default.
        signing_kp:
          type: string
          format: uuid
          nullable: true
          title: Signing Keypair
          description: Keypair used to sign outgoing Responses going to the Identity
            Provider.
        digest_algorithm:
          $ref: '#/components/schemas/DigestAlgorithmEnum'
        signature_algorithm:
          $ref: '#/components/schemas/SignatureAlgorithmEnum'
        temporary_user_delete_after:
          type: string
          minLength: 1
          title: Delete temporary users after
          description: 'Time offset when temporary users should be deleted. This only
            applies if your IDP uses the NameID Format ''transient'', and the user
            doesn''t log out manually. (Format: hours=1;minutes=2;seconds=3).'
        encryption_kp:
          type: string
          format: uuid
          nullable: true
          title: Encryption Keypair
          description: When selected, incoming assertions are encrypted by the IdP
            using the public key of the encryption keypair. The assertion is decrypted
            by the SP using the the private key.
        signed_assertion:
          type: boolean
        signed_response:
          type: boolean
    PatchedSCIMMappingRequest:
      type: object
      description: SCIMMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
    PatchedSCIMProviderRequest:
      type: object
      description: SCIMProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        property_mappings_group:
          type: array
          items:
            type: string
            format: uuid
          description: Property mappings used for group creation/updating.
        url:
          type: string
          minLength: 1
          description: Base URL to SCIM requests, usually ends in /v2
        verify_certificates:
          type: boolean
        token:
          type: string
          description: Authentication token
        auth_mode:
          $ref: '#/components/schemas/SCIMAuthenticationModeEnum'
        auth_oauth:
          type: string
          format: uuid
          nullable: true
          description: OAuth Source used for authentication
        auth_oauth_params:
          type: object
          additionalProperties: {}
          description: Additional OAuth parameters, such as grant_type
        compatibility_mode:
          allOf:
          - $ref: '#/components/schemas/CompatibilityModeEnum'
          title: SCIM Compatibility Mode
          description: Alter authentik behavior for vendor-specific SCIM implementations.
        exclude_users_service_account:
          type: boolean
        filter_group:
          type: string
          format: uuid
          nullable: true
        sync_page_size:
          type: integer
          maximum: 2147483647
          minimum: 1
          description: Controls the number of objects synced in a single task
        sync_page_timeout:
          type: string
          minLength: 1
          description: Timeout for synchronization of a single page
        dry_run:
          type: boolean
          description: When enabled, provider will not modify or create objects in
            the remote system.
    PatchedSCIMSourceGroupRequest:
      type: object
      description: SCIMSourceGroup Serializer
      properties:
        id:
          type: string
          minLength: 1
        external_id:
          type: string
          minLength: 1
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        attributes:
          type: object
          additionalProperties: {}
    PatchedSCIMSourcePropertyMappingRequest:
      type: object
      description: SCIMSourcePropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
    PatchedSCIMSourceRequest:
      type: object
      description: SCIMSource Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Source's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        user_path_template:
          type: string
          minLength: 1
    PatchedSCIMSourceUserRequest:
      type: object
      description: SCIMSourceUser Serializer
      properties:
        id:
          type: string
          minLength: 1
        external_id:
          type: string
          minLength: 1
        user:
          type: integer
        source:
          type: string
          format: uuid
        attributes:
          type: object
          additionalProperties: {}
    PatchedSMSDeviceRequest:
      type: object
      description: Serializer for sms authenticator devices
      properties:
        name:
          type: string
          minLength: 1
          description: The human-readable name of this device.
          maxLength: 64
    PatchedSSFProviderRequest:
      type: object
      description: SSFProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        signing_key:
          type: string
          format: uuid
          description: Key used to sign the SSF Events.
        oidc_auth_providers:
          type: array
          items:
            type: integer
        event_retention:
          type: string
          minLength: 1
    PatchedScheduleRequest:
      type: object
      properties:
        rel_obj_id:
          type: string
          nullable: true
          minLength: 1
        crontab:
          type: string
          minLength: 1
          description: When to schedule tasks
        paused:
          type: boolean
          description: Pause this schedule
    PatchedScopeMappingRequest:
      type: object
      description: ScopeMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
        scope_name:
          type: string
          minLength: 1
          description: Scope name requested by the client
        description:
          type: string
          description: Description shown to the user when consenting. If left empty,
            the user won't be informed.
    PatchedSettingsRequest:
      type: object
      description: Settings Serializer
      properties:
        avatars:
          type: string
          minLength: 1
          description: Configure how authentik should show avatars for users.
        default_user_change_name:
          type: boolean
          description: Enable the ability for users to change their name.
        default_user_change_email:
          type: boolean
          description: Enable the ability for users to change their email address.
        default_user_change_username:
          type: boolean
          description: Enable the ability for users to change their username.
        event_retention:
          type: string
          minLength: 1
          description: 'Events will be deleted after this duration.(Format: weeks=3;days=2;hours=3,seconds=2).'
        reputation_lower_limit:
          type: integer
          maximum: 0
          minimum: -2147483648
          description: Reputation cannot decrease lower than this value. Zero or negative.
        reputation_upper_limit:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: Reputation cannot increase higher than this value. Zero or
            positive.
        footer_links: {}
        gdpr_compliance:
          type: boolean
          description: When enabled, all the events caused by a user will be deleted
            upon the user's deletion.
        impersonation:
          type: boolean
          description: Globally enable/disable impersonation.
        impersonation_require_reason:
          type: boolean
          description: Require administrators to provide a reason for impersonating
            a user.
        default_token_duration:
          type: string
          minLength: 1
          description: Default token duration
        default_token_length:
          type: integer
          maximum: 2147483647
          minimum: 1
          description: Default token length
        flags:
          type: object
          properties:
            policies_buffered_access_view:
              type: boolean
          required:
          - policies_buffered_access_view
    PatchedSourceStageRequest:
      type: object
      description: SourceStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        source:
          type: string
          format: uuid
        resume_timeout:
          type: string
          minLength: 1
          description: 'Amount of time a user can take to return from the source to
            continue the flow (Format: hours=-1;minutes=-2;seconds=-3)'
    PatchedStaticDeviceRequest:
      type: object
      description: Serializer for static authenticator devices
      properties:
        name:
          type: string
          minLength: 1
          description: The human-readable name of this device.
          maxLength: 64
    PatchedTOTPDeviceRequest:
      type: object
      description: Serializer for totp authenticator devices
      properties:
        name:
          type: string
          minLength: 1
          description: The human-readable name of this device.
          maxLength: 64
    PatchedTelegramSourcePropertyMappingRequest:
      type: object
      description: TelegramSourcePropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
    PatchedTelegramSourceRequest:
      type: object
      description: Source Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Source's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        user_path_template:
          type: string
          minLength: 1
        bot_username:
          type: string
          minLength: 1
          description: Telegram bot username
        bot_token:
          type: string
          writeOnly: true
          minLength: 1
          description: Telegram bot token
        request_message_access:
          type: boolean
          description: Request access to send messages from your bot.
        pre_authentication_flow:
          type: string
          format: uuid
          description: Flow used before authentication.
    PatchedTenantRequest:
      type: object
      description: Tenant Serializer
      properties:
        schema_name:
          type: string
          minLength: 1
          maxLength: 63
        name:
          type: string
          minLength: 1
        ready:
          type: boolean
    PatchedTokenRequest:
      type: object
      description: Token Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        identifier:
          type: string
          minLength: 1
          maxLength: 255
          pattern: ^[-a-zA-Z0-9_]+$
        intent:
          $ref: '#/components/schemas/IntentEnum'
        user:
          type: integer
        description:
          type: string
        expires:
          type: string
          format: date-time
          nullable: true
        expiring:
          type: boolean
    PatchedUniquePasswordPolicyRequest:
      type: object
      description: Password Uniqueness Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        password_field:
          type: string
          minLength: 1
          description: Field key to check, field keys defined in Prompt stages are
            available.
        num_historical_passwords:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: Number of passwords to check against.
    PatchedUserDeleteStageRequest:
      type: object
      description: UserDeleteStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
    PatchedUserKerberosSourceConnectionRequest:
      type: object
      description: User source connection
      properties:
        user:
          type: integer
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
    PatchedUserLDAPSourceConnectionRequest:
      type: object
      description: User source connection
      properties:
        user:
          type: integer
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
    PatchedUserLoginStageRequest:
      type: object
      description: UserLoginStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        session_duration:
          type: string
          minLength: 1
          description: 'Determines how long a session lasts. Default of 0 means that
            the sessions lasts until the browser is closed. (Format: hours=-1;minutes=-2;seconds=-3)'
        terminate_other_sessions:
          type: boolean
          description: Terminate all other sessions of the user logging in.
        remember_me_offset:
          type: string
          minLength: 1
          description: 'Offset the session will be extended by when the user picks
            the remember me option. Default of 0 means that the remember me option
            will not be shown. (Format: hours=-1;minutes=-2;seconds=-3)'
        network_binding:
          allOf:
          - $ref: '#/components/schemas/NetworkBindingEnum'
          description: Bind sessions created by this stage to the configured network
        geoip_binding:
          allOf:
          - $ref: '#/components/schemas/GeoipBindingEnum'
          description: Bind sessions created by this stage to the configured GeoIP
            location
        remember_device:
          type: string
          minLength: 1
          description: 'When set to a non-zero value, authentik will save a cookie
            with a longer expiry,to remember the device the user is logging in from.
            (Format: hours=-1;minutes=-2;seconds=-3)'
    PatchedUserLogoutStageRequest:
      type: object
      description: UserLogoutStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
    PatchedUserOAuthSourceConnectionRequest:
      type: object
      description: User source connection
      properties:
        user:
          type: integer
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
        access_token:
          type: string
          writeOnly: true
          nullable: true
        expires:
          type: string
          format: date-time
    PatchedUserPlexSourceConnectionRequest:
      type: object
      description: User source connection
      properties:
        user:
          type: integer
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
        plex_token:
          type: string
          writeOnly: true
          minLength: 1
    PatchedUserRequest:
      type: object
      description: User Serializer
      properties:
        username:
          type: string
          minLength: 1
          maxLength: 150
        name:
          type: string
          description: User's display name.
        is_active:
          type: boolean
          title: Active
          description: Designates whether this user should be treated as active. Unselect
            this instead of deleting accounts.
        last_login:
          type: string
          format: date-time
          nullable: true
        groups:
          type: array
          items:
            type: string
            format: uuid
        email:
          type: string
          format: email
          title: Email address
          maxLength: 254
        attributes:
          type: object
          additionalProperties: {}
        path:
          type: string
          minLength: 1
        type:
          $ref: '#/components/schemas/UserTypeEnum'
    PatchedUserSAMLSourceConnectionRequest:
      type: object
      description: User source connection
      properties:
        user:
          type: integer
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
    PatchedUserSourceConnectionRequest:
      type: object
      description: User source connection
      properties:
        user:
          type: integer
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
    PatchedUserTelegramSourceConnectionRequest:
      type: object
      description: User source connection
      properties:
        user:
          type: integer
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
    PatchedUserWriteStageRequest:
      type: object
      description: UserWriteStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        user_creation_mode:
          $ref: '#/components/schemas/UserCreationModeEnum'
        create_users_as_inactive:
          type: boolean
          description: When set, newly created users are inactive and cannot login.
        create_users_group:
          type: string
          format: uuid
          nullable: true
          description: Optionally add newly created users to this group.
        user_type:
          $ref: '#/components/schemas/UserTypeEnum'
        user_path_template:
          type: string
    PatchedWebAuthnDeviceRequest:
      type: object
      description: Serializer for WebAuthn authenticator devices
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 200
    Permission:
      type: object
      description: Global permission
      properties:
        id:
          type: integer
          readOnly: true
        name:
          type: string
          maxLength: 255
        codename:
          type: string
          maxLength: 100
        model:
          type: string
          title: Python model class name
          readOnly: true
        app_label:
          type: string
          readOnly: true
        app_label_verbose:
          type: string
          description: Human-readable app label
          readOnly: true
        model_verbose:
          type: string
          description: Human-readable model name
          readOnly: true
      required:
      - app_label
      - app_label_verbose
      - codename
      - id
      - model
      - model_verbose
      - name
    PermissionAssignRequest:
      type: object
      description: Request to assign a new permission
      properties:
        permissions:
          type: array
          items:
            type: string
            minLength: 1
        model:
          $ref: '#/components/schemas/ModelEnum'
        object_pk:
          type: string
          minLength: 1
      required:
      - permissions
    PermissionAssignResult:
      type: object
      description: Result from assigning permissions to a user/role
      properties:
        id:
          type: string
      required:
      - id
    PlexAuthenticationChallenge:
      type: object
      description: Challenge shown to the user in identification stage
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-source-plex
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        client_id:
          type: string
        slug:
          type: string
      required:
      - client_id
      - slug
    PlexAuthenticationChallengeResponseRequest:
      type: object
      description: Pseudo class for plex response
      properties:
        component:
          type: string
          minLength: 1
          default: ak-source-plex
    PlexSource:
      type: object
      description: Plex Source Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pbm uuid
        name:
          type: string
          description: Source's display Name.
        slug:
          type: string
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
          readOnly: true
        user_path_template:
          type: string
        icon:
          type: string
          readOnly: true
        group_matching_mode:
          allOf:
          - $ref: '#/components/schemas/GroupMatchingModeEnum'
          description: How the source determines if an existing group should be used
            or a new group created.
        client_id:
          type: string
          description: Client identifier used to talk to Plex.
        allowed_servers:
          type: array
          items:
            type: string
          description: Which servers a user has to be a member of to be granted access.
            Empty list allows every server.
        allow_friends:
          type: boolean
          description: Allow friends to authenticate, even if you don't share a server.
        plex_token:
          type: string
          description: Plex token used to check friends
      required:
      - component
      - icon
      - managed
      - meta_model_name
      - name
      - pk
      - plex_token
      - slug
      - verbose_name
      - verbose_name_plural
    PlexSourcePropertyMapping:
      type: object
      description: PlexSourcePropertyMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
        expression:
          type: string
        component:
          type: string
          description: Get object's component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
      required:
      - component
      - expression
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    PlexSourcePropertyMappingRequest:
      type: object
      description: PlexSourcePropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
      required:
      - expression
      - name
    PlexSourceRequest:
      type: object
      description: Plex Source Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Source's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        user_path_template:
          type: string
          minLength: 1
        group_matching_mode:
          allOf:
          - $ref: '#/components/schemas/GroupMatchingModeEnum'
          description: How the source determines if an existing group should be used
            or a new group created.
        client_id:
          type: string
          minLength: 1
          description: Client identifier used to talk to Plex.
        allowed_servers:
          type: array
          items:
            type: string
            minLength: 1
          description: Which servers a user has to be a member of to be granted access.
            Empty list allows every server.
        allow_friends:
          type: boolean
          description: Allow friends to authenticate, even if you don't share a server.
        plex_token:
          type: string
          minLength: 1
          description: Plex token used to check friends
      required:
      - name
      - plex_token
      - slug
    PlexTokenRedeemRequest:
      type: object
      description: Serializer to redeem a plex token
      properties:
        plex_token:
          type: string
          minLength: 1
      required:
      - plex_token
    Policy:
      type: object
      description: Policy Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Policy uuid
        name:
          type: string
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        bound_to:
          type: integer
          description: Return objects policy is bound to
          readOnly: true
      required:
      - bound_to
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    PolicyBinding:
      type: object
      description: PolicyBinding Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Policy binding uuid
        policy:
          type: string
          format: uuid
          nullable: true
        group:
          type: string
          format: uuid
          nullable: true
        user:
          type: integer
          nullable: true
        policy_obj:
          allOf:
          - $ref: '#/components/schemas/Policy'
          readOnly: true
        group_obj:
          allOf:
          - $ref: '#/components/schemas/PartialGroup'
          readOnly: true
        user_obj:
          allOf:
          - $ref: '#/components/schemas/PartialUser'
          readOnly: true
        target:
          type: string
          format: uuid
        negate:
          type: boolean
          description: Negates the outcome of the policy. Messages are unaffected.
        enabled:
          type: boolean
        order:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        timeout:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: Timeout after which Policy execution is terminated.
        failure_result:
          type: boolean
          description: Result if the Policy execution fails.
      required:
      - group_obj
      - order
      - pk
      - policy_obj
      - target
      - user_obj
    PolicyBindingRequest:
      type: object
      description: PolicyBinding Serializer
      properties:
        policy:
          type: string
          format: uuid
          nullable: true
        group:
          type: string
          format: uuid
          nullable: true
        user:
          type: integer
          nullable: true
        target:
          type: string
          format: uuid
        negate:
          type: boolean
          description: Negates the outcome of the policy. Messages are unaffected.
        enabled:
          type: boolean
        order:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        timeout:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: Timeout after which Policy execution is terminated.
        failure_result:
          type: boolean
          description: Result if the Policy execution fails.
      required:
      - order
      - target
    PolicyEngineMode:
      enum:
      - all
      - any
      type: string
    PolicyTestRequest:
      type: object
      description: Test policy execution for a user with context
      properties:
        user:
          type: integer
        context:
          type: object
          additionalProperties: {}
      required:
      - user
    PolicyTestResult:
      type: object
      description: result of a policy test
      properties:
        passing:
          type: boolean
        messages:
          type: array
          items:
            type: string
          readOnly: true
        log_messages:
          type: array
          items:
            $ref: '#/components/schemas/LogEvent'
          readOnly: true
      required:
      - log_messages
      - messages
      - passing
    Process:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        user:
          type: string
      required:
      - id
      - name
    ProcessRequest:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
          minLength: 1
        user:
          type: string
          minLength: 1
      required:
      - id
      - name
    Prompt:
      type: object
      description: Prompt Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Prompt uuid
        name:
          type: string
        field_key:
          type: string
          description: Name of the form field, also used to store the value
        label:
          type: string
        type:
          $ref: '#/components/schemas/PromptTypeEnum'
        required:
          type: boolean
        placeholder:
          type: string
          description: Optionally provide a short hint that describes the expected
            input value. When creating a fixed choice field, enable interpreting as
            expression and return a list to return multiple choices.
        initial_value:
          type: string
          description: Optionally pre-fill the input with an initial value. When creating
            a fixed choice field, enable interpreting as expression and return a list
            to return multiple default choices.
        order:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        prompt_stages_obj:
          type: array
          items:
            $ref: '#/components/schemas/PromptStage'
          readOnly: true
        sub_text:
          type: string
        placeholder_expression:
          type: boolean
        initial_value_expression:
          type: boolean
      required:
      - field_key
      - label
      - name
      - pk
      - prompt_stages_obj
      - type
    PromptChallenge:
      type: object
      description: Initial challenge being sent, define fields
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-prompt
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        fields:
          type: array
          items:
            $ref: '#/components/schemas/StagePrompt'
      required:
      - fields
    PromptChallengeResponseRequest:
      type: object
      description: |-
        Validate response, fields are dynamically created based
        on the stage
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-prompt
      additionalProperties: {}
    PromptChoice:
      type: object
      description: Serializer for a single Choice field
      properties:
        value:
          type: string
        label:
          type: string
      required:
      - label
      - value
    PromptRequest:
      type: object
      description: Prompt Serializer
      properties:
        name:
          type: string
          minLength: 1
        field_key:
          type: string
          minLength: 1
          description: Name of the form field, also used to store the value
        label:
          type: string
          minLength: 1
        type:
          $ref: '#/components/schemas/PromptTypeEnum'
        required:
          type: boolean
        placeholder:
          type: string
          description: Optionally provide a short hint that describes the expected
            input value. When creating a fixed choice field, enable interpreting as
            expression and return a list to return multiple choices.
        initial_value:
          type: string
          description: Optionally pre-fill the input with an initial value. When creating
            a fixed choice field, enable interpreting as expression and return a list
            to return multiple default choices.
        order:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        sub_text:
          type: string
        placeholder_expression:
          type: boolean
        initial_value_expression:
          type: boolean
      required:
      - field_key
      - label
      - name
      - type
    PromptStage:
      type: object
      description: PromptStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        fields:
          type: array
          items:
            type: string
            format: uuid
        validation_policies:
          type: array
          items:
            type: string
            format: uuid
      required:
      - component
      - fields
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    PromptStageRequest:
      type: object
      description: PromptStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        fields:
          type: array
          items:
            type: string
            format: uuid
        validation_policies:
          type: array
          items:
            type: string
            format: uuid
      required:
      - fields
      - name
    PromptTypeEnum:
      enum:
      - text
      - text_area
      - text_read_only
      - text_area_read_only
      - username
      - email
      - password
      - number
      - checkbox
      - radio-button-group
      - dropdown
      - date
      - date-time
      - file
      - separator
      - hidden
      - static
      - ak-locale
      type: string
    PropertyMapping:
      type: object
      description: PropertyMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
        expression:
          type: string
        component:
          type: string
          description: Get object's component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
      required:
      - component
      - expression
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    PropertyMappingPreview:
      type: object
      description: Preview how the current user is mapped via the property mappings
        selected in a provider
      properties:
        preview:
          type: object
          additionalProperties: {}
          readOnly: true
      required:
      - preview
    PropertyMappingTestRequest:
      type: object
      description: Test property mapping execution for a user/group with context
      properties:
        user:
          type: integer
          nullable: true
        context:
          type: object
          additionalProperties: {}
        group:
          type: string
          format: uuid
          nullable: true
    PropertyMappingTestResult:
      type: object
      description: Result of a Property-mapping test
      properties:
        result:
          type: string
          readOnly: true
        successful:
          type: boolean
          readOnly: true
      required:
      - result
      - successful
    ProtocolEnum:
      enum:
      - rdp
      - vnc
      - ssh
      type: string
    Provider:
      type: object
      description: Provider Serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        assigned_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        assigned_backchannel_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_backchannel_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
      required:
      - assigned_application_name
      - assigned_application_slug
      - assigned_backchannel_application_name
      - assigned_backchannel_application_slug
      - authorization_flow
      - component
      - invalidation_flow
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    ProviderEnum:
      enum:
      - twilio
      - generic
      type: string
    ProviderModelEnum:
      enum:
      - authentik_providers_google_workspace.googleworkspaceprovider
      - authentik_providers_ldap.ldapprovider
      - authentik_providers_microsoft_entra.microsoftentraprovider
      - authentik_providers_oauth2.oauth2provider
      - authentik_providers_proxy.proxyprovider
      - authentik_providers_rac.racprovider
      - authentik_providers_radius.radiusprovider
      - authentik_providers_saml.samlprovider
      - authentik_providers_scim.scimprovider
      - authentik_providers_ssf.ssfprovider
      type: string
    ProviderTypeEnum:
      enum:
      - apple
      - openidconnect
      - entraid
      - azuread
      - discord
      - facebook
      - github
      - gitlab
      - google
      - mailcow
      - okta
      - patreon
      - reddit
      - twitch
      - twitter
      type: string
    ProxyMode:
      enum:
      - proxy
      - forward_single
      - forward_domain
      type: string
    ProxyOutpostConfig:
      type: object
      description: Proxy provider serializer for outposts
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
        internal_host:
          type: string
          format: uri
        external_host:
          type: string
          format: uri
        internal_host_ssl_validation:
          type: boolean
          description: Validate SSL Certificates of upstream servers
        client_id:
          type: string
          maxLength: 255
        client_secret:
          type: string
          maxLength: 255
        oidc_configuration:
          allOf:
          - $ref: '#/components/schemas/OpenIDConnectConfiguration'
          readOnly: true
        cookie_secret:
          type: string
        certificate:
          type: string
          format: uuid
          nullable: true
        skip_path_regex:
          type: string
          description: Regular expressions for which authentication is not required.
            Each new line is interpreted as a new Regular Expression.
        basic_auth_enabled:
          type: boolean
          title: Set HTTP-Basic Authentication
          description: Set a custom HTTP-Basic Authentication header based on values
            from authentik.
        basic_auth_password_attribute:
          type: string
          title: HTTP-Basic Password Key
          description: User/Group Attribute used for the password part of the HTTP-Basic
            Header.
        basic_auth_user_attribute:
          type: string
          title: HTTP-Basic Username Key
          description: User/Group Attribute used for the user part of the HTTP-Basic
            Header. If not set, the user's Email address is used.
        mode:
          allOf:
          - $ref: '#/components/schemas/ProxyMode'
          description: Enable support for forwardAuth in traefik and nginx auth_request.
            Exclusive with internal_host.
        cookie_domain:
          type: string
        access_token_validity:
          type: number
          format: double
          nullable: true
          description: Get token validity as second count
          readOnly: true
        intercept_header_auth:
          type: boolean
          description: When enabled, this provider will intercept the authorization
            header and authenticate requests based on its value.
        scopes_to_request:
          type: array
          items:
            type: string
          description: |-
            Get all the scope names the outpost should request,
            including custom-defined ones
          readOnly: true
        assigned_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
      required:
      - access_token_validity
      - assigned_application_name
      - assigned_application_slug
      - external_host
      - name
      - oidc_configuration
      - pk
      - scopes_to_request
    ProxyProvider:
      type: object
      description: ProxyProvider Serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        assigned_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        assigned_backchannel_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_backchannel_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        client_id:
          type: string
          readOnly: true
        internal_host:
          type: string
          format: uri
        external_host:
          type: string
          format: uri
        internal_host_ssl_validation:
          type: boolean
          description: Validate SSL Certificates of upstream servers
        certificate:
          type: string
          format: uuid
          nullable: true
        skip_path_regex:
          type: string
          description: Regular expressions for which authentication is not required.
            Each new line is interpreted as a new Regular Expression.
        basic_auth_enabled:
          type: boolean
          title: Set HTTP-Basic Authentication
          description: Set a custom HTTP-Basic Authentication header based on values
            from authentik.
        basic_auth_password_attribute:
          type: string
          title: HTTP-Basic Password Key
          description: User/Group Attribute used for the password part of the HTTP-Basic
            Header.
        basic_auth_user_attribute:
          type: string
          title: HTTP-Basic Username Key
          description: User/Group Attribute used for the user part of the HTTP-Basic
            Header. If not set, the user's Email address is used.
        mode:
          allOf:
          - $ref: '#/components/schemas/ProxyMode'
          description: Enable support for forwardAuth in traefik and nginx auth_request.
            Exclusive with internal_host.
        intercept_header_auth:
          type: boolean
          description: When enabled, this provider will intercept the authorization
            header and authenticate requests based on its value.
        redirect_uris:
          type: array
          items:
            $ref: '#/components/schemas/RedirectURI'
          readOnly: true
        cookie_domain:
          type: string
        jwt_federation_sources:
          type: array
          items:
            type: string
            format: uuid
            title: Any JWT signed by the JWK of the selected source can be used to
              authenticate.
          title: Any JWT signed by the JWK of the selected source can be used to authenticate.
        jwt_federation_providers:
          type: array
          items:
            type: integer
        access_token_validity:
          type: string
          description: 'Tokens not valid on or after current time + this value (Format:
            hours=1;minutes=2;seconds=3).'
        refresh_token_validity:
          type: string
          description: 'Tokens not valid on or after current time + this value (Format:
            hours=1;minutes=2;seconds=3).'
        outpost_set:
          type: array
          items:
            type: string
          readOnly: true
      required:
      - assigned_application_name
      - assigned_application_slug
      - assigned_backchannel_application_name
      - assigned_backchannel_application_slug
      - authorization_flow
      - client_id
      - component
      - external_host
      - invalidation_flow
      - meta_model_name
      - name
      - outpost_set
      - pk
      - redirect_uris
      - verbose_name
      - verbose_name_plural
    ProxyProviderRequest:
      type: object
      description: ProxyProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        internal_host:
          type: string
          format: uri
        external_host:
          type: string
          minLength: 1
          format: uri
        internal_host_ssl_validation:
          type: boolean
          description: Validate SSL Certificates of upstream servers
        certificate:
          type: string
          format: uuid
          nullable: true
        skip_path_regex:
          type: string
          description: Regular expressions for which authentication is not required.
            Each new line is interpreted as a new Regular Expression.
        basic_auth_enabled:
          type: boolean
          title: Set HTTP-Basic Authentication
          description: Set a custom HTTP-Basic Authentication header based on values
            from authentik.
        basic_auth_password_attribute:
          type: string
          title: HTTP-Basic Password Key
          description: User/Group Attribute used for the password part of the HTTP-Basic
            Header.
        basic_auth_user_attribute:
          type: string
          title: HTTP-Basic Username Key
          description: User/Group Attribute used for the user part of the HTTP-Basic
            Header. If not set, the user's Email address is used.
        mode:
          allOf:
          - $ref: '#/components/schemas/ProxyMode'
          description: Enable support for forwardAuth in traefik and nginx auth_request.
            Exclusive with internal_host.
        intercept_header_auth:
          type: boolean
          description: When enabled, this provider will intercept the authorization
            header and authenticate requests based on its value.
        cookie_domain:
          type: string
        jwt_federation_sources:
          type: array
          items:
            type: string
            format: uuid
            title: Any JWT signed by the JWK of the selected source can be used to
              authenticate.
          title: Any JWT signed by the JWK of the selected source can be used to authenticate.
        jwt_federation_providers:
          type: array
          items:
            type: integer
        access_token_validity:
          type: string
          minLength: 1
          description: 'Tokens not valid on or after current time + this value (Format:
            hours=1;minutes=2;seconds=3).'
        refresh_token_validity:
          type: string
          minLength: 1
          description: 'Tokens not valid on or after current time + this value (Format:
            hours=1;minutes=2;seconds=3).'
      required:
      - authorization_flow
      - external_host
      - invalidation_flow
      - name
    RACPropertyMapping:
      type: object
      description: RACPropertyMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
        expression:
          type: string
        component:
          type: string
          description: Get object's component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        static_settings:
          type: object
          additionalProperties: {}
      required:
      - component
      - meta_model_name
      - name
      - pk
      - static_settings
      - verbose_name
      - verbose_name_plural
    RACPropertyMappingRequest:
      type: object
      description: RACPropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
        static_settings:
          type: object
          additionalProperties: {}
      required:
      - name
      - static_settings
    RACProvider:
      type: object
      description: RACProvider Serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        assigned_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        assigned_backchannel_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_backchannel_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        settings:
          type: object
          additionalProperties: {}
        outpost_set:
          type: array
          items:
            type: string
          readOnly: true
        connection_expiry:
          type: string
          description: 'Determines how long a session lasts. Default of 0 means that
            the sessions lasts until the browser is closed. (Format: hours=-1;minutes=-2;seconds=-3)'
        delete_token_on_disconnect:
          type: boolean
          description: When set to true, connection tokens will be deleted upon disconnect.
      required:
      - assigned_application_name
      - assigned_application_slug
      - assigned_backchannel_application_name
      - assigned_backchannel_application_slug
      - authorization_flow
      - component
      - meta_model_name
      - name
      - outpost_set
      - pk
      - verbose_name
      - verbose_name_plural
    RACProviderRequest:
      type: object
      description: RACProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        settings:
          type: object
          additionalProperties: {}
        connection_expiry:
          type: string
          minLength: 1
          description: 'Determines how long a session lasts. Default of 0 means that
            the sessions lasts until the browser is closed. (Format: hours=-1;minutes=-2;seconds=-3)'
        delete_token_on_disconnect:
          type: boolean
          description: When set to true, connection tokens will be deleted upon disconnect.
      required:
      - authorization_flow
      - name
    RadiusCheckAccess:
      type: object
      description: Base serializer class which doesn't implement create/update methods
      properties:
        attributes:
          type: string
        access:
          $ref: '#/components/schemas/PolicyTestResult'
      required:
      - access
    RadiusOutpostConfig:
      type: object
      description: RadiusProvider Serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
        application_slug:
          type: string
        auth_flow_slug:
          type: string
        client_networks:
          type: string
          description: List of CIDRs (comma-separated) that clients can connect from.
            A more specific CIDR will match before a looser one. Clients connecting
            from a non-specified CIDR will be dropped.
        shared_secret:
          type: string
          description: Shared secret between clients and server to hash packets.
        mfa_support:
          type: boolean
          description: When enabled, code-based multi-factor authentication can be
            used by appending a semicolon and the TOTP code to the password. This
            should only be enabled if all users that will bind to this provider have
            a TOTP device configured, as otherwise a password may incorrectly be rejected
            if it contains a semicolon.
        certificate:
          type: string
          format: uuid
          nullable: true
      required:
      - application_slug
      - auth_flow_slug
      - name
      - pk
    RadiusProvider:
      type: object
      description: RadiusProvider Serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        assigned_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        assigned_backchannel_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_backchannel_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        client_networks:
          type: string
          description: List of CIDRs (comma-separated) that clients can connect from.
            A more specific CIDR will match before a looser one. Clients connecting
            from a non-specified CIDR will be dropped.
        shared_secret:
          type: string
          description: Shared secret between clients and server to hash packets.
        outpost_set:
          type: array
          items:
            type: string
          readOnly: true
        mfa_support:
          type: boolean
          description: When enabled, code-based multi-factor authentication can be
            used by appending a semicolon and the TOTP code to the password. This
            should only be enabled if all users that will bind to this provider have
            a TOTP device configured, as otherwise a password may incorrectly be rejected
            if it contains a semicolon.
        certificate:
          type: string
          format: uuid
          nullable: true
      required:
      - assigned_application_name
      - assigned_application_slug
      - assigned_backchannel_application_name
      - assigned_backchannel_application_slug
      - authorization_flow
      - component
      - invalidation_flow
      - meta_model_name
      - name
      - outpost_set
      - pk
      - verbose_name
      - verbose_name_plural
    RadiusProviderPropertyMapping:
      type: object
      description: RadiusProviderPropertyMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
        expression:
          type: string
        component:
          type: string
          description: Get object's component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
      required:
      - component
      - expression
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    RadiusProviderPropertyMappingRequest:
      type: object
      description: RadiusProviderPropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
      required:
      - expression
      - name
    RadiusProviderRequest:
      type: object
      description: RadiusProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        client_networks:
          type: string
          minLength: 1
          description: List of CIDRs (comma-separated) that clients can connect from.
            A more specific CIDR will match before a looser one. Clients connecting
            from a non-specified CIDR will be dropped.
        shared_secret:
          type: string
          minLength: 1
          description: Shared secret between clients and server to hash packets.
        mfa_support:
          type: boolean
          description: When enabled, code-based multi-factor authentication can be
            used by appending a semicolon and the TOTP code to the password. This
            should only be enabled if all users that will bind to this provider have
            a TOTP device configured, as otherwise a password may incorrectly be rejected
            if it contains a semicolon.
        certificate:
          type: string
          format: uuid
          nullable: true
      required:
      - authorization_flow
      - invalidation_flow
      - name
    RedirectChallenge:
      type: object
      description: Challenge type to redirect the client
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: xak-flow-redirect
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        to:
          type: string
      required:
      - to
    RedirectChallengeResponseRequest:
      type: object
      description: Redirect challenge response
      properties:
        component:
          type: string
          minLength: 1
          default: xak-flow-redirect
        to:
          type: string
          minLength: 1
      required:
      - to
    RedirectStage:
      type: object
      description: RedirectStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        keep_context:
          type: boolean
        mode:
          $ref: '#/components/schemas/RedirectStageModeEnum'
        target_static:
          type: string
        target_flow:
          type: string
          format: uuid
          nullable: true
      required:
      - component
      - meta_model_name
      - mode
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    RedirectStageModeEnum:
      enum:
      - static
      - flow
      type: string
    RedirectStageRequest:
      type: object
      description: RedirectStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        keep_context:
          type: boolean
        mode:
          $ref: '#/components/schemas/RedirectStageModeEnum'
        target_static:
          type: string
        target_flow:
          type: string
          format: uuid
          nullable: true
      required:
      - mode
      - name
    RedirectURI:
      type: object
      description: A single allowed redirect URI entry
      properties:
        matching_mode:
          $ref: '#/components/schemas/MatchingModeEnum'
        url:
          type: string
      required:
      - matching_mode
      - url
    RedirectURIRequest:
      type: object
      description: A single allowed redirect URI entry
      properties:
        matching_mode:
          $ref: '#/components/schemas/MatchingModeEnum'
        url:
          type: string
          minLength: 1
      required:
      - matching_mode
      - url
    Reputation:
      type: object
      description: Reputation Serializer
      properties:
        pk:
          type: string
          format: uuid
          title: Reputation uuid
        identifier:
          type: string
        ip:
          type: string
        ip_geo_data:
          type: object
          additionalProperties: {}
        ip_asn_data:
          type: object
          additionalProperties: {}
        score:
          type: integer
          maximum: 9223372036854775807
          minimum: -9223372036854775808
          format: int64
        updated:
          type: string
          format: date-time
          readOnly: true
      required:
      - identifier
      - ip
      - updated
    ReputationPolicy:
      type: object
      description: Reputation Policy Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Policy uuid
        name:
          type: string
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        bound_to:
          type: integer
          description: Return objects policy is bound to
          readOnly: true
        check_ip:
          type: boolean
        check_username:
          type: boolean
        threshold:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
      required:
      - bound_to
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    ReputationPolicyRequest:
      type: object
      description: Reputation Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        check_ip:
          type: boolean
        check_username:
          type: boolean
        threshold:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
      required:
      - name
    ResidentKeyRequirementEnum:
      enum:
      - discouraged
      - preferred
      - required
      type: string
    Role:
      type: object
      description: Role serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Uuid
        name:
          type: string
          maxLength: 150
      required:
      - name
      - pk
    RoleAssignedObjectPermission:
      type: object
      description: Roles assigned object permission serializer
      properties:
        role_pk:
          type: string
          readOnly: true
        name:
          type: string
          readOnly: true
        permissions:
          type: array
          items:
            $ref: '#/components/schemas/RoleObjectPermission'
      required:
      - name
      - permissions
      - role_pk
    RoleObjectPermission:
      type: object
      description: Role-bound object level permission
      properties:
        id:
          type: integer
          readOnly: true
        codename:
          type: string
          readOnly: true
        model:
          type: string
          title: Python model class name
          readOnly: true
        app_label:
          type: string
          readOnly: true
        object_pk:
          type: string
        name:
          type: string
          readOnly: true
      required:
      - app_label
      - codename
      - id
      - model
      - name
      - object_pk
    RoleRequest:
      type: object
      description: Role serializer
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 150
      required:
      - name
    SAMLBindingsEnum:
      enum:
      - redirect
      - post
      type: string
    SAMLMetadata:
      type: object
      description: SAML Provider Metadata serializer
      properties:
        metadata:
          type: string
          readOnly: true
        download_url:
          type: string
          readOnly: true
      required:
      - download_url
      - metadata
    SAMLNameIDPolicyEnum:
      enum:
      - urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress
      - urn:oasis:names:tc:SAML:2.0:nameid-format:persistent
      - urn:oasis:names:tc:SAML:1.1:nameid-format:X509SubjectName
      - urn:oasis:names:tc:SAML:2.0:nameid-format:WindowsDomainQualifiedName
      - urn:oasis:names:tc:SAML:2.0:nameid-format:transient
      - urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified
      type: string
    SAMLPropertyMapping:
      type: object
      description: SAMLPropertyMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
        expression:
          type: string
        component:
          type: string
          description: Get object's component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        saml_name:
          type: string
        friendly_name:
          type: string
          nullable: true
      required:
      - component
      - expression
      - meta_model_name
      - name
      - pk
      - saml_name
      - verbose_name
      - verbose_name_plural
    SAMLPropertyMappingRequest:
      type: object
      description: SAMLPropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
        saml_name:
          type: string
          minLength: 1
        friendly_name:
          type: string
          nullable: true
      required:
      - expression
      - name
      - saml_name
    SAMLProvider:
      type: object
      description: SAMLProvider Serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        assigned_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        assigned_backchannel_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_backchannel_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        acs_url:
          type: string
          format: uri
        sls_url:
          type: string
          description: Single Logout Service URL where the logout response should
            be sent.
          format: uri
        audience:
          type: string
          description: Value of the audience restriction field of the assertion. When
            left empty, no audience restriction will be added.
        issuer:
          type: string
          description: Also known as EntityID
        assertion_valid_not_before:
          type: string
          description: 'Assertion valid not before current time + this value (Format:
            hours=-1;minutes=-2;seconds=-3).'
        assertion_valid_not_on_or_after:
          type: string
          description: 'Assertion not valid on or after current time + this value
            (Format: hours=1;minutes=2;seconds=3).'
        session_valid_not_on_or_after:
          type: string
          description: 'Session not valid on or after current time + this value (Format:
            hours=1;minutes=2;seconds=3).'
        name_id_mapping:
          type: string
          format: uuid
          nullable: true
          title: NameID Property Mapping
          description: Configure how the NameID value will be created. When left empty,
            the NameIDPolicy of the incoming request will be considered
        authn_context_class_ref_mapping:
          type: string
          format: uuid
          nullable: true
          title: AuthnContextClassRef Property Mapping
          description: Configure how the AuthnContextClassRef value will be created.
            When left empty, the AuthnContextClassRef will be set based on which authentication
            methods the user used to authenticate.
        digest_algorithm:
          $ref: '#/components/schemas/DigestAlgorithmEnum'
        signature_algorithm:
          $ref: '#/components/schemas/SignatureAlgorithmEnum'
        signing_kp:
          type: string
          format: uuid
          nullable: true
          title: Signing Keypair
          description: Keypair used to sign outgoing Responses going to the Service
            Provider.
        verification_kp:
          type: string
          format: uuid
          nullable: true
          title: Verification Certificate
          description: When selected, incoming assertion's Signatures will be validated
            against this certificate. To allow unsigned Requests, leave on default.
        encryption_kp:
          type: string
          format: uuid
          nullable: true
          title: Encryption Keypair
          description: When selected, incoming assertions are encrypted by the IdP
            using the public key of the encryption keypair. The assertion is decrypted
            by the SP using the the private key.
        sign_assertion:
          type: boolean
        sign_response:
          type: boolean
        sign_logout_request:
          type: boolean
        sp_binding:
          allOf:
          - $ref: '#/components/schemas/SAMLBindingsEnum'
          title: Service Provider Binding
          description: This determines how authentik sends the response back to the
            Service Provider.
        sls_binding:
          allOf:
          - $ref: '#/components/schemas/SAMLBindingsEnum'
          description: This determines how authentik sends the logout response back
            to the Service Provider.
        logout_method:
          allOf:
          - $ref: '#/components/schemas/SAMLProviderLogoutMethodEnum'
          description: Method to use for logout. Front-channel iframe loads all logout
            URLs simultaneously in hidden iframes. Front-channel native uses your
            active browser tab to send post requests and redirect to providers. Back-channel
            sends logout requests directly from the server without user interaction
            (requires POST SLS binding).
        default_relay_state:
          type: string
          description: Default relay_state value for IDP-initiated logins
        default_name_id_policy:
          $ref: '#/components/schemas/SAMLNameIDPolicyEnum'
        url_download_metadata:
          type: string
          description: Get metadata download URL
          readOnly: true
        url_sso_post:
          type: string
          description: Get SSO Post URL
          readOnly: true
        url_sso_redirect:
          type: string
          description: Get SSO Redirect URL
          readOnly: true
        url_sso_init:
          type: string
          description: Get SSO IDP-Initiated URL
          readOnly: true
        url_slo_post:
          type: string
          description: Get SLO POST URL
          readOnly: true
        url_slo_redirect:
          type: string
          description: Get SLO redirect URL
          readOnly: true
      required:
      - acs_url
      - assigned_application_name
      - assigned_application_slug
      - assigned_backchannel_application_name
      - assigned_backchannel_application_slug
      - authorization_flow
      - component
      - invalidation_flow
      - meta_model_name
      - name
      - pk
      - url_download_metadata
      - url_slo_post
      - url_slo_redirect
      - url_sso_init
      - url_sso_post
      - url_sso_redirect
      - verbose_name
      - verbose_name_plural
    SAMLProviderImportRequest:
      type: object
      description: Import saml provider from XML Metadata
      properties:
        name:
          type: string
          minLength: 1
        authorization_flow:
          type: string
          format: uuid
        invalidation_flow:
          type: string
          format: uuid
        file:
          type: string
          format: binary
      required:
      - authorization_flow
      - file
      - invalidation_flow
      - name
    SAMLProviderLogoutMethodEnum:
      enum:
      - frontchannel_iframe
      - frontchannel_native
      - backchannel
      type: string
    SAMLProviderRequest:
      type: object
      description: SAMLProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow used for authentication when the associated application
            is accessed by an un-authenticated user.
        authorization_flow:
          type: string
          format: uuid
          description: Flow used when authorizing this provider.
        invalidation_flow:
          type: string
          format: uuid
          description: Flow used ending the session from a provider.
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        acs_url:
          type: string
          minLength: 1
          format: uri
        sls_url:
          type: string
          description: Single Logout Service URL where the logout response should
            be sent.
          format: uri
        audience:
          type: string
          description: Value of the audience restriction field of the assertion. When
            left empty, no audience restriction will be added.
        issuer:
          type: string
          minLength: 1
          description: Also known as EntityID
        assertion_valid_not_before:
          type: string
          minLength: 1
          description: 'Assertion valid not before current time + this value (Format:
            hours=-1;minutes=-2;seconds=-3).'
        assertion_valid_not_on_or_after:
          type: string
          minLength: 1
          description: 'Assertion not valid on or after current time + this value
            (Format: hours=1;minutes=2;seconds=3).'
        session_valid_not_on_or_after:
          type: string
          minLength: 1
          description: 'Session not valid on or after current time + this value (Format:
            hours=1;minutes=2;seconds=3).'
        name_id_mapping:
          type: string
          format: uuid
          nullable: true
          title: NameID Property Mapping
          description: Configure how the NameID value will be created. When left empty,
            the NameIDPolicy of the incoming request will be considered
        authn_context_class_ref_mapping:
          type: string
          format: uuid
          nullable: true
          title: AuthnContextClassRef Property Mapping
          description: Configure how the AuthnContextClassRef value will be created.
            When left empty, the AuthnContextClassRef will be set based on which authentication
            methods the user used to authenticate.
        digest_algorithm:
          $ref: '#/components/schemas/DigestAlgorithmEnum'
        signature_algorithm:
          $ref: '#/components/schemas/SignatureAlgorithmEnum'
        signing_kp:
          type: string
          format: uuid
          nullable: true
          title: Signing Keypair
          description: Keypair used to sign outgoing Responses going to the Service
            Provider.
        verification_kp:
          type: string
          format: uuid
          nullable: true
          title: Verification Certificate
          description: When selected, incoming assertion's Signatures will be validated
            against this certificate. To allow unsigned Requests, leave on default.
        encryption_kp:
          type: string
          format: uuid
          nullable: true
          title: Encryption Keypair
          description: When selected, incoming assertions are encrypted by the IdP
            using the public key of the encryption keypair. The assertion is decrypted
            by the SP using the the private key.
        sign_assertion:
          type: boolean
        sign_response:
          type: boolean
        sign_logout_request:
          type: boolean
        sp_binding:
          allOf:
          - $ref: '#/components/schemas/SAMLBindingsEnum'
          title: Service Provider Binding
          description: This determines how authentik sends the response back to the
            Service Provider.
        sls_binding:
          allOf:
          - $ref: '#/components/schemas/SAMLBindingsEnum'
          description: This determines how authentik sends the logout response back
            to the Service Provider.
        logout_method:
          allOf:
          - $ref: '#/components/schemas/SAMLProviderLogoutMethodEnum'
          description: Method to use for logout. Front-channel iframe loads all logout
            URLs simultaneously in hidden iframes. Front-channel native uses your
            active browser tab to send post requests and redirect to providers. Back-channel
            sends logout requests directly from the server without user interaction
            (requires POST SLS binding).
        default_relay_state:
          type: string
          description: Default relay_state value for IDP-initiated logins
        default_name_id_policy:
          $ref: '#/components/schemas/SAMLNameIDPolicyEnum'
      required:
      - acs_url
      - authorization_flow
      - invalidation_flow
      - name
    SAMLSource:
      type: object
      description: SAMLSource Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pbm uuid
        name:
          type: string
          description: Source's display Name.
        slug:
          type: string
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
          readOnly: true
        user_path_template:
          type: string
        icon:
          type: string
          readOnly: true
        group_matching_mode:
          allOf:
          - $ref: '#/components/schemas/GroupMatchingModeEnum'
          description: How the source determines if an existing group should be used
            or a new group created.
        pre_authentication_flow:
          type: string
          format: uuid
          description: Flow used before authentication.
        issuer:
          type: string
          description: Also known as Entity ID. Defaults the Metadata URL.
        sso_url:
          type: string
          description: URL that the initial Login request is sent to.
          format: uri
        slo_url:
          type: string
          nullable: true
          description: Optional URL if your IDP supports Single-Logout.
          format: uri
        allow_idp_initiated:
          type: boolean
          description: Allows authentication flows initiated by the IdP. This can
            be a security risk, as no validation of the request ID is done.
        name_id_policy:
          allOf:
          - $ref: '#/components/schemas/SAMLNameIDPolicyEnum'
          description: NameID Policy sent to the IdP. Can be unset, in which case
            no Policy is sent.
        binding_type:
          $ref: '#/components/schemas/BindingTypeEnum'
        verification_kp:
          type: string
          format: uuid
          nullable: true
          title: Verification Certificate
          description: When selected, incoming assertion's Signatures will be validated
            against this certificate. To allow unsigned Requests, leave on default.
        signing_kp:
          type: string
          format: uuid
          nullable: true
          title: Signing Keypair
          description: Keypair used to sign outgoing Responses going to the Identity
            Provider.
        digest_algorithm:
          $ref: '#/components/schemas/DigestAlgorithmEnum'
        signature_algorithm:
          $ref: '#/components/schemas/SignatureAlgorithmEnum'
        temporary_user_delete_after:
          type: string
          title: Delete temporary users after
          description: 'Time offset when temporary users should be deleted. This only
            applies if your IDP uses the NameID Format ''transient'', and the user
            doesn''t log out manually. (Format: hours=1;minutes=2;seconds=3).'
        encryption_kp:
          type: string
          format: uuid
          nullable: true
          title: Encryption Keypair
          description: When selected, incoming assertions are encrypted by the IdP
            using the public key of the encryption keypair. The assertion is decrypted
            by the SP using the the private key.
        signed_assertion:
          type: boolean
        signed_response:
          type: boolean
      required:
      - component
      - icon
      - managed
      - meta_model_name
      - name
      - pk
      - pre_authentication_flow
      - slug
      - sso_url
      - verbose_name
      - verbose_name_plural
    SAMLSourcePropertyMapping:
      type: object
      description: SAMLSourcePropertyMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
        expression:
          type: string
        component:
          type: string
          description: Get object's component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
      required:
      - component
      - expression
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    SAMLSourcePropertyMappingRequest:
      type: object
      description: SAMLSourcePropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
      required:
      - expression
      - name
    SAMLSourceRequest:
      type: object
      description: SAMLSource Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Source's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        user_path_template:
          type: string
          minLength: 1
        group_matching_mode:
          allOf:
          - $ref: '#/components/schemas/GroupMatchingModeEnum'
          description: How the source determines if an existing group should be used
            or a new group created.
        pre_authentication_flow:
          type: string
          format: uuid
          description: Flow used before authentication.
        issuer:
          type: string
          description: Also known as Entity ID. Defaults the Metadata URL.
        sso_url:
          type: string
          minLength: 1
          description: URL that the initial Login request is sent to.
          format: uri
        slo_url:
          type: string
          nullable: true
          description: Optional URL if your IDP supports Single-Logout.
          format: uri
        allow_idp_initiated:
          type: boolean
          description: Allows authentication flows initiated by the IdP. This can
            be a security risk, as no validation of the request ID is done.
        name_id_policy:
          allOf:
          - $ref: '#/components/schemas/SAMLNameIDPolicyEnum'
          description: NameID Policy sent to the IdP. Can be unset, in which case
            no Policy is sent.
        binding_type:
          $ref: '#/components/schemas/BindingTypeEnum'
        verification_kp:
          type: string
          format: uuid
          nullable: true
          title: Verification Certificate
          description: When selected, incoming assertion's Signatures will be validated
            against this certificate. To allow unsigned Requests, leave on default.
        signing_kp:
          type: string
          format: uuid
          nullable: true
          title: Signing Keypair
          description: Keypair used to sign outgoing Responses going to the Identity
            Provider.
        digest_algorithm:
          $ref: '#/components/schemas/DigestAlgorithmEnum'
        signature_algorithm:
          $ref: '#/components/schemas/SignatureAlgorithmEnum'
        temporary_user_delete_after:
          type: string
          minLength: 1
          title: Delete temporary users after
          description: 'Time offset when temporary users should be deleted. This only
            applies if your IDP uses the NameID Format ''transient'', and the user
            doesn''t log out manually. (Format: hours=1;minutes=2;seconds=3).'
        encryption_kp:
          type: string
          format: uuid
          nullable: true
          title: Encryption Keypair
          description: When selected, incoming assertions are encrypted by the IdP
            using the public key of the encryption keypair. The assertion is decrypted
            by the SP using the the private key.
        signed_assertion:
          type: boolean
        signed_response:
          type: boolean
      required:
      - name
      - pre_authentication_flow
      - slug
      - sso_url
    SCIMAuthenticationModeEnum:
      enum:
      - token
      - oauth
      type: string
    SCIMMapping:
      type: object
      description: SCIMMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
        expression:
          type: string
        component:
          type: string
          description: Get object's component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
      required:
      - component
      - expression
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    SCIMMappingRequest:
      type: object
      description: SCIMMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
      required:
      - expression
      - name
    SCIMProvider:
      type: object
      description: SCIMProvider Serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        property_mappings_group:
          type: array
          items:
            type: string
            format: uuid
          description: Property mappings used for group creation/updating.
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        assigned_backchannel_application_slug:
          type: string
          description: Internal application name, used in URLs.
          readOnly: true
        assigned_backchannel_application_name:
          type: string
          description: Application's display Name.
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        url:
          type: string
          description: Base URL to SCIM requests, usually ends in /v2
        verify_certificates:
          type: boolean
        token:
          type: string
          description: Authentication token
        auth_mode:
          $ref: '#/components/schemas/SCIMAuthenticationModeEnum'
        auth_oauth:
          type: string
          format: uuid
          nullable: true
          description: OAuth Source used for authentication
        auth_oauth_params:
          type: object
          additionalProperties: {}
          description: Additional OAuth parameters, such as grant_type
        compatibility_mode:
          allOf:
          - $ref: '#/components/schemas/CompatibilityModeEnum'
          title: SCIM Compatibility Mode
          description: Alter authentik behavior for vendor-specific SCIM implementations.
        exclude_users_service_account:
          type: boolean
        filter_group:
          type: string
          format: uuid
          nullable: true
        sync_page_size:
          type: integer
          maximum: 2147483647
          minimum: 1
          description: Controls the number of objects synced in a single task
        sync_page_timeout:
          type: string
          description: Timeout for synchronization of a single page
        dry_run:
          type: boolean
          description: When enabled, provider will not modify or create objects in
            the remote system.
      required:
      - assigned_backchannel_application_name
      - assigned_backchannel_application_slug
      - component
      - meta_model_name
      - name
      - pk
      - url
      - verbose_name
      - verbose_name_plural
    SCIMProviderGroup:
      type: object
      description: SCIMProviderGroup Serializer
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        scim_id:
          type: string
        group:
          type: string
          format: uuid
        group_obj:
          allOf:
          - $ref: '#/components/schemas/PartialGroup'
          readOnly: true
        provider:
          type: integer
        attributes:
          type: object
          additionalProperties: {}
          readOnly: true
      required:
      - attributes
      - group
      - group_obj
      - id
      - provider
      - scim_id
    SCIMProviderGroupRequest:
      type: object
      description: SCIMProviderGroup Serializer
      properties:
        scim_id:
          type: string
          minLength: 1
        group:
          type: string
          format: uuid
        provider:
          type: integer
      required:
      - group
      - provider
      - scim_id
    SCIMProviderRequest:
      type: object
      description: SCIMProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        property_mappings:
          type: array
          items:
            type: string
            format: uuid
        property_mappings_group:
          type: array
          items:
            type: string
            format: uuid
          description: Property mappings used for group creation/updating.
        url:
          type: string
          minLength: 1
          description: Base URL to SCIM requests, usually ends in /v2
        verify_certificates:
          type: boolean
        token:
          type: string
          description: Authentication token
        auth_mode:
          $ref: '#/components/schemas/SCIMAuthenticationModeEnum'
        auth_oauth:
          type: string
          format: uuid
          nullable: true
          description: OAuth Source used for authentication
        auth_oauth_params:
          type: object
          additionalProperties: {}
          description: Additional OAuth parameters, such as grant_type
        compatibility_mode:
          allOf:
          - $ref: '#/components/schemas/CompatibilityModeEnum'
          title: SCIM Compatibility Mode
          description: Alter authentik behavior for vendor-specific SCIM implementations.
        exclude_users_service_account:
          type: boolean
        filter_group:
          type: string
          format: uuid
          nullable: true
        sync_page_size:
          type: integer
          maximum: 2147483647
          minimum: 1
          description: Controls the number of objects synced in a single task
        sync_page_timeout:
          type: string
          minLength: 1
          description: Timeout for synchronization of a single page
        dry_run:
          type: boolean
          description: When enabled, provider will not modify or create objects in
            the remote system.
      required:
      - name
      - url
    SCIMProviderUser:
      type: object
      description: SCIMProviderUser Serializer
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        scim_id:
          type: string
        user:
          type: integer
        user_obj:
          allOf:
          - $ref: '#/components/schemas/PartialUser'
          readOnly: true
        provider:
          type: integer
        attributes:
          type: object
          additionalProperties: {}
          readOnly: true
      required:
      - attributes
      - id
      - provider
      - scim_id
      - user
      - user_obj
    SCIMProviderUserRequest:
      type: object
      description: SCIMProviderUser Serializer
      properties:
        scim_id:
          type: string
          minLength: 1
        user:
          type: integer
        provider:
          type: integer
      required:
      - provider
      - scim_id
      - user
    SCIMSource:
      type: object
      description: SCIMSource Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pbm uuid
        name:
          type: string
          description: Source's display Name.
        slug:
          type: string
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
          readOnly: true
        user_path_template:
          type: string
        root_url:
          type: string
          description: Get Root URL
          readOnly: true
        token_obj:
          allOf:
          - $ref: '#/components/schemas/Token'
          readOnly: true
      required:
      - component
      - managed
      - meta_model_name
      - name
      - pk
      - root_url
      - slug
      - token_obj
      - verbose_name
      - verbose_name_plural
    SCIMSourceGroup:
      type: object
      description: SCIMSourceGroup Serializer
      properties:
        id:
          type: string
        external_id:
          type: string
        group:
          type: string
          format: uuid
        group_obj:
          allOf:
          - $ref: '#/components/schemas/PartialGroup'
          readOnly: true
        source:
          type: string
          format: uuid
        attributes:
          type: object
          additionalProperties: {}
      required:
      - external_id
      - group
      - group_obj
      - source
    SCIMSourceGroupRequest:
      type: object
      description: SCIMSourceGroup Serializer
      properties:
        id:
          type: string
          minLength: 1
        external_id:
          type: string
          minLength: 1
        group:
          type: string
          format: uuid
        source:
          type: string
          format: uuid
        attributes:
          type: object
          additionalProperties: {}
      required:
      - external_id
      - group
      - source
    SCIMSourcePropertyMapping:
      type: object
      description: SCIMSourcePropertyMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
        expression:
          type: string
        component:
          type: string
          description: Get object's component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
      required:
      - component
      - expression
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    SCIMSourcePropertyMappingRequest:
      type: object
      description: SCIMSourcePropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
      required:
      - expression
      - name
    SCIMSourceRequest:
      type: object
      description: SCIMSource Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Source's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        user_path_template:
          type: string
          minLength: 1
      required:
      - name
      - slug
    SCIMSourceUser:
      type: object
      description: SCIMSourceUser Serializer
      properties:
        id:
          type: string
        external_id:
          type: string
        user:
          type: integer
        user_obj:
          allOf:
          - $ref: '#/components/schemas/PartialUser'
          readOnly: true
        source:
          type: string
          format: uuid
        attributes:
          type: object
          additionalProperties: {}
      required:
      - external_id
      - source
      - user
      - user_obj
    SCIMSourceUserRequest:
      type: object
      description: SCIMSourceUser Serializer
      properties:
        id:
          type: string
          minLength: 1
        external_id:
          type: string
          minLength: 1
        user:
          type: integer
        source:
          type: string
          format: uuid
        attributes:
          type: object
          additionalProperties: {}
      required:
      - external_id
      - source
      - user
    SMSDevice:
      type: object
      description: Serializer for sms authenticator devices
      properties:
        name:
          type: string
          description: The human-readable name of this device.
          maxLength: 64
        pk:
          type: integer
          readOnly: true
          title: ID
        phone_number:
          type: string
          readOnly: true
        user:
          allOf:
          - $ref: '#/components/schemas/PartialUser'
          readOnly: true
      required:
      - name
      - phone_number
      - pk
      - user
    SMSDeviceRequest:
      type: object
      description: Serializer for sms authenticator devices
      properties:
        name:
          type: string
          minLength: 1
          description: The human-readable name of this device.
          maxLength: 64
      required:
      - name
    SSFProvider:
      type: object
      description: SSFProvider Serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        signing_key:
          type: string
          format: uuid
          description: Key used to sign the SSF Events.
        token_obj:
          allOf:
          - $ref: '#/components/schemas/Token'
          readOnly: true
        oidc_auth_providers:
          type: array
          items:
            type: integer
        ssf_url:
          type: string
          nullable: true
          readOnly: true
        event_retention:
          type: string
      required:
      - component
      - meta_model_name
      - name
      - pk
      - signing_key
      - ssf_url
      - token_obj
      - verbose_name
      - verbose_name_plural
    SSFProviderRequest:
      type: object
      description: SSFProvider Serializer
      properties:
        name:
          type: string
          minLength: 1
        signing_key:
          type: string
          format: uuid
          description: Key used to sign the SSF Events.
        oidc_auth_providers:
          type: array
          items:
            type: integer
        event_retention:
          type: string
          minLength: 1
      required:
      - name
      - signing_key
    SSFStream:
      type: object
      description: SSFStream Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Uuid
        provider:
          type: integer
        provider_obj:
          allOf:
          - $ref: '#/components/schemas/SSFProvider'
          readOnly: true
        delivery_method:
          $ref: '#/components/schemas/DeliveryMethodEnum'
        endpoint_url:
          type: string
          nullable: true
        events_requested:
          type: array
          items:
            $ref: '#/components/schemas/EventsRequestedEnum'
        format:
          type: string
        aud:
          type: array
          items:
            type: string
        iss:
          type: string
      required:
      - delivery_method
      - format
      - iss
      - pk
      - provider
      - provider_obj
    Schedule:
      type: object
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        identifier:
          type: string
          readOnly: true
          nullable: true
          description: Unique schedule identifier
        uid:
          type: string
          readOnly: true
        actor_name:
          type: string
          readOnly: true
          description: Dramatiq actor to call
        rel_obj_app_label:
          type: string
          readOnly: true
        rel_obj_model:
          type: string
          title: Python model class name
          readOnly: true
        rel_obj_id:
          type: string
          nullable: true
        crontab:
          type: string
          description: When to schedule tasks
        paused:
          type: boolean
          description: Pause this schedule
        next_run:
          type: string
          format: date-time
          readOnly: true
        description:
          type: string
          nullable: true
          readOnly: true
        last_task_status:
          allOf:
          - $ref: '#/components/schemas/LastTaskStatusEnum'
          nullable: true
          readOnly: true
      required:
      - actor_name
      - crontab
      - description
      - id
      - identifier
      - last_task_status
      - next_run
      - rel_obj_app_label
      - rel_obj_model
      - uid
    ScheduleRequest:
      type: object
      properties:
        rel_obj_id:
          type: string
          nullable: true
          minLength: 1
        crontab:
          type: string
          minLength: 1
          description: When to schedule tasks
        paused:
          type: boolean
          description: Pause this schedule
      required:
      - crontab
    ScopeMapping:
      type: object
      description: ScopeMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
        expression:
          type: string
        component:
          type: string
          description: Get object's component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        scope_name:
          type: string
          description: Scope name requested by the client
        description:
          type: string
          description: Description shown to the user when consenting. If left empty,
            the user won't be informed.
      required:
      - component
      - expression
      - meta_model_name
      - name
      - pk
      - scope_name
      - verbose_name
      - verbose_name_plural
    ScopeMappingRequest:
      type: object
      description: ScopeMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
        scope_name:
          type: string
          minLength: 1
          description: Scope name requested by the client
        description:
          type: string
          description: Description shown to the user when consenting. If left empty,
            the user won't be informed.
      required:
      - expression
      - name
      - scope_name
    SelectableStage:
      type: object
      description: Serializer for stages which can be selected by users
      properties:
        pk:
          type: string
          format: uuid
        name:
          type: string
        verbose_name:
          type: string
        meta_model_name:
          type: string
      required:
      - meta_model_name
      - name
      - pk
      - verbose_name
    ServiceConnection:
      type: object
      description: ServiceConnection Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Uuid
        name:
          type: string
        local:
          type: boolean
          description: If enabled, use the local connection. Required Docker socket/Kubernetes
            Integration
        component:
          type: string
          description: Return component used to edit this object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    ServiceConnectionState:
      type: object
      description: Serializer for Service connection state
      properties:
        healthy:
          type: boolean
          readOnly: true
        version:
          type: string
          readOnly: true
      required:
      - healthy
      - version
    SessionEndChallenge:
      type: object
      description: Challenge for ending a session
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-session-end
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        pending_user:
          type: string
        pending_user_avatar:
          type: string
        application_name:
          type: string
        application_launch_url:
          type: string
        invalidation_flow_url:
          type: string
        brand_name:
          type: string
      required:
      - brand_name
      - pending_user
      - pending_user_avatar
    SessionUser:
      type: object
      description: |-
        Response for the /user/me endpoint, returns the currently active user (as `user` property)
        and, if this user is being impersonated, the original user in the `original` property.
      properties:
        user:
          $ref: '#/components/schemas/UserSelf'
        original:
          $ref: '#/components/schemas/UserSelf'
      required:
      - user
    Settings:
      type: object
      description: Settings Serializer
      properties:
        avatars:
          type: string
          description: Configure how authentik should show avatars for users.
        default_user_change_name:
          type: boolean
          description: Enable the ability for users to change their name.
        default_user_change_email:
          type: boolean
          description: Enable the ability for users to change their email address.
        default_user_change_username:
          type: boolean
          description: Enable the ability for users to change their username.
        event_retention:
          type: string
          description: 'Events will be deleted after this duration.(Format: weeks=3;days=2;hours=3,seconds=2).'
        reputation_lower_limit:
          type: integer
          maximum: 0
          minimum: -2147483648
          description: Reputation cannot decrease lower than this value. Zero or negative.
        reputation_upper_limit:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: Reputation cannot increase higher than this value. Zero or
            positive.
        footer_links: {}
        gdpr_compliance:
          type: boolean
          description: When enabled, all the events caused by a user will be deleted
            upon the user's deletion.
        impersonation:
          type: boolean
          description: Globally enable/disable impersonation.
        impersonation_require_reason:
          type: boolean
          description: Require administrators to provide a reason for impersonating
            a user.
        default_token_duration:
          type: string
          description: Default token duration
        default_token_length:
          type: integer
          maximum: 2147483647
          minimum: 1
          description: Default token length
        flags:
          type: object
          properties:
            policies_buffered_access_view:
              type: boolean
          required:
          - policies_buffered_access_view
      required:
      - flags
    SettingsRequest:
      type: object
      description: Settings Serializer
      properties:
        avatars:
          type: string
          minLength: 1
          description: Configure how authentik should show avatars for users.
        default_user_change_name:
          type: boolean
          description: Enable the ability for users to change their name.
        default_user_change_email:
          type: boolean
          description: Enable the ability for users to change their email address.
        default_user_change_username:
          type: boolean
          description: Enable the ability for users to change their username.
        event_retention:
          type: string
          minLength: 1
          description: 'Events will be deleted after this duration.(Format: weeks=3;days=2;hours=3,seconds=2).'
        reputation_lower_limit:
          type: integer
          maximum: 0
          minimum: -2147483648
          description: Reputation cannot decrease lower than this value. Zero or negative.
        reputation_upper_limit:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: Reputation cannot increase higher than this value. Zero or
            positive.
        footer_links: {}
        gdpr_compliance:
          type: boolean
          description: When enabled, all the events caused by a user will be deleted
            upon the user's deletion.
        impersonation:
          type: boolean
          description: Globally enable/disable impersonation.
        impersonation_require_reason:
          type: boolean
          description: Require administrators to provide a reason for impersonating
            a user.
        default_token_duration:
          type: string
          minLength: 1
          description: Default token duration
        default_token_length:
          type: integer
          maximum: 2147483647
          minimum: 1
          description: Default token length
        flags:
          type: object
          properties:
            policies_buffered_access_view:
              type: boolean
          required:
          - policies_buffered_access_view
      required:
      - flags
    SeverityEnum:
      enum:
      - notice
      - warning
      - alert
      type: string
    ShellChallenge:
      type: object
      description: challenge type to render HTML as-is
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: xak-flow-shell
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        body:
          type: string
      required:
      - body
    SignatureAlgorithmEnum:
      enum:
      - http://www.w3.org/2000/09/xmldsig#rsa-sha1
      - http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
      - http://www.w3.org/2001/04/xmldsig-more#rsa-sha384
      - http://www.w3.org/2001/04/xmldsig-more#rsa-sha512
      - http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha1
      - http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256
      - http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha384
      - http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha512
      - http://www.w3.org/2000/09/xmldsig#dsa-sha1
      type: string
    Software:
      type: object
      properties:
        name:
          type: string
        version:
          type: string
        source:
          type: string
        path:
          type: string
      required:
      - name
      - source
    SoftwareRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
        version:
          type: string
        source:
          type: string
          minLength: 1
        path:
          type: string
          minLength: 1
      required:
      - name
      - source
    Source:
      type: object
      description: Source Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pbm uuid
        name:
          type: string
          description: Source's display Name.
        slug:
          type: string
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
          readOnly: true
        user_path_template:
          type: string
        icon:
          type: string
          nullable: true
          description: |-
            Get the URL to the Icon. If the name is /static or
            starts with http it is returned as-is
          readOnly: true
      required:
      - component
      - icon
      - managed
      - meta_model_name
      - name
      - pk
      - slug
      - verbose_name
      - verbose_name_plural
    SourceStage:
      type: object
      description: SourceStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        source:
          type: string
          format: uuid
        resume_timeout:
          type: string
          description: 'Amount of time a user can take to return from the source to
            continue the flow (Format: hours=-1;minutes=-2;seconds=-3)'
      required:
      - component
      - meta_model_name
      - name
      - pk
      - source
      - verbose_name
      - verbose_name_plural
    SourceStageRequest:
      type: object
      description: SourceStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        source:
          type: string
          format: uuid
        resume_timeout:
          type: string
          minLength: 1
          description: 'Amount of time a user can take to return from the source to
            continue the flow (Format: hours=-1;minutes=-2;seconds=-3)'
      required:
      - name
      - source
    SourceType:
      type: object
      description: Serializer for SourceType
      properties:
        name:
          type: string
        verbose_name:
          type: string
        urls_customizable:
          type: boolean
        request_token_url:
          type: string
          readOnly: true
          nullable: true
        authorization_url:
          type: string
          readOnly: true
          nullable: true
        access_token_url:
          type: string
          readOnly: true
          nullable: true
        profile_url:
          type: string
          readOnly: true
          nullable: true
        oidc_well_known_url:
          type: string
          readOnly: true
          nullable: true
        oidc_jwks_url:
          type: string
          readOnly: true
          nullable: true
      required:
      - access_token_url
      - authorization_url
      - name
      - oidc_jwks_url
      - oidc_well_known_url
      - profile_url
      - request_token_url
      - urls_customizable
      - verbose_name
    Stage:
      type: object
      description: Stage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    StagePrompt:
      type: object
      description: Serializer for a single Prompt field
      properties:
        field_key:
          type: string
        label:
          type: string
        type:
          $ref: '#/components/schemas/PromptTypeEnum'
        required:
          type: boolean
        placeholder:
          type: string
        initial_value:
          type: string
        order:
          type: integer
        sub_text:
          type: string
        choices:
          type: array
          items:
            $ref: '#/components/schemas/PromptChoice'
          nullable: true
      required:
      - choices
      - field_key
      - initial_value
      - label
      - order
      - placeholder
      - required
      - sub_text
      - type
    StateEnum:
      enum:
      - queued
      - consumed
      - preprocess
      - running
      - postprocess
      - rejected
      - done
      type: string
    StaticDevice:
      type: object
      description: Serializer for static authenticator devices
      properties:
        name:
          type: string
          description: The human-readable name of this device.
          maxLength: 64
        token_set:
          type: array
          items:
            $ref: '#/components/schemas/StaticDeviceToken'
          readOnly: true
        pk:
          type: integer
          readOnly: true
          title: ID
        user:
          allOf:
          - $ref: '#/components/schemas/PartialUser'
          readOnly: true
      required:
      - name
      - pk
      - token_set
      - user
    StaticDeviceRequest:
      type: object
      description: Serializer for static authenticator devices
      properties:
        name:
          type: string
          minLength: 1
          description: The human-readable name of this device.
          maxLength: 64
      required:
      - name
    StaticDeviceToken:
      type: object
      description: Serializer for static device's tokens
      properties:
        token:
          type: string
          maxLength: 16
      required:
      - token
    SubModeEnum:
      enum:
      - hashed_user_id
      - user_id
      - user_uuid
      - user_username
      - user_email
      - user_upn
      type: string
    SyncObjectModelEnum:
      enum:
      - authentik.core.models.User
      - authentik.core.models.Group
      type: string
    SyncObjectRequest:
      type: object
      description: Sync object serializer
      properties:
        sync_object_model:
          $ref: '#/components/schemas/SyncObjectModelEnum'
        sync_object_id:
          type: string
          minLength: 1
        override_dry_run:
          type: boolean
          default: false
      required:
      - sync_object_id
      - sync_object_model
    SyncObjectResult:
      type: object
      description: Result of a single object sync
      properties:
        messages:
          type: array
          items:
            $ref: '#/components/schemas/LogEvent'
          readOnly: true
      required:
      - messages
    SyncStatus:
      type: object
      description: Provider/source sync status
      properties:
        is_running:
          type: boolean
        last_successful_sync:
          type: string
          format: date-time
        last_sync_status:
          $ref: '#/components/schemas/TaskAggregatedStatusEnum'
      required:
      - is_running
    SystemInfo:
      type: object
      description: Get system information.
      properties:
        http_headers:
          type: object
          additionalProperties:
            type: string
          description: Get HTTP Request headers
          readOnly: true
        http_host:
          type: string
          description: Get HTTP host
          readOnly: true
        http_is_secure:
          type: boolean
          description: Get HTTP Secure flag
          readOnly: true
        runtime:
          type: object
          description: Get versions
          properties:
            python_version:
              type: string
            environment:
              type: string
            architecture:
              type: string
            platform:
              type: string
            uname:
              type: string
            openssl_version:
              type: string
            openssl_fips_enabled:
              type: boolean
              nullable: true
            authentik_version:
              type: string
          required:
          - architecture
          - authentik_version
          - environment
          - openssl_fips_enabled
          - openssl_version
          - platform
          - python_version
          - uname
          readOnly: true
        brand:
          type: string
          description: Currently active brand
          readOnly: true
        server_time:
          type: string
          format: date-time
          description: Current server time
          readOnly: true
        embedded_outpost_disabled:
          type: boolean
          description: Whether the embedded outpost is disabled
          readOnly: true
        embedded_outpost_host:
          type: string
          description: Get the FQDN configured on the embedded outpost
          readOnly: true
      required:
      - brand
      - embedded_outpost_disabled
      - embedded_outpost_host
      - http_headers
      - http_host
      - http_is_secure
      - runtime
      - server_time
    TOTPDevice:
      type: object
      description: Serializer for totp authenticator devices
      properties:
        name:
          type: string
          description: The human-readable name of this device.
          maxLength: 64
        pk:
          type: integer
          readOnly: true
          title: ID
        user:
          allOf:
          - $ref: '#/components/schemas/PartialUser'
          readOnly: true
      required:
      - name
      - pk
      - user
    TOTPDeviceRequest:
      type: object
      description: Serializer for totp authenticator devices
      properties:
        name:
          type: string
          minLength: 1
          description: The human-readable name of this device.
          maxLength: 64
      required:
      - name
    Task:
      type: object
      properties:
        message_id:
          type: string
          format: uuid
        queue_name:
          type: string
          description: Queue name
        actor_name:
          type: string
          description: Dramatiq actor name
        state:
          allOf:
          - $ref: '#/components/schemas/StateEnum'
          description: Task status
        mtime:
          type: string
          format: date-time
          description: Task last modified time
        retries:
          type: integer
          maximum: 9223372036854775807
          minimum: 0
          format: int64
          description: Number of retries
        eta:
          type: string
          format: date-time
          nullable: true
          description: Planned execution time
        rel_obj_app_label:
          type: string
          readOnly: true
        rel_obj_model:
          type: string
          title: Python model class name
          readOnly: true
        rel_obj_id:
          type: string
          nullable: true
        uid:
          type: string
          readOnly: true
        logs:
          type: array
          items:
            $ref: '#/components/schemas/LogEvent'
          readOnly: true
        previous_logs:
          type: array
          items:
            $ref: '#/components/schemas/LogEvent'
          readOnly: true
        aggregated_status:
          $ref: '#/components/schemas/TaskAggregatedStatusEnum'
        description:
          type: string
          nullable: true
          readOnly: true
      required:
      - actor_name
      - aggregated_status
      - description
      - logs
      - previous_logs
      - rel_obj_app_label
      - rel_obj_model
      - uid
    TaskAggregatedStatusEnum:
      enum:
      - queued
      - consumed
      - preprocess
      - running
      - postprocess
      - rejected
      - done
      - info
      - warning
      - error
      type: string
    TelegramChallengeResponseRequest:
      type: object
      description: Base class for all challenge responses
      properties:
        component:
          type: string
          minLength: 1
          default: ak-source-telegram
        id:
          type: integer
        first_name:
          type: string
          minLength: 1
          maxLength: 255
        last_name:
          type: string
          minLength: 1
          maxLength: 255
        username:
          type: string
          minLength: 1
          maxLength: 255
        photo_url:
          type: string
          format: uri
          minLength: 1
        auth_date:
          type: integer
        hash:
          type: string
          minLength: 1
          maxLength: 64
      required:
      - auth_date
      - hash
      - id
    TelegramLoginChallenge:
      type: object
      description: Base login challenge for Identification stage
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-source-telegram
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        bot_username:
          type: string
          description: Telegram bot username
        request_message_access:
          type: boolean
      required:
      - bot_username
      - request_message_access
    TelegramSource:
      type: object
      description: Source Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pbm uuid
        name:
          type: string
          description: Source's display Name.
        slug:
          type: string
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
          readOnly: true
        user_path_template:
          type: string
        icon:
          type: string
          nullable: true
          readOnly: true
        bot_username:
          type: string
          description: Telegram bot username
        request_message_access:
          type: boolean
          description: Request access to send messages from your bot.
        pre_authentication_flow:
          type: string
          format: uuid
          description: Flow used before authentication.
      required:
      - bot_username
      - component
      - icon
      - managed
      - meta_model_name
      - name
      - pk
      - pre_authentication_flow
      - slug
      - verbose_name
      - verbose_name_plural
    TelegramSourcePropertyMapping:
      type: object
      description: TelegramSourcePropertyMapping Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Pm uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
        expression:
          type: string
        component:
          type: string
          description: Get object's component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
      required:
      - component
      - expression
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    TelegramSourcePropertyMappingRequest:
      type: object
      description: TelegramSourcePropertyMapping Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        name:
          type: string
          minLength: 1
        expression:
          type: string
          minLength: 1
      required:
      - expression
      - name
    TelegramSourceRequest:
      type: object
      description: Source Serializer
      properties:
        name:
          type: string
          minLength: 1
          description: Source's display Name.
        slug:
          type: string
          minLength: 1
          description: Internal source name, used in URLs.
          pattern: ^[-a-zA-Z0-9_]+$
        enabled:
          type: boolean
        promoted:
          type: boolean
          description: When enabled, this source will be displayed as a prominent
            button on the login page, instead of a small icon.
        authentication_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when authenticating existing users.
        enrollment_flow:
          type: string
          format: uuid
          nullable: true
          description: Flow to use when enrolling new users.
        user_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        group_property_mappings:
          type: array
          items:
            type: string
            format: uuid
        policy_engine_mode:
          $ref: '#/components/schemas/PolicyEngineMode'
        user_matching_mode:
          allOf:
          - $ref: '#/components/schemas/UserMatchingModeEnum'
          description: How the source determines if an existing user should be authenticated
            or a new user enrolled.
        user_path_template:
          type: string
          minLength: 1
        bot_username:
          type: string
          minLength: 1
          description: Telegram bot username
        bot_token:
          type: string
          writeOnly: true
          minLength: 1
          description: Telegram bot token
        request_message_access:
          type: boolean
          description: Request access to send messages from your bot.
        pre_authentication_flow:
          type: string
          format: uuid
          description: Flow used before authentication.
      required:
      - bot_token
      - bot_username
      - name
      - pre_authentication_flow
      - slug
    Tenant:
      type: object
      description: Tenant Serializer
      properties:
        tenant_uuid:
          type: string
          format: uuid
          readOnly: true
        schema_name:
          type: string
          maxLength: 63
        name:
          type: string
        ready:
          type: boolean
      required:
      - name
      - schema_name
      - tenant_uuid
    TenantAdminGroupRequestRequest:
      type: object
      description: Tenant admin group creation request serializer
      properties:
        user:
          type: string
          minLength: 1
      required:
      - user
    TenantRecoveryKeyRequestRequest:
      type: object
      description: Tenant recovery key creation request serializer
      properties:
        user:
          type: string
          minLength: 1
        duration_days:
          type: integer
      required:
      - duration_days
      - user
    TenantRecoveryKeyResponse:
      type: object
      description: Tenant recovery key creation response serializer
      properties:
        expiry:
          type: string
          format: date-time
        url:
          type: string
      required:
      - expiry
      - url
    TenantRequest:
      type: object
      description: Tenant Serializer
      properties:
        schema_name:
          type: string
          minLength: 1
          maxLength: 63
        name:
          type: string
          minLength: 1
        ready:
          type: boolean
      required:
      - name
      - schema_name
    Token:
      type: object
      description: Token Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Token uuid
        managed:
          type: string
          nullable: true
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        identifier:
          type: string
          maxLength: 255
          pattern: ^[-a-zA-Z0-9_]+$
        intent:
          $ref: '#/components/schemas/IntentEnum'
        user:
          type: integer
        user_obj:
          allOf:
          - $ref: '#/components/schemas/User'
          readOnly: true
        description:
          type: string
        expires:
          type: string
          format: date-time
          nullable: true
        expiring:
          type: boolean
      required:
      - identifier
      - pk
      - user_obj
    TokenModel:
      type: object
      description: Serializer for BaseGrantModel and RefreshToken
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        provider:
          $ref: '#/components/schemas/OAuth2Provider'
        user:
          $ref: '#/components/schemas/User'
        is_expired:
          type: boolean
          description: Check if token is expired yet.
          readOnly: true
        expires:
          type: string
          format: date-time
          nullable: true
        scope:
          type: array
          items:
            type: string
        id_token:
          type: string
          description: Get the token's id_token as JSON String
          readOnly: true
        revoked:
          type: boolean
      required:
      - id_token
      - is_expired
      - pk
      - provider
      - scope
      - user
    TokenRequest:
      type: object
      description: Token Serializer
      properties:
        managed:
          type: string
          nullable: true
          minLength: 1
          title: Managed by authentik
          description: Objects that are managed by authentik. These objects are created
            and updated automatically. This flag only indicates that an object can
            be overwritten by migrations. You can still modify the objects via the
            API, but expect changes to be overwritten in a later update.
        identifier:
          type: string
          minLength: 1
          maxLength: 255
          pattern: ^[-a-zA-Z0-9_]+$
        intent:
          $ref: '#/components/schemas/IntentEnum'
        user:
          type: integer
        description:
          type: string
        expires:
          type: string
          format: date-time
          nullable: true
        expiring:
          type: boolean
      required:
      - identifier
    TokenSetKeyRequest:
      type: object
      description: Set token's key
      properties:
        key:
          type: string
          minLength: 1
      required:
      - key
    TokenView:
      type: object
      description: Show token's current key
      properties:
        key:
          type: string
          readOnly: true
      required:
      - key
    TransactionApplicationRequest:
      type: object
      description: Serializer for creating a provider and an application in one transaction
      properties:
        app:
          $ref: '#/components/schemas/ApplicationRequest'
        provider_model:
          $ref: '#/components/schemas/ProviderModelEnum'
        provider:
          $ref: '#/components/schemas/modelRequest'
        policy_bindings:
          type: array
          items:
            $ref: '#/components/schemas/TransactionPolicyBindingRequest'
      required:
      - app
      - provider
      - provider_model
    TransactionApplicationResponse:
      type: object
      description: Transactional creation response
      properties:
        applied:
          type: boolean
        logs:
          type: array
          items:
            type: string
      required:
      - applied
      - logs
    TransactionPolicyBindingRequest:
      type: object
      description: PolicyBindingSerializer which does not require target as target
        is set implicitly
      properties:
        policy:
          type: string
          format: uuid
          nullable: true
        group:
          type: string
          format: uuid
          nullable: true
        user:
          type: integer
          nullable: true
        negate:
          type: boolean
          description: Negates the outcome of the policy. Messages are unaffected.
        enabled:
          type: boolean
        order:
          type: integer
          maximum: 2147483647
          minimum: -2147483648
        timeout:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: Timeout after which Policy execution is terminated.
        failure_result:
          type: boolean
          description: Result if the Policy execution fails.
      required:
      - order
    TypeCreate:
      type: object
      description: Types of an object that can be created
      properties:
        name:
          type: string
        description:
          type: string
        component:
          type: string
        model_name:
          type: string
        icon_url:
          type: string
        requires_enterprise:
          type: boolean
          default: false
      required:
      - component
      - description
      - model_name
      - name
    UiThemeEnum:
      enum:
      - automatic
      - light
      - dark
      type: string
    UniquePasswordPolicy:
      type: object
      description: Password Uniqueness Policy Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Policy uuid
        name:
          type: string
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        component:
          type: string
          description: Get object component so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        bound_to:
          type: integer
          description: Return objects policy is bound to
          readOnly: true
        password_field:
          type: string
          description: Field key to check, field keys defined in Prompt stages are
            available.
        num_historical_passwords:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: Number of passwords to check against.
      required:
      - bound_to
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    UniquePasswordPolicyRequest:
      type: object
      description: Password Uniqueness Policy Serializer
      properties:
        name:
          type: string
          minLength: 1
        execution_logging:
          type: boolean
          description: When this option is enabled, all executions of this policy
            will be logged. By default, only execution errors are logged.
        password_field:
          type: string
          minLength: 1
          description: Field key to check, field keys defined in Prompt stages are
            available.
        num_historical_passwords:
          type: integer
          maximum: 2147483647
          minimum: 0
          description: Number of passwords to check against.
      required:
      - name
    UsedBy:
      type: object
      description: A list of all objects referencing the queried object
      properties:
        app:
          type: string
        model_name:
          type: string
        pk:
          type: string
        name:
          type: string
        action:
          $ref: '#/components/schemas/UsedByActionEnum'
      required:
      - action
      - app
      - model_name
      - name
      - pk
    UsedByActionEnum:
      enum:
      - cascade
      - cascade_many
      - set_null
      - set_default
      type: string
    User:
      type: object
      description: User Serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        username:
          type: string
          maxLength: 150
        name:
          type: string
          description: User's display name.
        is_active:
          type: boolean
          title: Active
          description: Designates whether this user should be treated as active. Unselect
            this instead of deleting accounts.
        last_login:
          type: string
          format: date-time
          nullable: true
        date_joined:
          type: string
          format: date-time
          readOnly: true
        is_superuser:
          type: boolean
          readOnly: true
        groups:
          type: array
          items:
            type: string
            format: uuid
        groups_obj:
          type: array
          items:
            $ref: '#/components/schemas/PartialGroup'
          readOnly: true
          nullable: true
        email:
          type: string
          format: email
          title: Email address
          maxLength: 254
        avatar:
          type: string
          description: User's avatar, either a http/https URL or a data URI
          readOnly: true
        attributes:
          type: object
          additionalProperties: {}
        uid:
          type: string
          readOnly: true
        path:
          type: string
        type:
          $ref: '#/components/schemas/UserTypeEnum'
        uuid:
          type: string
          format: uuid
          readOnly: true
        password_change_date:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
      required:
      - avatar
      - date_joined
      - groups_obj
      - is_superuser
      - last_updated
      - name
      - password_change_date
      - pk
      - uid
      - username
      - uuid
    UserAccountRequest:
      type: object
      description: Account adding/removing operations
      properties:
        pk:
          type: integer
      required:
      - pk
    UserAssignedObjectPermission:
      type: object
      description: Users assigned object permission serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        username:
          type: string
          description: Required. 150 characters or fewer. Letters, digits and @/./+/-/_
            only.
          pattern: ^[\w.@+-]+$
          maxLength: 150
        name:
          type: string
          description: User's display name.
        is_active:
          type: boolean
          title: Active
          description: Designates whether this user should be treated as active. Unselect
            this instead of deleting accounts.
        last_login:
          type: string
          format: date-time
          nullable: true
        email:
          type: string
          format: email
          title: Email address
          maxLength: 254
        attributes:
          type: object
          additionalProperties: {}
        uid:
          type: string
          readOnly: true
        permissions:
          type: array
          items:
            $ref: '#/components/schemas/UserObjectPermission'
        is_superuser:
          type: boolean
      required:
      - is_superuser
      - name
      - permissions
      - pk
      - uid
      - username
    UserAttributeEnum:
      enum:
      - username
      - email
      type: string
    UserConsent:
      type: object
      description: UserConsent Serializer
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        expires:
          type: string
          format: date-time
          nullable: true
        expiring:
          type: boolean
        user:
          $ref: '#/components/schemas/User'
        application:
          $ref: '#/components/schemas/Application'
        permissions:
          type: string
          default: ''
      required:
      - application
      - pk
      - user
    UserCreationModeEnum:
      enum:
      - never_create
      - create_when_required
      - always_create
      type: string
    UserDeleteStage:
      type: object
      description: UserDeleteStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    UserDeleteStageRequest:
      type: object
      description: UserDeleteStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
      required:
      - name
    UserFieldsEnum:
      enum:
      - email
      - username
      - upn
      type: string
    UserKerberosSourceConnection:
      type: object
      description: User source connection
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        user:
          type: integer
        source:
          type: string
          format: uuid
        source_obj:
          allOf:
          - $ref: '#/components/schemas/Source'
          readOnly: true
        identifier:
          type: string
        created:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
      required:
      - created
      - identifier
      - last_updated
      - pk
      - source
      - source_obj
      - user
    UserKerberosSourceConnectionRequest:
      type: object
      description: User source connection
      properties:
        user:
          type: integer
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
      required:
      - identifier
      - source
      - user
    UserLDAPSourceConnection:
      type: object
      description: User source connection
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        user:
          type: integer
        source:
          type: string
          format: uuid
        source_obj:
          allOf:
          - $ref: '#/components/schemas/Source'
          readOnly: true
        identifier:
          type: string
        created:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
      required:
      - created
      - identifier
      - last_updated
      - pk
      - source
      - source_obj
      - user
    UserLDAPSourceConnectionRequest:
      type: object
      description: User source connection
      properties:
        user:
          type: integer
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
      required:
      - identifier
      - source
      - user
    UserLoginChallenge:
      type: object
      description: Empty challenge
      properties:
        flow_info:
          $ref: '#/components/schemas/ContextualFlowInfo'
        component:
          type: string
          default: ak-stage-user-login
        response_errors:
          type: object
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/ErrorDetail'
        pending_user:
          type: string
        pending_user_avatar:
          type: string
      required:
      - pending_user
      - pending_user_avatar
    UserLoginChallengeResponseRequest:
      type: object
      description: User login challenge
      properties:
        component:
          type: string
          minLength: 1
          default: ak-stage-user-login
        remember_me:
          type: boolean
      required:
      - remember_me
    UserLoginStage:
      type: object
      description: UserLoginStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        session_duration:
          type: string
          description: 'Determines how long a session lasts. Default of 0 means that
            the sessions lasts until the browser is closed. (Format: hours=-1;minutes=-2;seconds=-3)'
        terminate_other_sessions:
          type: boolean
          description: Terminate all other sessions of the user logging in.
        remember_me_offset:
          type: string
          description: 'Offset the session will be extended by when the user picks
            the remember me option. Default of 0 means that the remember me option
            will not be shown. (Format: hours=-1;minutes=-2;seconds=-3)'
        network_binding:
          allOf:
          - $ref: '#/components/schemas/NetworkBindingEnum'
          description: Bind sessions created by this stage to the configured network
        geoip_binding:
          allOf:
          - $ref: '#/components/schemas/GeoipBindingEnum'
          description: Bind sessions created by this stage to the configured GeoIP
            location
        remember_device:
          type: string
          description: 'When set to a non-zero value, authentik will save a cookie
            with a longer expiry,to remember the device the user is logging in from.
            (Format: hours=-1;minutes=-2;seconds=-3)'
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    UserLoginStageRequest:
      type: object
      description: UserLoginStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        session_duration:
          type: string
          minLength: 1
          description: 'Determines how long a session lasts. Default of 0 means that
            the sessions lasts until the browser is closed. (Format: hours=-1;minutes=-2;seconds=-3)'
        terminate_other_sessions:
          type: boolean
          description: Terminate all other sessions of the user logging in.
        remember_me_offset:
          type: string
          minLength: 1
          description: 'Offset the session will be extended by when the user picks
            the remember me option. Default of 0 means that the remember me option
            will not be shown. (Format: hours=-1;minutes=-2;seconds=-3)'
        network_binding:
          allOf:
          - $ref: '#/components/schemas/NetworkBindingEnum'
          description: Bind sessions created by this stage to the configured network
        geoip_binding:
          allOf:
          - $ref: '#/components/schemas/GeoipBindingEnum'
          description: Bind sessions created by this stage to the configured GeoIP
            location
        remember_device:
          type: string
          minLength: 1
          description: 'When set to a non-zero value, authentik will save a cookie
            with a longer expiry,to remember the device the user is logging in from.
            (Format: hours=-1;minutes=-2;seconds=-3)'
      required:
      - name
    UserLogoutStage:
      type: object
      description: UserLogoutStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    UserLogoutStageRequest:
      type: object
      description: UserLogoutStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
      required:
      - name
    UserMatchingModeEnum:
      enum:
      - identifier
      - email_link
      - email_deny
      - username_link
      - username_deny
      type: string
    UserOAuthSourceConnection:
      type: object
      description: User source connection
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        user:
          type: integer
        source:
          type: string
          format: uuid
        source_obj:
          allOf:
          - $ref: '#/components/schemas/Source'
          readOnly: true
        identifier:
          type: string
        created:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
        expires:
          type: string
          format: date-time
      required:
      - created
      - identifier
      - last_updated
      - pk
      - source
      - source_obj
      - user
    UserOAuthSourceConnectionRequest:
      type: object
      description: User source connection
      properties:
        user:
          type: integer
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
        access_token:
          type: string
          writeOnly: true
          nullable: true
        expires:
          type: string
          format: date-time
      required:
      - identifier
      - source
      - user
    UserObjectPermission:
      type: object
      description: User-bound object level permission
      properties:
        id:
          type: integer
          readOnly: true
        codename:
          type: string
          readOnly: true
        model:
          type: string
          title: Python model class name
          readOnly: true
        app_label:
          type: string
          readOnly: true
        object_pk:
          type: string
        name:
          type: string
          readOnly: true
      required:
      - app_label
      - codename
      - id
      - model
      - name
      - object_pk
    UserPasswordSetRequest:
      type: object
      description: Payload to set a users' password directly
      properties:
        password:
          type: string
          minLength: 1
      required:
      - password
    UserPath:
      type: object
      properties:
        paths:
          type: array
          items:
            type: string
          readOnly: true
      required:
      - paths
    UserPlexSourceConnection:
      type: object
      description: User source connection
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        user:
          type: integer
        source:
          type: string
          format: uuid
        source_obj:
          allOf:
          - $ref: '#/components/schemas/Source'
          readOnly: true
        identifier:
          type: string
        created:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
      required:
      - created
      - identifier
      - last_updated
      - pk
      - source
      - source_obj
      - user
    UserPlexSourceConnectionRequest:
      type: object
      description: User source connection
      properties:
        user:
          type: integer
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
        plex_token:
          type: string
          writeOnly: true
          minLength: 1
      required:
      - identifier
      - plex_token
      - source
      - user
    UserRequest:
      type: object
      description: User Serializer
      properties:
        username:
          type: string
          minLength: 1
          maxLength: 150
        name:
          type: string
          description: User's display name.
        is_active:
          type: boolean
          title: Active
          description: Designates whether this user should be treated as active. Unselect
            this instead of deleting accounts.
        last_login:
          type: string
          format: date-time
          nullable: true
        groups:
          type: array
          items:
            type: string
            format: uuid
        email:
          type: string
          format: email
          title: Email address
          maxLength: 254
        attributes:
          type: object
          additionalProperties: {}
        path:
          type: string
          minLength: 1
        type:
          $ref: '#/components/schemas/UserTypeEnum'
      required:
      - name
      - username
    UserSAMLSourceConnection:
      type: object
      description: User source connection
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        user:
          type: integer
        source:
          type: string
          format: uuid
        source_obj:
          allOf:
          - $ref: '#/components/schemas/Source'
          readOnly: true
        identifier:
          type: string
        created:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
      required:
      - created
      - identifier
      - last_updated
      - pk
      - source
      - source_obj
      - user
    UserSAMLSourceConnectionRequest:
      type: object
      description: User source connection
      properties:
        user:
          type: integer
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
      required:
      - identifier
      - source
      - user
    UserSelf:
      type: object
      description: User Serializer for information a user can retrieve about themselves
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        username:
          type: string
          description: Required. 150 characters or fewer. Letters, digits and @/./+/-/_
            only.
          pattern: ^[\w.@+-]+$
          maxLength: 150
        name:
          type: string
          description: User's display name.
        is_active:
          type: boolean
          readOnly: true
          title: Active
          description: Designates whether this user should be treated as active. Unselect
            this instead of deleting accounts.
        is_superuser:
          type: boolean
          readOnly: true
        groups:
          type: array
          items:
            $ref: '#/components/schemas/UserSelfGroups'
          readOnly: true
        email:
          type: string
          format: email
          title: Email address
          maxLength: 254
        avatar:
          type: string
          description: User's avatar, either a http/https URL or a data URI
          readOnly: true
        uid:
          type: string
          readOnly: true
        settings:
          type: object
          additionalProperties: {}
          description: Get user settings with brand and group settings applied
          readOnly: true
        type:
          $ref: '#/components/schemas/UserTypeEnum'
        system_permissions:
          type: array
          items:
            type: string
          description: Get all system permissions assigned to the user
          readOnly: true
      required:
      - avatar
      - groups
      - is_active
      - is_superuser
      - name
      - pk
      - settings
      - system_permissions
      - uid
      - username
    UserSelfGroups:
      type: object
      properties:
        name:
          type: string
          readOnly: true
        pk:
          type: string
          readOnly: true
      required:
      - name
      - pk
    UserServiceAccountRequest:
      type: object
      description: Payload to create a service account
      properties:
        name:
          type: string
          minLength: 1
        create_group:
          type: boolean
          default: false
        expiring:
          type: boolean
          default: true
        expires:
          type: string
          format: date-time
          description: If not provided, valid for 360 days
      required:
      - name
    UserServiceAccountResponse:
      type: object
      properties:
        username:
          type: string
        token:
          type: string
        user_uid:
          type: string
        user_pk:
          type: integer
        group_pk:
          type: string
      required:
      - token
      - user_pk
      - user_uid
      - username
    UserSetting:
      type: object
      description: Serializer for User settings for stages and sources
      properties:
        object_uid:
          type: string
        component:
          type: string
        title:
          type: string
        configure_url:
          type: string
        icon_url:
          type: string
      required:
      - component
      - object_uid
      - title
    UserSourceConnection:
      type: object
      description: User source connection
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        user:
          type: integer
        source:
          type: string
          format: uuid
        source_obj:
          allOf:
          - $ref: '#/components/schemas/Source'
          readOnly: true
        identifier:
          type: string
        created:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
      required:
      - created
      - identifier
      - last_updated
      - pk
      - source
      - source_obj
      - user
    UserSourceConnectionRequest:
      type: object
      description: User source connection
      properties:
        user:
          type: integer
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
      required:
      - identifier
      - source
      - user
    UserTelegramSourceConnection:
      type: object
      description: User source connection
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        user:
          type: integer
        source:
          type: string
          format: uuid
        source_obj:
          allOf:
          - $ref: '#/components/schemas/Source'
          readOnly: true
        identifier:
          type: string
        created:
          type: string
          format: date-time
          readOnly: true
        last_updated:
          type: string
          format: date-time
          readOnly: true
      required:
      - created
      - identifier
      - last_updated
      - pk
      - source
      - source_obj
      - user
    UserTelegramSourceConnectionRequest:
      type: object
      description: User source connection
      properties:
        user:
          type: integer
        source:
          type: string
          format: uuid
        identifier:
          type: string
          minLength: 1
      required:
      - identifier
      - source
      - user
    UserTypeEnum:
      enum:
      - internal
      - external
      - service_account
      - internal_service_account
      type: string
    UserVerificationEnum:
      enum:
      - required
      - preferred
      - discouraged
      type: string
    UserWriteStage:
      type: object
      description: UserWriteStage Serializer
      properties:
        pk:
          type: string
          format: uuid
          readOnly: true
          title: Stage uuid
        name:
          type: string
        component:
          type: string
          description: Get object type so that we know how to edit the object
          readOnly: true
        verbose_name:
          type: string
          description: Return object's verbose_name
          readOnly: true
        verbose_name_plural:
          type: string
          description: Return object's plural verbose_name
          readOnly: true
        meta_model_name:
          type: string
          description: Return internal model name
          readOnly: true
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSet'
        user_creation_mode:
          $ref: '#/components/schemas/UserCreationModeEnum'
        create_users_as_inactive:
          type: boolean
          description: When set, newly created users are inactive and cannot login.
        create_users_group:
          type: string
          format: uuid
          nullable: true
          description: Optionally add newly created users to this group.
        user_type:
          $ref: '#/components/schemas/UserTypeEnum'
        user_path_template:
          type: string
      required:
      - component
      - meta_model_name
      - name
      - pk
      - verbose_name
      - verbose_name_plural
    UserWriteStageRequest:
      type: object
      description: UserWriteStage Serializer
      properties:
        name:
          type: string
          minLength: 1
        flow_set:
          type: array
          items:
            $ref: '#/components/schemas/FlowSetRequest'
        user_creation_mode:
          $ref: '#/components/schemas/UserCreationModeEnum'
        create_users_as_inactive:
          type: boolean
          description: When set, newly created users are inactive and cannot login.
        create_users_group:
          type: string
          format: uuid
          nullable: true
          description: Optionally add newly created users to this group.
        user_type:
          $ref: '#/components/schemas/UserTypeEnum'
        user_path_template:
          type: string
      required:
      - name
    ValidationError:
      type: object
      description: Validation Error
      properties:
        non_field_errors:
          type: array
          items:
            type: string
        code:
          type: string
      additionalProperties: {}
    Version:
      type: object
      description: Get running and latest version.
      properties:
        version_current:
          type: string
          description: Get current version
          readOnly: true
        version_latest:
          type: string
          description: Get latest version from cache
          readOnly: true
        version_latest_valid:
          type: boolean
          description: Check if latest version is valid
          readOnly: true
        build_hash:
          type: string
          description: Get build hash, if version is not latest or released
          readOnly: true
        outdated:
          type: boolean
          description: Check if we're running the latest version
          readOnly: true
        outpost_outdated:
          type: boolean
          description: Check if any outpost is outdated/has a version mismatch
          readOnly: true
      required:
      - build_hash
      - outdated
      - outpost_outdated
      - version_current
      - version_latest
      - version_latest_valid
    VersionHistory:
      type: object
      description: VersionHistory Serializer
      properties:
        id:
          type: integer
          readOnly: true
        timestamp:
          type: string
          format: date-time
        version:
          type: string
        build:
          type: string
      required:
      - build
      - id
      - timestamp
      - version
    WebAuthnDevice:
      type: object
      description: Serializer for WebAuthn authenticator devices
      properties:
        pk:
          type: integer
          readOnly: true
          title: ID
        name:
          type: string
          maxLength: 200
        created_on:
          type: string
          format: date-time
          readOnly: true
        device_type:
          allOf:
          - $ref: '#/components/schemas/WebAuthnDeviceType'
          readOnly: true
          nullable: true
        aaguid:
          type: string
          readOnly: true
        user:
          allOf:
          - $ref: '#/components/schemas/PartialUser'
          readOnly: true
      required:
      - aaguid
      - created_on
      - device_type
      - name
      - pk
      - user
    WebAuthnDeviceRequest:
      type: object
      description: Serializer for WebAuthn authenticator devices
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 200
      required:
      - name
    WebAuthnDeviceType:
      type: object
      description: WebAuthnDeviceType Serializer
      properties:
        aaguid:
          type: string
          format: uuid
        description:
          type: string
      required:
      - aaguid
      - description
    Worker:
      type: object
      properties:
        worker_id:
          type: string
        version:
          type: string
        version_matching:
          type: boolean
      required:
      - version
      - version_matching
      - worker_id
    modelRequest:
      oneOf:
      - $ref: '#/components/schemas/GoogleWorkspaceProviderRequest'
      - $ref: '#/components/schemas/LDAPProviderRequest'
      - $ref: '#/components/schemas/MicrosoftEntraProviderRequest'
      - $ref: '#/components/schemas/OAuth2ProviderRequest'
      - $ref: '#/components/schemas/ProxyProviderRequest'
      - $ref: '#/components/schemas/RACProviderRequest'
      - $ref: '#/components/schemas/RadiusProviderRequest'
      - $ref: '#/components/schemas/SAMLProviderRequest'
      - $ref: '#/components/schemas/SCIMProviderRequest'
      - $ref: '#/components/schemas/SSFProviderRequest'
      discriminator:
        propertyName: provider_model
        mapping:
          authentik_providers_google_workspace.googleworkspaceprovider: '#/components/schemas/GoogleWorkspaceProviderRequest'
          authentik_providers_ldap.ldapprovider: '#/components/schemas/LDAPProviderRequest'
          authentik_providers_microsoft_entra.microsoftentraprovider: '#/components/schemas/MicrosoftEntraProviderRequest'
          authentik_providers_oauth2.oauth2provider: '#/components/schemas/OAuth2ProviderRequest'
          authentik_providers_proxy.proxyprovider: '#/components/schemas/ProxyProviderRequest'
          authentik_providers_rac.racprovider: '#/components/schemas/RACProviderRequest'
          authentik_providers_radius.radiusprovider: '#/components/schemas/RadiusProviderRequest'
          authentik_providers_saml.samlprovider: '#/components/schemas/SAMLProviderRequest'
          authentik_providers_scim.scimprovider: '#/components/schemas/SCIMProviderRequest'
          authentik_providers_ssf.ssfprovider: '#/components/schemas/SSFProviderRequest'
  securitySchemes:
    authentik:
      type: http
      scheme: bearer
servers:
- url: /api/v3
apiVersion: v1
kind: Namespace
metadata:
  name: cnpg-system
  labels:
    name: cnpg-system
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - namespace.yaml
  - postgres-cluster.yaml
labels:
  - pairs:
      app.kubernetes.io/managed-by: argocd
      app.kubernetes.io/part-of: homelab
    includeSelectors: false
# Operator installed via:
# kubectl apply --server-side -f https://raw.githubusercontent.com/cloudnative-pg/cloudnative-pg/release-1.22/releases/cnpg-1.22.0.yaml
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: postgres
  namespace: default
  labels:
    app.kubernetes.io/name: postgres
    app.kubernetes.io/component: database
    app.kubernetes.io/part-of: homelab
spec:
  instances: 3

  storage:
    size: 10Gi
    storageClass: longhorn

  postgresql:
    parameters:
      max_connections: "100"
      shared_buffers: "256MB"

  bootstrap:
    initdb:
      database: app
      owner: app

  affinity:
    podAntiAffinityType: preferred
    topologyKey: kubernetes.io/hostname

  monitoring:
    enablePodMonitor: true
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: grafana-tls
  namespace: monitoring
  labels:
    app.kubernetes.io/name: grafana
    app.kubernetes.io/component: tls
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  secretName: grafana-tls
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  dnsNames:
    - grafana.lab.axiomlayer.com
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: monitoring
resources:
  - grafana-certificate.yaml
  - grafana-oidc-sealed-secret.yaml
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: grafana-oidc-secret
  namespace: monitoring
spec:
  encryptedData:
    "client-id": AgCka7rFjeoWcR7mJIhod+uk4GwDOPMEYvgceoR59SMreuyeXF+eyl9P8tDWewzuuSwn+ZjLcnnYIl/uCt65HadweFebT1OAP6LI2m9cEspYwEM/n5+Cg9wBasMoMkLZKp61xXoWRX5kXq0+ih29ytWVhFcgUlgBf8NbkyJk5Ih0WbHGZ1a4xUXSvNCWEpCs1tnL0xuV8G9nUpFrgtSvw3AW01ESxboLiDyAKGBDKOSl4oDZYB0AojaZYCNeBjzanMO20D5ejVCKMqD3fik69UqQ+uW/pWMLVuIDnCXOiVX2umwX5hyONL+zIN1mribeAOHCBYRxKLFn68Bc1ypeW7hXWTh6TqJpRI1P7G78x6i+gkBQH7iXqgva317f2Oyt8rxYxp5IpHIlfvmYISeyAobGU3mL7i/MYFeEkTE9uyinz0qApPCrgdXotqAtTzFYV3wd9MQYbi0Z05C1DaNlYRRYlYtM3JqSvxjxCmmCDmPne2SoKzK/J3yqJuVbYtU3bbod6G4gbvVLYVIXOT5lc1XSTaB5XUS81ibix6Ga/dZRKcGGxaUg+HDat4dotQaPiQiYM1cafcwK13T+e24oKVBNcXyIg0Ji9g3M2wQBEmzh4r6f65/U6XW/73ymFiHFaJ7mwaWjfTrtMH8OgGdvG/rFScRcL6CZN0uvGzudQU5rTqSx2PkvGRnWmOR1DoReKkC/DFSTzNiq
    "client-secret": AgAtK719RvEld+feuOQSWlQu7uTqRynYdfQ4fMjbkZMxuUXCFlDelmnKttpRDBwOQ7B/bDjyMxSmrsqTyTmxMIXezG5bW3ESX5r+ObbLq5biiegQz4npMoZds8ff8kuwwZu+GNpggFSF2Zt4TCe8x64ZjlBkWtPSmlIbGR8rf55kvlzFH1+CvGNw//THzVJI7DBpdDqkBmr6bQFwAPC0nh4YJo3OCsLIKaIrlnVDrSe876juRT7IBuvQMWSWOIU2xtpMQyHUV/wgOhey8wEk39cVuSQpLMaWKDw0y1MyfDRwnPIDjQ+/t7qWTOLky8/AaPT4SfFSUdsMEwJ1pL7M6voCdUXIsdog9/aJMay3fQOVS3aU9AWWu446QdY0Ls2QtjM/dk+qt8yxAe/Qw5i5qJ+WCe6Sy5ese2w1EsGfQnysRCHyiOn+SaVaCjcJ6onrU6M3vhMj04NWdzo2FfIrOHDy9y6aBz3ZJ5TbiB3Ygvc+ey+d/LqjKuRFpBkbu+OXBPgDJfMnRBozsZlJnVJRAl9mPiZ+zv78oeNre0Nr0jeCnQF3EjByU6LU/RfNz2siAuC6aQEJOlTaOdjHcgcI2gZcp9QuuPcC8fjG44poGW6XbeQ+pa2z7KAx04jWBB2EnM83sBo2qZrKSOruYnN9svmSl0GC1qwRaGu385stK3lTC7cGUR6NaCBkYl54gzmUKt3kZXMKGc3+9PwA+vhFIKfUdhBEovK0jvQsL15hr2lVaYwrP+xxYbobpQG/TDnnam7qdII5LztEYC2I/su+PbZoJdExx2iXNSuttIzFgGvB7PxYbXtdVbyEtYEvq7d1VqnV7RFv5QHrur+Ayc0lURhQuIxv1W17PxTT8iq1SBBLEA==
  template:
    metadata:
      name: grafana-oidc-secret
      namespace: monitoring
    type: Opaque
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: backup-db-credentials
  namespace: longhorn-system
spec:
  encryptedData:
    authentik-password: AgBsynEZFitz96AOr8k3t2QEdkftykDLB7SnAFmoeuz+ssiL3xj0uRtDt2b1QTNW7M0J3B7Nz8oOdl0C0Uiqg3nEkIDztu2nQxuKcjpEbVwvg81G466odSuWPql96jwLrXN88VCk7b29QHlKVsFSt3f4ykgfnZN54hn7/ebXxbvEeK19B+HXdVUTO8o/lHNS8MBdahRLXdb3fRMFL/tAgeP0IWJnzdvs6SC9eKk8MW46ywQ8Tt6ArgGEVr09rCLmo0224bQgkmrEh4uR2ank2Xacz5YkoJK+Kr1mZeb0p/P/mzox5F58Dup8Ye7tCRfRykKoQQlps1IoeJZ5oh4xi9j7xs6wtzMILz6PF89Oz7IAQLnL9PIozgp2hhDjPxxoV5LHotWwC2tx6/vlfz7LHFs89MV4yGlTtlHre2RXLEwGJLkE4r634Dwst75Xggh1kEWjpUXwXz+iFHd7EwhaayAsXnUsUopUdnotogvp5PqnzzR4SdOyeHXuIptNnZW6IzAWSgSu6dZnLgS98ROuK/diEeuqBwAIQ3kKecRR5KYIcwVWqtOGCGjwGzXlE0BZJ/6p2v/Rg5hOZBCh97a+x3M3jsGGM/OEoVTztCXO261sDpCuXzAMklcYPE/YkdEfv8hSe2OZZTAogUShv8Gic3TV6R/PlRRNfIe1fmwcHHBUMrqgoZAecRlUoWNNby3d3/89ES5aCNBbs3h2iaicEtZWCFGFpM3sC97EI7PJFVUdbg==
    outline-password: AgA56J4FFcxAAPiulIU5Oi9569CUOTJGyJy590WA6828rqp8WiILpSqQoG4crDHBhblEaOtRaYLKJXGFpCNJMvDM+0sGSl5NUJPMB7f25o/EYkyMk8xcvTtPSJWMzZe4Elab6Bx7rtGddiBkglXUSAxOlrvsCk3sbOb0CYSJDvXJD/s2qfXSyvZ3EXyMJIgtUK+6W0RE9+RGjk/mcw7ZYZJHB9v5z3Dd6mwO5/YIkEfv2HsxgQqgpz5s6PIYtdpf5WmhogJhqhP4Oe/DRUTGVKb/c4gWXi0ruvjHO80T461PKI0GAL3cJBOghOjLVIZtkRTwDPkCDK64tSKh7Tk8gGO/d+WZ1xDeENq7dJ1bpF8uW8NH5TgHLSTy8y5e7SmywMcvrumu4MNuWAKWRUNQj3lfYdXBHlsM3Fnscj6F7JtRB/0SRF5LvlAf6vFAUkQo4iNrOIic6N/0NSs2u4Tau7RIogaLjSTXNx7gQ2xXfd0+VMxTZ399bA6F4hYWvV6T0l7vhx8Qex8BVGg2IplCGXEtBlzns1fTXquAUz00lLzkvAKYMmCYWxaCGSKZuYC1LPgyh1t3AnKBCQ5GzvyEfzj3g3eCQDSfFymsVk3pHmlNLzCRvyVETkPy8fiSqbp/37+EfKYGjJ9/UNs0qgv20G0oE6kciKvkFD8q176ekDKxWqjHy1v16PfI7fCF5nQVBfBm2zalvnu9w6VAE6CY+XH593i1ev5+hL7apT/syh36oWl2dOzYVgb580pGlJ1ZyVihRmUBYk01q+wiPXsk/Rvc
  template:
    metadata:
      name: backup-db-credentials
      namespace: longhorn-system
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - longhorn-recurring-jobs.yaml
  - backup-cronjob.yaml
  - backup-db-credentials-sealed.yaml
# Longhorn Recurring Backup Jobs
# These create automatic snapshots and backups of all volumes
apiVersion: longhorn.io/v1beta2
kind: RecurringJob
metadata:
  name: daily-snapshot
  namespace: longhorn-system
  labels:
    app.kubernetes.io/name: longhorn
    app.kubernetes.io/component: backup
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  name: daily-snapshot
  task: snapshot
  cron: "0 2 * * *"  # 2 AM daily
  retain: 7           # Keep 7 daily snapshots
  concurrency: 2
  groups:
    - default
---
apiVersion: longhorn.io/v1beta2
kind: RecurringJob
metadata:
  name: weekly-snapshot
  namespace: longhorn-system
  labels:
    app.kubernetes.io/name: longhorn
    app.kubernetes.io/component: backup
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  name: weekly-snapshot
  task: snapshot
  cron: "0 3 * * 0"  # 3 AM every Sunday
  retain: 4           # Keep 4 weekly snapshots
  concurrency: 2
  groups:
    - default
# Automated Backup CronJob
# Backs up Authentik and Outline databases to NAS via nfs-proxy
apiVersion: batch/v1
kind: CronJob
metadata:
  name: homelab-backup
  namespace: longhorn-system
  labels:
    app.kubernetes.io/name: homelab-backup
    app.kubernetes.io/component: backup
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  schedule: "0 3 * * *"  # 3 AM daily
  concurrencyPolicy: Forbid
  successfulJobsHistoryLimit: 3
  failedJobsHistoryLimit: 3
  jobTemplate:
    spec:
      ttlSecondsAfterFinished: 86400  # Clean up after 24 hours
      template:
        metadata:
          labels:
            app.kubernetes.io/name: homelab-backup
        spec:
          restartPolicy: OnFailure
          serviceAccountName: backup-sa
          nodeSelector:
            kubernetes.io/hostname: neko
          containers:
            - name: backup
              image: postgres:16-alpine
              command:
                - /bin/sh
                - -c
                - |
                  set -e
                  DATE=$(date +%Y%m%d-%H%M%S)
                  BACKUP_DIR="/backup/homelab-$DATE"
                  mkdir -p "$BACKUP_DIR"

                  echo "=== Homelab Backup - $DATE ==="

                  # Backup Authentik DB
                  echo "Backing up Authentik database..."
                  PGPASSWORD="$AUTHENTIK_DB_PASSWORD" pg_dump \
                    -h authentik-db-rw.authentik.svc \
                    -U authentik \
                    -d authentik \
                    > "$BACKUP_DIR/authentik-db.sql"
                  echo "   Authentik: $(wc -l < "$BACKUP_DIR/authentik-db.sql") lines"

                  # Backup Outline DB
                  echo "Backing up Outline database..."
                  PGPASSWORD="$OUTLINE_DB_PASSWORD" pg_dump \
                    -h outline-db-rw.outline.svc \
                    -U outline \
                    -d outline \
                    > "$BACKUP_DIR/outline-db.sql"
                  echo "   Outline: $(wc -l < "$BACKUP_DIR/outline-db.sql") lines"

                  # Cleanup old backups (keep last 7)
                  echo "Cleaning up old backups..."
                  cd /backup && ls -dt homelab-*/ 2>/dev/null | tail -n +8 | xargs -r rm -rf

                  echo "=== Backup Complete ==="
                  ls -lh "$BACKUP_DIR"
              env:
                - name: AUTHENTIK_DB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: backup-db-credentials
                      key: authentik-password
                - name: OUTLINE_DB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: backup-db-credentials
                      key: outline-password
              volumeMounts:
                - name: backup-storage
                  mountPath: /backup
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
                limits:
                  cpu: 500m
                  memory: 512Mi
          volumes:
            - name: backup-storage
              nfs:
                server: 192.168.1.234
                path: /volume/e8e70d24-82e0-45f1-8ef6-f8ca399ad2d6/.srv/.unifi-drive/Shared_Drive_Example/.data/k8s-backup
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: backup-sa
  namespace: longhorn-system
  labels:
    app.kubernetes.io/name: homelab-backup
    app.kubernetes.io/part-of: homelab
apiVersion: v1
kind: Namespace
metadata:
  name: nfs-proxy
  labels:
    app.kubernetes.io/name: nfs-proxy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nfs-proxy
  namespace: nfs-proxy
  labels:
    app.kubernetes.io/name: nfs-proxy
    app.kubernetes.io/component: server
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: nfs-proxy
  strategy:
    type: Recreate
  template:
    metadata:
      labels:
        app.kubernetes.io/name: nfs-proxy
        app.kubernetes.io/component: server
    spec:
      nodeSelector:
        kubernetes.io/hostname: neko
      containers:
        - name: nfs-server
          image: erichough/nfs-server@sha256:1efd4ece380c5ba27479417585224ef857006daa46ab84560a28c1224bc71e9e
          ports:
            - name: nfs
              containerPort: 2049
              protocol: TCP
            - name: nfs-udp
              containerPort: 2049
              protocol: UDP
            - name: mountd
              containerPort: 20048
              protocol: TCP
            - name: rpcbind
              containerPort: 111
              protocol: TCP
            - name: statd
              containerPort: 32765
              protocol: TCP
            - name: statd-udp
              containerPort: 32765
              protocol: UDP
            - name: lockd
              containerPort: 32767
              protocol: TCP
            - name: lockd-udp
              containerPort: 32767
              protocol: UDP
          securityContext:
            privileged: true
            capabilities:
              add:
                - SYS_ADMIN
          env:
            - name: NFS_EXPORT_0
              value: "/data/k8s-backup *(rw,sync,no_subtree_check,no_root_squash,fsid=0)"
            - name: NFS_LOG_LEVEL
              value: "DEBUG"
          volumeMounts:
            - name: upstream-nfs
              mountPath: /data
          resources:
            requests:
              cpu: 100m
              memory: 256Mi
            limits:
              cpu: 500m
              memory: 512Mi
      volumes:
        - name: upstream-nfs
          nfs:
            server: 192.168.1.234
            path: /volume/e8e70d24-82e0-45f1-8ef6-f8ca399ad2d6/.srv/.unifi-drive/Shared_Drive_Example/.data
apiVersion: v1
kind: ConfigMap
metadata:
  name: nfs-ganesha-config
  namespace: nfs-proxy
  labels:
    app.kubernetes.io/name: nfs-proxy
    app.kubernetes.io/component: config
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
data:
  ganesha.conf: |
    NFS_CORE_PARAM {
        NFS_Protocols = 3,4;
        Bind_addr = 0.0.0.0;
    }

    EXPORT {
        Export_Id = 1;
        Path = /data/k8s-backup;
        Pseudo = /k8s-backup;
        Access_Type = RW;
        Squash = No_Root_Squash;
        SecType = sys;
        Filesystem_id = 1.1;
        FSAL {
            Name = VFS;
        }
        CLIENT {
            Clients = 10.42.0.0/16;
            Access_Type = RW;
        }
    }
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: nfs-proxy
resources:
  - namespace.yaml
  - configmap.yaml
  - deployment.yaml
  - service.yaml
  - networkpolicy.yaml
labels:
  - pairs:
      app.kubernetes.io/managed-by: argocd
      app.kubernetes.io/part-of: homelab
    includeSelectors: false
apiVersion: v1
kind: Service
metadata:
  name: nfs-proxy
  namespace: nfs-proxy
  labels:
    app.kubernetes.io/name: nfs-proxy
    app.kubernetes.io/component: server
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  type: ClusterIP
  selector:
    app.kubernetes.io/name: nfs-proxy
  ports:
    - name: nfs
      port: 2049
      targetPort: 2049
      protocol: TCP
    - name: nfs-udp
      port: 2049
      targetPort: 2049
      protocol: UDP
    - name: mountd
      port: 20048
      targetPort: 20048
      protocol: TCP
    - name: rpcbind
      port: 111
      targetPort: 111
      protocol: TCP
    - name: statd
      port: 32765
      targetPort: 32765
      protocol: TCP
    - name: statd-udp
      port: 32765
      targetPort: 32765
      protocol: UDP
    - name: lockd
      port: 32767
      targetPort: 32767
      protocol: TCP
    - name: lockd-udp
      port: 32767
      targetPort: 32767
      protocol: UDP
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: nfs-proxy-default-deny
  namespace: nfs-proxy
  labels:
    app.kubernetes.io/name: nfs-proxy
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector: {}
  policyTypes:
    - Ingress
    - Egress
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: nfs-proxy-allow-ingress
  namespace: nfs-proxy
  labels:
    app.kubernetes.io/name: nfs-proxy
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: nfs-proxy
  policyTypes:
    - Ingress
  ingress:
    # Allow NFS from cluster pods (Longhorn backup)
    - from:
        - namespaceSelector: {}
      ports:
        - protocol: TCP
          port: 2049
        - protocol: UDP
          port: 2049
        - protocol: TCP
          port: 20048
        - protocol: TCP
          port: 111
        - protocol: TCP
          port: 32765
        - protocol: UDP
          port: 32765
        - protocol: TCP
          port: 32767
        - protocol: UDP
          port: 32767
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: nfs-proxy-allow-egress
  namespace: nfs-proxy
  labels:
    app.kubernetes.io/name: nfs-proxy
    app.kubernetes.io/component: network-policy
    app.kubernetes.io/part-of: homelab
    app.kubernetes.io/managed-by: argocd
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: nfs-proxy
  policyTypes:
    - Egress
  egress:
    # Allow DNS resolution
    - to:
        - namespaceSelector: {}
          podSelector:
            matchLabels:
              k8s-app: kube-dns
      ports:
        - protocol: UDP
          port: 53
        - protocol: TCP
          port: 53
    # Allow NFS to upstream NAS (192.168.1.234)
    - to:
        - ipBlock:
            cidr: 192.168.1.234/32
      ports:
        - protocol: TCP
          port: 2049
        - protocol: UDP
          port: 2049
        - protocol: TCP
          port: 111
        - protocol: UDP
          port: 111
